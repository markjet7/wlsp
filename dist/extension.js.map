{"version":3,"sources":[".././node_modules/abort-controller/dist/abort-controller.js",".././node_modules/duplexer/index.js",".././node_modules/event-stream/index.js",".././node_modules/event-target-shim/dist/event-target-shim.js",".././node_modules/find-free-port/index.js",".././node_modules/from/index.js",".././node_modules/map-stream/index.js",".././node_modules/pause-stream/index.js",".././node_modules/ps-tree/index.js",".././node_modules/split/index.js",".././node_modules/stream-combiner/index.js",".././node_modules/through/index.js",".././src/clients.ts",".././src/dataPanel.ts",".././src/notebook.ts",".././src/notebookController.ts",".././src/plotsView.ts",".././src/scriptController.ts",".././src/treeDataProvider.ts",".././node_modules/vscode-jsonrpc/lib/cancellation.js",".././node_modules/vscode-jsonrpc/lib/events.js",".././node_modules/vscode-jsonrpc/lib/is.js",".././node_modules/vscode-jsonrpc/lib/linkedMap.js",".././node_modules/vscode-jsonrpc/lib/main.js",".././node_modules/vscode-jsonrpc/lib/messageReader.js",".././node_modules/vscode-jsonrpc/lib/messageWriter.js",".././node_modules/vscode-jsonrpc/lib/messages.js",".././node_modules/vscode-jsonrpc/lib/pipeSupport.js",".././node_modules/vscode-jsonrpc/lib/socketSupport.js",".././node_modules/vscode-languageclient/lib/callHierarchy.proposed.js",".././node_modules/vscode-languageclient/lib/client.js",".././node_modules/vscode-languageclient/lib/codeConverter.js",".././node_modules/vscode-languageclient/lib/colorProvider.js",".././node_modules/vscode-languageclient/lib/configuration.js",".././node_modules/vscode-languageclient/lib/declaration.js",".././node_modules/vscode-languageclient/lib/foldingRange.js",".././node_modules/vscode-languageclient/lib/implementation.js",".././node_modules/vscode-languageclient/lib/main.js",".././node_modules/vscode-languageclient/lib/progress.js",".././node_modules/vscode-languageclient/lib/progressPart.js",".././node_modules/vscode-languageclient/lib/protocolCodeLens.js",".././node_modules/vscode-languageclient/lib/protocolCompletionItem.js",".././node_modules/vscode-languageclient/lib/protocolConverter.js",".././node_modules/vscode-languageclient/lib/protocolDocumentLink.js",".././node_modules/vscode-languageclient/lib/selectionRange.js",".././node_modules/vscode-languageclient/lib/semanticTokens.proposed.js",".././node_modules/vscode-languageclient/lib/typeDefinition.js",".././node_modules/vscode-languageclient/lib/utils/async.js",".././node_modules/vscode-languageclient/lib/utils/is.js",".././node_modules/vscode-languageclient/lib/utils/processes.js",".././node_modules/vscode-languageclient/lib/utils/uuid.js",".././node_modules/vscode-languageclient/lib/workspaceFolders.js",".././node_modules/vscode-languageclient/node_modules/semver/semver.js",".././node_modules/vscode-languageserver-protocol/lib/main.js",".././node_modules/vscode-languageserver-protocol/lib/messages.js",".././node_modules/vscode-languageserver-protocol/lib/protocol.callHierarchy.proposed.js",".././node_modules/vscode-languageserver-protocol/lib/protocol.colorProvider.js",".././node_modules/vscode-languageserver-protocol/lib/protocol.configuration.js",".././node_modules/vscode-languageserver-protocol/lib/protocol.declaration.js",".././node_modules/vscode-languageserver-protocol/lib/protocol.foldingRange.js",".././node_modules/vscode-languageserver-protocol/lib/protocol.implementation.js",".././node_modules/vscode-languageserver-protocol/lib/protocol.js",".././node_modules/vscode-languageserver-protocol/lib/protocol.progress.js",".././node_modules/vscode-languageserver-protocol/lib/protocol.selectionRange.js",".././node_modules/vscode-languageserver-protocol/lib/protocol.sematicTokens.proposed.js",".././node_modules/vscode-languageserver-protocol/lib/protocol.typeDefinition.js",".././node_modules/vscode-languageserver-protocol/lib/protocol.workspaceFolders.js",".././node_modules/vscode-languageserver-protocol/lib/utils/is.js",".././node_modules/vscode-languageserver-types/lib/esm/main.js","../external \"buffer\"","../external \"child_process\"","../external \"crypto\"","../external \"fs\"","../external \"net\"","../external \"os\"","../external \"path\"","../external \"stream\"","../external \"string_decoder\"","../external \"vscode\"","../webpack/bootstrap","../webpack/runtime/define property getters","../webpack/runtime/hasOwnProperty shorthand","../webpack/runtime/make namespace object",".././src/extension.ts"],"names":["Object","defineProperty","exports","value","eventTargetShim","AbortSignal","EventTarget","super","TypeError","aborted","abortedFlags","get","this","defineEventAttribute","prototype","WeakMap","defineProperties","enumerable","Symbol","toStringTag","configurable","AbortController","signals","set","signal","create","call","createAbortSignal","getSignal","dispatchEvent","type","controller","abort","default","module","Stream","writeMethods","readMethods","readEvents","slice","Array","forEach","arr","fn","i","length","writer","reader","stream","ended","methodName","apply","arguments","emit","func","on","args","unshift","reemit","writable","readable","err","es","through","from","duplex","map","pause","split","pipeline","immediately","global","setImmediate","process","nextTick","connect","pipe","concat","merge","toMerge","setMaxListeners","endCount","e","end","write","data","destroy","writeArray","done","Error","a","array","isDone","l","push","readArray","paused","isArray","resume","continueOnError","reading","mapSync","sync","mappedData","undefined","log","name","console","error","child","stdin","stdout","parse","options","emitError","obj","JSON","toString","stringify","Buffer","isBuffer","replace","to","join","str","wait","first","callback","body","pipeable","privateData","wrappers","pd","event","retv","assert","setCancelFlag","passiveListener","cancelable","canceled","preventDefault","Event","eventTarget","eventPhase","currentTarget","stopped","immediateStopped","timeStamp","Date","now","keys","key","defineRedirectDescriptor","defineCallDescriptor","getWrapper","proto","wrapper","BaseEvent","CustomEvent","constructor","isFunc","getOwnPropertyDescriptor","defineWrapper","getPrototypeOf","isStopped","setPassiveListener","stopPropagation","stopImmediatePropagation","Boolean","bubbles","composed","cancelBubble","window","setPrototypeOf","listenersMap","isObject","x","getListeners","listeners","eventTargetPrototype","eventName","node","listenerType","listener","next","prev","delete","newNode","passive","once","defineEventAttributeDescriptor","defineCustomEventTarget","eventNames","CustomEventTarget","types","Map","optionsIsObj","capture","wrappedEvent","wrapEvent","handleEvent","setEventPhase","setCurrentTarget","defaultPrevented","net","findFreePort","beg","rest","p","cb","ip","cnt","test","retcb","res","probe","port","s","createConnection","host","onprobe","nextPort","Promise","resolve","reject","ports","source","source_index","source_len","started","mapper","opts","self","inputs","outputs","destroyed","lastWritten","inNext","errorEventName","failures","writeQueue","queueData","number","nextToWrite","hasOwnProperty","dataToWrite","written","input","spawn","normalizeHeader","platform","pid","processLister","headers","line","columns","trim","row","h","shift","ps","parents","children","proc","PPID","PID","Decoder","matcher","decoder","soFar","maxLength","piece","queue","buffer","pieces","pop","b","duplexer","streams","last","thepipe","recurse","onerror","_ended","drain","_end","autoDestroy","fp","wolframStatusBar","vscode","createStatusBarItem","StatusBarAlignment","Left","wolframVersionText","fs","lspPath","kernelPath","context","outputChannel","clientPort","kernelPort","clients","processes","updateConfiguration","workspace","getConfiguration","restart","wolframBusyQ","evaluationQueue","wolframClient","stopWolfram","wolfram","then","startWLSP","wolframKernelClient","wolframKernel","startWLSPKernel","text","show","onclientReady","checkClient","initializeResult","onReady","onNotification","updatePositions","sendRequest","result","setTimeout","onkernelReady","checkKernel","onRunInWolfram","wolframBusy","updateDecorations","updateVarTable","moveCursor","treeDataProvider","workspaceSymbolProvider","registerTreeDataProvider","context0","outputChannel0","asAbsolutePath","path","command","onDidChangeTextDocument","didChangeTextDocument","scriptserializer","WolframScriptSerializer","notebookSerializer","WolframNotebookSerializer","notebookcontroller","WolframNotebookController","scriptController","WolframScriptController","subscriptions","registerNotebookSerializer","commands","registerCommand","runInWolfram","printInWolfram","runTextCell","startWolframTerminal","runInTerminal","help","stringHelp","textToSection","textFromSection","createFile","createNotebook","createNotebookScript","showOutput","showPlots","runExpression","onDidOpenTextDocument","didOpenTextDocument","onDidSaveTextDocument","didSaveTextDocument","onDidChangeWindowState","didChangeWindowState","onDidChangeConfiguration","textDocuments","onDidChangeWorkspaceFolders","folder","removed","client","uri","stop","promises","values","all","movePositions","params","variableTable","vars","index","updateOutputPanel","runningLines","activeTextEditor","outputPosition","Position","selection","Selection","revealRange","Range","TextEditorRevealType","Default","decorateRunningLine","decorationLine","document","lineAt","start","lineNumber","range","character","d","starttime","print","sel","evaluationData","textDocument","sendToWolfram","active","lineCount","edit","editBuilder","insert","scheme","sendNotification","ready","file","appendLine","readFileSync","visibleTextEditors","filter","printResults","output","updateResults","refresh","outputPanel","plotsPanel","outputColumn","viewColumn","visible","reveal","createWebviewPanel","preserveFocus","enableScripts","retainContextWhenHidden","webview","html","getOutputContent","extensionUri","onDidReceiveMessage","message","onDidDispose","showPlotPanel","expression","busy","workspaceDecorations","clearDecorations","editor","newDecorations","decorationfile","editorDecorations","setDecorations","variableDecorationType","createTextEditorDecorationType","backgroundColor","light","color","ThemeColor","dark","out","k","postMessage","timeout","serverOptions","socket","Socket","toLocaleTimeString","clearTimeout","code","setKeepAlive","freePort","load","r","clientOptions","documentSelector","diagnosticCollectionName","LanguageClient","disposible","cp","detached","showErrorMessage","client_process","exec","stderr","location","doc","languageId","isUntitled","has","getWorkspaceFolder","openTextDocument","Uri","showTextDocument","openNotebookDocument","state","focused","cmd","activeWolframTerminal","createTerminal","activeTerminal","selections","sendText","getText","txt","url","string","lines","newlines","editbuilder","trimRight","getUri","pathList","asWebviewUri","joinPath","getTime","cspSource","raw","cells","content","_token","contents","TextDecoder","decode","mretry","item","getCells","kind","metadata","attempts","NotebookData","NotebookCellData","outs","reduce","o","c","NotebookCellOutput","NotebookCellOutputItem","cell","language","fileName","viewType","isDirty","languages","_wolframClient","mapping","preloadScript","displayOrders","nextExecutionOrder","version","contentOptions","transientOutputs","transientMetadata","controllerId","notebookType","label","supportedLanguages","_executionOrder","_controller","notebooks","createNotebookController","supportsExecutionOrder","executeHandler","_execute","bind","_notebook","_doExecution","notebook","NotebookCellKind","Code","execution","executionSummary","executionOrder","executionId","id","createNotebookCellExecution","abortCtl","token","onCancellationRequested","replaceOutput","isCancellationRequested","dispose","executions","_context","interruptHandler","_interrupt","substring","TreeItem","TreeItemCollapsibleState","None","Collapsed","_onDidChangeTreeData","EventEmitter","onDidChangeTreeData","getBuiltins","getSymbols","builtins","readFile","letters","String","fromCharCode","builtinsymbols","symbol","tooltip","definition","title","letter","startsWith","fire","files","workspace_items","some","f","symbolToTreeItem","collapsibleState","Expanded","element","events_1","Is","CancellationToken","freeze","Cancelled","is","candidate","boolean","shortcutEvent","handle","MutableToken","_isCancelled","_emitter","Emitter","CancellationTokenSource","cancel","Disposable","_disposable","CallbackList","bucket","_callbacks","_contexts","remove","foundCallbackWithDifferentContext","len","splice","ret","callbacks","contexts","_options","_event","thisArgs","disposables","onFirstListenerAdd","isEmpty","add","_noop","onLastListenerRemove","invoke","Number","stringArray","every","elem","Touch","First","Last","LinkedMap","_map","_head","_tail","_size","clear","touch","previous","addItemLast","addItemFirst","removeItem","callbackfn","thisArg","current","__export","m","messages_1","RequestType","RequestType0","RequestType1","RequestType2","RequestType3","RequestType4","RequestType5","RequestType6","RequestType7","RequestType8","RequestType9","ResponseError","ErrorCodes","NotificationType","NotificationType0","NotificationType1","NotificationType2","NotificationType3","NotificationType4","NotificationType5","NotificationType6","NotificationType7","NotificationType8","NotificationType9","messageReader_1","MessageReader","StreamMessageReader","IPCMessageReader","SocketMessageReader","messageWriter_1","MessageWriter","StreamMessageWriter","IPCMessageWriter","SocketMessageWriter","cancellation_1","linkedMap_1","CancelNotification","ProgressNotification","Trace","TraceFormat","SetTraceNotification","LogTraceNotification","ConnectionErrors","ConnectionState","ProgressType","NullLogger","warn","info","fromString","Off","toLowerCase","Messages","Verbose","Text","ConnectionError","_createMessageConnection","messageReader","messageWriter","logger","strategy","sequenceNumber","notificationSquenceNumber","unknownResponseSquenceNumber","starRequestHandler","starNotificationHandler","timer","tracer","requestHandlers","notificationHandlers","progressHandlers","messageQueue","responsePromises","requestTokens","trace","traceFormat","New","errorEmitter","closeEmitter","unhandledNotificationEmitter","unhandledProgressEmitter","disposeEmitter","createRequestQueueKey","cancelUndispatched","_message","isListening","Listening","isClosed","Closed","isDisposed","Disposed","closeHandler","triggerMessageQueue","size","isRequestMessage","requestMessage","reply","resultOrError","method","startTime","jsonrpc","toJson","traceSendingResponse","replyError","logLSPMessage","traceReceivedRequest","requestHandler","handler","cancellationSource","tokenKey","handlerResult","numberOfParams","promise","InternalError","replySuccess","MethodNotFound","handleRequest","isNotificationMessage","notificationHandler","traceReceivedNotification","handleNotification","isResponseMessage","responseMessage","responsePromise","timerStart","traceReceivedResponse","handleResponse","responseHandler","handleInvalidMessage","processMessageQueue","onClose","onError","toCancel","response","addMessageToQueue","lspMessage","isLSPMessage","timestamp","throwIfClosedOrDisposed","undefinedToNull","param","computeMessageParams","connection","messageParams","notificationMessage","traceSendingNotification","onProgress","_type","sendProgress","onUnhandledProgress","throwIfNotListening","traceSendingRequest","MessageWriteError","onRequest","_value","_tracer","sendNotificationOrTraceOptions","_sendNotification","_traceFormat","onUnhandledNotification","onDispose","listen","AlreadyListening","throwIfListening","inspect","verbose","ConnectionStrategy","createMessageConnection","read","isMessageWriter","DefaultSize","CR","LF","MessageBuffer","encoding","allocUnsafe","chunk","toAppend","bufferLen","byteLength","copy","newSize","Math","ceil","header","indexOf","substr","nextStart","onPartialMessage","AbstractMessageReader","partialMessageEmitter","asError","_partialMessageTimeout","nextMessageLength","messageToken","partialMessageTimer","onData","fireError","fireClose","append","tryReadHeaders","contentLength","parseInt","isNaN","msg","tryReadContent","setPartialMessageTimer","clearPartialMessageTimer","json","firePartialMessage","waitingTime","eventEmitter","ContentLength","CRLF","AbstractMessageWriter","count","errorCount","sending","doWriteMessage","send","handleError","ParseError","InvalidRequest","InvalidParams","serverErrorStart","serverErrorEnd","ServerNotInitialized","UnknownErrorCode","RequestCancelled","ContentModified","MessageReadError","AbstractMessageType","_method","_numberOfParams","_","path_1","os_1","crypto_1","net_1","generateRandomPipeName","randomSuffix","randomBytes","tmpdir","createClientPipeTransport","pipeName","connectResolve","connected","_reject","server","createServer","close","removeListener","onConnected","createServerPipeTransport","createClientSocketTransport","createServerSocketTransport","vscode_1","vscode_languageserver_protocol_1","client_1","ensure","target","protocol2code","code2protocol","asCallHierarchyItem","converter","CallHierarchyItem","asSymbolKind","detail","asUri","asRange","selectionRange","tags","asSymbolTags","asCallHierarchyIncomingCall","CallHierarchyIncomingCall","asRanges","fromRanges","asCallHierarchyOutgoingCall","CallHierarchyOutgoingCall","asCallHierarchyItems","items","asCallHierarchyIncomingCalls","asCallHierarchyOutgoingCalls","CallHierarchyProvider","middleware","position","prepareCallHierarchy","code2ProtocolConverter","asTextDocumentPositionParams","Proposed","CallHierarchyPrepareRequest","protocol2CodeConverter","logFailedRequest","provideCallHierarchyIncomingCalls","CallHierarchyIncomingCallsRequest","provideCallHierarchyOutgoingCalls","CallHierarchyOutgoingCallsRequest","provideCallHierarchyOutgingCalls","CallHierarchyFeature","TextDocumentFeature","cap","dynamicRegistration","capabilities","getRegistration","callHierarchyProvider","register","messages","registerOptions","_client","provider","registerCallHierarchyProvider","c2p","p2c","async_1","UUID","progressPart_1","ConsoleLogger","ErrorAction","CloseAction","RevealOutputChannelOn","State","ClientState","DefaultErrorHandler","restarts","_error","Continue","Shutdown","Restart","DoNotRestart","SupportedSymbolKinds","SymbolKind","File","Module","Namespace","Package","Class","Method","Property","Field","Constructor","Enum","Interface","Function","Variable","Constant","Key","Null","EnumMember","Struct","Operator","TypeParameter","SupportedCompletionItemKinds","CompletionItemKind","Unit","Value","Keyword","Snippet","Color","Reference","Folder","DynamicFeature","unregister","DocumentNotifiactions","_middleware","_createParams","_selectorFilter","_selectors","selectors","selector","match","_listener","notificationSent","_data","DidOpenTextDocumentFeature","_syncedDocuments","DidOpenTextDocumentNotification","didOpen","asOpenTextDocumentParams","textDocumentFilter","textDocumentSyncOptions","resolvedTextDocumentSync","openClose","generateUuid","DidCloseTextDocumentFeature","onDidCloseTextDocument","DidCloseTextDocumentNotification","didClose","asCloseTextDocumentParams","DidChangeTextDocumentFeature","_changeData","_forcingDelivery","DidChangeTextDocumentNotification","change","TextDocumentSyncKind","assign","syncKind","contentChanges","changeData","Incremental","asChangeTextDocumentParams","didChange","Full","_changeDelayer","forceDelivery","delayer","trigger","Delayer","WillSaveFeature","onWillSaveTextDocument","WillSaveTextDocumentNotification","willSave","willSaveEvent","asWillSaveTextDocumentParams","WillSaveWaitUntilFeature","WillSaveTextDocumentWaitUntilRequest","willSaveWaitUntil","edits","vEdits","asTextEdits","waitUntil","DidSaveTextDocumentFeature","DidSaveTextDocumentNotification","didSave","asSaveTextDocumentParams","_includeText","save","includeText","FileSystemWatcherFeature","_notifyFileEvent","_watchers","DidChangeWatchedFilesNotification","_capabilities","_documentSelector","watchers","disposeables","watcher","globPattern","watchCreate","watchChange","watchDelete","WatchKind","Create","Change","Delete","fileSystemWatcher","createFileSystemWatcher","hookListeners","fileSystemWatchers","onDidCreate","resource","FileChangeType","Created","onDidChange","Changed","onDidDelete","Deleted","disposable","_registrations","registration","registerLanguageProvider","capability","TextDocumentRegistrationOptions","StaticRegistrationOptions","hasId","WorkDoneProgressOptions","CompletionItemFeature","CompletionRequest","capabilites","completion","contextSupport","completionItem","snippetSupport","commitCharactersSupport","documentationFormat","MarkupKind","Markdown","PlainText","deprecatedSupport","preselectSupport","tagSupport","valueSet","CompletionItemTag","Deprecated","completionItemKind","getRegistrationOptions","completionProvider","triggerCharacters","provideCompletionItems","asCompletionParams","asCompletionResult","provideCompletionItem","resolveCompletionItem","resolveProvider","CompletionResolveRequest","asCompletionItem","registerCompletionItemProvider","HoverFeature","HoverRequest","hoverCapability","contentFormat","hoverProvider","provideHover","asHover","registerHoverProvider","SignatureHelpFeature","SignatureHelpRequest","config","signatureInformation","parameterInformation","labelOffsetSupport","signatureHelpProvider","provideSignatureHelp","providerSignatureHelp","asSignatureHelpParams","asSignatureHelp","retriggerCharacters","registerSignatureHelpProvider","metaData","DefinitionFeature","DefinitionRequest","definitionSupport","linkSupport","definitionProvider","provideDefinition","asDefinitionResult","registerDefinitionProvider","ReferencesFeature","ReferencesRequest","referencesProvider","provideReferences","_providerReferences","asReferenceParams","asReferences","registerReferenceProvider","DocumentHighlightFeature","DocumentHighlightRequest","documentHighlightProvider","provideDocumentHighlights","_provideDocumentHighlights","asDocumentHighlights","registerDocumentHighlightProvider","DocumentSymbolFeature","DocumentSymbolRequest","symbolCapabilities","symbolKind","hierarchicalDocumentSymbolSupport","documentSymbolProvider","provideDocumentSymbols","_provideDocumentSymbols","asDocumentSymbolParams","DocumentSymbol","asDocumentSymbols","asSymbolInformations","registerDocumentSymbolProvider","WorkspaceSymbolFeature","WorkspaceSymbolRequest","workDoneProgress","provideWorkspaceSymbols","query","registerWorkspaceSymbolProvider","CodeActionFeature","CodeActionRequest","isPreferredSupport","codeActionLiteralSupport","codeActionKind","CodeActionKind","Empty","QuickFix","Refactor","RefactorExtract","RefactorInline","RefactorRewrite","Source","SourceOrganizeImports","codeActionProvider","provideCodeActions","_provideCodeActions","asTextDocumentIdentifier","asCodeActionContext","Command","asCommand","asCodeAction","registerCodeActionsProvider","codeActionKinds","providedCodeActionKinds","asCodeActionKinds","CodeLensFeature","CodeLensRequest","codeLensProvider","provideCodeLenses","asCodeLensParams","asCodeLenses","resolveCodeLens","codeLens","CodeLensResolveRequest","asCodeLens","registerCodeLensProvider","DocumentFormattingFeature","DocumentFormattingRequest","documentFormattingProvider","provideDocumentFormattingEdits","asFormattingOptions","registerDocumentFormattingEditProvider","DocumentRangeFormattingFeature","DocumentRangeFormattingRequest","documentRangeFormattingProvider","provideDocumentRangeFormattingEdits","registerDocumentRangeFormattingEditProvider","DocumentOnTypeFormattingFeature","DocumentOnTypeFormattingRequest","documentOnTypeFormattingProvider","provideOnTypeFormattingEdits","ch","asPosition","moreTriggerCharacter","registerOnTypeFormattingEditProvider","firstTriggerCharacter","RenameFeature","RenameRequest","rename","prepareSupport","renameProvider","prepareProvider","provideRenameEdits","newName","asWorkspaceEdit","prepareRename","PrepareRenameRequest","placeholder","registerRenameProvider","DocumentLinkFeature","DocumentLinkRequest","documentLinkCapabilities","tooltipSupport","documentLinkProvider","provideDocumentLinks","asDocumentLinkParams","asDocumentLinks","resolveDocumentLink","link","DocumentLinkResolveRequest","asDocumentLink","registerDocumentLinkProvider","ConfigurationFeature","_listeners","DidChangeConfigurationNotification","section","synchronize","configurationSection","sections","affectsConfiguration","didChangeConfiguration","settings","extractSettingsInformation","getMiddleware","ensurePath","workspaceFolder","ExecuteCommandFeature","_commands","ExecuteCommandRequest","executeCommandProvider","executeCommand","MessageTransports","OnReady","_resolve","_used","BaseLanguageClient","_features","_method2Message","_dynamicFeatures","_id","_name","_clientOptions","outputChannelName","revealOutputChannelOn","stdioEncoding","initializationOptions","initializationFailedHandler","progressOnInitialization","errorHandler","uriConverters","Initial","_connectionPromise","_resolvedConnection","_initializeResult","_outputChannel","_disposeOutputChannel","_traceOutputChannel","traceOutputChannel","_providers","_diagnostics","_fileEvents","_fileEventDelayer","_onReady","_onReadyCallbacks","_onStop","_telemetryEmitter","_stateChangeEmitter","messageOrDataObject","logTrace","logObjectTrace","_c2p","createConverter","code2Protocol","_p2c","protocol2Code","registerBuiltinFeatures","_state","oldState","getPublicState","newState","Running","Starting","Stopped","isConnectionActive","forceDocumentSync","createOutputChannel","_trace","resolveConnection","responseError","stack","showNotification","data2String","Info","showNotificationMessage","Warn","showInformationMessage","Stopping","isUsed","createDiagnosticCollection","onLogMessage","MessageType","Warning","onShowMessage","showWarningMessage","ShowMessageRequest","messageFunc","actions","onTelemetry","initialize","StartFailed","needsStop","refreshTrace","initOption","rootPath","fsPath","_clientGetRootPath","initParams","processId","clientInfo","rootUri","computeClientCapabilities","workspaceFolders","fillInitializeParams","part","ProgressPart","workDoneToken","doInitialize","textDocumentSync","onDiagnostics","handleDiagnostics","RegistrationRequest","handleRegistrationRequest","UnregistrationRequest","handleUnregistrationRequest","ApplyWorkspaceEditRequest","handleApplyWorkspaceEdit","InitializedNotification","hookFileEvents","hookConfigurationChanged","initializeFeatures","retry","folders","cleanUp","shutdown","exit","cleanUpChannel","channel","diagnostics","_a","_b","didChangeWatchedFile","didChangeWatchedFiles","changes","workSpaceMiddleware","asDiagnostics","setDiagnostics","handleConnectionError","handleConnectionClosed","createMessageTransports","transports","createProtocolConnection","defaultTraceOptions","InitializeRequest","ShutdownRequest","ExitNotification","LogMessageNotification","ShowMessageNotification","TelemetryEventNotification","didCloseTextDocument","PublishDiagnosticsNotification","action","closed","traceConfig","_connection","fileEvents","registerRaw","features","feature","registerFeature","request","notifyFileEvent","applyEdit","workspaceEdit","documentChanges","resourceOperations","ResourceOperationKind","Rename","failureHandling","FailureHandlingKind","TextOnlyTransactional","relatedInformation","versionSupport","DiagnosticTag","Unnecessary","fillClientCapabilities","registrations","unregistration","unregisterations","openTextDocuments","versionMismatch","TextDocumentEdit","applied","asPromise","protocolCompletionItem_1","protocolCodeLens_1","protocolDocumentLink_1","uriConverter","_uriConverter","asVersionedTextDocumentIdentifier","asTextDocumentSaveReason","reason","TextDocumentSaveReason","Manual","AfterDelay","FocusOut","asCompletionTriggerKind","triggerKind","CompletionTriggerKind","TriggerCharacter","TriggerForIncompleteCompletions","Invoked","asSignatureHelpTriggerKind","SignatureHelpTriggerKind","Invoke","ContentChange","asParameterInformation","asSignatureInformation","parameters","asWorkerPosition","inserting","replacing","isInsertReplace","asLocation","Location","asDiagnosticSeverity","DiagnosticSeverity","Information","Hint","asDiagnosticTag","tag","asRelatedInformation","asDiagnostic","Diagnostic","severity","converted","asDiagnosticTags","asCompletionItemTag","asTextEdit","newText","asSymbolTag","arg","isTextDocument","isTextDocumentChangeEvent","rangeLength","includeContent","triggerCharacter","isRetrigger","activeSignatureHelp","signatures","activeSignature","activeParameter","asPositions","protocolItem","original","documentation","format","asDocumentation","filterText","InsertTextFormat","textEdit","insertText","SnippetString","insertTextFormat","fromEdit","fillPrimaryInsertText","originalItemKind","sortText","additionalTextEdits","commitCharacters","preselect","asCompletionItemTags","deprecated","includeDeclaration","only","CodeActionContext","CodeLens","tabSize","insertSpaces","DocumentLink","ColorProviderFeature","DocumentColorRequest","colorProvider","provideColorPresentations","requestParams","ColorPresentationRequest","asColorPresentations","provideDocumentColors","asColorInformations","registerColorProvider","red","green","blue","alpha","colorInformation","ci","ColorInformation","asColor","colorPresentations","presentation","ColorPresentation","configuration","ConfigurationRequest","scopeUri","lastIndexOf","DeclarationFeature","DeclarationRequest","declarationSupport","declarationProvider","provideDeclaration","asDeclarationResult","registerDeclarationProvider","FoldingRangeFeature","FoldingRangeRequest","rangeLimit","lineFoldingOnly","foldingRangeProvider","provideFoldingRanges","asFoldingRanges","registerFoldingRangeProvider","FoldingRangeKind","Comment","Imports","Region","foldingRanges","FoldingRange","startLine","endLine","asFoldingRangeKind","ImplementationFeature","ImplementationRequest","implementationSupport","implementationProvider","provideImplementation","registerImplementationProvider","SemVer","colorProvider_1","configuration_1","implementation_1","typeDefinition_1","workspaceFolders_1","foldingRange_1","declaration_1","selectionRange_1","progress_1","callHierarchy_proposed_1","semanticTokens_proposed_1","processes_1","Executable","TransportKind","Transport","NodeModule","StreamInfo","ChildProcessInfo","ProposedFeatures","isSocket","arg1","arg2","arg3","arg4","arg5","forceDebug","_serverOptions","_forceDebug","checkVersion","codeVersion","prerelease","satisfies","_serverProcess","toCheck","_isDetached","checkProcessDied","childProcess","kill","terminate","getEnvironment","env","fork","debugStartWith","debugEquals","assertStdio","runDebug","run","debug","execArgv","startedInDebugMode","_getServerWorkingDir","serverWorkingDir","transport","stdio","runtime","ipc","cwd","silent","sp","protocol","execOptions","serverProcess","registerFeatures","createAll","TypeDefinitionFeature","WorkspaceFoldersFeature","SelectionRangeFeature","ProgressFeature","_mainGetRootPath","lstat","stats","isDirectory","SettingMonitor","_setting","primary","enabled","needsStart","SemanticTokensFeature","WorkDoneProgressCreateRequest","_reported","WorkDoneProgress","begin","report","cancellable","ProgressLocation","Notification","Window","withProgress","async","progress","cancellationToken","_progress","_infinite","percentage","_cancellationToken","WorkDoneProgressCancelNotification","max","min","delta","increment","ProtocolCodeLens","ProtocolCompletionItem","CompletionItem","ls","CodeBlock","diagnostic","asDiagnosticRelatedInformation","information","DiagnosticRelatedInformation","MarkdownString","asCompletionInsertText","itemKind","TextEdit","asSignatureInformations","SignatureInformation","asParameterInformations","ParameterInformation","asLocationLink","targetUri","targetRange","targetSelectionRange","originSelectionRange","asLocationResult","LocationLink","asDocumentHighlight","DocumentHighlight","asDocumentHighlightKind","DocumentHighlightKind","Read","Write","asSymbolInformation","SymbolInformation","containerName","asDocumentSymbol","kindMapping","asCodeActionKind","parts","WorkspaceEdit","CreateFile","RenameFile","renameFile","oldUri","newUri","DeleteFile","deleteFile","asColorInformation","asColorPresentation","asFoldingRange","asSelectionRange","SelectionRange","parent","hover","Hover","appendCodeblock","appendMarkdown","appendText","asHoverContent","list","CompletionList","isIncomplete","SignatureHelp","asCommands","CodeAction","isPreferred","asSelectionRanges","selectionRanges","ProtocolDocumentLink","SelectionRangeRequest","selectionRangeProvider","provideSelectionRanges","positions","ranges","registerSelectionRangeProvider","asSemanticTokensEdit","SemanticTokensEdit","deleteCount","Uint32Array","asSemanticTokens","SemanticTokens","resultId","asSemanticTokensEdits","SemanticTokensEdits","asLegend","SemanticTokensRequest","tokenTypes","SemanticTokenTypes","comment","keyword","regexp","operator","namespace","struct","class","interface","enum","typeParameter","function","member","macro","variable","parameter","property","tokenModifiers","SemanticTokenModifiers","declaration","static","abstract","readonly","semanticTokensProvider","documentProvider","provideDocumentSemanticTokens","provideDocumentSemanticTokensEdits","previousResultId","SemanticTokensEditsRequest","rangeProvider","provideDocumentRangeSemanticTokens","SemanticTokensRangeRequest","legend","registerDocumentSemanticTokensProvider","registerDocumentRangeSemanticTokensProvider","TypeDefinitionRequest","typeDefinitionSupport","typeDefinitionProvider","provideTypeDefinition","registerTypeDefinitionProvider","defaultDelay","completionPromise","onSuccess","task","delay","cancelTimeout","thenable","typedArray","check","resolved","isWindows","isMacintosh","isLinux","execFileSync","__dirname","spawnSync","ValueUUID","other","asHex","V4UUID","_randomHex","_oneOf","_timeHighBits","floor","random","_chars","v4","empty","_UUIDPattern","isUUID","access","arrayDiff","left","right","DidChangeWorkspaceFoldersNotification","initializeWithFolders","asProtocol","currentWorkspaceFolders","_initialFolders","WorkspaceFoldersRequest","added","doSendEvent","addedFolders","removedFolders","didChangeWorkspaceFolders","sendInitialEvent","NODE_DEBUG","SEMVER_SPEC_VERSION","MAX_SAFE_INTEGER","re","src","t","tokens","R","tok","n","NUMERICIDENTIFIER","NUMERICIDENTIFIERLOOSE","NONNUMERICIDENTIFIER","MAINVERSION","MAINVERSIONLOOSE","PRERELEASEIDENTIFIER","PRERELEASEIDENTIFIERLOOSE","PRERELEASE","PRERELEASELOOSE","BUILDIDENTIFIER","BUILD","FULLPLAIN","FULL","LOOSEPLAIN","LOOSE","GTLT","XRANGEIDENTIFIERLOOSE","XRANGEIDENTIFIER","XRANGEPLAIN","XRANGEPLAINLOOSE","XRANGE","XRANGELOOSE","COERCE","COERCERTL","RegExp","LONETILDE","TILDETRIM","TILDE","TILDELOOSE","LONECARET","CARETTRIM","CARET","CARETLOOSE","COMPARATORLOOSE","COMPARATOR","COMPARATORTRIM","HYPHENRANGE","HYPHENRANGELOOSE","STAR","loose","includePrerelease","er","major","minor","patch","num","build","valid","v","clean","compare","compareMain","comparePre","compareIdentifiers","compareBuild","inc","release","identifier","diff","version1","version2","eq","v1","v2","prefix","defaultResult","numeric","anum","bnum","gt","lt","neq","gte","lte","cmp","op","Comparator","comp","semver","ANY","rcompareIdentifiers","compareLoose","versionA","versionB","rcompare","sort","rsort","parseRange","isSatisfiable","comparators","remainingComparators","testComparator","otherComparator","intersects","isX","hyphenReplace","$0","fM","fm","fpr","fb","tM","tm","tp","tpr","tb","testSet","allowed","outside","hilo","gtfn","ltefn","ltfn","ecomp","high","low","comparator","rangeTmp","sameDirectionIncreasing","sameDirectionDecreasing","sameSemVer","differentDirectionsInclusive","oppositeDirectionsLessThan","oppositeDirectionsGreaterThan","comps","hr","compRe","M","pr","replaceCaret","replaceCarets","replaceTilde","replaceTildes","gtlt","xM","xm","xp","anyX","replaceXRange","replaceXRanges","replaceStars","parseComparator","thisComparators","rangeComparators","thisComparator","rangeComparator","toComparators","maxSatisfying","versions","maxSV","rangeObj","minSatisfying","minSV","minVersion","minver","compver","validRange","ltr","gtr","parsed","r1","r2","coerce","rtl","lastIndex","vscode_jsonrpc_1","callHierarchy","st","ProtocolRequestType0","ProtocolRequestType","ProtocolNotificationType","ProtocolNotificationType0","resultType","protocol_implementation_1","protocol_typeDefinition_1","protocol_workspaceFolders_1","protocol_configuration_1","protocol_colorProvider_1","protocol_foldingRange_1","protocol_declaration_1","protocol_selectionRange_1","protocol_progress_1","DocumentFilter","DocumentSelector","pattern","Abort","Transactional","Undo","objectLiteral","hasWorkDoneProgress","InitializeError","unknownProtocolVersion","Log","one","two","three","four","defined","startCharacter","endCharacter","_i","del","VersionedTextDocumentIdentifier","overwrite","ignoreIfExists","recursive","ignoreIfNotExists","TextDocumentIdentifier","TextDocumentItem","MarkupContent","MarkedString","SymbolTag","FormattingOptions","TextEditChangeImpl","WorkspaceChange","_this","_textEditChanges","_workspaceEdit","textEditChange","getTextEditChange","textDocumentEdit","checkDocumentChanges","fromPlainText","plainText","SourceFixAll","commandOrEdit","TextDocument","EOL","mergeSort","leftIdx","rightIdx","FullTextDocument","positionAt","offsetAt","applyEdits","sortedEdits","lastModifiedOffset","startOffset","endOffset","_uri","_languageId","_version","_content","_lineOffsets","update","getLineOffsets","lineOffsets","isLineStart","charAt","offset","mid","lineOffset","nextLineOffset","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","__webpack_modules__","prop","willsaveDocument","endsWith","startLanguageServer"],"mappings":"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","file":"extension.js","sourcesContent":["/**\n * @author Toru Nagashima <https://github.com/mysticatea>\n * See LICENSE file in root directory for full license.\n */\n'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\nvar eventTargetShim = require('event-target-shim');\n\n/**\n * The signal class.\n * @see https://dom.spec.whatwg.org/#abortsignal\n */\nclass AbortSignal extends eventTargetShim.EventTarget {\n    /**\n     * AbortSignal cannot be constructed directly.\n     */\n    constructor() {\n        super();\n        throw new TypeError(\"AbortSignal cannot be constructed directly\");\n    }\n    /**\n     * Returns `true` if this `AbortSignal`'s `AbortController` has signaled to abort, and `false` otherwise.\n     */\n    get aborted() {\n        const aborted = abortedFlags.get(this);\n        if (typeof aborted !== \"boolean\") {\n            throw new TypeError(`Expected 'this' to be an 'AbortSignal' object, but got ${this === null ? \"null\" : typeof this}`);\n        }\n        return aborted;\n    }\n}\neventTargetShim.defineEventAttribute(AbortSignal.prototype, \"abort\");\n/**\n * Create an AbortSignal object.\n */\nfunction createAbortSignal() {\n    const signal = Object.create(AbortSignal.prototype);\n    eventTargetShim.EventTarget.call(signal);\n    abortedFlags.set(signal, false);\n    return signal;\n}\n/**\n * Abort a given signal.\n */\nfunction abortSignal(signal) {\n    if (abortedFlags.get(signal) !== false) {\n        return;\n    }\n    abortedFlags.set(signal, true);\n    signal.dispatchEvent({ type: \"abort\" });\n}\n/**\n * Aborted flag for each instances.\n */\nconst abortedFlags = new WeakMap();\n// Properties should be enumerable.\nObject.defineProperties(AbortSignal.prototype, {\n    aborted: { enumerable: true },\n});\n// `toString()` should return `\"[object AbortSignal]\"`\nif (typeof Symbol === \"function\" && typeof Symbol.toStringTag === \"symbol\") {\n    Object.defineProperty(AbortSignal.prototype, Symbol.toStringTag, {\n        configurable: true,\n        value: \"AbortSignal\",\n    });\n}\n\n/**\n * The AbortController.\n * @see https://dom.spec.whatwg.org/#abortcontroller\n */\nclass AbortController {\n    /**\n     * Initialize this controller.\n     */\n    constructor() {\n        signals.set(this, createAbortSignal());\n    }\n    /**\n     * Returns the `AbortSignal` object associated with this object.\n     */\n    get signal() {\n        return getSignal(this);\n    }\n    /**\n     * Abort and signal to any observers that the associated activity is to be aborted.\n     */\n    abort() {\n        abortSignal(getSignal(this));\n    }\n}\n/**\n * Associated signals.\n */\nconst signals = new WeakMap();\n/**\n * Get the associated signal of a given controller.\n */\nfunction getSignal(controller) {\n    const signal = signals.get(controller);\n    if (signal == null) {\n        throw new TypeError(`Expected 'this' to be an 'AbortController' object, but got ${controller === null ? \"null\" : typeof controller}`);\n    }\n    return signal;\n}\n// Properties should be enumerable.\nObject.defineProperties(AbortController.prototype, {\n    signal: { enumerable: true },\n    abort: { enumerable: true },\n});\nif (typeof Symbol === \"function\" && typeof Symbol.toStringTag === \"symbol\") {\n    Object.defineProperty(AbortController.prototype, Symbol.toStringTag, {\n        configurable: true,\n        value: \"AbortController\",\n    });\n}\n\nexports.AbortController = AbortController;\nexports.AbortSignal = AbortSignal;\nexports.default = AbortController;\n\nmodule.exports = AbortController\nmodule.exports.AbortController = module.exports[\"default\"] = AbortController\nmodule.exports.AbortSignal = AbortSignal\n//# sourceMappingURL=abort-controller.js.map\n","var Stream = require(\"stream\")\nvar writeMethods = [\"write\", \"end\", \"destroy\"]\nvar readMethods = [\"resume\", \"pause\"]\nvar readEvents = [\"data\", \"close\"]\nvar slice = Array.prototype.slice\n\nmodule.exports = duplex\n\nfunction forEach (arr, fn) {\n    if (arr.forEach) {\n        return arr.forEach(fn)\n    }\n\n    for (var i = 0; i < arr.length; i++) {\n        fn(arr[i], i)\n    }\n}\n\nfunction duplex(writer, reader) {\n    var stream = new Stream()\n    var ended = false\n\n    forEach(writeMethods, proxyWriter)\n\n    forEach(readMethods, proxyReader)\n\n    forEach(readEvents, proxyStream)\n\n    reader.on(\"end\", handleEnd)\n\n    writer.on(\"drain\", function() {\n      stream.emit(\"drain\")\n    })\n\n    writer.on(\"error\", reemit)\n    reader.on(\"error\", reemit)\n\n    stream.writable = writer.writable\n    stream.readable = reader.readable\n\n    return stream\n\n    function proxyWriter(methodName) {\n        stream[methodName] = method\n\n        function method() {\n            return writer[methodName].apply(writer, arguments)\n        }\n    }\n\n    function proxyReader(methodName) {\n        stream[methodName] = method\n\n        function method() {\n            stream.emit(methodName)\n            var func = reader[methodName]\n            if (func) {\n                return func.apply(reader, arguments)\n            }\n            reader.emit(methodName)\n        }\n    }\n\n    function proxyStream(methodName) {\n        reader.on(methodName, reemit)\n\n        function reemit() {\n            var args = slice.call(arguments)\n            args.unshift(methodName)\n            stream.emit.apply(stream, args)\n        }\n    }\n\n    function handleEnd() {\n        if (ended) {\n            return\n        }\n        ended = true\n        var args = slice.call(arguments)\n        args.unshift(\"end\")\n        stream.emit.apply(stream, args)\n    }\n\n    function reemit(err) {\n        stream.emit(\"error\", err)\n    }\n}\n","//filter will reemit the data if cb(err,pass) pass is truthy\n\n// reduce is more tricky\n// maybe we want to group the reductions or emit progress updates occasionally\n// the most basic reduce just emits one 'data' event after it has recieved 'end'\n\nvar Stream = require('stream').Stream\n  , es = exports\n  , through = require('through')\n  , from = require('from')\n  , duplex = require('duplexer')\n  , map = require('map-stream')\n  , pause = require('pause-stream')\n  , split = require('split')\n  , pipeline = require('stream-combiner')\n  , immediately = global.setImmediate || process.nextTick;\n\nes.Stream = Stream //re-export Stream from core\nes.through = through\nes.from = from\nes.duplex = duplex\nes.map = map\nes.pause = pause\nes.split = split\nes.pipeline = es.connect = es.pipe = pipeline\n// merge / concat\n//\n// combine multiple streams into a single stream.\n// will emit end only once\n\nes.concat = //actually this should be called concat\nes.merge = function (/*streams...*/) {\n  var toMerge = [].slice.call(arguments)\n  if (toMerge.length === 1 && (toMerge[0] instanceof Array)) {\n    toMerge = toMerge[0] //handle array as arguments object\n  }\n  var stream = new Stream()\n  stream.setMaxListeners(0) // allow adding more than 11 streams\n  var endCount = 0\n  stream.writable = stream.readable = true\n\n  if (toMerge.length) {\n    toMerge.forEach(function (e) {\n      e.pipe(stream, {end: false})\n      var ended = false\n      e.on('end', function () {\n        if(ended) return\n        ended = true\n        endCount ++\n        if(endCount == toMerge.length)\n          stream.emit('end')\n      })\n    })\n  } else {\n    process.nextTick(function () {\n      stream.emit('end')\n    })\n  }\n  \n  stream.write = function (data) {\n    this.emit('data', data)\n  }\n  stream.destroy = function () {\n    toMerge.forEach(function (e) {\n      if(e.destroy) e.destroy()\n    })\n  }\n  return stream\n}\n\n\n// writable stream, collects all events into an array\n// and calls back when 'end' occurs\n// mainly I'm using this to test the other functions\n\nes.writeArray = function (done) {\n  if ('function' !== typeof done)\n    throw new Error('function writeArray (done): done must be function')\n\n  var a = new Stream ()\n    , array = [], isDone = false\n  a.write = function (l) {\n    array.push(l)\n  }\n  a.end = function () {\n    isDone = true\n    done(null, array)\n  }\n  a.writable = true\n  a.readable = false\n  a.destroy = function () {\n    a.writable = a.readable = false\n    if(isDone) return\n    done(new Error('destroyed before end'), array)\n  }\n  return a\n}\n\n//return a Stream that reads the properties of an object\n//respecting pause() and resume()\n\nes.readArray = function (array) {\n  var stream = new Stream()\n    , i = 0\n    , paused = false\n    , ended = false\n\n  stream.readable = true\n  stream.writable = false\n\n  if(!Array.isArray(array))\n    throw new Error('event-stream.read expects an array')\n\n  stream.resume = function () {\n    if(ended) return\n    paused = false\n    var l = array.length\n    while(i < l && !paused && !ended) {\n      stream.emit('data', array[i++])\n    }\n    if(i == l && !ended)\n      ended = true, stream.readable = false, stream.emit('end')\n  }\n  process.nextTick(stream.resume)\n  stream.pause = function () {\n     paused = true\n  }\n  stream.destroy = function () {\n    ended = true\n    stream.emit('close')\n  }\n  return stream\n}\n\n//\n// readable (asyncFunction)\n// return a stream that calls an async function while the stream is not paused.\n//\n// the function must take: (count, callback) {...\n//\n\nes.readable =\nfunction (func, continueOnError) {\n  var stream = new Stream()\n    , i = 0\n    , paused = false\n    , ended = false\n    , reading = false\n\n  stream.readable = true\n  stream.writable = false\n\n  if('function' !== typeof func)\n    throw new Error('event-stream.readable expects async function')\n\n  stream.on('end', function () { ended = true })\n\n  function get (err, data) {\n\n    if(err) {\n      stream.emit('error', err)\n      if(!continueOnError) stream.emit('end')\n    } else if (arguments.length > 1)\n      stream.emit('data', data)\n\n    immediately(function () {\n      if(ended || paused || reading) return\n      try {\n        reading = true\n        func.call(stream, i++, function () {\n          reading = false\n          get.apply(null, arguments)\n        })\n      } catch (err) {\n        stream.emit('error', err)\n      }\n    })\n  }\n  stream.resume = function () {\n    paused = false\n    get()\n  }\n  process.nextTick(get)\n  stream.pause = function () {\n     paused = true\n  }\n  stream.destroy = function () {\n    stream.emit('end')\n    stream.emit('close')\n    ended = true\n  }\n  return stream\n}\n\n\n//\n// map sync\n//\n\nes.mapSync = function (sync) {\n  return es.through(function write(data) {\n    var mappedData\n    try {\n      mappedData = sync(data)\n    } catch (err) {\n      return this.emit('error', err)\n    }\n    if (mappedData !== undefined)\n      this.emit('data', mappedData)\n  })\n}\n\n//\n// log just print out what is coming through the stream, for debugging\n//\n\nes.log = function (name) {\n  return es.through(function (data) {\n    var args = [].slice.call(arguments)\n    if(name) console.error(name, data)\n    else     console.error(data)\n    this.emit('data', data)\n  })\n}\n\n\n//\n// child -- pipe through a child process\n//\n\nes.child = function (child) {\n\n  return es.duplex(child.stdin, child.stdout)\n\n}\n\n//\n// parse\n//\n// must be used after es.split() to ensure that each chunk represents a line\n// source.pipe(es.split()).pipe(es.parse())\n\nes.parse = function (options) {\n  var emitError = !!(options ? options.error : false)\n  return es.through(function (data) {\n    var obj\n    try {\n      if(data) //ignore empty lines\n        obj = JSON.parse(data.toString())\n    } catch (err) {\n      if (emitError)\n        return this.emit('error', err)\n      return console.error(err, 'attempting to parse:', data)\n    }\n    //ignore lines that where only whitespace.\n    if(obj !== undefined)\n      this.emit('data', obj)\n  })\n}\n//\n// stringify\n//\n\nes.stringify = function () {\n  var Buffer = require('buffer').Buffer\n  return es.mapSync(function (e){\n    return JSON.stringify(Buffer.isBuffer(e) ? e.toString() : e) + '\\n'\n  })\n}\n\n//\n// replace a string within a stream.\n//\n// warn: just concatenates the string and then does str.split().join().\n// probably not optimal.\n// for smallish responses, who cares?\n// I need this for shadow-npm so it's only relatively small json files.\n\nes.replace = function (from, to) {\n  return es.pipeline(es.split(from), es.join(to))\n}\n\n//\n// join chunks with a joiner. just like Array#join\n// also accepts a callback that is passed the chunks appended together\n// this is still supported for legacy reasons.\n//\n\nes.join = function (str) {\n\n  //legacy api\n  if('function' === typeof str)\n    return es.wait(str)\n\n  var first = true\n  return es.through(function (data) {\n    if(!first)\n      this.emit('data', str)\n    first = false\n    this.emit('data', data)\n    return true\n  })\n}\n\n\n//\n// wait. callback when 'end' is emitted, with all chunks appended as string.\n//\n\nes.wait = function (callback) {\n  var arr = []\n  return es.through(function (data) { arr.push(data) },\n    function () {\n      var body = Buffer.isBuffer(arr[0]) ? Buffer.concat(arr)\n        : arr.join('')\n      this.emit('data', body)\n      this.emit('end')\n      if(callback) callback(null, body)\n    })\n}\n\nes.pipeable = function () {\n  throw new Error('[EVENT-STREAM] es.pipeable is deprecated')\n}\n","/**\n * @author Toru Nagashima <https://github.com/mysticatea>\n * @copyright 2015 Toru Nagashima. All rights reserved.\n * See LICENSE file in root directory for full license.\n */\n'use strict';\n\nObject.defineProperty(exports, '__esModule', { value: true });\n\n/**\n * @typedef {object} PrivateData\n * @property {EventTarget} eventTarget The event target.\n * @property {{type:string}} event The original event object.\n * @property {number} eventPhase The current event phase.\n * @property {EventTarget|null} currentTarget The current event target.\n * @property {boolean} canceled The flag to prevent default.\n * @property {boolean} stopped The flag to stop propagation.\n * @property {boolean} immediateStopped The flag to stop propagation immediately.\n * @property {Function|null} passiveListener The listener if the current listener is passive. Otherwise this is null.\n * @property {number} timeStamp The unix time.\n * @private\n */\n\n/**\n * Private data for event wrappers.\n * @type {WeakMap<Event, PrivateData>}\n * @private\n */\nconst privateData = new WeakMap();\n\n/**\n * Cache for wrapper classes.\n * @type {WeakMap<Object, Function>}\n * @private\n */\nconst wrappers = new WeakMap();\n\n/**\n * Get private data.\n * @param {Event} event The event object to get private data.\n * @returns {PrivateData} The private data of the event.\n * @private\n */\nfunction pd(event) {\n    const retv = privateData.get(event);\n    console.assert(\n        retv != null,\n        \"'this' is expected an Event object, but got\",\n        event\n    );\n    return retv\n}\n\n/**\n * https://dom.spec.whatwg.org/#set-the-canceled-flag\n * @param data {PrivateData} private data.\n */\nfunction setCancelFlag(data) {\n    if (data.passiveListener != null) {\n        if (\n            typeof console !== \"undefined\" &&\n            typeof console.error === \"function\"\n        ) {\n            console.error(\n                \"Unable to preventDefault inside passive event listener invocation.\",\n                data.passiveListener\n            );\n        }\n        return\n    }\n    if (!data.event.cancelable) {\n        return\n    }\n\n    data.canceled = true;\n    if (typeof data.event.preventDefault === \"function\") {\n        data.event.preventDefault();\n    }\n}\n\n/**\n * @see https://dom.spec.whatwg.org/#interface-event\n * @private\n */\n/**\n * The event wrapper.\n * @constructor\n * @param {EventTarget} eventTarget The event target of this dispatching.\n * @param {Event|{type:string}} event The original event to wrap.\n */\nfunction Event(eventTarget, event) {\n    privateData.set(this, {\n        eventTarget,\n        event,\n        eventPhase: 2,\n        currentTarget: eventTarget,\n        canceled: false,\n        stopped: false,\n        immediateStopped: false,\n        passiveListener: null,\n        timeStamp: event.timeStamp || Date.now(),\n    });\n\n    // https://heycam.github.io/webidl/#Unforgeable\n    Object.defineProperty(this, \"isTrusted\", { value: false, enumerable: true });\n\n    // Define accessors\n    const keys = Object.keys(event);\n    for (let i = 0; i < keys.length; ++i) {\n        const key = keys[i];\n        if (!(key in this)) {\n            Object.defineProperty(this, key, defineRedirectDescriptor(key));\n        }\n    }\n}\n\n// Should be enumerable, but class methods are not enumerable.\nEvent.prototype = {\n    /**\n     * The type of this event.\n     * @type {string}\n     */\n    get type() {\n        return pd(this).event.type\n    },\n\n    /**\n     * The target of this event.\n     * @type {EventTarget}\n     */\n    get target() {\n        return pd(this).eventTarget\n    },\n\n    /**\n     * The target of this event.\n     * @type {EventTarget}\n     */\n    get currentTarget() {\n        return pd(this).currentTarget\n    },\n\n    /**\n     * @returns {EventTarget[]} The composed path of this event.\n     */\n    composedPath() {\n        const currentTarget = pd(this).currentTarget;\n        if (currentTarget == null) {\n            return []\n        }\n        return [currentTarget]\n    },\n\n    /**\n     * Constant of NONE.\n     * @type {number}\n     */\n    get NONE() {\n        return 0\n    },\n\n    /**\n     * Constant of CAPTURING_PHASE.\n     * @type {number}\n     */\n    get CAPTURING_PHASE() {\n        return 1\n    },\n\n    /**\n     * Constant of AT_TARGET.\n     * @type {number}\n     */\n    get AT_TARGET() {\n        return 2\n    },\n\n    /**\n     * Constant of BUBBLING_PHASE.\n     * @type {number}\n     */\n    get BUBBLING_PHASE() {\n        return 3\n    },\n\n    /**\n     * The target of this event.\n     * @type {number}\n     */\n    get eventPhase() {\n        return pd(this).eventPhase\n    },\n\n    /**\n     * Stop event bubbling.\n     * @returns {void}\n     */\n    stopPropagation() {\n        const data = pd(this);\n\n        data.stopped = true;\n        if (typeof data.event.stopPropagation === \"function\") {\n            data.event.stopPropagation();\n        }\n    },\n\n    /**\n     * Stop event bubbling.\n     * @returns {void}\n     */\n    stopImmediatePropagation() {\n        const data = pd(this);\n\n        data.stopped = true;\n        data.immediateStopped = true;\n        if (typeof data.event.stopImmediatePropagation === \"function\") {\n            data.event.stopImmediatePropagation();\n        }\n    },\n\n    /**\n     * The flag to be bubbling.\n     * @type {boolean}\n     */\n    get bubbles() {\n        return Boolean(pd(this).event.bubbles)\n    },\n\n    /**\n     * The flag to be cancelable.\n     * @type {boolean}\n     */\n    get cancelable() {\n        return Boolean(pd(this).event.cancelable)\n    },\n\n    /**\n     * Cancel this event.\n     * @returns {void}\n     */\n    preventDefault() {\n        setCancelFlag(pd(this));\n    },\n\n    /**\n     * The flag to indicate cancellation state.\n     * @type {boolean}\n     */\n    get defaultPrevented() {\n        return pd(this).canceled\n    },\n\n    /**\n     * The flag to be composed.\n     * @type {boolean}\n     */\n    get composed() {\n        return Boolean(pd(this).event.composed)\n    },\n\n    /**\n     * The unix time of this event.\n     * @type {number}\n     */\n    get timeStamp() {\n        return pd(this).timeStamp\n    },\n\n    /**\n     * The target of this event.\n     * @type {EventTarget}\n     * @deprecated\n     */\n    get srcElement() {\n        return pd(this).eventTarget\n    },\n\n    /**\n     * The flag to stop event bubbling.\n     * @type {boolean}\n     * @deprecated\n     */\n    get cancelBubble() {\n        return pd(this).stopped\n    },\n    set cancelBubble(value) {\n        if (!value) {\n            return\n        }\n        const data = pd(this);\n\n        data.stopped = true;\n        if (typeof data.event.cancelBubble === \"boolean\") {\n            data.event.cancelBubble = true;\n        }\n    },\n\n    /**\n     * The flag to indicate cancellation state.\n     * @type {boolean}\n     * @deprecated\n     */\n    get returnValue() {\n        return !pd(this).canceled\n    },\n    set returnValue(value) {\n        if (!value) {\n            setCancelFlag(pd(this));\n        }\n    },\n\n    /**\n     * Initialize this event object. But do nothing under event dispatching.\n     * @param {string} type The event type.\n     * @param {boolean} [bubbles=false] The flag to be possible to bubble up.\n     * @param {boolean} [cancelable=false] The flag to be possible to cancel.\n     * @deprecated\n     */\n    initEvent() {\n        // Do nothing.\n    },\n};\n\n// `constructor` is not enumerable.\nObject.defineProperty(Event.prototype, \"constructor\", {\n    value: Event,\n    configurable: true,\n    writable: true,\n});\n\n// Ensure `event instanceof window.Event` is `true`.\nif (typeof window !== \"undefined\" && typeof window.Event !== \"undefined\") {\n    Object.setPrototypeOf(Event.prototype, window.Event.prototype);\n\n    // Make association for wrappers.\n    wrappers.set(window.Event.prototype, Event);\n}\n\n/**\n * Get the property descriptor to redirect a given property.\n * @param {string} key Property name to define property descriptor.\n * @returns {PropertyDescriptor} The property descriptor to redirect the property.\n * @private\n */\nfunction defineRedirectDescriptor(key) {\n    return {\n        get() {\n            return pd(this).event[key]\n        },\n        set(value) {\n            pd(this).event[key] = value;\n        },\n        configurable: true,\n        enumerable: true,\n    }\n}\n\n/**\n * Get the property descriptor to call a given method property.\n * @param {string} key Property name to define property descriptor.\n * @returns {PropertyDescriptor} The property descriptor to call the method property.\n * @private\n */\nfunction defineCallDescriptor(key) {\n    return {\n        value() {\n            const event = pd(this).event;\n            return event[key].apply(event, arguments)\n        },\n        configurable: true,\n        enumerable: true,\n    }\n}\n\n/**\n * Define new wrapper class.\n * @param {Function} BaseEvent The base wrapper class.\n * @param {Object} proto The prototype of the original event.\n * @returns {Function} The defined wrapper class.\n * @private\n */\nfunction defineWrapper(BaseEvent, proto) {\n    const keys = Object.keys(proto);\n    if (keys.length === 0) {\n        return BaseEvent\n    }\n\n    /** CustomEvent */\n    function CustomEvent(eventTarget, event) {\n        BaseEvent.call(this, eventTarget, event);\n    }\n\n    CustomEvent.prototype = Object.create(BaseEvent.prototype, {\n        constructor: { value: CustomEvent, configurable: true, writable: true },\n    });\n\n    // Define accessors.\n    for (let i = 0; i < keys.length; ++i) {\n        const key = keys[i];\n        if (!(key in BaseEvent.prototype)) {\n            const descriptor = Object.getOwnPropertyDescriptor(proto, key);\n            const isFunc = typeof descriptor.value === \"function\";\n            Object.defineProperty(\n                CustomEvent.prototype,\n                key,\n                isFunc\n                    ? defineCallDescriptor(key)\n                    : defineRedirectDescriptor(key)\n            );\n        }\n    }\n\n    return CustomEvent\n}\n\n/**\n * Get the wrapper class of a given prototype.\n * @param {Object} proto The prototype of the original event to get its wrapper.\n * @returns {Function} The wrapper class.\n * @private\n */\nfunction getWrapper(proto) {\n    if (proto == null || proto === Object.prototype) {\n        return Event\n    }\n\n    let wrapper = wrappers.get(proto);\n    if (wrapper == null) {\n        wrapper = defineWrapper(getWrapper(Object.getPrototypeOf(proto)), proto);\n        wrappers.set(proto, wrapper);\n    }\n    return wrapper\n}\n\n/**\n * Wrap a given event to management a dispatching.\n * @param {EventTarget} eventTarget The event target of this dispatching.\n * @param {Object} event The event to wrap.\n * @returns {Event} The wrapper instance.\n * @private\n */\nfunction wrapEvent(eventTarget, event) {\n    const Wrapper = getWrapper(Object.getPrototypeOf(event));\n    return new Wrapper(eventTarget, event)\n}\n\n/**\n * Get the immediateStopped flag of a given event.\n * @param {Event} event The event to get.\n * @returns {boolean} The flag to stop propagation immediately.\n * @private\n */\nfunction isStopped(event) {\n    return pd(event).immediateStopped\n}\n\n/**\n * Set the current event phase of a given event.\n * @param {Event} event The event to set current target.\n * @param {number} eventPhase New event phase.\n * @returns {void}\n * @private\n */\nfunction setEventPhase(event, eventPhase) {\n    pd(event).eventPhase = eventPhase;\n}\n\n/**\n * Set the current target of a given event.\n * @param {Event} event The event to set current target.\n * @param {EventTarget|null} currentTarget New current target.\n * @returns {void}\n * @private\n */\nfunction setCurrentTarget(event, currentTarget) {\n    pd(event).currentTarget = currentTarget;\n}\n\n/**\n * Set a passive listener of a given event.\n * @param {Event} event The event to set current target.\n * @param {Function|null} passiveListener New passive listener.\n * @returns {void}\n * @private\n */\nfunction setPassiveListener(event, passiveListener) {\n    pd(event).passiveListener = passiveListener;\n}\n\n/**\n * @typedef {object} ListenerNode\n * @property {Function} listener\n * @property {1|2|3} listenerType\n * @property {boolean} passive\n * @property {boolean} once\n * @property {ListenerNode|null} next\n * @private\n */\n\n/**\n * @type {WeakMap<object, Map<string, ListenerNode>>}\n * @private\n */\nconst listenersMap = new WeakMap();\n\n// Listener types\nconst CAPTURE = 1;\nconst BUBBLE = 2;\nconst ATTRIBUTE = 3;\n\n/**\n * Check whether a given value is an object or not.\n * @param {any} x The value to check.\n * @returns {boolean} `true` if the value is an object.\n */\nfunction isObject(x) {\n    return x !== null && typeof x === \"object\" //eslint-disable-line no-restricted-syntax\n}\n\n/**\n * Get listeners.\n * @param {EventTarget} eventTarget The event target to get.\n * @returns {Map<string, ListenerNode>} The listeners.\n * @private\n */\nfunction getListeners(eventTarget) {\n    const listeners = listenersMap.get(eventTarget);\n    if (listeners == null) {\n        throw new TypeError(\n            \"'this' is expected an EventTarget object, but got another value.\"\n        )\n    }\n    return listeners\n}\n\n/**\n * Get the property descriptor for the event attribute of a given event.\n * @param {string} eventName The event name to get property descriptor.\n * @returns {PropertyDescriptor} The property descriptor.\n * @private\n */\nfunction defineEventAttributeDescriptor(eventName) {\n    return {\n        get() {\n            const listeners = getListeners(this);\n            let node = listeners.get(eventName);\n            while (node != null) {\n                if (node.listenerType === ATTRIBUTE) {\n                    return node.listener\n                }\n                node = node.next;\n            }\n            return null\n        },\n\n        set(listener) {\n            if (typeof listener !== \"function\" && !isObject(listener)) {\n                listener = null; // eslint-disable-line no-param-reassign\n            }\n            const listeners = getListeners(this);\n\n            // Traverse to the tail while removing old value.\n            let prev = null;\n            let node = listeners.get(eventName);\n            while (node != null) {\n                if (node.listenerType === ATTRIBUTE) {\n                    // Remove old value.\n                    if (prev !== null) {\n                        prev.next = node.next;\n                    } else if (node.next !== null) {\n                        listeners.set(eventName, node.next);\n                    } else {\n                        listeners.delete(eventName);\n                    }\n                } else {\n                    prev = node;\n                }\n\n                node = node.next;\n            }\n\n            // Add new value.\n            if (listener !== null) {\n                const newNode = {\n                    listener,\n                    listenerType: ATTRIBUTE,\n                    passive: false,\n                    once: false,\n                    next: null,\n                };\n                if (prev === null) {\n                    listeners.set(eventName, newNode);\n                } else {\n                    prev.next = newNode;\n                }\n            }\n        },\n        configurable: true,\n        enumerable: true,\n    }\n}\n\n/**\n * Define an event attribute (e.g. `eventTarget.onclick`).\n * @param {Object} eventTargetPrototype The event target prototype to define an event attrbite.\n * @param {string} eventName The event name to define.\n * @returns {void}\n */\nfunction defineEventAttribute(eventTargetPrototype, eventName) {\n    Object.defineProperty(\n        eventTargetPrototype,\n        `on${eventName}`,\n        defineEventAttributeDescriptor(eventName)\n    );\n}\n\n/**\n * Define a custom EventTarget with event attributes.\n * @param {string[]} eventNames Event names for event attributes.\n * @returns {EventTarget} The custom EventTarget.\n * @private\n */\nfunction defineCustomEventTarget(eventNames) {\n    /** CustomEventTarget */\n    function CustomEventTarget() {\n        EventTarget.call(this);\n    }\n\n    CustomEventTarget.prototype = Object.create(EventTarget.prototype, {\n        constructor: {\n            value: CustomEventTarget,\n            configurable: true,\n            writable: true,\n        },\n    });\n\n    for (let i = 0; i < eventNames.length; ++i) {\n        defineEventAttribute(CustomEventTarget.prototype, eventNames[i]);\n    }\n\n    return CustomEventTarget\n}\n\n/**\n * EventTarget.\n *\n * - This is constructor if no arguments.\n * - This is a function which returns a CustomEventTarget constructor if there are arguments.\n *\n * For example:\n *\n *     class A extends EventTarget {}\n *     class B extends EventTarget(\"message\") {}\n *     class C extends EventTarget(\"message\", \"error\") {}\n *     class D extends EventTarget([\"message\", \"error\"]) {}\n */\nfunction EventTarget() {\n    /*eslint-disable consistent-return */\n    if (this instanceof EventTarget) {\n        listenersMap.set(this, new Map());\n        return\n    }\n    if (arguments.length === 1 && Array.isArray(arguments[0])) {\n        return defineCustomEventTarget(arguments[0])\n    }\n    if (arguments.length > 0) {\n        const types = new Array(arguments.length);\n        for (let i = 0; i < arguments.length; ++i) {\n            types[i] = arguments[i];\n        }\n        return defineCustomEventTarget(types)\n    }\n    throw new TypeError(\"Cannot call a class as a function\")\n    /*eslint-enable consistent-return */\n}\n\n// Should be enumerable, but class methods are not enumerable.\nEventTarget.prototype = {\n    /**\n     * Add a given listener to this event target.\n     * @param {string} eventName The event name to add.\n     * @param {Function} listener The listener to add.\n     * @param {boolean|{capture?:boolean,passive?:boolean,once?:boolean}} [options] The options for this listener.\n     * @returns {void}\n     */\n    addEventListener(eventName, listener, options) {\n        if (listener == null) {\n            return\n        }\n        if (typeof listener !== \"function\" && !isObject(listener)) {\n            throw new TypeError(\"'listener' should be a function or an object.\")\n        }\n\n        const listeners = getListeners(this);\n        const optionsIsObj = isObject(options);\n        const capture = optionsIsObj\n            ? Boolean(options.capture)\n            : Boolean(options);\n        const listenerType = capture ? CAPTURE : BUBBLE;\n        const newNode = {\n            listener,\n            listenerType,\n            passive: optionsIsObj && Boolean(options.passive),\n            once: optionsIsObj && Boolean(options.once),\n            next: null,\n        };\n\n        // Set it as the first node if the first node is null.\n        let node = listeners.get(eventName);\n        if (node === undefined) {\n            listeners.set(eventName, newNode);\n            return\n        }\n\n        // Traverse to the tail while checking duplication..\n        let prev = null;\n        while (node != null) {\n            if (\n                node.listener === listener &&\n                node.listenerType === listenerType\n            ) {\n                // Should ignore duplication.\n                return\n            }\n            prev = node;\n            node = node.next;\n        }\n\n        // Add it.\n        prev.next = newNode;\n    },\n\n    /**\n     * Remove a given listener from this event target.\n     * @param {string} eventName The event name to remove.\n     * @param {Function} listener The listener to remove.\n     * @param {boolean|{capture?:boolean,passive?:boolean,once?:boolean}} [options] The options for this listener.\n     * @returns {void}\n     */\n    removeEventListener(eventName, listener, options) {\n        if (listener == null) {\n            return\n        }\n\n        const listeners = getListeners(this);\n        const capture = isObject(options)\n            ? Boolean(options.capture)\n            : Boolean(options);\n        const listenerType = capture ? CAPTURE : BUBBLE;\n\n        let prev = null;\n        let node = listeners.get(eventName);\n        while (node != null) {\n            if (\n                node.listener === listener &&\n                node.listenerType === listenerType\n            ) {\n                if (prev !== null) {\n                    prev.next = node.next;\n                } else if (node.next !== null) {\n                    listeners.set(eventName, node.next);\n                } else {\n                    listeners.delete(eventName);\n                }\n                return\n            }\n\n            prev = node;\n            node = node.next;\n        }\n    },\n\n    /**\n     * Dispatch a given event.\n     * @param {Event|{type:string}} event The event to dispatch.\n     * @returns {boolean} `false` if canceled.\n     */\n    dispatchEvent(event) {\n        if (event == null || typeof event.type !== \"string\") {\n            throw new TypeError('\"event.type\" should be a string.')\n        }\n\n        // If listeners aren't registered, terminate.\n        const listeners = getListeners(this);\n        const eventName = event.type;\n        let node = listeners.get(eventName);\n        if (node == null) {\n            return true\n        }\n\n        // Since we cannot rewrite several properties, so wrap object.\n        const wrappedEvent = wrapEvent(this, event);\n\n        // This doesn't process capturing phase and bubbling phase.\n        // This isn't participating in a tree.\n        let prev = null;\n        while (node != null) {\n            // Remove this listener if it's once\n            if (node.once) {\n                if (prev !== null) {\n                    prev.next = node.next;\n                } else if (node.next !== null) {\n                    listeners.set(eventName, node.next);\n                } else {\n                    listeners.delete(eventName);\n                }\n            } else {\n                prev = node;\n            }\n\n            // Call this listener\n            setPassiveListener(\n                wrappedEvent,\n                node.passive ? node.listener : null\n            );\n            if (typeof node.listener === \"function\") {\n                try {\n                    node.listener.call(this, wrappedEvent);\n                } catch (err) {\n                    if (\n                        typeof console !== \"undefined\" &&\n                        typeof console.error === \"function\"\n                    ) {\n                        console.error(err);\n                    }\n                }\n            } else if (\n                node.listenerType !== ATTRIBUTE &&\n                typeof node.listener.handleEvent === \"function\"\n            ) {\n                node.listener.handleEvent(wrappedEvent);\n            }\n\n            // Break if `event.stopImmediatePropagation` was called.\n            if (isStopped(wrappedEvent)) {\n                break\n            }\n\n            node = node.next;\n        }\n        setPassiveListener(wrappedEvent, null);\n        setEventPhase(wrappedEvent, 0);\n        setCurrentTarget(wrappedEvent, null);\n\n        return !wrappedEvent.defaultPrevented\n    },\n};\n\n// `constructor` is not enumerable.\nObject.defineProperty(EventTarget.prototype, \"constructor\", {\n    value: EventTarget,\n    configurable: true,\n    writable: true,\n});\n\n// Ensure `eventTarget instanceof window.EventTarget` is `true`.\nif (\n    typeof window !== \"undefined\" &&\n    typeof window.EventTarget !== \"undefined\"\n) {\n    Object.setPrototypeOf(EventTarget.prototype, window.EventTarget.prototype);\n}\n\nexports.defineEventAttribute = defineEventAttribute;\nexports.EventTarget = EventTarget;\nexports.default = EventTarget;\n\nmodule.exports = EventTarget\nmodule.exports.EventTarget = module.exports[\"default\"] = EventTarget\nmodule.exports.defineEventAttribute = defineEventAttribute\n//# sourceMappingURL=event-target-shim.js.map\n","const net = require(\"net\");\n\n// call method 1: (port, cb(err, freePort))\n// call method 2: (portBeg, portEnd, cb(err, freePort))\n// call method 3: (portBeg, host, cb(err, freePort))\n// call method 4: (portBeg, portEnd, host, cb(err, freePort))\n// call method 5: (portBeg, portEnd, host, howmany, cb(err, freePort1, freePort2, ...))\n\nfunction findFreePort(beg, ...rest){\n  const p = rest.slice(0, rest.length - 1), cb = rest[rest.length - 1];\n  let [end, ip, cnt] = Array.from(p);\n  if (!ip && end && !/^\\d+$/.test(end)) { // deal with method 3\n    ip = end;\n    end = 65534;\n  } else {\n    if (end == null) { end = 65534; }\n  }\n  if (cnt == null) { cnt = 1; }\n\n  const retcb = cb;\n  const res = [];\n  const probe = function(ip, port, cb){\n    const s = net.createConnection({port: port, host: ip})\n    s.on('connect', function(){ s.end(); cb(null, port + 1); });\n    s.on('error', err=> { cb(port); });  // can't connect, port is available\n  };\n  var onprobe = function(port, nextPort){\n    if (port) {\n      res.push(port);\n      if (res.length >= cnt) {\n        retcb(null, ...res)\n      } else {\n        setImmediate(()=> probe(ip, port+1, onprobe));\n      }\n    } else {\n      if (nextPort>=end) {\n        retcb(new Error(\"No available ports\"));\n      } else {\n        setImmediate(()=> probe(ip, nextPort, onprobe));\n      }\n    }\n  };\n  return probe(ip, beg, onprobe);\n};\n\nfunction findFreePortPmfy(beg, ...rest) {\n  const last = rest[rest.length - 1];\n  if (typeof last === 'function') {\n    findFreePort(beg, ...rest);\n  } else {\n    return new Promise((resolve, reject) => {\n      findFreePort(beg, ...rest, (err, ...ports) => {\n        if (err) reject(err)\n        else resolve(ports);\n      })\n    })\n  }\n}\nmodule.exports = findFreePortPmfy","\n'use strict';\n\nvar Stream = require('stream')\n\n// from\n//\n// a stream that reads from an source.\n// source may be an array, or a function.\n// from handles pause behaviour for you.\n\nmodule.exports =\nfunction from (source) {\n  if(Array.isArray(source)) {\n\t\tvar source_index = 0, source_len = source.length;\n    return from (function (i) {\n      if(source_index < source_len)\n        this.emit('data', source[source_index++])\n      else\n        this.emit('end')\n      return true\n    })\n  }\n  var s = new Stream(), i = 0\n  s.ended = false\n  s.started = false\n  s.readable = true\n  s.writable = false\n  s.paused = false\n  s.ended = false\n  s.pause = function () {\n    s.started = true\n    s.paused = true\n  }\n  function next () {\n    s.started = true\n    if(s.ended) return\n    while(!s.ended && !s.paused && source.call(s, i++, function () {\n      if(!s.ended && !s.paused)\n          process.nextTick(next);\n    }))\n      ;\n  }\n  s.resume = function () {\n    s.started = true\n    s.paused = false\n    next()\n  }\n  s.on('end', function () {\n    s.ended = true\n    s.readable = false\n    process.nextTick(s.destroy)\n  })\n  s.destroy = function () {\n    s.ended = true\n    s.emit('close') \n  }\n  /*\n    by default, the stream will start emitting at nextTick\n    if you want, you can pause it, after pipeing.\n    you can also resume before next tick, and that will also\n    work.\n  */\n  process.nextTick(function () {\n    if(!s.started) s.resume()\n  })\n  return s\n}\n","//filter will reemit the data if cb(err,pass) pass is truthy\n\n// reduce is more tricky\n// maybe we want to group the reductions or emit progress updates occasionally\n// the most basic reduce just emits one 'data' event after it has recieved 'end'\n\n\nvar Stream = require('stream').Stream\n\n\n//create an event stream and apply function to each .write\n//emitting each response as data\n//unless it's an empty callback\n\nmodule.exports = function (mapper, opts) {\n\n  var stream = new Stream()\n    , self = this\n    , inputs = 0\n    , outputs = 0\n    , ended = false\n    , paused = false\n    , destroyed = false\n    , lastWritten = 0\n    , inNext = false\n\n  this.opts = opts || {};\n  var errorEventName = this.opts.failures ? 'failure' : 'error';\n\n  // Items that are not ready to be written yet (because they would come out of\n  // order) get stuck in a queue for later.\n  var writeQueue = {}\n\n  stream.writable = true\n  stream.readable = true\n\n  function queueData (data, number) {\n    var nextToWrite = lastWritten + 1\n\n    if (number === nextToWrite) {\n      // If it's next, and its not undefined write it\n      if (data !== undefined) {\n        stream.emit.apply(stream, ['data', data])\n      }\n      lastWritten ++\n      nextToWrite ++\n    } else {\n      // Otherwise queue it for later.\n      writeQueue[number] = data\n    }\n\n    // If the next value is in the queue, write it\n    if (writeQueue.hasOwnProperty(nextToWrite)) {\n      var dataToWrite = writeQueue[nextToWrite]\n      delete writeQueue[nextToWrite]\n      return queueData(dataToWrite, nextToWrite)\n    }\n\n    outputs ++\n    if(inputs === outputs) {\n      if(paused) paused = false, stream.emit('drain') //written all the incoming events\n      if(ended) end()\n    }\n  }\n\n  function next (err, data, number) {\n    if(destroyed) return\n    inNext = true\n\n    if (!err || self.opts.failures) {\n      queueData(data, number)\n    }\n\n    if (err) {\n      stream.emit.apply(stream, [ errorEventName, err ]);\n    }\n\n    inNext = false;\n  }\n\n  // Wrap the mapper function by calling its callback with the order number of\n  // the item in the stream.\n  function wrappedMapper (input, number, callback) {\n    return mapper.call(null, input, function(err, data){\n      callback(err, data, number)\n    })\n  }\n\n  stream.write = function (data) {\n    if(ended) throw new Error('map stream is not writable')\n    inNext = false\n    inputs ++\n\n    try {\n      //catch sync errors and handle them like async errors\n      var written = wrappedMapper(data, inputs, next)\n      paused = (written === false)\n      return !paused\n    } catch (err) {\n      //if the callback has been called syncronously, and the error\n      //has occured in an listener, throw it again.\n      if(inNext)\n        throw err\n      next(err)\n      return !paused\n    }\n  }\n\n  function end (data) {\n    //if end was called with args, write it, \n    ended = true //write will emit 'end' if ended is true\n    stream.writable = false\n    if(data !== undefined) {\n      return queueData(data, inputs)\n    } else if (inputs == outputs) { //wait for processing \n      stream.readable = false, stream.emit('end'), stream.destroy() \n    }\n  }\n\n  stream.end = function (data) {\n    if(ended) return\n    end()\n  }\n\n  stream.destroy = function () {\n    ended = destroyed = true\n    stream.writable = stream.readable = paused = false\n    process.nextTick(function () {\n      stream.emit('close')\n    })\n  }\n  stream.pause = function () {\n    paused = true\n  }\n\n  stream.resume = function () {\n    paused = false\n  }\n\n  return stream\n}\n\n\n\n\n","//through@2 handles this by default!\nmodule.exports = require('through')\n\n","'use strict';\n\nvar spawn = require('child_process').spawn,\n    es    = require('event-stream');\n\nmodule.exports = function childrenOfPid(pid, callback) {\n  var headers = null;\n\n  if (typeof callback !== 'function') {\n    throw new Error('childrenOfPid(pid, callback) expects callback');\n  }\n\n  if (typeof pid === 'number') {\n    pid = pid.toString();\n  }\n\n  //\n  // The `ps-tree` module behaves differently on *nix vs. Windows\n  // by spawning different programs and parsing their output.\n  //\n  // Linux:\n  // 1. \" <defunct> \" need to be striped\n  // ```bash\n  // $ ps -A -o comm,ppid,pid,stat\n  // COMMAND          PPID   PID STAT\n  // bbsd             2899 16958 Ss\n  // watch <defunct>  1914 16964 Z\n  // ps              20688 16965 R+\n  // ```\n  //\n  // Win32:\n  // 1. wmic PROCESS WHERE ParentProcessId=4604 GET Name,ParentProcessId,ProcessId,Status)\n  // 2. The order of head columns is fixed\n  // ```shell\n  // > wmic PROCESS GET Name,ProcessId,ParentProcessId,Status\n  // Name                          ParentProcessId  ProcessId   Status\n  // System Idle Process           0                0\n  // System                        0                4\n  // smss.exe                      4                228\n  // ```\n\n  var processLister;\n  if (process.platform === 'win32') {\n    // See also: https://github.com/nodejs/node-v0.x-archive/issues/2318\n    processLister = spawn('wmic.exe', ['PROCESS', 'GET', 'Name,ProcessId,ParentProcessId,Status']);\n  } else {\n    processLister = spawn('ps', ['-A', '-o', 'ppid,pid,stat,comm']);\n  }\n\n  es.connect(\n    // spawn('ps', ['-A', '-o', 'ppid,pid,stat,comm']).stdout,\n    processLister.stdout,\n    es.split(),\n    es.map(function (line, cb) { //this could parse alot of unix command output\n      var columns = line.trim().split(/\\s+/);\n      if (!headers) {\n        headers = columns;\n\n        //\n        // Rename Win32 header name, to as same as the linux, for compatible.\n        //\n        headers = headers.map(normalizeHeader);\n        return cb();\n      }\n\n      var row = {};\n      // For each header\n      var h = headers.slice();\n      while (h.length) {\n        row[h.shift()] = h.length ? columns.shift() : columns.join(' ');\n      }\n\n      return cb(null, row);\n    }),\n    es.writeArray(function (err, ps) {\n      var parents = {},\n          children = [];\n\n      parents[pid] = true;\n      ps.forEach(function (proc) {\n        if (parents[proc.PPID]) {\n          parents[proc.PID] = true;\n          children.push(proc)\n        }\n      });\n\n      callback(null, children);\n    })\n  ).on('error', callback)\n}\n\n/**\n * Normalizes the given header `str` from the Windows\n * title to the *nix title.\n *\n * @param {string} str Header string to normalize\n */\nfunction normalizeHeader(str) {\n  if (process.platform !== 'win32') {\n    return str;\n  }\n\n  switch (str) {\n    case 'Name':\n      return 'COMMAND';\n      break;\n    case 'ParentProcessId':\n      return 'PPID';\n      break;\n    case 'ProcessId':\n      return 'PID';\n      break;\n    case 'Status':\n      return 'STAT';\n      break;\n    default:\n      throw new Error('Unknown process listing header: ' + str);\n  }\n}\n","//filter will reemit the data if cb(err,pass) pass is truthy\n\n// reduce is more tricky\n// maybe we want to group the reductions or emit progress updates occasionally\n// the most basic reduce just emits one 'data' event after it has recieved 'end'\n\n\nvar through = require('through')\nvar Decoder = require('string_decoder').StringDecoder\n\nmodule.exports = split\n\n//TODO pass in a function to map across the lines.\n\nfunction split (matcher, mapper, options) {\n  var decoder = new Decoder()\n  var soFar = ''\n  var maxLength = options && options.maxLength;\n  if('function' === typeof matcher)\n    mapper = matcher, matcher = null\n  if (!matcher)\n    matcher = /\\r?\\n/\n\n  function emit(stream, piece) {\n    if(mapper) {\n      try {\n        piece = mapper(piece)\n      }\n      catch (err) {\n        return stream.emit('error', err)\n      }\n      if('undefined' !== typeof piece)\n        stream.queue(piece)\n    }\n    else\n      stream.queue(piece)\n  }\n\n  function next (stream, buffer) {\n    var pieces = ((soFar != null ? soFar : '') + buffer).split(matcher)\n    soFar = pieces.pop()\n\n    if (maxLength && soFar.length > maxLength)\n      stream.emit('error', new Error('maximum buffer reached'))\n\n    for (var i = 0; i < pieces.length; i++) {\n      var piece = pieces[i]\n      emit(stream, piece)\n    }\n  }\n\n  return through(function (b) {\n    next(this, decoder.write(b))\n  },\n  function () {\n    if(decoder.end)\n      next(this, decoder.end())\n    if(soFar != null)\n      emit(this, soFar)\n    this.queue(null)\n  })\n}\n\n","var duplexer = require('duplexer')\n\nmodule.exports = function () {\n\n  var streams = [].slice.call(arguments)\n    , first = streams[0]\n    , last = streams[streams.length - 1]\n    , thepipe = duplexer(first, last)\n\n  if(streams.length == 1)\n    return streams[0]\n  else if (!streams.length)\n    throw new Error('connect called with empty args')\n\n  //pipe all the streams together\n\n  function recurse (streams) {\n    if(streams.length < 2)\n      return\n    streams[0].pipe(streams[1])\n    recurse(streams.slice(1))  \n  }\n  \n  recurse(streams)\n \n  function onerror () {\n    var args = [].slice.call(arguments)\n    args.unshift('error')\n    thepipe.emit.apply(thepipe, args)\n  }\n  \n  //es.duplex already reemits the error from the first and last stream.\n  //add a listener for the inner streams in the pipeline.\n  for(var i = 1; i < streams.length - 1; i ++)\n    streams[i].on('error', onerror)\n\n  return thepipe\n}\n\n","var Stream = require('stream')\n\n// through\n//\n// a stream that does nothing but re-emit the input.\n// useful for aggregating a series of changing but not ending streams into one stream)\n\nexports = module.exports = through\nthrough.through = through\n\n//create a readable writable stream.\n\nfunction through (write, end, opts) {\n  write = write || function (data) { this.queue(data) }\n  end = end || function () { this.queue(null) }\n\n  var ended = false, destroyed = false, buffer = [], _ended = false\n  var stream = new Stream()\n  stream.readable = stream.writable = true\n  stream.paused = false\n\n//  stream.autoPause   = !(opts && opts.autoPause   === false)\n  stream.autoDestroy = !(opts && opts.autoDestroy === false)\n\n  stream.write = function (data) {\n    write.call(this, data)\n    return !stream.paused\n  }\n\n  function drain() {\n    while(buffer.length && !stream.paused) {\n      var data = buffer.shift()\n      if(null === data)\n        return stream.emit('end')\n      else\n        stream.emit('data', data)\n    }\n  }\n\n  stream.queue = stream.push = function (data) {\n//    console.error(ended)\n    if(_ended) return stream\n    if(data === null) _ended = true\n    buffer.push(data)\n    drain()\n    return stream\n  }\n\n  //this will be registered as the first 'end' listener\n  //must call destroy next tick, to make sure we're after any\n  //stream piped from here.\n  //this is only a problem if end is not emitted synchronously.\n  //a nicer way to do this is to make sure this is the last listener for 'end'\n\n  stream.on('end', function () {\n    stream.readable = false\n    if(!stream.writable && stream.autoDestroy)\n      process.nextTick(function () {\n        stream.destroy()\n      })\n  })\n\n  function _end () {\n    stream.writable = false\n    end.call(stream)\n    if(!stream.readable && stream.autoDestroy)\n      stream.destroy()\n  }\n\n  stream.end = function (data) {\n    if(ended) return\n    ended = true\n    if(arguments.length) stream.write(data)\n    _end() // will emit or queue\n    return stream\n  }\n\n  stream.destroy = function () {\n    if(destroyed) return\n    destroyed = true\n    ended = true\n    buffer.length = 0\n    stream.writable = stream.readable = false\n    stream.emit('close')\n    return stream\n  }\n\n  stream.pause = function () {\n    if(stream.paused) return\n    stream.paused = true\n    return stream\n  }\n\n  stream.resume = function () {\n    if(stream.paused) {\n      stream.paused = false\n      stream.emit('resume')\n    }\n    drain()\n    //may have become paused again,\n    //as drain emits 'data'.\n    if(!stream.paused)\n      stream.emit('drain')\n    return stream\n  }\n  return stream\n}\n\n","import * as vscode from 'vscode';\nimport * as path from 'path';\nimport * as net from 'net';\nconst fp = require('find-free-port');\nimport * as cp from 'child_process';\nconst psTree = require('ps-tree');\nimport {\n    BaseLanguageClient,\n    LanguageClient,\n    LanguageClientOptions,\n    NotificationType,\n    ServerOptions,\n    NodeModule,\n    TransportKind\n} from 'vscode-languageclient';\nimport { resolve } from 'path';\nimport { deactivate } from './notebook';\nimport { time } from 'console';\nlet wolframStatusBar: vscode.StatusBarItem = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\nlet wolframVersionText = \"$(extensions-sync-enabled~spin) Wolfram\";\nconst fs = require('fs')\nimport { WolframScriptSerializer, WolframNotebookSerializer } from './notebook';\nimport { WolframNotebookController } from './notebookController';\nimport { WolframScriptController } from './scriptController';\nimport { workspaceSymbolProvider } from './treeDataProvider';\nimport {getOutputContent} from './dataPanel';\nimport {showPlotPanel} from './plotsView';\n\n// export let wolframClient: LanguageClient;\n// export let wolframKernelClient: LanguageClient;\n\n// let wolfram: cp.ChildProcess;\n// let wolframKernel: cp.ChildProcess;\n\nlet clientPort: number = 7710;\nlet kernelPort: number = 7910;\nlet lspPath: string;\nlet kernelPath: string;\nlet context!: vscode.ExtensionContext;\nlet outputChannel!: vscode.OutputChannel;\nlet clients: Map<string, (LanguageClient|undefined)[]> = new Map();\nlet processes: cp.ChildProcess[] = [];\n\nexport var wolfram!: cp.ChildProcess;\nexport var wolframKernel!: cp.ChildProcess;\n\nexport var wolframClient!: LanguageClient | undefined;\nexport var wolframKernelClient: LanguageClient | undefined;\nexport let scriptserializer: vscode.NotebookSerializer;\nexport let notebookSerializer: WolframNotebookSerializer;\nexport let notebookcontroller: WolframNotebookController;\nexport let scriptController: WolframScriptController;\nexport let treeDataProvider: workspaceSymbolProvider;\n\nexport async function startLanguageServer(context0: vscode.ExtensionContext, outputChannel0: vscode.OutputChannel): Promise<void> {\n\n\n    context = context0;\n    lspPath = context.asAbsolutePath(path.join('wolfram', 'wolfram-lsp.wl'));\n    kernelPath = context.asAbsolutePath(path.join('wolfram', 'wolfram-kernel.wl'));\n    outputChannel = outputChannel0;\n    wolframStatusBar.text = \"Wolfram ?\";\n    wolframStatusBar.command = 'wolfram.restart';\n    wolframStatusBar.show();\n    vscode.workspace.onDidChangeTextDocument(didChangeTextDocument);\n\n    scriptserializer = new WolframScriptSerializer()\n    notebookSerializer = new WolframNotebookSerializer()\n\n    notebookcontroller = new WolframNotebookController()\n    scriptController = new WolframScriptController(context)\n\n    context.subscriptions.push(\n        vscode.workspace.registerNotebookSerializer('wolfram-notebook', notebookSerializer)\n    );\n\n    context.subscriptions.push(\n        vscode.workspace.registerNotebookSerializer('wolfram-script', scriptserializer)\n    );\n\n    context.subscriptions.push(notebookcontroller);\n    context.subscriptions.push(scriptController);\n\n    vscode.commands.registerCommand('wolfram.runInWolfram', runInWolfram);\n    vscode.commands.registerCommand('wolfram.printInWolfram', printInWolfram);\n    vscode.commands.registerCommand('wolfram.runTextCell', runTextCell);\n    vscode.commands.registerCommand('wolfram.wolframTerminal', startWolframTerminal);\n    vscode.commands.registerCommand('wolfram.runInTerminal', runInTerminal);\n    vscode.commands.registerCommand('wolfram.help', help);\n    vscode.commands.registerCommand('wolfram.stringHelp', stringHelp);\n    vscode.commands.registerCommand('wolfram.restart', restart);\n    vscode.commands.registerCommand('wolfram.abort', abort);\n    vscode.commands.registerCommand('wolfram.textToSection', textToSection);\n    vscode.commands.registerCommand('wolfram.textFromSection', textFromSection);\n    vscode.commands.registerCommand('wolfram.createFile', createFile);\n    vscode.commands.registerCommand('wolfram.createNotebook', createNotebook);\n    vscode.commands.registerCommand('wolfram.createNotebookScript', createNotebookScript);\n    vscode.commands.registerCommand('wolfram.showOutput', showOutput); \n    vscode.commands.registerCommand('wolfram.showPlots', showPlots); \n    vscode.commands.registerCommand('wolfram.runExpression', runExpression);\n\n    vscode.workspace.onDidOpenTextDocument(didOpenTextDocument);\n    vscode.workspace.onDidSaveTextDocument(didSaveTextDocument);\n    vscode.window.onDidChangeWindowState(didChangeWindowState);\n    vscode.workspace.onDidChangeConfiguration(updateConfiguration);\n\n    vscode.workspace.textDocuments.forEach(didOpenTextDocument);\n\tvscode.workspace.onDidChangeWorkspaceFolders((event) => {\n\t\tfor (const folder  of event.removed) {\n\t\t\tconst client = clients.get(folder.uri.toString());\n\t\t\tif (client) {\n\t\t\t\tclients.delete(folder.uri.toString());\n\t\t\t\tclient[0]?.stop();\n                client[1]?.stop();\n\t\t\t}\n\t\t}\n\t});\n\n    // setTimeout(updateRunningLines, 500);\n    \n    // restart()\n}\n\nfunction updateConfiguration(){\n    if (vscode.workspace.getConfiguration().get(\"wlsp.liveDocument\")) {\n    } \n}\n\nexport async function restart(): Promise<void> {\n    wolframBusyQ = false;\n    evaluationQueue = [];    \n    \n    if (wolframClient) {\n        stopWolfram(wolframClient, wolfram).then(() => {\n            startWLSP()\n        })\n    } else {\n        startWLSP()\n    }\n\n    if (wolframKernelClient) {\n        stopWolfram(wolframKernelClient, wolframKernel).then(() => {\n            startWLSPKernel()\n        })\n    } else {\n        startWLSPKernel()\n    }\n\n    // while (context.subscriptions.pop()){}\n\n\n    return new Promise((resolve) => {\n        wolframStatusBar.text = \"Wolfram ?\";\n        wolframStatusBar.show();\n\n        wolframBusyQ = false;\n        wolframStatusBar.text = \"Starting Wolfram...\"\n        wolframStatusBar.show();\n\n        // startWLSP()\n        // startWLSPKernel()\n        resolve()\n    })\n}\n\nexport function stop() {\n\tconst promises: (Thenable<void>|undefined)[] = [];\n\tfor (const client of clients.values()) {\n\t\tpromises.push(client[0]?.stop());\n\t\tpromises.push(client[1]?.stop());\n\t}\n    \n    for (let p of processes) {\n        stopWolfram(undefined, p)\n    }\n\n\treturn Promise.all(promises).then(() => undefined);\n\n}\n\nasync function onclientReady() : Promise<void> {\n    function checkClient(cb:any) {\n        if (wolframClient !== undefined && wolframClient.initializeResult !== undefined) {\n            wolframClient.onReady().then(() => {\n    \n                wolframClient?.onNotification(\"updatePositions\", updatePositions);\n    \n                wolframClient?.sendRequest(\"wolframVersion\").then((result:any) => {\n                    wolframVersionText = result[\"output\"];\n                    wolframStatusBar.text = result[\"output\"];\n                })\n\n                wolframClient?.sendRequest(\"DocumentSymbolRequest\");\n            })\n    \n        } else {\n            setTimeout(() => {\n                checkClient(cb)\n            }, 500);\n        }\n    }\n\n    return new Promise((resolve) => {\n        checkClient(resolve)\n    })\n}\n\nexport async function  onkernelReady(): Promise<void> {\n    function checkKernel(cb:any) {\n        if (wolframKernelClient !== undefined && wolframKernelClient.initializeResult !== undefined) {\n            wolframKernelClient?.onReady().then(() => {\n\n                wolframKernelClient?.onNotification(\"onRunInWolfram\", onRunInWolfram);\n                wolframKernelClient?.onNotification(\"wolframBusy\", wolframBusy);\n                wolframKernelClient?.onNotification(\"updateDecorations\", updateDecorations);\n                wolframKernelClient?.onNotification(\"updateVarTable\", updateVarTable);\n                wolframKernelClient?.onNotification(\"moveCursor\", moveCursor);\n                \n                treeDataProvider = new workspaceSymbolProvider();\n                vscode.window.registerTreeDataProvider(\"wolframSymbols\", treeDataProvider);\n\n                cb()\n            });\n        } else {\n            setTimeout(() => {\n                checkKernel(cb)\n            }, 500)\n        }\n    }\n\n\n    return new Promise((resolve) => {\n        checkKernel(resolve)\n    })\n\n}\n\nlet movePositions:{[index:string]: any} = {};\nfunction updatePositions(params:any) {\n    params[\"result\"].forEach((e:any) => {\n        if (!(e[\"location\"][\"uri\"] in movePositions)) {\n            movePositions[e[\"location\"][\"uri\"]] = {}\n        } \n        movePositions[e[\"location\"][\"uri\"]][e[\"name\"]] = e;\n    });\n}\n\nfunction runToLine() {\n    let e: any = vscode.window.activeTextEditor;\n    let sel: vscode.Position = e?.selection.active;\n    let outputPosition: vscode.Position = new vscode.Position(sel.line + 1, 0);\n    let r: vscode.Selection = new vscode.Selection(\n        0,\n        0,\n        sel.line,\n        sel.character\n    );\n\n    e.revealRange(r, vscode.TextEditorRevealType.Default);\n\n    try {\n        wolframKernelClient?.sendRequest(\"runInWolfram\", { range: r, textDocument: e.document, print: false }).then((result: any) => {\n            // cursor has not moved yet\n            if (e.selection.active.line === outputPosition.line - 1 && e.selection.active.character === outputPosition.character) {\n                outputPosition = new vscode.Position(result[\"position\"][\"line\"], result[\"position\"][\"character\"]);\n                e.selection = new vscode.Selection(outputPosition, outputPosition);\n                e.revealRange(new vscode.Range(outputPosition, outputPosition), vscode.TextEditorRevealType.Default);\n            }\n\n            updateResults(e, result, false);\n        });\n    } catch {\n        console.log(\"Kernel is not ready. Restarting...\")\n        restart()\n    }\n}\n\n\nlet variableTable: any = {}\nfunction updateVarTable(vars: any) {\n    for (let index = 0; index < vars[\"values\"].length; index++) {\n        variableTable[vars[\"values\"][index][0]] = vars[\"values\"][index][1].slice(0, 200) + \"...\";\n    }\n    updateOutputPanel();\n}\n\nlet runningLines:any[] = []\nfunction moveCursor2(position:vscode.Position) {\n    let e = vscode.window.activeTextEditor;\n    let uri = e?.document.uri.toString();\n    if (!(uri === undefined) && (uri in movePositions)) {\n        let newPos:any[] = Object.values(movePositions[uri]).filter((p:any) => {\n            let r = p[\"location\"][\"range\"] as vscode.Range;\n            return ((r.start.line <= position.line) && (position.line <= r.end.line ))\n        })\n\n        if (newPos.length > 0) {\n            let outputPosition = new vscode.Position(newPos[0][\"location\"][\"range\"][\"end\"][\"line\"]+1, 0) ;\n            if (e) {\n                e.selection = new vscode.Selection(outputPosition, outputPosition);\n                e.revealRange(new vscode.Range(outputPosition, outputPosition), vscode.TextEditorRevealType.Default);\n            }\n            decorateRunningLine(outputPosition);\n        } else {\n            if (e) {\n                let outputPosition = new vscode.Position(position[\"line\"]+1, 0);\n                e.selection = new vscode.Selection(outputPosition, outputPosition);\n                e.revealRange(new vscode.Range(outputPosition, outputPosition), vscode.TextEditorRevealType.Default);\n                decorateRunningLine(outputPosition);\n            }\n        }\n    }\n}\n\nfunction moveCursor(params: any) {\n    let e: vscode.TextEditor | undefined = vscode.window.activeTextEditor;\n    let outputPosition = new vscode.Position(params[\"position\"][\"line\"], params[\"position\"][\"character\"]);\n    if (e) {\n        e.selection = new vscode.Selection(outputPosition, outputPosition);\n        e.revealRange(new vscode.Range(outputPosition, outputPosition), vscode.TextEditorRevealType.Default);\n    }\n    decorateRunningLine(outputPosition);\n}\n\nfunction decorateRunningLine(outputPosition:vscode.Position) {\n    let e: vscode.TextEditor | undefined = vscode.window.activeTextEditor;\n    if (e) {\n\n        let decorationLine = e.document.lineAt(outputPosition.line - 1)\n        let start = new vscode.Position(decorationLine.lineNumber, decorationLine.range.end.character)\n        let end = new vscode.Position(decorationLine.lineNumber, decorationLine.range.end.character)\n        let range = new vscode.Range(start, end)\n\n        let d: vscode.DecorationOptions = {\n            \"range\": range,\n            \"renderOptions\": {\n                \"after\": {\n                    \"contentText\": \".\",\n                    \"color\": \"foreground\",\n                    \"margin\": \"20px\"\n                }\n            }\n        }\n\n        runningLines.push(d);\n        // updateDecorations([d]);\n    }\n}\n\nfunction updateRunningLines() {\n    let editor = vscode.window.activeTextEditor;\n    if (wolframBusyQ === true) {\n        runningLines.forEach((d:vscode.DecorationOptions) => {\n            let r = d[\"renderOptions\"];\n            let a = r?[\"after\"] : {\"contentText\": \"\"};\n            let c = a?[\"contentText\"] : \"\";\n            if (d[\"renderOptions\"]![\"after\"]![\"contentText\"] == \".\") {\n                d[\"renderOptions\"]![\"after\"]![\"contentText\"] = \"..\"\n            } else \n            if (d[\"renderOptions\"]![\"after\"]![\"contentText\"] == \"..\") {\n                d[\"renderOptions\"]![\"after\"]![\"contentText\"] = \"...\"\n            } else \n            if (d[\"renderOptions\"]![\"after\"]![\"contentText\"] == \"...\") {\n                d[\"renderOptions\"]![\"after\"]![\"contentText\"] = \"....\"\n            } else \n            if (d[\"renderOptions\"]![\"after\"]![\"contentText\"] == \"....\") {\n                d[\"renderOptions\"]![\"after\"]![\"contentText\"] = \".....\"\n            } else \n            if (d[\"renderOptions\"]![\"after\"]![\"contentText\"] == \".....\") {\n                d[\"renderOptions\"]![\"after\"]![\"contentText\"] = \".\"\n            }\n        })\n        editor?.setDecorations(runningDecorationType, runningLines)\n\n        setTimeout(updateRunningLines, 500)\n    } else {\n        editor?.setDecorations(runningDecorationType, [])\n    }\n}\n\nlet starttime = 0;\nfunction runInWolfram(print = false) {\n    let e: vscode.TextEditor | undefined = vscode.window.activeTextEditor;\n    let sel: vscode.Selection = e!.selection;\n\n    let evaluationData = { range: sel, textDocument: e?.document, print: print };\n    evaluationQueue.push(evaluationData);\n\n    if (!wolframKernelClient) {\n        restart().then(() => {\n            evaluationQueue.push(evaluationData);\n            sendToWolfram(print);\n            return\n        })\n    } \n\n    if (evaluationQueue.length == 1 || wolframBusyQ == false) {\n        sendToWolfram(print);\n    }\n\n    wolframClient?.onReady().then(()=>{\n        wolframClient?.sendRequest(\"moveCursor\", { range: sel, textDocument: e?.document }).then((result:any) => {\n            moveCursor(result)\n        });\n    })\n}\n\nlet evaluationQueue:any[] = [];\nfunction sendToWolfram(print = false, sel:vscode.Selection|undefined = undefined) {\n\n    let e: vscode.TextEditor | undefined = vscode.window.activeTextEditor;\n    if(!sel) {sel = e!.selection};\n    let outputPosition: vscode.Position = new vscode.Position(sel.active.line + 1, 0);\n\n    if (e?.document.lineCount == outputPosition.line) {\n        e?.edit(editBuilder => {\n            editBuilder.insert(outputPosition!, \"\\n\")\n        })\n    }\n\n    if (e?.document.uri.scheme === 'vscode-notebook-cell') {\n        e.selection = new vscode.Selection(0, 0, 1, 1)\n        try {\n            starttime = Date.now();\n            wolframKernelClient?.sendNotification(\"runInWolfram\", { range: sel, textDocument: e.document, print: false });\n        } catch (err) {\n            console.log(err);\n            restart()\n        }\n\n    }\n    else if (e?.document.uri.scheme === 'file' || e?.document.uri.scheme === 'untitled') {\n        e.selection = new vscode.Selection(outputPosition, outputPosition);\n        e.revealRange(new vscode.Range(outputPosition, outputPosition), vscode.TextEditorRevealType.Default);\n\n        // wolframKernelClient.sendNotification(\"moveCursor\", {range:sel, textDocument:e.document});\n\n        if(!wolframBusyQ) {\n            wolframKernelClient?.onReady().then(ready => {\n                wolframBusyQ = true;\n                wolframStatusBar.text = \"$(extensions-sync-enabled~spin) Wolfram Running\";\n                wolframStatusBar.show();\n                starttime = Date.now();\n                wolframKernelClient?.sendNotification(\"runInWolfram\", evaluationQueue.pop())\n            });\n        } \n    }\n}\n\nlet evaluationResults:{[key:string]:string} = {}\nfunction onRunInWolfram(file: any) {\n    let end  = Date.now();\n    outputChannel.appendLine(`Execution time: ${end - starttime} ms` );\n\n    wolframBusyQ = false;\n    wolframStatusBar.text = wolframVersionText;\n    wolframStatusBar.show();\n\n    let result:any;\n    try{\n        result = JSON.parse(fs.readFileSync(file[\"file\"], \"utf8\"))[\"params\"];\n    } catch {\n        return\n    }\n    let editors: vscode.TextEditor[] = vscode.window.visibleTextEditors;\n    let e = editors.filter((e) => { return e.document.uri.path === result[\"document\"][\"path\"] })[0];\n\n    if (runningLines.length > 0) {\n        runningLines.pop()\n    }\n\n    if (e.document.uri.scheme == 'vscode-notebook-cell') {\n\n    } else {\n        updateResults(e, result, result[\"print\"]);\n    }\n\n    if (evaluationQueue.length > 0) {\n        sendToWolfram();\n    }\n    treeDataProvider.refresh();\n}\n\nlet maxPrintResults = 20;\nlet printResults: any[] = [];\nfunction updateResults(e: vscode.TextEditor | undefined, result: any, print: boolean) {\n    if (printResults.length > maxPrintResults) {\n        printResults.shift();\n    }\n\n    if (typeof (e) !== \"undefined\") {\n        e.edit(editBuilder => {\n\n            let output = fs.readFileSync(result[\"output\"].toString(), 'utf8');\n            printResults.push(output);\n            // let out = console_outputs.pop();\n            // printResults.push(out);\n            outputChannel.appendLine(output.slice(0, 8192));\n            // showOutput();\n\n            if (print) {\n                let sel: vscode.Selection = e!.selection;\n                let outputPosition: vscode.Position = new vscode.Position(sel.active.line + 1, 0);\n                editBuilder.insert(outputPosition, \"\\n\\n\" + result[\"result\"] + \"\\n\\n\");\n            }\n        });\n    };\n\n    updateOutputPanel();\n\n}\n\n\nlet outputPanel: vscode.WebviewPanel | undefined;\nfunction showOutput() {\n    let outputColumn: vscode.ViewColumn | undefined = vscode.window.activeTextEditor?.viewColumn;\n    //let out = \"<table id='outputs'>\";\n\n    if (outputPanel) {\n        if (outputPanel.visible) {\n\n        } else {\n            if (outputColumn) {\n                outputPanel.reveal(outputColumn + 1, true);\n            } else {\n                outputPanel.reveal(1, true);\n            }\n        }\n    } else {\n        outputPanel = vscode.window.createWebviewPanel(\n            'WolframOutput',\n            \"Wolfram Output\",\n            { viewColumn: 2, preserveFocus: true },\n            {\n                // localResourceRoots: [vscode.Uri.file(path.join(context.extensionPath, 'wolfram'))],\n                enableScripts: true,\n                retainContextWhenHidden: true\n            });\n\n        outputPanel.webview.html = getOutputContent(outputPanel.webview, context.extensionUri);\n\n        outputPanel.webview.onDidReceiveMessage(\n            message => {\n                runExpression(message.text, 0, 100);\n                return;\n            }\n            , undefined, context.subscriptions);\n\n        outputPanel.onDidDispose(() => {\n            outputPanel = undefined;\n        }, null);\n\n\n        updateOutputPanel()\n    }\n\n}\n\nlet plotsPanel: vscode.WebviewPanel | undefined;\nfunction showPlots() {\n    let outputColumn: vscode.ViewColumn | undefined = vscode.window.activeTextEditor?.viewColumn;\n    //let out = \"<table id='outputs'>\";\n\n    if (plotsPanel) {\n        if (plotsPanel.visible) {\n\n        } else {\n            if (outputColumn) {\n                plotsPanel.reveal(outputColumn + 1, true);\n            } else {\n                plotsPanel.reveal(1, true);\n            }\n        }\n    } else {\n        plotsPanel = vscode.window.createWebviewPanel(\n            'WolframPlots',\n            \"Wolfram Plots\",\n            { viewColumn: 2, preserveFocus: true },\n            {\n                // localResourceRoots: [vscode.Uri.file(path.join(context.extensionPath, 'wolfram'))],\n                enableScripts: true,\n                retainContextWhenHidden: true\n            });\n\n            plotsPanel.webview.html = showPlotPanel(plotsPanel.webview, context.extensionUri);\n\n            plotsPanel.webview.onDidReceiveMessage(\n            message => {\n                runExpression(message.text, 0, 100);\n                return;\n            }\n            , undefined, context.subscriptions);\n\n        plotsPanel.onDidDispose(() => {\n            plotsPanel = undefined;\n        }, null);\n\n\n        updateOutputPanel()\n    }\n\n}\n\nfunction runExpression(expression: string, line: 0, end: 100) {\n    let e: vscode.TextEditor | undefined = (vscode.window.activeTextEditor == null) ? vscode.window.visibleTextEditors[0] : vscode.window.activeTextEditor;\n\n\n    decorateRunningLine(new vscode.Position(line, end));\n    wolframKernelClient?.sendRequest(\"runExpression\", { print: false, expression: expression, textDocument: e?.document, line: line, end: end }).then((result: any) => { });\n}\n\nlet wolframBusyQ:boolean = false;\nfunction wolframBusy(params: any) {\n    if (params.busy === true) {\n        //kernelStatusBar.color = \"red\";\n        wolframBusyQ = true;\n        wolframStatusBar.text = \"$(extensions-sync-enabled~spin) Wolfram Running\";\n        wolframStatusBar.show();\n    } else {\n        //kernelStatusBar.color = \"yellow\";\n        wolframBusyQ = false;\n        wolframStatusBar.text = wolframVersionText;\n        wolframStatusBar.show();\n    }\n}\n\nlet workspaceDecorations: { [index: string]: vscode.DecorationOptions[]; } = {};\nfunction clearDecorations() {\n    let editor = vscode.window.activeTextEditor;\n    let uri = editor?.document.uri.toString();\n\n    if (uri && uri in workspaceDecorations) {\n        // workspaceDecorations[uri] = {} as vscode.DecorationOptions[];\n\n        // editor?.setDecorations(variableDecorationType,[] )\n    }\n}\n\nlet newDecorations: { [index: string]: vscode.DecorationOptions[]; } = {};\nfunction updateDecorations(decorationfile: string) {\n    let editor = vscode.window.activeTextEditor;\n    if (editor?.document.uri.scheme === 'file' || editor?.document.uri.scheme === 'untitled') {\n        //editor.setDecorations(variableDecorationType, []);\n\n        try{\n            newDecorations = JSON.parse(fs.readFileSync(decorationfile, 'utf8'));\n        } catch{\n            newDecorations = {};\n            return\n        }\n\n        if (typeof (editor) === \"undefined\") {\n            return;\n        }\n        let uri = editor.document.uri.toString();\n\n        let editorDecorations: vscode.DecorationOptions[] = [];\n        if (newDecorations[uri] === workspaceDecorations[uri]) {\n            return\n        } else {\n            workspaceDecorations[uri] = newDecorations[uri];\n            Object.keys(workspaceDecorations[uri]).forEach((d: any) => {\n                editorDecorations.push(workspaceDecorations[uri][d]);\n            });\n    \n            runningLines = [];\n            editor.setDecorations(variableDecorationType, editorDecorations);\n        }\n    }\n}\n\n\nlet variableDecorationType: vscode.TextEditorDecorationType = vscode.window.createTextEditorDecorationType(\n    {\n        backgroundColor: 'none',\n        light: {\n            color: new vscode.ThemeColor(\"foreground\")\n        },\n        dark: {\n            color: new vscode.ThemeColor(\"foreground\")\n        }\n    }\n);\n\nlet runningDecorationType: vscode.TextEditorDecorationType = vscode.window.createTextEditorDecorationType(\n    {\n        backgroundColor: 'none',\n        light: {\n            color: new vscode.ThemeColor(\"foreground\")\n        },\n        dark: {\n            color: new vscode.ThemeColor(\"foreground\")\n        }\n    }\n);\n\nfunction updateOutputPanel() {\n    let out = \"\";\n\n    for (let i = 0; i < printResults.length; i++) {\n        // out += \"<tr><td>\" + i.toString() + \": </td><td>\" + img3 + \"</td></tr>\";\n\n\n        let data = \"\";\n        try {\n                data += printResults[i];\n        } catch (e) {\n            console.log((e as Error).message);\n            data += \"Error reading result\";\n        }\n\n        if (data !== \"\") {\n            out += \"<div id='result'>\" +\n                // printResults[i].replace(/(?:\\r\\n|\\r|\\n)/g, '<br><br>') + // .replace(/^\\\"/, '').replace(/\\\"$/, '')\n                data +\n                \"</div>\";\n        }\n    }\n\n    let vars = `<vscode-data-grid-row row-type=\"header\">\n        <vscode-data-grid-cell cell-type=\"columnheader\" grid-column=\"1\">Var</vscode-data-grid-cell>\n        <vscode-data-grid-cell cell-type=\"columnheader\" grid-column=\"2\">Value</vscode-data-grid-cell>\n    </vscode-data-grid-row>`;\n\n    let i = 0;\n    Object.keys(variableTable).forEach(k => {\n        // if (i % 2 === 0) {\n        //     vars += \"<tr><td style='background:var(--vscode-editor-foreground) !important; color:var(--vscode-editor-background) !important;'>\" + k + \"</td><td style='background:var(--vscode-editor-foreground) !important; color:var(--vscode-editor-background) !important;'>\" + variableTable[k] + \"</td></tr>\\n\"\n        // } else {\n        //     vars += \"<tr><td>\" + k + \"</td><td>\" + variableTable[k] + \"</td></tr>\\n\"\n        // }\n        vars += `<vscode-data-grid-row>\n\t\t    <vscode-data-grid-cell grid-column=\"1\">${k}</vscode-data-grid-cell>\n\t\t    <vscode-data-grid-cell grid-column=\"2\">${variableTable[k]}</vscode-data-grid-cell>\n        </vscode-data-grid-row>\n        `\n        i++;\n    });\n\n    outputPanel?.webview.postMessage({ text: out, vars: vars });\n    plotsPanel?.webview.postMessage({ text: out, vars: vars });\n}\n\nasync function connectModule(modulePath: string, runtimePath: string, port: number, outputChannel: vscode.OutputChannel): Promise<(unknown)[]> {\n    console.log(\"Connecting to module: \" + modulePath);\n    console.log(\"Connecting to runtime: \" + runtimePath);\n    let serverOptions: NodeModule = {\n        module: modulePath,\n        runtime: runtimePath,\n        transport: {\n            kind: TransportKind.socket,\n            port: port\n        },\n        options: {\n            env: {\n                PATH: process.env.PATH\n            }\n        },\n        args: ['-file', runtimePath, port.toString(), runtimePath]\n    }\n\n    let clientOptions: LanguageClientOptions = {\n        documentSelector: [\n            \"wolfram\"\n        ],\n        diagnosticCollectionName: 'wolfram-lsp',\n        outputChannel: outputChannel\n    };\n\n    function delay(time:any) {\n        return new Promise(resolve => setTimeout(resolve, time));\n      }\n\n    return new Promise(async (resolve) => {\n        let disposible: vscode.Disposable;\n        let client = new LanguageClient('wolfram', 'Wolfram Language Server', serverOptions, clientOptions);\n        while (client.needsStart()){\n            console.log(\"Waiting for client to start...\");\n            disposible = client.start();\n            delay(1000);\n        }\n        client.onReady().then(() => {\n            console.log(\"Client ready\");\n            resolve([client, disposible]);\n        });\n\n        \n    })\n}\n\nlet console_outputs:string[] = []\nlet socketsClosed = 0;\nasync function startWLSP(): Promise<void> {\n    let timeout: any;\n\n    let serverOptions: ServerOptions = function () {\n        return new Promise(async (resolve, reject) => {\n            let socket = new net.Socket();\n            \n\n            socket.setMaxListeners(5);\n\n            // socket.on(\"data\", (data) => {\n                // console.log(\"WLSP Kernel Data: \" + data.toString().slice(0, 200))\n                // console_outputs.push(data.toString());\n            // });\n\n            socket.on('connect', () => {\n                outputChannel.appendLine(\"Client Socket connected: \" )\n                outputChannel.appendLine(new Date().toLocaleTimeString())\n                clearTimeout(timeout);\n                setTimeout(() => {\n                    outputChannel.appendLine(\"Client Resolved\")\n                    outputChannel.appendLine(new Date().toLocaleTimeString())\n                    resolve({\n                        reader: socket,\n                        writer: socket\n                    })\n                }, 10)\n            })\n\n            socket.on('error', function (err:any) {\n                outputChannel.appendLine(\"Client Socket error: \" + err)\n                outputChannel.appendLine(new Date().toLocaleTimeString())\n                if (err.code === 'ECONNREFUSED') {\n                    timeout = setTimeout(() => {\n                        socket.connect(clientPort, \"127.0.0.1\", () => {\n                            socket.setKeepAlive(false);\n                        });\n                    }, 500)\n                }\n            })\n\n            socket.on(\"close\", () => {\n                outputChannel.appendLine(\"Client Socket close\")    \n                outputChannel.appendLine(new Date().toLocaleTimeString())\n            });\n\n            socket.on('timeout', () => {\n                outputChannel.appendLine(\"Client Socket timeout\")    \n                outputChannel.appendLine(new Date().toLocaleTimeString())\n            });\n\n            socket.on('ready', () => {\n                outputChannel.appendLine(\"Client Socket ready\")     \n                outputChannel.appendLine(new Date().toLocaleTimeString())\n            })\n\n            socket.on('drain', () => {\n                outputChannel.appendLine(\"Client Socket is draining\")\n                outputChannel.appendLine(new Date().toLocaleTimeString())\n            })\n\n\n            socket.on(\"end\", () => {\n                outputChannel.appendLine(\"Client Socket end\");\n                outputChannel.appendLine(new Date().toLocaleTimeString())\n            })\n                 \n\n            fp(clientPort).then(([freePort]:number[]) => {\n                clientPort = freePort;\n                load(wolfram, lspPath, clientPort, outputChannel).then((r:any) => {\n                    wolfram = r\n                    socket.connect(clientPort, \"127.0.0.1\", () => {\n                        socket.setKeepAlive(false);\n                    });\n                });\n            })\n        })\n    };\n\n    let clientOptions: LanguageClientOptions = {\n        documentSelector: [\n            \"wolfram\"\n        ],\n        diagnosticCollectionName: 'wolfram-lsp',\n        outputChannel: outputChannel\n    };\n\n    return new Promise(async (resolve) => {\n        wolframClient = new LanguageClient('wolfram', 'Wolfram Language Server', serverOptions, clientOptions);        \n        \n        wolframClient.onReady().then(() => {\n            onclientReady();\n        })\n\n        setTimeout(() => {\n            let disposible: vscode.Disposable |undefined;\n            disposible = wolframClient?.start();\n            outputChannel.appendLine(\"Client Started\")\n            outputChannel.appendLine(new Date().toLocaleTimeString())\n            if (disposible) {context.subscriptions.push(disposible)};\n            resolve()\n        }, 2000)\n\n    });\n}\n\n\nasync function startWLSPKernel(): Promise<void> {\n    let timeout: any;\n    \n    let serverOptions: ServerOptions = function () {\n        return new Promise(async (resolve, reject) => {\n            let socket = new net.Socket();\n            \n\n            socket.setMaxListeners(5);\n\n            // socket.on(\"data\", (data) => {\n                // outputChannel.appendLine(\"WLSP Kernel Data: \" + data.toString().slice(0, 200))\n                // console_outputs.push(data.toString());\n            // });\n\n            socket.on('connect', () => {\n                outputChannel.appendLine(new Date().toLocaleTimeString())\n                outputChannel.appendLine(\"Kernel Socket connected: \" )\n                clearTimeout(timeout);\n                setTimeout(() => {\n                    outputChannel.appendLine(\"Kernel Resolved\")\n                    outputChannel.appendLine(new Date().toLocaleTimeString())\n                    resolve({\n                        reader: socket,\n                        writer: socket\n                    })\n                }, 10)\n            })\n\n            socket.on('error', function (err:any) {\n                outputChannel.appendLine(\"Kernel Socket error: \" + err)\n                if (err.code === 'ECONNREFUSED') {\n                    timeout = setTimeout(() => {                        \n                        socket.connect(kernelPort, \"127.0.0.1\", () => {\n                            socket.setKeepAlive(false);\n                        });\n                    }, 500)\n                }\n            })\n\n            socket.on(\"close\", () => {\n                outputChannel.appendLine(new Date().toLocaleTimeString())\n                outputChannel.appendLine(\"Kernel Socket close\")    \n            });\n\n            socket.on('timeout', () => {\n                outputChannel.appendLine(\"Kernel Socket timeout\")    \n            });\n\n            socket.on('ready', () => {\n                outputChannel.appendLine(new Date().toLocaleTimeString())\n                outputChannel.appendLine(\"Kernel Socket ready\")     \n                clearTimeout(timeout);\n                setTimeout(() => {\n                    resolve({\n                        reader: socket,\n                        writer: socket\n                    }),\n                    500\n                })\n            })\n\n            socket.on('drain', () => {\n                outputChannel.appendLine(\"Kernel Socket is draining\")\n            })\n\n\n            socket.on(\"end\", () => {\n                outputChannel.appendLine(\"Kernel Socket end\");\n            })\n                 \n\n            fp(kernelPort).then(([freePort]:number[]) => {\n                kernelPort = freePort;\n                load(wolframKernel, kernelPath, kernelPort, outputChannel).then((r:any) => {\n                    wolframKernel = r\n                    socket.connect(kernelPort, \"127.0.0.1\", () => {\n                        socket.setKeepAlive(false);\n                    });\n                });\n            })\n        })\n    };\n\n    let clientOptions: LanguageClientOptions = {\n        documentSelector: [\n            \"wolfram\"\n        ],\n        diagnosticCollectionName: 'wolfram-lsp',\n        outputChannel: outputChannel\n    };\n\n    return new Promise(async (resolve) => {\n        wolframKernelClient = new LanguageClient('wolfram', 'Wolfram Language Server', serverOptions, clientOptions);        \n     \n        wolframKernelClient.onReady().then(() => {\n            onkernelReady();\n        })\n\n\n        setTimeout(() => {\n            let disposible: vscode.Disposable |undefined;\n            disposible = wolframKernelClient?.start();\n            outputChannel.appendLine(\"Kernel Started\")\n            outputChannel.appendLine(new Date().toLocaleTimeString())\n            if (disposible) {context.subscriptions.push(disposible)};\n            resolve()\n        }, 2000)\n        \n    });\n}\n\nasync function connect(context: vscode.ExtensionContext, outputChannel: vscode.OutputChannel, port: number, type?: string): Promise<(any)[]> {\n\n    let serverOptions: ServerOptions = function () {\n        return new Promise((resolve, reject) => {\n            let socket = new net.Socket();\n\n            socket.setMaxListeners(100);\n\n            // socket.on(\"data\", (data) => {\n                // console.log(\"WLSP Kernel Data: \" + data.toString().slice(0, 200))\n                // console_outputs.push(data.toString());\n            // });\n\n            let timeout: any;\n            socket.on('connect', () => {\n                console.log(\"Socket connected: \" )\n                clearTimeout(timeout);\n                resolve({\n                    reader: socket,\n                    writer: socket\n                })\n            })\n\n            socket.on('error', function (err) {\n                // console.log(\"Socket Error: \" + err.message);\n                timeout = setTimeout(() => {            \n                    socket.connect(port, \"127.0.0.1\", () => {\n                        socket.setKeepAlive(false);\n                    });\n                },1000)\n            })\n\n            socket.on(\"close\", () => {\n                console.log(\"Socket close\")    \n                // startLanguageServer(context, outputChannel)\n            })\n\n            socket.on('timeout', () => {\n                console.log(\"Socket timeout\")    \n            });\n\n            socket.on('ready', () => {\n                console.log(\"Socket ready\")     \n            })\n\n            socket.on('drain', () => {\n                console.log(\"Socket is draining\")\n            })\n\n\n            socket.on(\"end\", () => {\n                console.log(\"Socket end\");\n                timeout = setTimeout(() => {\n                    socket.connect(port, \"127.0.0.1\", () => { socket.setKeepAlive(true) });\n                }, 1000);\n            })\n\n            socket.connect(port, \"127.0.0.1\", () => {\n                socket.setKeepAlive(false);\n            });\n\n\n        })\n    };\n\n    let clientOptions: LanguageClientOptions = {\n        documentSelector: [\n            \"wolfram\"\n        ],\n        diagnosticCollectionName: 'wolfram-lsp',\n        outputChannel: outputChannel\n    };\n\n\n    return new Promise(async (resolve) => {\n        let disposible: vscode.Disposable;\n        let client = new LanguageClient('wolfram', 'Wolfram Language Server', serverOptions, clientOptions);        \n        while (client.needsStart()){\n            console.log(\"Waiting for client to start...\");\n            disposible = client.start();\n            delay(1000);\n        }\n        client.onReady().then(() => {\n            console.log(\"Client ready\");\n            resolve([client, disposible]);\n        });\n\n        // disposible = client.start();\n        // resolve([client, disposible]);\n    });\n}\n\nasync function delay(ms: number) {\n    return new Promise((resolve) => { setTimeout(resolve, ms) })\n}\n\nfunction connectKernelClient(outputChannel: any, context: any) {\n\n}\n\nasync function load(wolfram: cp.ChildProcess, path: string, port: number, outputChannel: vscode.OutputChannel): Promise<cp.ChildProcess> {\n    return new Promise((resolve) => {\n        try {\n            if (process.platform === \"win32\") {\n                wolfram = cp.spawn('cmd.exe', ['/c', 'wolframscript.exe', '-file', path, port.toString(), path], { detached: false });\n            } else {\n                wolfram = cp.spawn('wolframscript', ['-file', path, port.toString(), path], { detached: true });\n            }\n\n            wolfram.stdout?.once('data', (data: any) => {\n                outputChannel.appendLine(\"WLSP: \" + data.toString())\n                resolve(wolfram);\n            });\n\n\n            if (wolfram.pid != undefined) {\n                console.log(\"Launching wolframscript: \" + wolfram.pid.toString());\n                processes.push(wolfram)\n            } else {\n                console.log(\"Launching wolframscript: pid unknown\");\n            }\n\n\n            wolfram.on('SIGPIPE', (data) => {\n                console.log(\"SIGPIPE\");\n            });\n\n\n            wolfram.stdout?.on('error', (data) => {\n                console.log(\"STDOUT Error\" + data.toString());\n            });\n\n            wolfram.stdout?.on('data', (data) => {\n                outputChannel.appendLine(\"WLSP: \" + data.toString())\n            });\n\n\n        } catch (error) {\n            console.log(error)\n            vscode.window.showErrorMessage(\"Wolframscript failed to load.\")\n            resolve(wolfram)\n        }\n    })\n}\n\n\n\nfunction stopWolfram(client: LanguageClient|undefined, client_process: any): Promise<void> {\n    return new Promise((resolve) => {\n        // client?.stop();\n        try {\n            client?.stop();\n        } catch {}\n\n        try {\n            let cp = require('child_process');\n            let isWin = /^win/.test(process.platform);\n            if (isWin) {\n                cp.exec('taskkill /PID ' + client_process.pid + ' /T /F', function (error: any, stdout: any, stderr: any) {});\n                resolve()\n\n            } else {\n                console.log(\"Killing process: \" + client_process.pid);\n                cp.exec('kill -9 ' + client_process.pid, function (error: any, stdout: any, stderr: any) {});\n                resolve()\n                // process.kill(-client_process.pid, 'SIGKILL');\n\n                // cp.exec('kill -9 ' + client_process.pid , function (error: any, stdout: any, stderr: any) {})\n                // client_process.kill();\n                // kill(client_process.pid);\n            }\n        } catch (e) {\n            console.log((e as Error).message)\n            resolve()\n        }\n    })\n}\n\nlet kill = function (pid: any) {\n    let signal = 'SIGTERM';\n    let callback = function () { };\n    var killTree = false;\n    if (killTree) {\n        psTree(pid, function (err: any, children: any) {\n            [pid].concat(\n                children.map(function (p: any) {\n                    return p.PID;\n                })\n            ).forEach(function (pid) {\n                try { process.kill(pid, signal); }\n                catch (ex) {\n                    console.log(\"Failed to kill: \" + pid)\n                    console.log((ex as Error).message)\n                }\n            });\n            callback();\n        });\n    } else {\n        try { process.kill(pid, signal); }\n        catch (ex) {\n            console.log(\"Failed to kill wolfram process\")\n        }\n        callback();\n    }\n};\n\n\n\n\n\n\nfunction runTextCell(location:vscode.Range) {\n    let e: vscode.TextEditor | undefined = vscode.window.activeTextEditor;\n    let sel: vscode.Selection = new vscode.Selection(\n        new vscode.Position(location.start.line, location.start.character),\n        new vscode.Position(location.end.line, location.end.character)\n    );\n    sendToWolfram(false, sel)\n}\n\nfunction printInWolfram(print = true) {\n    runInWolfram(print);\n}\n\nfunction didChangeTextDocument(event: vscode.TextDocumentChangeEvent): void {\n    // didOpenTextDocument(event.document);\n    // remove old decorations\n\n    let editor = vscode.window.activeTextEditor;\n\n    if (event.document.uri.toString() !== editor?.document.uri.toString()) {\n        return\n    }\n\n    clearDecorations();\n    if (vscode.workspace.getConfiguration().get(\"wlsp.liveDocument\")) {\n        let doc = editor?.document;\n\n        if (wolframKernelClient) {        \n            wolframKernelClient.onReady().then(() => {\n                wolframKernelClient?.sendNotification(\"runDocumentLive\", doc?.uri)\n            })\n        } \n        return\n    }  \n\n    // let decorations: vscode.DecorationOptions[] = [];\n    // if (editor == null) {\n    //     return\n    // } else {\n    //     let position = editor?.selection.active;\n\n    //     let uri = editor.document.uri.toString();\n\n    //     if ((workspaceDecorations == undefined) || (workspaceDecorations == null)) {\n    //         workspaceDecorations = {};\n    //     }\n\n    //     if (workspaceDecorations[uri] !== undefined) {\n    //         Object.keys(workspaceDecorations[uri]).forEach((line: any) => {\n    //             if (parseInt(line, 10) < position.line) {\n    //                 decorations.push(workspaceDecorations[uri][line]);\n    //             } else {\n    //                 delete workspaceDecorations[uri][line];\n    //             }\n    //         });\n    //     }\n\n    //     // live document\n    //     editor.setDecorations(variableDecorationType, decorations);\n       \n    // }\n    return;\n}\n\nfunction isUntitled(document:vscode.TextDocument) {\n    return (document.languageId === \"wolfram\" && document.uri.scheme === 'untitled')\n}\n\n\nfunction didOpenTextDocument(document: vscode.TextDocument): void {\n    if (document.languageId !== 'wolfram' || (document.uri.scheme !== 'file' && document.uri.scheme !== 'untitled')) {\n        return;\n    }\n\n    if (isUntitled(document) && !clients.has(\"default\")) {\n        startWLSP()\n        startWLSPKernel()\n\n        clients.set(\"default\", [wolframClient, wolframKernelClient])\n        return;\n\n    }  \n\n    let folder = vscode.workspace.getWorkspaceFolder(document.uri);\n    if (!folder) {\n        return\n    }\n    \n    if (!clients.has(folder.uri.toString()) && document.languageId === \"wolfram\"){\n        startWLSP()\n        startWLSPKernel()\n        clients.set(folder.uri.toString(), [wolframClient, wolframKernelClient])\n    }\n\n\n\n    return;\n}\n\n\nfunction didSaveTextDocument(event: vscode.TextDocument): void {\n    treeDataProvider.refresh();\n    clearDecorations();\n    didOpenTextDocument(event);\n    return;\n}\n\n\nfunction createFile() {\n    vscode.workspace.openTextDocument(vscode.Uri.parse(\"untitled:.wl\")).then((document: vscode.TextDocument) => {\n        vscode.window.showTextDocument(document);\n    });\n}\n\nfunction createNotebook() {\n    vscode.workspace.openNotebookDocument(vscode.Uri.parse(\"untitled:.nb\")).then((document: vscode.NotebookDocument) => {\n        // vscode.window.showNotebookDocument(document);\n    });\n}\n\nfunction createNotebookScript() {\n    vscode.workspace.openNotebookDocument(vscode.Uri.parse(\"untitled:.wl\")).then((document: vscode.NotebookDocument) => {\n        // vscode.window.showNotebookDocument(document);\n    });\n}\n\n\nfunction didChangeWindowState(state: vscode.WindowState) {\n    if (wolframClient !== null || wolframClient !== undefined) {\n        if (state.focused === true) {\n            wolframClient?.onReady().then(ready => {\n                wolframClient?.sendNotification(\"windowFocused\", true);\n            });\n        } else {\n\n            wolframClient?.onReady().then(ready => {\n                wolframClient?.sendNotification(\"windowFocused\", false);\n            });\n        }\n    }\n}\n\n\nfunction startWolframTerminal() {\n    let cmd: string;\n    let args: string[];\n    if (process.platform === \"win32\") {\n        cmd = 'cmd.exe';\n        args = ['/c', 'wolframscript.exe'];\n    } else {\n        cmd = 'rlwrap wolframscript';\n        args = [];\n    }\n    let activeWolframTerminal: vscode.Terminal;\n    activeWolframTerminal = vscode.window.createTerminal(\"wolfram terminal\", cmd, args);\n    activeWolframTerminal.show(true);\n}\n\nfunction runInTerminal() {\n    if (!vscode.window.activeTerminal) {\n        startWolframTerminal();\n    }\n\n    let e: any = vscode.window.activeTextEditor;\n    let d: vscode.TextDocument = e!.document;\n    let sel = e!.selections;\n    vscode.window.activeTerminal?.sendText(d.getText(new vscode.Range(e.selection.start, e?.selection.end)));\n}\n\nfunction help() {\n    let e: vscode.TextEditor | undefined = vscode.window.activeTextEditor;\n    let d = e!.document;\n    let sel = e!.selections;\n    let txt = \"\";\n    let dataString = \"\";\n    for (var x = 0; x < sel.length; x++) {\n        txt = txt + d.getText(new vscode.Range(sel[x].start, sel[x].end));\n    }\n\n    let url = \"https://reference.wolfram.com/language/ref/\" + txt + \".html\";\n    // opn(url);\n\n    let helpPanel = vscode.window.createWebviewPanel(\n        \"wolframHelp\",\n        \"Wolfram Help\",\n        2,\n        {\n            enableScripts: true,\n            retainContextWhenHidden: true\n        }\n    );\n    helpPanel.webview.html = `<!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n    \n    <meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self' https://reference.wolfram.com 'unsafe-inline'\">\n    \n    </head>\n    <body>\n        <span>\n            <input\n                action=\"action\"\n                onclick=\"window.history.go(-1); return false;\"\n                type=\"button\"\n                value=\"Back\"\n            />\n            <input\n                action=\"action\"\n                onclick=\"window.history.forward(); return false;\"\n                type=\"button\"\n                value=\"Forward\"\n            />\n        </span>\n        <iframe src=\"${url}\" style=\"height:100vh; width:100%\" sandbox=\"allow-same-origin allow-scripts allow-popups allow-forms allow-top-navigation allow-modals\"></iframe>\n    </body>\n    </html>\n    `\n}\n\nfunction stringHelp(string: string) {\n    let url = \"https://reference.wolfram.com/language/ref/\" + string + \".html\";\n    let helpPanel = vscode.window.createWebviewPanel(\n        \"wolframHelp\",\n        \"Wolfram Help\",\n        2,\n        {\n            enableScripts: true,\n            retainContextWhenHidden: true\n        }\n    );\n\n    helpPanel.webview.html = `<!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n    \n    <meta http-equiv=\"Content-Security-Policy\" content=\"default-src 'self' https://reference.wolfram.com 'unsafe-inline'\">\n    \n    </head>\n    <body>\n        <span>\n            <input\n                action=\"action\"\n                onclick=\"window.history.go(-1); return false;\"\n                type=\"button\"\n                value=\"Back\"\n            />\n            <input\n                action=\"action\"\n                onclick=\"window.history.forward(); return false;\"\n                type=\"button\"\n                value=\"Forward\"\n            />\n        </span>\n        <iframe src=\"${url}\" style=\"height:100vh; width:100%\" sandbox=\"allow-same-origin allow-scripts allow-popups allow-forms allow-top-navigation allow-modals\"></iframe>\n    </body>\n    </html>\n    `\n}\n\nfunction abort() {\n    wolframClient?.sendNotification(\"abort\");\n}\n\nfunction textToSection() {\n    let e: vscode.TextEditor | undefined = vscode.window.activeTextEditor;\n\n    let lines: string[];\n    let newlines: string = \"\";\n\n    if (e) {\n        let sel: vscode.Selection = e.selection;\n        lines = e?.document.getText(new vscode.Range(sel.start, sel.end)).split('\\n');\n\n        lines.forEach(l => {\n            newlines += \"(*\" + l + \"*)\\n\"\n        });\n\n\n        e.edit(editbuilder => {\n            editbuilder.replace(sel, newlines.trimRight())\n        })\n    }\n}\n\n\nfunction textFromSection() {\n    let e: vscode.TextEditor | undefined = vscode.window.activeTextEditor;\n\n    let lines: string[];\n    let newlines: string = \"\";\n\n    if (e) {\n        let sel: vscode.Selection = e.selection;\n        lines = e?.document.getText(new vscode.Range(sel.start, sel.end)).split('\\n');\n\n        lines.forEach(l => {\n            newlines += l.replace(/^\\(\\*/, \"\").replace(/\\*\\)$/, \"\") + \"\\n\"\n        });\n\n\n        e.edit(editbuilder => {\n            editbuilder.replace(sel, newlines.trimRight())\n        })\n    }\n}\n\n// let kill = function (pid:any) {\n//     let signal   = 'SIGKILL';\n//     let callback = function () {};\n//     var killTree = true;\n//     if(killTree) {\n//         psTree(pid, function (err:any, children:any) {\n//             [pid].concat(\n//                 children.map(function (p:any) {\n//                     return p.PID;\n//                 })\n//             ).forEach(function (pid) {\n//                 try { process.kill(pid, signal);}\n//                 catch (ex) {\n//                     console.log(\"Failed to kill: \" + pid)\n//                  }\n//             });\n//             callback();\n//         });\n//     } else {\n//         try { process.kill(pid, signal); }\n//         catch (ex) { \n//             console.log(\"Failed to kill wolfram process\")}\n//         callback();\n//     }\n// };\n","\n\nimport { Uri, Webview } from \"vscode\";\n\nexport function getOutputContent(webview: any, extensionUri: Uri) {\n    let timeNow = new Date().getTime();\n    const toolkitUri = getUri(webview, extensionUri, [\n        \"node_modules\",\n        \"@vscode\",\n        \"webview-ui-toolkit\",\n        \"dist\",\n        \"toolkit.js\",\n    ]);\n\n    const mainUri = getUri(webview, extensionUri, [\"media\", \"main.js\"]);\n    const styleUri = getUri(webview, extensionUri, [\"media\", \"style.css\"]);\n    const codiconsUri = getUri(webview, extensionUri, [\n        \"node_modules\",\n        \"@vscode\",\n        \"codicons\",\n        \"dist\",\n        \"codicon.css\",\n    ]);\n    \n    let result = `<!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n        <script type=\"module\" src=\"${toolkitUri}\"></script>\n        <!-- <script type=\"module\" src=\"${mainUri}\"></script>\n        <link rel=\"stylesheet\" href=\"${styleUri}\"> \n        <link rel=\"stylesheet\" href=\"${codiconsUri}\"> -->\n        <style type=\"text/css\">\n\n            body{\n                overflow:scroll;\n                height:100%;\n            }\n\n            body.vscode-light {\n                background: var(--vscode-editor-background);\n                color: var(--vscode-editor-foreground);\n                font: var(--vscode-editor-font-family);\n            }\n\n            body.vscode-dark {\n                background: var(--vscode-editor-background);\n                color: var(--vscode-editor-foreground);\n                font: var(--vscode-editor-font-family);\n            }\n\n            body.vscode-high-contrast {\n                background: var(--vscode-editor-background);\n                color: var(--vscode-editor-foreground);\n                font: var(--vscode-editor-font-family);\n            }\n\n            #expression {\n                background: var(--vscode-editor-background);\n                color: var(--vscode-editor-foreground);\n                font: var(--vscode-editor-font-family);\n                width: 100%;\n            }\n\n            #vars {\n                height:98vh;\n                position:relative;\n                top:0;\n                border-bottom: solid white 1px;\n                overflow-y:scroll;\n                width:93vw;\n            }\n\n            .outer {\n                height:100vh;\n                display:block;\n                position:relative;\n                top:0;\n            }\n            #scratch {\n                position:fixed;\n                width:95vw;\n                bottom:0px;\n                height: 8vh;\n            }\n\n            #scratch textarea {\n                border-radius:2px;\n                color: var(--vscode-editor-foreground);\n                font: var(--vscode-editor-font-family);\n            }\n\n        </style>\n        <meta charset=\"UTF-8\">\n\n        <!-- <meta http-equiv=\"Content-Security-Policy\" content=\"default-src *; img-src ${webview.cspSource} https: data:; script-src ${webview.cspSource} 'unsafe-inline'; style-src ${webview.cspSource} 'unsafe-inline';\"/> -->\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>Wolfram Output</title>\n        <script>\n            const vscode = acquireVsCodeApi();\n            function scrollToBottom() {\n                // window.scrollTo(0,document.body.scrollHeight);\n\n                var color = '';\n                var fontFamily = '';\n                var fontSize = '';\n                var theme = '';\n                var fontWeight = '';\n                try {\n                    computedStyle = window.getComputedStyle(document.body);\n                    color = computedStyle.color + '';\n                    backgroundColor = computedStyle.backgroundColor + '';\n                    fontFamily = computedStyle.fontFamily;\n                    fontSize = computedStyle.fontSize;\n                    fontWeight = computedStyle.fontWeight;\n                    theme = document.body.className;\n                } catch(ex) { }\n            }\n\n        function run(input) {\n            if(event.key === 'Enter') {\n                if(event.shiftKey) {\n                    vscode.postMessage({\n                        text: input.value\n                    });\n                    input.value = \"\"\n                }\n            }\n        }\n\n        window.addEventListener('message', event => {\n            const message = event.data;\n\n            const varT = document.getElementById('varTable');\n            varT.innerHTML = message.vars;\n        })\n        </script>\n    </head>\n    <body onload=\"scrollToBottom()\">\n        <div class=\"outer\">\n            <div id=\"vars\">\n            <vscode-data-grid generate-header=\"sticky\" aria-label=\"With Sticky Header\" id=\"varTable\">\n                <vscode-data-grid-row row-type=\"header\">\n                    <vscode-data-grid-cell cell-type=\"columnheader\" grid-column=\"1\">Var</vscode-data-grid-cell>\n                    <vscode-data-grid-cell cell-type=\"columnheader\" grid-column=\"2\">Value</vscode-data-grid-cell>\n                </vscode-data-grid-row>\n            </vscode-data-grid>\n            </div>\n            <!--- <div id=\"scratch\">\n                <vscode-text-area id=\"expression\" onkeydown=\"run(this)\" rows=\"3\" placeholder=\"Shift+Enter to run\"></vscode-text-area>\n            </div> -->\n        </div>\n    </body>\n    </html>`;\n    return result;\n}\n\nfunction getUri(webview: Webview, extensionUri: Uri, pathList: string[]) {\n    return webview.asWebviewUri(Uri.joinPath(extensionUri, ...pathList));\n}","import { rejects, throws } from 'assert';\nimport { Runnable } from 'mocha';\nimport { rawListeners } from 'process';\nimport * as vscode from 'vscode';\nimport { \n\tLanguageClient,\n\tLanguageClientOptions,\n\tServerOptions,\n\tTransportKind } from 'vscode-languageclient';\nimport { wolframClient } from './clients';\n\n\n\nexport interface RawNotebookCell {\n    indentation?: string;\n    metadata?:any;\n\t  language: string;\n\t  value: string;\n    kind: vscode.NotebookCellKind;\n}\n\n// export function activate(context: vscode.ExtensionContext) {\n//     context.subscriptions.push(\n//       vscode.workspace.registerNotebookSerializer('wolfram-notebook', new WolframNotebookSerializer())\n//   );\n// }\n\nexport class WolframNotebookSerializer implements vscode.NotebookSerializer {\n\n  async deserializeNotebook(\n    content: Uint8Array,\n    _token: vscode.CancellationToken\n  ): Promise<vscode.NotebookData> {\n    return new Promise((resolve, reject) => {\n      var contents = new TextDecoder().decode(content);\n\n\n      let x = this.mretry(contents, 1, resolve)\n    })\n  }\n\n  private raw: vscode.NotebookCellData[] = [];\n  private cells: vscode.NotebookCellData[] = [];\n  getCells(item:any){\n    if(item.constructor.name === \"Array\"){\n      item.map(\n        (item:any) => this.getCells(item)\n      );\n    } else {\n      this.raw.push({\n        kind: item.kind,\n        languageId: item.languageId,\n        value: item.value,\n        metadata: item.metadata,\n        outputs: item.outputs\n      })\n    }\n  } \n\n  mretry(contents:any, attempts:number, cb:any) {\n    setTimeout(() => {\n      if (attempts > 20) {\n        vscode.window.showErrorMessage(\"Failed to open notebook.\")\n        cb(new vscode.NotebookData(this.cells));\n        return new vscode.NotebookData(this.cells);\n      } \n      if (wolframClient !== undefined) {\n        wolframClient.onReady().then(() => {\n      \n          wolframClient?.sendRequest(\"deserializeNotebook\", {contents: contents}).then((result:any)=>{\n\n            this.raw = [];\n            result.map(\n              (item:any) => this.getCells(item)\n            );\n            this.cells = this.raw.map(\n              (item:any) => {\n              let i = new vscode.NotebookCellData(item.kind, item.value, item.languageId)\n\n              i.metadata = item.metadata;\n\n              let outs = item.outputs.reduce((o:any, c:any) => {\n                return {value: o.value?.toString() + \"<br>\" + c?.value?.toString()}\n              }, {value:\"\"}).value\n\n              i.outputs = [\n                new vscode.NotebookCellOutput([\n                  vscode.NotebookCellOutputItem.text(outs, \"text/html\")\n                ])\n              ] \n              \n              return i\n              }\n            );\n            cb(new vscode.NotebookData(this.cells));\n            return new vscode.NotebookData(this.cells);\n          }).then((result:any) => {\n            return result\n          })\n        })\n      } else {\n        console.log(\"Waiting for kernel\")\n        this.mretry(contents, attempts++, cb)\n      }\n    }, 3000)\n  }\n\n  async serializeNotebook(\n    data: vscode.NotebookData,\n    _token: vscode.CancellationToken\n  ): Promise<Uint8Array> {\n    let contents: any[] = [];\n\n    for (const cell of data.cells) {\n      contents.push({\n        kind: cell.kind,\n        language: cell.languageId,\n        value: cell.value,\n        metadata: Object.values((cell as any).metadata).join(\"\"),\n        outputs: cell.outputs\n      });\n    }\n\n    if (wolframClient) {\n      return wolframClient.sendRequest(\"serializeNotebook\", {contents: contents}).then((result:any)=>{\n         return Buffer.from(result);\n      });\n    } else {\n      return Buffer.from(JSON.stringify(contents));\n    }\n  }\n\n  \n}\n\nexport class WolframScriptSerializer implements vscode.NotebookSerializer {\n  private raw: vscode.NotebookCellData[] = [];\n  private cells: vscode.NotebookCellData[] = [];\n\n  async deserializeNotebook(\n    content: Uint8Array,\n    _token: vscode.CancellationToken\n  ): Promise<vscode.NotebookData> {\n    return new Promise((resolve, reject) => {    \n      var contents = new TextDecoder().decode(content);\n\n      let x = this.mretry(contents, 1, resolve) \n\n    })\n  }\n\n  async serializeNotebook(\n    data: vscode.NotebookData,\n    _token: vscode.CancellationToken\n  ): Promise<Uint8Array> {\n    let contents: any[] = [];\n\n    for (const cell of data.cells) {\n      contents.push({\n        kind: cell.kind,\n        language: cell.languageId,\n        value: cell.value,\n        metadata: Object.values((cell as any).metadata).join(\"\"),\n        outputs: \"\" //cell.outputs\n      });\n    }\n\n    return new Promise((resolve, reject) => {\n      if (wolframClient !== undefined) {\n        wolframClient.onReady().then(() => {\n        return wolframClient?.sendRequest(\"serializeScript\", {contents: contents}).then((result:any)=>{\n          resolve(Buffer.from(result));\n        });\n      });\n    } else {\n      let string = \"\";\n      for (const cell of contents) {\n        string += cell.value + \"\\n\\n\\n\";\n      }\n      resolve(Buffer.from(string));\n    }\n  })}\n\n  getCells(item:any){\n    if(item.constructor.name === \"Array\"){\n      item.map(\n        (item:any) => this.getCells(item)\n      );\n    } else {\n      this.raw.push({\n        kind: item.kind,\n        languageId: item.languageId,\n        value: item.value,\n        metadata: item.metadata,\n        outputs: item.outputs\n      })\n    }\n  }\n    \n  mretry(contents:any, attempts:number, cb:any) {\n    setTimeout(() => {\n      if (attempts > 20) {\n        vscode.window.showErrorMessage(\"Failed to open notebook.\")\n        cb(new vscode.NotebookData(this.cells));\n        return new vscode.NotebookData(this.cells);\n      } \n      if (wolframClient !== undefined) {\n        wolframClient.onReady().then(() => {\n      \n          wolframClient?.sendRequest(\"deserializeScript\", {contents: contents}).then((result:any)=>{\n\n            this.raw = [];\n            result.map(\n              (item:any) => this.getCells(item)\n            );\n            this.cells = this.raw.map(\n              (item:any) => {\n              try{\n                let i = new vscode.NotebookCellData(item.kind, item.value, item.languageId)\n  \n                i.metadata = item.metadata;\n                \n                return i\n              } catch(e){\n                return new vscode.NotebookCellData(1, item ? \"\" : item.value?.toString() , \"markdown\")  \n              }\n              }\n            );\n            cb(new vscode.NotebookData(this.cells));\n            return new vscode.NotebookData(this.cells);\n          }).then((result:any) => {\n            return result\n          })\n        })\n      } else {\n        console.log(\"Waiting for kernel to deserialize script\")\n        this.mretry(contents, attempts++, cb)\n      }\n    }, 3000)\n  }\n\n}\n\nexport class WolframNotebook {\n    public mapping: Map<number, any> = new Map();\n    private wolframClient:LanguageClient;\n\tprivate preloadScript = false;\n\tprivate displayOrders = [\n\t\t'text/html',\n\t\t'application/json',\n\t\t'application/javascript',\n\t\t'application/vnd.*',\n\t\t'image/svg+xml',\n\t\t'text/markdown',\n\t\t'image/svg+xml',\n\t\t'image/png',\n\t\t'image/jpeg',\n\t\t'text/plain'\n    ];\n    private nextExecutionOrder = 0;\n    public version = 0;\n    public contentOptions = {\n        transientOutputs: true,\n        transientMetadata: {}\n    }\n    \n    constructor(\n        public uri:vscode.Uri,\n        public fileName:string,\n        public viewType:string,\n        public isDirty:boolean,\n        public isUntitled:boolean,\n        public cells: readonly any[],\n        public languages: string[],\n        // public metadata: vscode.NotebookDocumentMetadata,\n        private _wolframClient:LanguageClient) {\n\n            // this.uri = uri;\n            this.fileName = fileName;\n            this.viewType = viewType;\n            this.isDirty = isDirty;\n            this.isUntitled = isUntitled;\n            this.cells = cells;\n            this.languages = languages;\n            // this.metadata = metadata;\n            this.wolframClient = _wolframClient;\n    }\n    // uri: vscode.Uri;\n    // fileName: string;\n    // viewType: string;\n    // isDirty: boolean;\n    // isUntitled: boolean;\n    // cells: readonly vscode.NotebookCell[];\n    // languages: string[];\n    // displayOrder?: vscode.GlobPattern[] | undefined;\n    // metadata: vscode.NotebookDocumentMetadata;\n\n    public setWolframClient(_wolframClient:LanguageClient) {\n        this.wolframClient = _wolframClient\n    }\n\n    // async execute(document: vscode.NotebookDocument, cell: vscode.NotebookCell | undefined) {\n    //     if (cell) {\n    //         const index = document.getCells().indexOf(cell);\n    //         let source = cell.document.getText();\n    //         let r:vscode.Selection = new vscode.Selection(\n    //             0,\n    //             0,\n    //             0,\n    //             0\n    //         );\n            \n    //         if (this.wolframClient){       \n    //             await this.wolframClient.sendRequest(\"runCell\", {range:r, textDocument:document.uri.toString(), print:false, source:source}).then((result:any) => {\n    //                 let c = document.cellAt(index);\n    //                 c.outputs.concat([\n    //                     {\n    //                             mime: \"text/html\",\n    //                             value: \n    //                                 \"<div style=\\\"min-height:50px; max-height:300px; overflow:scroll\\\">\" + result.output.toString() + \"<\\div>\"\n    //                     }]\n    //                 )  \n    //             }  else {\n    //                 console.log(\"Wolfram not connected\");\n    //                 vscode.window.showErrorMessage(\"Wolfram not connected.\");\n    //             }\n    //     }\n    // }\n\n    // resolve(): vscode.NotebookData {\n    //     let result = {\n    //         languages: ['wolfram'],\n    //         metadata: {\n\n\t// \t\t\teditable: this.metadata?.editable === undefined ? true : this.metadata?.editable,\n\t// \t\t\trunnable: this.metadata?.runnable === undefined ? true : this.metadata?.runnable,\n\t// \t\t\tcellEditable: this.metadata?.cellEditable === undefined ? true : this.metadata?.cellEditable,\n\t// \t\t\tcellRunnable: this.metadata?.cellRunnable === undefined ? true : this.metadata?.cellRunnable,\n\t// \t\t\tdisplayOrder: this.displayOrders\n    //         },\n    //         cells: this.cells.map(((raw_cell:any):vscode.NotebookCellData => {\n    //             let outputs:vscode.NotebookCellOutput[] = [];\n    //             let metadata = {editable:true, runnable:true, cellEditable:true, cellRunnable:true};\n    //             return {\n    //                 kind: raw_cell.cellKind,\n    //                 source: raw_cell.source,\n    //                 language: raw_cell.language || 'wolfram',\n    //                 outputs: outputs,\n    //                 // metadata: metadata\n    //             }\n    //         }))\n    //     }\n\n    //     return result;\n    // }\n\n}\n\n\n\nasync function timeFn(fn: () => Promise<void>): Promise<number> {\n    const startTime = Date.now();\n    await fn();\n    return Date.now() - startTime;\n}\n\n\n// export class WolframProvider implements vscode.NotebookContentProvider, vscode.NotebookKernel {\n//     private _onDidChangeNotebook = new vscode.EventEmitter<vscode.NotebookDocumentEditEvent>();\n// \tpublic _notebooks: Map<string, WolframNotebook> = new Map();\n// \tonDidChange: vscode.Event<void> = new vscode.EventEmitter<void>().event;\n// \tlabel: string = 'Wolfram';\n//     isPreferred: boolean = true;\n//     private wolframClient:LanguageClient;\n    \n//     constructor(viewType: string, private _extensionPath: string, private fillOutputs: boolean, private _wolframClient:LanguageClient) {\n\n//         this.wolframClient = _wolframClient;\n// \t\tconst emitter = new vscode.EventEmitter<void>();\n// \t\tvscode.notebook.registerNotebookContentProvider({ notebookType: viewType }, {\n// \t\t\tonDidChangeKernels: undefined,\n// \t\t\tprovideKernels: () => {\n// \t\t\t\treturn [this];\n// \t\t\t}\n// \t\t});\n\n// \t\tsetTimeout(() => {\n// \t\t\temitter.fire();\n// \t\t}, 5000);\n\n//     }\n\n//     public setWolframClient(_wolframClient:LanguageClient) {\n//         this.wolframClient = _wolframClient;\n//         this._notebooks.forEach((n:WolframNotebook, k:string) => {\n//             n.setWolframClient(_wolframClient);\n//         })\n//     }\n    \n//     async openNotebook(uri: vscode.Uri, context:vscode.NotebookDocumentOpenContext): Promise<vscode.NotebookData> {\n//         let actualUri = context.backupId ? vscode.Uri.parse(context.backupId) : uri; \n\n//         try {\n\n//             this.wolframClient.sendRequest(\"openNotebook\", {path:actualUri}).then(async (result:any) => {\n//                 let source = (await vscode.workspace.fs.readFile(actualUri)).toString();\n\n            \n            \n//             // const metadata:vscode.NotebookDocumentMetadata =  { editable: true, cellEditable: true, cellHasExecutionOrder: true, cellRunnable: true, runnable: true };\n//                         // {\n//             //     cells: [{\n//             //         cell_type: 'markdown',\n//             //         source: [\n//             //             '# header'\n//             //         ]\n//             //     }]\n//             // }\n//             let rawcells:any = [];\n            \n//             // = source.replace(/\\r/gm,\"\\n\").split(/\\n\\n\\n\\n|(?<=::\\s+\\*\\))\\n+/).map((s:any) => {\n//             //         let trimmed = s.trim();\n//             //         if (trimmed.substr(0, 3) == \"(* \" && trimmed.substr(trimmed.length - 3) == \" *)\"){\n//             //             return {\n//             //                 type: 'markdown',\n//             //                 source: s,\n//             //                 metadata:{editable:true, runnable:true, cellEditable:true, cellRunnable:true, language_info:'markdown'},\n//             //                 language:'markdown',\n//             //                 cellKind: vscode.CellKind.Markdown,\n//             //                 outputs:[]\n//             //             }\n//             //         } else {\n//             //             return {\n//             //                     type: 'wolfram',\n//             //                     source: s,\n//             //                     metadata:{editable:true, runnable:true, cellEditable:true, cellRunnable:true, language_info:'wolfram'},\n//             //                     language:'wolfram',\n//             //                     cellKind: vscode.CellKind.Code,\n//             //                     outputs:[]\n//             //                 }}\n//             //     })\n//             let languages = ['wolfram']       \n        \n//             let wolframNotebook = new WolframNotebook(\n//                 uri,\n//                 uri.fsPath.toString(),\n//                 \"wolfram.input\",\n//                 false,\n//                 false,\n//                 rawcells,\n//                 languages,\n//                 metadata,\n//                 this.wolframClient\n//             )\n\n//             //let wolframNotebook = new WolframNotebook(this._extensionPath, notebookRaw, true, this.wolframClient);\n            \n//             this._notebooks.set(uri.toString(), wolframNotebook);\n//             return wolframNotebook.resolve();\n//         })\n//         } catch (error) {\n//             console.log(error.message)\n//             throw new Error(\"Failed to load the document\");\n//         }\n//     }\n\n//     async executeCell(document: vscode.NotebookDocument, cell: vscode.NotebookCell | undefined): Promise<void> {\n// \t\tif (cell) {\n// \t\t\t// cell.metadata.statusMessage = 'Running';\n// \t\t\t// cell.metadata.runStartTime = Date.now();\n//             // cell.metadata.runState = vscode.NotebookCellRunState.Running;\n//             // cell.outputs = [];\n// \t\t} else {\n//             // document.cells.map((c:any) => {\n//             //     this.executeCell(document, c);\n//             // })\n//         }\n\n// \t\tconst duration = await timeFn(async () => {\n// \t\t\tconst wolframNotebook = this._notebooks.get(document.uri.toString());\n// \t\t\tif (wolframNotebook) {\n// \t\t\t\treturn wolframNotebook.execute(document, cell);\n// \t\t\t}\n// \t\t});\n\n// \t\tif (cell) {\n// \t\t\t// cell.metadata.lastRunDuration = duration;\n// \t\t\t// cell.metadata.statusMessage = 'Success'\n// \t\t\t// cell.metadata.runState = vscode.NotebookCellRunState.Success;\n// \t\t}\n//     }\n\n//     async executeAllCells(document:vscode.NotebookDocument):Promise<void>{\n// \t\tawait this.executeCell(document, undefined);\n//     }\n\n//     async cancelAllCellsExecution(document:vscode.NotebookDocument):Promise<void> {\n\n//     }\n\n//     async cancelCellExecution(document:vscode.NotebookDocument, cell: vscode.NotebookCell | undefined){\n//         if(cell) {\n//             // cell.metadata.statusMessage = \"Cancelled\";\n//             // cell.metadata.runState = vscode.NotebookCellRunState.Error;\n//         }\n//     }\n\n//      // The following are dummy implementations not relevant to this example.\n//     // onDidChangeNotebook = new vscode.EventEmitter<vscode.NotebookDocumentEditEvent>().event;\n\n// \tonDidChangeNotebook: vscode.Event<vscode.NotebookDocumentEditEvent> = this._onDidChangeNotebook.event;\n\n//     async resolveNotebook(): Promise<void> { \n//         return \n//      }\n//     async saveNotebook(document: vscode.NotebookDocument, cancellation: vscode.CancellationToken): Promise<void> { \n//          const stringOutput = document.cells.map((c:any) => {\n//             return c.document.getText() +\"\\n\\n\\n\"\n//          }).reduce((p, c) => {return p + c}).trim();\n//          await vscode.workspace.fs.writeFile(document.uri, Buffer.from(stringOutput));\n//      }\n//     async saveNotebookAs(targetResource: vscode.Uri, document: vscode.NotebookDocument, cancellation: vscode.CancellationToken): Promise<void> { \n//         const stringOutput = document.cells.map((c:any) => {\n//            return c.source\n//         }).reduce((p, c) => {return p + c});\n//         await vscode.workspace.fs.writeFile(targetResource, Buffer.from(stringOutput));}\n//     async backupNotebook(): Promise<vscode.NotebookDocumentBackup> { return { id: '', delete: () => { } };}\n// }\n\nexport function deactivate() {}","\nimport AbortController from 'abort-controller';\nimport { exec } from 'child_process';\nimport * as vscode from 'vscode';\nconst fs = require('fs')\nimport { wolframKernelClient } from './clients';\n\nexport function activate(context: vscode.ExtensionContext) {\n    context.subscriptions.push(new WolframNotebookController());\n}\n  \nexport class WolframNotebookController  {\n    readonly controllerId = 'wolfram-notebook';\n    readonly notebookType = 'wolfram-notebook';\n    readonly label = 'Wolfram Notebook';\n    readonly supportedLanguages = ['wolfram'];\n\n    private readonly _controller: vscode.NotebookController;\n    private _executionOrder = 0;\n\n    constructor() {\n        this._controller = vscode.notebooks.createNotebookController(\n            this.controllerId,\n            this.notebookType,\n            this.label\n        );\n\n        this._controller.supportedLanguages = this.supportedLanguages;\n        this._controller.supportsExecutionOrder = true;\n        this._controller.executeHandler = this._execute.bind(this);\n        // this._controller.interruptHandler = this._interrupt.bind(this);\n    }\n\n    private async _execute(\n        cells: vscode.NotebookCell[],\n        _notebook: vscode.NotebookDocument,\n        _controller: vscode.NotebookController\n    ): Promise<void> {\n        let promises = cells.map(async cell => {\n            await this._doExecution(cell)\n            return true\n        })\n\n        await Promise.all(promises)\n\n    }\n\n    private _interrupt(notebook: vscode.NotebookDocument): void {\n        /* Do some interruption here; not implemented */\n        // for (let cell of notebook.getCells()) {\n        //     this._doInterrupt(cell);\n        // }\n    }\n\n    private _doInterrupt(cell: vscode.NotebookCell): void {\n        if (cell.kind === vscode.NotebookCellKind.Code) {\n            let execution = cell.executionSummary\n            if (execution?.executionOrder) {\n                let executionId = execution.executionOrder;\n                if (executionId && executionId <= this._executionOrder) {\n                    wolframKernelClient?.sendRequest(\"$/cancelRequest\", {id: executionId}).then(\n                        () => {});\n                }\n            } else {\n\n            }\n        }\n    }\n\n    private async _doExecution(cell: vscode.NotebookCell): Promise<void> {\n        let execution: vscode.NotebookCellExecution = this._controller.createNotebookCellExecution(cell);\n        execution.executionOrder = ++this._executionOrder;\n        execution.start(Date.now()); // Keep track of elapsed time to execute cell.\n        /* Do some execution here; not implemented */\n        try {\n            let abortCtl = new AbortController();\n            execution.token.onCancellationRequested(() => {\n                abortCtl.abort();\n                wolframKernelClient?.sendRequest(\"$/cancelRequest\", {id: execution.executionOrder}).then(\n                    () => {});\n                execution.replaceOutput(\n                    new vscode.NotebookCellOutput([\n                        vscode.NotebookCellOutputItem.error({\n                            name: 'error', \n                            message: \"aborted\"})\n                    ]));\n                execution.end(false, Date.now());\n            });\n            while(!execution.token.isCancellationRequested){\n                wolframKernelClient?.sendRequest(\"runExpression\", \n                    {\n                        expression: cell.document.getText(),\n                        line: 0,\n                        end: 0\n                    }\n                ).then((result:any) => {\n                    execution.replaceOutput([\n                        new vscode.NotebookCellOutput([\n                            vscode.NotebookCellOutputItem.text(\n                                    fs.readFileSync(result[\"output\"], 'utf8'),'text/html'),\n                            vscode.NotebookCellOutputItem.text(result[\"result\"]),\n                            vscode.NotebookCellOutputItem.text(result[\"result\"], 'text/wolfram')\n                        ])\n                    ]);\n                    if (execution.executionOrder !== undefined) {\n                        if (execution.executionOrder <= this._executionOrder) {\n                            execution.end(true, Date.now());\n                        }\n                    }        \n                })\n                break;\n            }\n        } catch (e) {\n            execution.replaceOutput(\n                new vscode.NotebookCellOutput([\n                    vscode.NotebookCellOutputItem.error({\n                        name: e instanceof Error && e.name || 'error', \n                        message: e instanceof Error && e.message || JSON.stringify(e, undefined, 4)})\n                ]));\n            execution.end(false, Date.now());\n        }\n    }\n\n    dispose() {\n        this._controller.dispose()\n    }\n\n}","\n\nimport { Uri, Webview } from \"vscode\";\n\nexport function showPlotPanel(webview: any, extensionUri: Uri) {\n    let timeNow = new Date().getTime();\n    const toolkitUri = getUri(webview, extensionUri, [\n        \"node_modules\",\n        \"@vscode\",\n        \"webview-ui-toolkit\",\n        \"dist\",\n        \"toolkit.js\",\n    ]);\n\n    const mainUri = getUri(webview, extensionUri, [\"media\", \"main.js\"]);\n    const styleUri = getUri(webview, extensionUri, [\"media\", \"style.css\"]);\n    const codiconsUri = getUri(webview, extensionUri, [\n        \"node_modules\",\n        \"@vscode\",\n        \"codicons\",\n        \"dist\",\n        \"codicon.css\",\n    ]);\n    \n    let result = `<!DOCTYPE html>\n    <html lang=\"en\">\n    <head>\n        <script type=\"module\" src=\"${toolkitUri}\"></script>\n        <!-- <script type=\"module\" src=\"${mainUri}\"></script>\n        <link rel=\"stylesheet\" href=\"${styleUri}\"> \n        <link rel=\"stylesheet\" href=\"${codiconsUri}\"> -->\n        <style type=\"text/css\">\n\n            body{\n                overflow:scroll;\n                height:100%;\n            }\n\n            body.vscode-light {\n                background: var(--vscode-editor-background);\n                color: var(--vscode-editor-foreground);\n                font: var(--vscode-editor-font-family);\n            }\n\n            body.vscode-dark {\n                background: var(--vscode-editor-background);\n                color: var(--vscode-editor-foreground);\n                font: var(--vscode-editor-font-family);\n            }\n\n            body.vscode-high-contrast {\n                background: var(--vscode-editor-background);\n                color: var(--vscode-editor-foreground);\n                font: var(--vscode-editor-font-family);\n            }\n\n            #expression {\n                background: var(--vscode-editor-background);\n                color: var(--vscode-editor-foreground);\n                font: var(--vscode-editor-font-family);\n                width: 100%;\n            }\n\n            .outer {\n                height:100vh;\n                display:block;\n                position:relative;\n                top:0;\n            }\n\n            #result {\n                border-bottom: var(--vscode-editor-foreground) 2px solid;\n                margin-top: 5px;\n                padding: 5px;\n                display: block;\n                margin:0px;\n                width:95vw;\n                max-height:42vh; \n                overflow:scroll;\n            }\n\n            #result img{\n                max-width: 100%;\n                max-height:40vh; \n                /* margin: 0; */\n                /* min-height: 200px; */\n                width: auto;\n                margin-left: auto;\n                margin-right: auto;\n                display: block;\n                height: auto;\n            }\n\n\n        </style>\n        <meta charset=\"UTF-8\">\n\n        <!-- <meta http-equiv=\"Content-Security-Policy\" content=\"default-src *; img-src ${webview.cspSource} https: data:; script-src ${webview.cspSource} 'unsafe-inline'; style-src ${webview.cspSource} 'unsafe-inline';\"/> -->\n        <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n        <title>Wolfram Output</title>\n        <script>\n            const vscode = acquireVsCodeApi();\n            function scrollToBottom() {\n                // window.scrollTo(0,document.body.scrollHeight);\n\n                var color = '';\n                var fontFamily = '';\n                var fontSize = '';\n                var theme = '';\n                var fontWeight = '';\n                try {\n                    computedStyle = window.getComputedStyle(document.body);\n                    color = computedStyle.color + '';\n                    backgroundColor = computedStyle.backgroundColor + '';\n                    fontFamily = computedStyle.fontFamily;\n                    fontSize = computedStyle.fontSize;\n                    fontWeight = computedStyle.fontWeight;\n                    theme = document.body.className;\n                } catch(ex) { }\n            }\n\n        function run(input) {\n            if(event.key === 'Enter') {\n                if(event.shiftKey) {\n                    vscode.postMessage({\n                        text: input.value\n                    });\n                    input.value = \"\"\n                }\n            }\n        }\n\n        window.addEventListener('message', event => {\n            const message = event.data;\n\n            const outputDiv = document.getElementById('outputs');\n            outputDiv.innerHTML = message.text;\n\n            outputDiv.scrollTop = outputDiv.scrollHeight;\n\n        })\n        </script>\n    </head>\n    <body onload=\"scrollToBottom()\">\n        <div class=\"outer\">\n            <div class=\"inner\" id='outputs'>\n            </div>\n        </div>\n    </body>\n    </html>`;\n    return result;\n}\n\nfunction getUri(webview: Webview, extensionUri: Uri, pathList: string[]) {\n    return webview.asWebviewUri(Uri.joinPath(extensionUri, ...pathList));\n}","\nimport AbortController from 'abort-controller';\nimport { exec } from 'child_process';\nimport * as vscode from 'vscode';\nimport {wolframKernelClient, restart, onkernelReady} from './clients'\nconst fs = require('fs')\n\nexport function activate(context: vscode.ExtensionContext) {\n    context.subscriptions.push(new WolframScriptController(context));\n}\n  \nexport class WolframScriptController {\n    readonly controllerId = 'wolfram-script';\n    readonly notebookType = 'wolfram-script';\n    readonly label = 'Wolfram Script';\n    readonly supportedLanguages = ['wolfram'];\n\n    private readonly _controller: vscode.NotebookController;\n    private _executionOrder = 0;\n    public _context: vscode.ExtensionContext;\n\n    constructor(context:vscode.ExtensionContext) {\n        this._controller = vscode.notebooks.createNotebookController(\n        this.controllerId,\n        this.notebookType,\n        this.label\n        );\n\n        this._context = context;\n\n        this._controller.supportedLanguages = this.supportedLanguages;\n        this._controller.supportsExecutionOrder = true;\n        this._controller.executeHandler = this._execute.bind(this);\n        this._controller.interruptHandler = this._interrupt.bind(this);\n    }\n\n    private async _execute(\n        cells: vscode.NotebookCell[],\n        _notebook: vscode.NotebookDocument,\n        _controller: vscode.NotebookController\n    ): Promise<void> {\n        let promises = cells.map(async cell => {\n            await this._doExecution(cell)\n            return true\n        })\n\n        await Promise.all(promises)\n\n    }\n\n    private _interrupt(notebook: vscode.NotebookDocument): void {\n        /* Do some interruption here; not implemented */\n        console.log(this.executions);\n        this.executions.map((execution) => {\n            try {\n                execution.end(false, Date.now());\n    \n                execution.replaceOutput(\n                    new vscode.NotebookCellOutput([\n                        vscode.NotebookCellOutputItem.error({\n                            name: 'error', \n                            message: \"aborted\"})\n                    ]));\n            } catch (e) {\n                console.log(e);\n            }\n        })\n        this.executions = [];\n        restart();\n        // for (let cell of notebook.getCells()) {\n        //     this._doInterrupt(cell);\n        // }\n    }\n\n    private _doInterrupt(cell: vscode.NotebookCell): void {\n\n    }\n\n    private executions: vscode.NotebookCellExecution[] = [];\n\n    private async _doExecution(cell: vscode.NotebookCell): Promise<void> {\n\n        if(!wolframKernelClient) {\n            restart()\n            onkernelReady().then(() => {\n                this._doExecution(cell)\n            })\n        } else {\n            let execution: vscode.NotebookCellExecution = this._controller.createNotebookCellExecution(cell);\n            execution.executionOrder = ++this._executionOrder;\n            execution.start(Date.now()); // Keep track of elapsed time to execute cell.\n            this.executions.push(execution);\n            /* Do some execution here; not implemented */\n            try {\n                let abortCtl = new AbortController();\n                execution.token.onCancellationRequested(() => {\n                    abortCtl.abort();\n\n                    execution.replaceOutput(\n                        new vscode.NotebookCellOutput([\n                            vscode.NotebookCellOutputItem.error({\n                                name: 'error', \n                                message: \"aborted\"})\n                        ]));\n                    execution.end(false, Date.now());\n                });\n                while(!execution.token.isCancellationRequested){\n                        wolframKernelClient.sendRequest(\"runExpression\", \n                            {\n                                expression: cell.document.getText(),\n                                line: 0,\n                                end: 0,\n                                textDocument: cell.document\n                            }\n                        ).then((result:any) => {\n                            execution.replaceOutput([\n                                new vscode.NotebookCellOutput([\n                                    vscode.NotebookCellOutputItem.text(\n                                            // result[\"output\"],\n                                            fs.readFileSync(result[\"output\"].toString().substring(1,result[\"output\"].toString().length-1), 'utf8'),\n                                            'text/html'),\n                                    vscode.NotebookCellOutputItem.text(result[\"result\"]),\n                                    vscode.NotebookCellOutputItem.text(result[\"result\"], 'text/wolfram')\n                                ])\n                            ]);\n                            if (execution.executionOrder !== undefined) {\n                                if (execution.executionOrder <= this._executionOrder) {\n                                    execution.end(true, Date.now());\n                                }\n                            }        \n                        })\n                    break;\n                }\n            } catch (e) {\n                execution.replaceOutput(\n                    new vscode.NotebookCellOutput([\n                        vscode.NotebookCellOutputItem.error({\n                            name: e instanceof Error && e.name || 'error', \n                            message: e instanceof Error && e.message || JSON.stringify(e, undefined, 4)})\n                    ]));\n                execution.end(false, Date.now());\n            }\n        }\n    }\n\n    \n\n    dispose() {\n        this._controller.dispose()\n    }\n}","import * as vscode from 'vscode';\nimport * as fs from 'fs';\nimport {wolframClient, wolframKernelClient} from './clients'\n\n\n\nclass TreeItem extends vscode.TreeItem {\n    children: TreeItem[]|undefined;\n    location: string;\n\n    constructor(label:string, children?:TreeItem[]) {\n        super(label, children === undefined ? vscode.TreeItemCollapsibleState.None : vscode.TreeItemCollapsibleState.Collapsed);\n        this.children = children;\n        this.location = \"\";\n    }\n}\n\nexport class workspaceSymbolProvider implements vscode.TreeDataProvider<TreeItem> {\n    private _onDidChangeTreeData: vscode.EventEmitter<TreeItem | undefined | void> = new vscode.EventEmitter<TreeItem | undefined | void>();\n\treadonly onDidChangeTreeData: vscode.Event<TreeItem | undefined | void> = this._onDidChangeTreeData.event;\n    private builtins: TreeItem;\n\n    data: TreeItem[] = [new TreeItem(\"Symbols\", [])];\n\n    constructor() {\n        this.getBuiltins();\n        this.getSymbols();\n        this.builtins = new TreeItem(\"Builtins\", []);\n\t}\n\n    async getBuiltins() {\n        wolframClient?.onReady().then(() => {\n            wolframClient?.sendRequest(\"builtInList\").then((file:any) => {\n        \n            fs.readFile(file, 'utf8', (err:any, data:string) => {\n                let result  = JSON.parse(data.toString());\n                let files:string[] = [];\n    \n                // get all the letters in the alphabet\n                let letters:string[] = [];\n                for (let i = 65; i < 91; i++) {\n                    letters.push(String.fromCharCode(i));\n                }\n    \n                let builtinsymbols = result.builtins.map((symbol:any) => \n                {\n                    let item = new vscode.TreeItem(symbol.name);\n                    item.tooltip = symbol.definition;\n                    let e = vscode.window.activeTextEditor;\n                    item.command = {command: 'wolfram.stringHelp', arguments: [\n                        symbol.name], title: 'Open'};\n                    \n                    //item.command = {command: 'editor.action.addCommentLine', arguments: [], title: 'Add Comment'};\n    \n                    return item\n                })\n            \n                if (this.builtins.children?.length === 0){\n                    this.builtins = new TreeItem(\"Builtins\",\n                        letters.map((letter:string) => {\n                            return new TreeItem(letter, builtinsymbols.filter((item:TreeItem) => item.label?.toString().startsWith(letter)));})\n                        );\n                    }\n                this.data = [this.builtins];\n                this._onDidChangeTreeData.fire();\n                });\n            })\n        });\n    }\n\n    async getSymbols() {\n        wolframKernelClient?.onReady().then(() => {\n            wolframKernelClient?.sendRequest(\"symbolList\").then((file:any) => {\n        \n            fs.readFile(file, 'utf8', (err:any, data:string) => {\n                let result  = JSON.parse(data.toString());\n                let files:string[] = [];\n                let workspace_items:TreeItem[] =  result.workspace.map((symbol:any) => {\n                    let item:TreeItem;\n                    if (symbol.children && symbol.children.length > 0) {\n                        item = new TreeItem(symbol.name, []);\n                    }\n                    else {\n                        item = new TreeItem(symbol.name);\n                    }\n                    item.tooltip = symbol.definition;\n                    if ('range' in symbol.location) {\n    \n                        item.location= symbol.location.uri.split(\"/\").pop().split(\"%\")[0];\n                        if (!files.some(f => f === item.location)) {\n                            files.push(item.location);\n                        }\n                        \n                        item.command = {command: 'editor.action.goToLocations', arguments: [\n                            vscode.Uri.parse(symbol.location.uri), \n                            new vscode.Position(symbol.location.range.start.line, symbol.location.range.start.character), \n                            [], \n                            \"peek\", \n                            symbol.name], title: 'Go to'};\n                    } \n                    //item.command = {command: 'editor.action.addCommentLine', arguments: [], title: 'Add Comment'};\n\n                    function symbolToTreeItem(symbol:any):TreeItem[]|undefined {\n                        if (symbol.children && symbol.children.length > 0) {\n                            return symbol.children.map((child:any) => {\n                                return new TreeItem(child.name, symbolToTreeItem(child));\n                                })\n                        } else {\n                            return undefined\n                        }\n                    }\n                    \n                    item.children = symbolToTreeItem(symbol);\n\n                    // if (symbol.children && symbol.children.length > 0) {\n                    //     symbol.children.forEach((child:any) => {\n                    //         let leaf:TreeItem = new TreeItem(child.name)\n                    //         leaf.tooltip = child.definition;\n                    //         leaf.children = symbolToTreeItem(child)\n                    //         item.children?.push(leaf);\n                    //     })\n                    // }\n\n                    return item\n                });\n    \n    \n                let workspace = new TreeItem(\"Workspace\", \n                    files.map((file:string) => {\n                        return new TreeItem(file, workspace_items.filter((item:TreeItem) => item.location === file));\n                    })\n                );\n                workspace.collapsibleState = vscode.TreeItemCollapsibleState.Expanded;\n\n                if (this.data.length === 1) {\n                    this.data.push(workspace);\n                } else {\n                    this.data.pop()\n                    this.data.push(workspace);\n                }\n                \n                this._onDidChangeTreeData.fire();\n                });\n            })\n        });\n    }\n\n    refresh(): void {\n        this.getSymbols();\n\t}\n\n\tgetTreeItem(element: vscode.TreeItem): vscode.TreeItem {\n\t\treturn element;\n\t}\n\n    getChildren(element?: TreeItem): TreeItem[] |undefined {\n        if (element === undefined) {\n            return this.data;\n        }\n        return element.children;\n        \n\n    }    \n}","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst events_1 = require(\"./events\");\r\nconst Is = require(\"./is\");\r\nvar CancellationToken;\r\n(function (CancellationToken) {\r\n    CancellationToken.None = Object.freeze({\r\n        isCancellationRequested: false,\r\n        onCancellationRequested: events_1.Event.None\r\n    });\r\n    CancellationToken.Cancelled = Object.freeze({\r\n        isCancellationRequested: true,\r\n        onCancellationRequested: events_1.Event.None\r\n    });\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && (candidate === CancellationToken.None\r\n            || candidate === CancellationToken.Cancelled\r\n            || (Is.boolean(candidate.isCancellationRequested) && !!candidate.onCancellationRequested));\r\n    }\r\n    CancellationToken.is = is;\r\n})(CancellationToken = exports.CancellationToken || (exports.CancellationToken = {}));\r\nconst shortcutEvent = Object.freeze(function (callback, context) {\r\n    let handle = setTimeout(callback.bind(context), 0);\r\n    return { dispose() { clearTimeout(handle); } };\r\n});\r\nclass MutableToken {\r\n    constructor() {\r\n        this._isCancelled = false;\r\n    }\r\n    cancel() {\r\n        if (!this._isCancelled) {\r\n            this._isCancelled = true;\r\n            if (this._emitter) {\r\n                this._emitter.fire(undefined);\r\n                this.dispose();\r\n            }\r\n        }\r\n    }\r\n    get isCancellationRequested() {\r\n        return this._isCancelled;\r\n    }\r\n    get onCancellationRequested() {\r\n        if (this._isCancelled) {\r\n            return shortcutEvent;\r\n        }\r\n        if (!this._emitter) {\r\n            this._emitter = new events_1.Emitter();\r\n        }\r\n        return this._emitter.event;\r\n    }\r\n    dispose() {\r\n        if (this._emitter) {\r\n            this._emitter.dispose();\r\n            this._emitter = undefined;\r\n        }\r\n    }\r\n}\r\nclass CancellationTokenSource {\r\n    get token() {\r\n        if (!this._token) {\r\n            // be lazy and create the token only when\r\n            // actually needed\r\n            this._token = new MutableToken();\r\n        }\r\n        return this._token;\r\n    }\r\n    cancel() {\r\n        if (!this._token) {\r\n            // save an object by returning the default\r\n            // cancelled token when cancellation happens\r\n            // before someone asks for the token\r\n            this._token = CancellationToken.Cancelled;\r\n        }\r\n        else {\r\n            this._token.cancel();\r\n        }\r\n    }\r\n    dispose() {\r\n        if (!this._token) {\r\n            // ensure to initialize with an empty token if we had none\r\n            this._token = CancellationToken.None;\r\n        }\r\n        else if (this._token instanceof MutableToken) {\r\n            // actually dispose\r\n            this._token.dispose();\r\n        }\r\n    }\r\n}\r\nexports.CancellationTokenSource = CancellationTokenSource;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Disposable;\r\n(function (Disposable) {\r\n    function create(func) {\r\n        return {\r\n            dispose: func\r\n        };\r\n    }\r\n    Disposable.create = create;\r\n})(Disposable = exports.Disposable || (exports.Disposable = {}));\r\nvar Event;\r\n(function (Event) {\r\n    const _disposable = { dispose() { } };\r\n    Event.None = function () { return _disposable; };\r\n})(Event = exports.Event || (exports.Event = {}));\r\nclass CallbackList {\r\n    add(callback, context = null, bucket) {\r\n        if (!this._callbacks) {\r\n            this._callbacks = [];\r\n            this._contexts = [];\r\n        }\r\n        this._callbacks.push(callback);\r\n        this._contexts.push(context);\r\n        if (Array.isArray(bucket)) {\r\n            bucket.push({ dispose: () => this.remove(callback, context) });\r\n        }\r\n    }\r\n    remove(callback, context = null) {\r\n        if (!this._callbacks) {\r\n            return;\r\n        }\r\n        var foundCallbackWithDifferentContext = false;\r\n        for (var i = 0, len = this._callbacks.length; i < len; i++) {\r\n            if (this._callbacks[i] === callback) {\r\n                if (this._contexts[i] === context) {\r\n                    // callback & context match => remove it\r\n                    this._callbacks.splice(i, 1);\r\n                    this._contexts.splice(i, 1);\r\n                    return;\r\n                }\r\n                else {\r\n                    foundCallbackWithDifferentContext = true;\r\n                }\r\n            }\r\n        }\r\n        if (foundCallbackWithDifferentContext) {\r\n            throw new Error('When adding a listener with a context, you should remove it with the same context');\r\n        }\r\n    }\r\n    invoke(...args) {\r\n        if (!this._callbacks) {\r\n            return [];\r\n        }\r\n        var ret = [], callbacks = this._callbacks.slice(0), contexts = this._contexts.slice(0);\r\n        for (var i = 0, len = callbacks.length; i < len; i++) {\r\n            try {\r\n                ret.push(callbacks[i].apply(contexts[i], args));\r\n            }\r\n            catch (e) {\r\n                // eslint-disable-next-line no-console\r\n                console.error(e);\r\n            }\r\n        }\r\n        return ret;\r\n    }\r\n    isEmpty() {\r\n        return !this._callbacks || this._callbacks.length === 0;\r\n    }\r\n    dispose() {\r\n        this._callbacks = undefined;\r\n        this._contexts = undefined;\r\n    }\r\n}\r\nclass Emitter {\r\n    constructor(_options) {\r\n        this._options = _options;\r\n    }\r\n    /**\r\n     * For the public to allow to subscribe\r\n     * to events from this Emitter\r\n     */\r\n    get event() {\r\n        if (!this._event) {\r\n            this._event = (listener, thisArgs, disposables) => {\r\n                if (!this._callbacks) {\r\n                    this._callbacks = new CallbackList();\r\n                }\r\n                if (this._options && this._options.onFirstListenerAdd && this._callbacks.isEmpty()) {\r\n                    this._options.onFirstListenerAdd(this);\r\n                }\r\n                this._callbacks.add(listener, thisArgs);\r\n                let result;\r\n                result = {\r\n                    dispose: () => {\r\n                        this._callbacks.remove(listener, thisArgs);\r\n                        result.dispose = Emitter._noop;\r\n                        if (this._options && this._options.onLastListenerRemove && this._callbacks.isEmpty()) {\r\n                            this._options.onLastListenerRemove(this);\r\n                        }\r\n                    }\r\n                };\r\n                if (Array.isArray(disposables)) {\r\n                    disposables.push(result);\r\n                }\r\n                return result;\r\n            };\r\n        }\r\n        return this._event;\r\n    }\r\n    /**\r\n     * To be kept private to fire an event to\r\n     * subscribers\r\n     */\r\n    fire(event) {\r\n        if (this._callbacks) {\r\n            this._callbacks.invoke.call(this._callbacks, event);\r\n        }\r\n    }\r\n    dispose() {\r\n        if (this._callbacks) {\r\n            this._callbacks.dispose();\r\n            this._callbacks = undefined;\r\n        }\r\n    }\r\n}\r\nexports.Emitter = Emitter;\r\nEmitter._noop = function () { };\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction boolean(value) {\r\n    return value === true || value === false;\r\n}\r\nexports.boolean = boolean;\r\nfunction string(value) {\r\n    return typeof value === 'string' || value instanceof String;\r\n}\r\nexports.string = string;\r\nfunction number(value) {\r\n    return typeof value === 'number' || value instanceof Number;\r\n}\r\nexports.number = number;\r\nfunction error(value) {\r\n    return value instanceof Error;\r\n}\r\nexports.error = error;\r\nfunction func(value) {\r\n    return typeof value === 'function';\r\n}\r\nexports.func = func;\r\nfunction array(value) {\r\n    return Array.isArray(value);\r\n}\r\nexports.array = array;\r\nfunction stringArray(value) {\r\n    return array(value) && value.every(elem => string(elem));\r\n}\r\nexports.stringArray = stringArray;\r\n","\"use strict\";\r\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nvar Touch;\r\n(function (Touch) {\r\n    Touch.None = 0;\r\n    Touch.First = 1;\r\n    Touch.Last = 2;\r\n})(Touch = exports.Touch || (exports.Touch = {}));\r\nclass LinkedMap {\r\n    constructor() {\r\n        this._map = new Map();\r\n        this._head = undefined;\r\n        this._tail = undefined;\r\n        this._size = 0;\r\n    }\r\n    clear() {\r\n        this._map.clear();\r\n        this._head = undefined;\r\n        this._tail = undefined;\r\n        this._size = 0;\r\n    }\r\n    isEmpty() {\r\n        return !this._head && !this._tail;\r\n    }\r\n    get size() {\r\n        return this._size;\r\n    }\r\n    has(key) {\r\n        return this._map.has(key);\r\n    }\r\n    get(key) {\r\n        const item = this._map.get(key);\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        return item.value;\r\n    }\r\n    set(key, value, touch = Touch.None) {\r\n        let item = this._map.get(key);\r\n        if (item) {\r\n            item.value = value;\r\n            if (touch !== Touch.None) {\r\n                this.touch(item, touch);\r\n            }\r\n        }\r\n        else {\r\n            item = { key, value, next: undefined, previous: undefined };\r\n            switch (touch) {\r\n                case Touch.None:\r\n                    this.addItemLast(item);\r\n                    break;\r\n                case Touch.First:\r\n                    this.addItemFirst(item);\r\n                    break;\r\n                case Touch.Last:\r\n                    this.addItemLast(item);\r\n                    break;\r\n                default:\r\n                    this.addItemLast(item);\r\n                    break;\r\n            }\r\n            this._map.set(key, item);\r\n            this._size++;\r\n        }\r\n    }\r\n    delete(key) {\r\n        const item = this._map.get(key);\r\n        if (!item) {\r\n            return false;\r\n        }\r\n        this._map.delete(key);\r\n        this.removeItem(item);\r\n        this._size--;\r\n        return true;\r\n    }\r\n    shift() {\r\n        if (!this._head && !this._tail) {\r\n            return undefined;\r\n        }\r\n        if (!this._head || !this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        const item = this._head;\r\n        this._map.delete(item.key);\r\n        this.removeItem(item);\r\n        this._size--;\r\n        return item.value;\r\n    }\r\n    forEach(callbackfn, thisArg) {\r\n        let current = this._head;\r\n        while (current) {\r\n            if (thisArg) {\r\n                callbackfn.bind(thisArg)(current.value, current.key, this);\r\n            }\r\n            else {\r\n                callbackfn(current.value, current.key, this);\r\n            }\r\n            current = current.next;\r\n        }\r\n    }\r\n    forEachReverse(callbackfn, thisArg) {\r\n        let current = this._tail;\r\n        while (current) {\r\n            if (thisArg) {\r\n                callbackfn.bind(thisArg)(current.value, current.key, this);\r\n            }\r\n            else {\r\n                callbackfn(current.value, current.key, this);\r\n            }\r\n            current = current.previous;\r\n        }\r\n    }\r\n    values() {\r\n        let result = [];\r\n        let current = this._head;\r\n        while (current) {\r\n            result.push(current.value);\r\n            current = current.next;\r\n        }\r\n        return result;\r\n    }\r\n    keys() {\r\n        let result = [];\r\n        let current = this._head;\r\n        while (current) {\r\n            result.push(current.key);\r\n            current = current.next;\r\n        }\r\n        return result;\r\n    }\r\n    /* JSON RPC run on es5 which has no Symbol.iterator\r\n    public keys(): IterableIterator<K> {\r\n        let current = this._head;\r\n        let iterator: IterableIterator<K> = {\r\n            [Symbol.iterator]() {\r\n                return iterator;\r\n            },\r\n            next():IteratorResult<K> {\r\n                if (current) {\r\n                    let result = { value: current.key, done: false };\r\n                    current = current.next;\r\n                    return result;\r\n                } else {\r\n                    return { value: undefined, done: true };\r\n                }\r\n            }\r\n        };\r\n        return iterator;\r\n    }\r\n\r\n    public values(): IterableIterator<V> {\r\n        let current = this._head;\r\n        let iterator: IterableIterator<V> = {\r\n            [Symbol.iterator]() {\r\n                return iterator;\r\n            },\r\n            next():IteratorResult<V> {\r\n                if (current) {\r\n                    let result = { value: current.value, done: false };\r\n                    current = current.next;\r\n                    return result;\r\n                } else {\r\n                    return { value: undefined, done: true };\r\n                }\r\n            }\r\n        };\r\n        return iterator;\r\n    }\r\n    */\r\n    addItemFirst(item) {\r\n        // First time Insert\r\n        if (!this._head && !this._tail) {\r\n            this._tail = item;\r\n        }\r\n        else if (!this._head) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        else {\r\n            item.next = this._head;\r\n            this._head.previous = item;\r\n        }\r\n        this._head = item;\r\n    }\r\n    addItemLast(item) {\r\n        // First time Insert\r\n        if (!this._head && !this._tail) {\r\n            this._head = item;\r\n        }\r\n        else if (!this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        else {\r\n            item.previous = this._tail;\r\n            this._tail.next = item;\r\n        }\r\n        this._tail = item;\r\n    }\r\n    removeItem(item) {\r\n        if (item === this._head && item === this._tail) {\r\n            this._head = undefined;\r\n            this._tail = undefined;\r\n        }\r\n        else if (item === this._head) {\r\n            this._head = item.next;\r\n        }\r\n        else if (item === this._tail) {\r\n            this._tail = item.previous;\r\n        }\r\n        else {\r\n            const next = item.next;\r\n            const previous = item.previous;\r\n            if (!next || !previous) {\r\n                throw new Error('Invalid list');\r\n            }\r\n            next.previous = previous;\r\n            previous.next = next;\r\n        }\r\n    }\r\n    touch(item, touch) {\r\n        if (!this._head || !this._tail) {\r\n            throw new Error('Invalid list');\r\n        }\r\n        if ((touch !== Touch.First && touch !== Touch.Last)) {\r\n            return;\r\n        }\r\n        if (touch === Touch.First) {\r\n            if (item === this._head) {\r\n                return;\r\n            }\r\n            const next = item.next;\r\n            const previous = item.previous;\r\n            // Unlink the item\r\n            if (item === this._tail) {\r\n                // previous must be defined since item was not head but is tail\r\n                // So there are more than on item in the map\r\n                previous.next = undefined;\r\n                this._tail = previous;\r\n            }\r\n            else {\r\n                // Both next and previous are not undefined since item was neither head nor tail.\r\n                next.previous = previous;\r\n                previous.next = next;\r\n            }\r\n            // Insert the node at head\r\n            item.previous = undefined;\r\n            item.next = this._head;\r\n            this._head.previous = item;\r\n            this._head = item;\r\n        }\r\n        else if (touch === Touch.Last) {\r\n            if (item === this._tail) {\r\n                return;\r\n            }\r\n            const next = item.next;\r\n            const previous = item.previous;\r\n            // Unlink the item.\r\n            if (item === this._head) {\r\n                // next must be defined since item was not tail but is head\r\n                // So there are more than on item in the map\r\n                next.previous = undefined;\r\n                this._head = next;\r\n            }\r\n            else {\r\n                // Both next and previous are not undefined since item was neither head nor tail.\r\n                next.previous = previous;\r\n                previous.next = next;\r\n            }\r\n            item.next = undefined;\r\n            item.previous = this._tail;\r\n            this._tail.next = item;\r\n            this._tail = item;\r\n        }\r\n    }\r\n}\r\nexports.LinkedMap = LinkedMap;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n/// <reference path=\"../typings/thenable.d.ts\" />\r\n'use strict';\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst Is = require(\"./is\");\r\nconst messages_1 = require(\"./messages\");\r\nexports.RequestType = messages_1.RequestType;\r\nexports.RequestType0 = messages_1.RequestType0;\r\nexports.RequestType1 = messages_1.RequestType1;\r\nexports.RequestType2 = messages_1.RequestType2;\r\nexports.RequestType3 = messages_1.RequestType3;\r\nexports.RequestType4 = messages_1.RequestType4;\r\nexports.RequestType5 = messages_1.RequestType5;\r\nexports.RequestType6 = messages_1.RequestType6;\r\nexports.RequestType7 = messages_1.RequestType7;\r\nexports.RequestType8 = messages_1.RequestType8;\r\nexports.RequestType9 = messages_1.RequestType9;\r\nexports.ResponseError = messages_1.ResponseError;\r\nexports.ErrorCodes = messages_1.ErrorCodes;\r\nexports.NotificationType = messages_1.NotificationType;\r\nexports.NotificationType0 = messages_1.NotificationType0;\r\nexports.NotificationType1 = messages_1.NotificationType1;\r\nexports.NotificationType2 = messages_1.NotificationType2;\r\nexports.NotificationType3 = messages_1.NotificationType3;\r\nexports.NotificationType4 = messages_1.NotificationType4;\r\nexports.NotificationType5 = messages_1.NotificationType5;\r\nexports.NotificationType6 = messages_1.NotificationType6;\r\nexports.NotificationType7 = messages_1.NotificationType7;\r\nexports.NotificationType8 = messages_1.NotificationType8;\r\nexports.NotificationType9 = messages_1.NotificationType9;\r\nconst messageReader_1 = require(\"./messageReader\");\r\nexports.MessageReader = messageReader_1.MessageReader;\r\nexports.StreamMessageReader = messageReader_1.StreamMessageReader;\r\nexports.IPCMessageReader = messageReader_1.IPCMessageReader;\r\nexports.SocketMessageReader = messageReader_1.SocketMessageReader;\r\nconst messageWriter_1 = require(\"./messageWriter\");\r\nexports.MessageWriter = messageWriter_1.MessageWriter;\r\nexports.StreamMessageWriter = messageWriter_1.StreamMessageWriter;\r\nexports.IPCMessageWriter = messageWriter_1.IPCMessageWriter;\r\nexports.SocketMessageWriter = messageWriter_1.SocketMessageWriter;\r\nconst events_1 = require(\"./events\");\r\nexports.Disposable = events_1.Disposable;\r\nexports.Event = events_1.Event;\r\nexports.Emitter = events_1.Emitter;\r\nconst cancellation_1 = require(\"./cancellation\");\r\nexports.CancellationTokenSource = cancellation_1.CancellationTokenSource;\r\nexports.CancellationToken = cancellation_1.CancellationToken;\r\nconst linkedMap_1 = require(\"./linkedMap\");\r\n__export(require(\"./pipeSupport\"));\r\n__export(require(\"./socketSupport\"));\r\nvar CancelNotification;\r\n(function (CancelNotification) {\r\n    CancelNotification.type = new messages_1.NotificationType('$/cancelRequest');\r\n})(CancelNotification || (CancelNotification = {}));\r\nvar ProgressNotification;\r\n(function (ProgressNotification) {\r\n    ProgressNotification.type = new messages_1.NotificationType('$/progress');\r\n})(ProgressNotification || (ProgressNotification = {}));\r\nclass ProgressType {\r\n    constructor() {\r\n    }\r\n}\r\nexports.ProgressType = ProgressType;\r\nexports.NullLogger = Object.freeze({\r\n    error: () => { },\r\n    warn: () => { },\r\n    info: () => { },\r\n    log: () => { }\r\n});\r\nvar Trace;\r\n(function (Trace) {\r\n    Trace[Trace[\"Off\"] = 0] = \"Off\";\r\n    Trace[Trace[\"Messages\"] = 1] = \"Messages\";\r\n    Trace[Trace[\"Verbose\"] = 2] = \"Verbose\";\r\n})(Trace = exports.Trace || (exports.Trace = {}));\r\n(function (Trace) {\r\n    function fromString(value) {\r\n        if (!Is.string(value)) {\r\n            return Trace.Off;\r\n        }\r\n        value = value.toLowerCase();\r\n        switch (value) {\r\n            case 'off':\r\n                return Trace.Off;\r\n            case 'messages':\r\n                return Trace.Messages;\r\n            case 'verbose':\r\n                return Trace.Verbose;\r\n            default:\r\n                return Trace.Off;\r\n        }\r\n    }\r\n    Trace.fromString = fromString;\r\n    function toString(value) {\r\n        switch (value) {\r\n            case Trace.Off:\r\n                return 'off';\r\n            case Trace.Messages:\r\n                return 'messages';\r\n            case Trace.Verbose:\r\n                return 'verbose';\r\n            default:\r\n                return 'off';\r\n        }\r\n    }\r\n    Trace.toString = toString;\r\n})(Trace = exports.Trace || (exports.Trace = {}));\r\nvar TraceFormat;\r\n(function (TraceFormat) {\r\n    TraceFormat[\"Text\"] = \"text\";\r\n    TraceFormat[\"JSON\"] = \"json\";\r\n})(TraceFormat = exports.TraceFormat || (exports.TraceFormat = {}));\r\n(function (TraceFormat) {\r\n    function fromString(value) {\r\n        value = value.toLowerCase();\r\n        if (value === 'json') {\r\n            return TraceFormat.JSON;\r\n        }\r\n        else {\r\n            return TraceFormat.Text;\r\n        }\r\n    }\r\n    TraceFormat.fromString = fromString;\r\n})(TraceFormat = exports.TraceFormat || (exports.TraceFormat = {}));\r\nvar SetTraceNotification;\r\n(function (SetTraceNotification) {\r\n    SetTraceNotification.type = new messages_1.NotificationType('$/setTraceNotification');\r\n})(SetTraceNotification = exports.SetTraceNotification || (exports.SetTraceNotification = {}));\r\nvar LogTraceNotification;\r\n(function (LogTraceNotification) {\r\n    LogTraceNotification.type = new messages_1.NotificationType('$/logTraceNotification');\r\n})(LogTraceNotification = exports.LogTraceNotification || (exports.LogTraceNotification = {}));\r\nvar ConnectionErrors;\r\n(function (ConnectionErrors) {\r\n    /**\r\n     * The connection is closed.\r\n     */\r\n    ConnectionErrors[ConnectionErrors[\"Closed\"] = 1] = \"Closed\";\r\n    /**\r\n     * The connection got disposed.\r\n     */\r\n    ConnectionErrors[ConnectionErrors[\"Disposed\"] = 2] = \"Disposed\";\r\n    /**\r\n     * The connection is already in listening mode.\r\n     */\r\n    ConnectionErrors[ConnectionErrors[\"AlreadyListening\"] = 3] = \"AlreadyListening\";\r\n})(ConnectionErrors = exports.ConnectionErrors || (exports.ConnectionErrors = {}));\r\nclass ConnectionError extends Error {\r\n    constructor(code, message) {\r\n        super(message);\r\n        this.code = code;\r\n        Object.setPrototypeOf(this, ConnectionError.prototype);\r\n    }\r\n}\r\nexports.ConnectionError = ConnectionError;\r\nvar ConnectionStrategy;\r\n(function (ConnectionStrategy) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && Is.func(candidate.cancelUndispatched);\r\n    }\r\n    ConnectionStrategy.is = is;\r\n})(ConnectionStrategy = exports.ConnectionStrategy || (exports.ConnectionStrategy = {}));\r\nvar ConnectionState;\r\n(function (ConnectionState) {\r\n    ConnectionState[ConnectionState[\"New\"] = 1] = \"New\";\r\n    ConnectionState[ConnectionState[\"Listening\"] = 2] = \"Listening\";\r\n    ConnectionState[ConnectionState[\"Closed\"] = 3] = \"Closed\";\r\n    ConnectionState[ConnectionState[\"Disposed\"] = 4] = \"Disposed\";\r\n})(ConnectionState || (ConnectionState = {}));\r\nfunction _createMessageConnection(messageReader, messageWriter, logger, strategy) {\r\n    let sequenceNumber = 0;\r\n    let notificationSquenceNumber = 0;\r\n    let unknownResponseSquenceNumber = 0;\r\n    const version = '2.0';\r\n    let starRequestHandler = undefined;\r\n    let requestHandlers = Object.create(null);\r\n    let starNotificationHandler = undefined;\r\n    let notificationHandlers = Object.create(null);\r\n    let progressHandlers = new Map();\r\n    let timer;\r\n    let messageQueue = new linkedMap_1.LinkedMap();\r\n    let responsePromises = Object.create(null);\r\n    let requestTokens = Object.create(null);\r\n    let trace = Trace.Off;\r\n    let traceFormat = TraceFormat.Text;\r\n    let tracer;\r\n    let state = ConnectionState.New;\r\n    let errorEmitter = new events_1.Emitter();\r\n    let closeEmitter = new events_1.Emitter();\r\n    let unhandledNotificationEmitter = new events_1.Emitter();\r\n    let unhandledProgressEmitter = new events_1.Emitter();\r\n    let disposeEmitter = new events_1.Emitter();\r\n    function createRequestQueueKey(id) {\r\n        return 'req-' + id.toString();\r\n    }\r\n    function createResponseQueueKey(id) {\r\n        if (id === null) {\r\n            return 'res-unknown-' + (++unknownResponseSquenceNumber).toString();\r\n        }\r\n        else {\r\n            return 'res-' + id.toString();\r\n        }\r\n    }\r\n    function createNotificationQueueKey() {\r\n        return 'not-' + (++notificationSquenceNumber).toString();\r\n    }\r\n    function addMessageToQueue(queue, message) {\r\n        if (messages_1.isRequestMessage(message)) {\r\n            queue.set(createRequestQueueKey(message.id), message);\r\n        }\r\n        else if (messages_1.isResponseMessage(message)) {\r\n            queue.set(createResponseQueueKey(message.id), message);\r\n        }\r\n        else {\r\n            queue.set(createNotificationQueueKey(), message);\r\n        }\r\n    }\r\n    function cancelUndispatched(_message) {\r\n        return undefined;\r\n    }\r\n    function isListening() {\r\n        return state === ConnectionState.Listening;\r\n    }\r\n    function isClosed() {\r\n        return state === ConnectionState.Closed;\r\n    }\r\n    function isDisposed() {\r\n        return state === ConnectionState.Disposed;\r\n    }\r\n    function closeHandler() {\r\n        if (state === ConnectionState.New || state === ConnectionState.Listening) {\r\n            state = ConnectionState.Closed;\r\n            closeEmitter.fire(undefined);\r\n        }\r\n        // If the connection is disposed don't sent close events.\r\n    }\r\n    function readErrorHandler(error) {\r\n        errorEmitter.fire([error, undefined, undefined]);\r\n    }\r\n    function writeErrorHandler(data) {\r\n        errorEmitter.fire(data);\r\n    }\r\n    messageReader.onClose(closeHandler);\r\n    messageReader.onError(readErrorHandler);\r\n    messageWriter.onClose(closeHandler);\r\n    messageWriter.onError(writeErrorHandler);\r\n    function triggerMessageQueue() {\r\n        if (timer || messageQueue.size === 0) {\r\n            return;\r\n        }\r\n        timer = setImmediate(() => {\r\n            timer = undefined;\r\n            processMessageQueue();\r\n        });\r\n    }\r\n    function processMessageQueue() {\r\n        if (messageQueue.size === 0) {\r\n            return;\r\n        }\r\n        let message = messageQueue.shift();\r\n        try {\r\n            if (messages_1.isRequestMessage(message)) {\r\n                handleRequest(message);\r\n            }\r\n            else if (messages_1.isNotificationMessage(message)) {\r\n                handleNotification(message);\r\n            }\r\n            else if (messages_1.isResponseMessage(message)) {\r\n                handleResponse(message);\r\n            }\r\n            else {\r\n                handleInvalidMessage(message);\r\n            }\r\n        }\r\n        finally {\r\n            triggerMessageQueue();\r\n        }\r\n    }\r\n    let callback = (message) => {\r\n        try {\r\n            // We have received a cancellation message. Check if the message is still in the queue\r\n            // and cancel it if allowed to do so.\r\n            if (messages_1.isNotificationMessage(message) && message.method === CancelNotification.type.method) {\r\n                let key = createRequestQueueKey(message.params.id);\r\n                let toCancel = messageQueue.get(key);\r\n                if (messages_1.isRequestMessage(toCancel)) {\r\n                    let response = strategy && strategy.cancelUndispatched ? strategy.cancelUndispatched(toCancel, cancelUndispatched) : cancelUndispatched(toCancel);\r\n                    if (response && (response.error !== void 0 || response.result !== void 0)) {\r\n                        messageQueue.delete(key);\r\n                        response.id = toCancel.id;\r\n                        traceSendingResponse(response, message.method, Date.now());\r\n                        messageWriter.write(response);\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n            addMessageToQueue(messageQueue, message);\r\n        }\r\n        finally {\r\n            triggerMessageQueue();\r\n        }\r\n    };\r\n    function handleRequest(requestMessage) {\r\n        if (isDisposed()) {\r\n            // we return here silently since we fired an event when the\r\n            // connection got disposed.\r\n            return;\r\n        }\r\n        function reply(resultOrError, method, startTime) {\r\n            let message = {\r\n                jsonrpc: version,\r\n                id: requestMessage.id\r\n            };\r\n            if (resultOrError instanceof messages_1.ResponseError) {\r\n                message.error = resultOrError.toJson();\r\n            }\r\n            else {\r\n                message.result = resultOrError === void 0 ? null : resultOrError;\r\n            }\r\n            traceSendingResponse(message, method, startTime);\r\n            messageWriter.write(message);\r\n        }\r\n        function replyError(error, method, startTime) {\r\n            let message = {\r\n                jsonrpc: version,\r\n                id: requestMessage.id,\r\n                error: error.toJson()\r\n            };\r\n            traceSendingResponse(message, method, startTime);\r\n            messageWriter.write(message);\r\n        }\r\n        function replySuccess(result, method, startTime) {\r\n            // The JSON RPC defines that a response must either have a result or an error\r\n            // So we can't treat undefined as a valid response result.\r\n            if (result === void 0) {\r\n                result = null;\r\n            }\r\n            let message = {\r\n                jsonrpc: version,\r\n                id: requestMessage.id,\r\n                result: result\r\n            };\r\n            traceSendingResponse(message, method, startTime);\r\n            messageWriter.write(message);\r\n        }\r\n        traceReceivedRequest(requestMessage);\r\n        let element = requestHandlers[requestMessage.method];\r\n        let type;\r\n        let requestHandler;\r\n        if (element) {\r\n            type = element.type;\r\n            requestHandler = element.handler;\r\n        }\r\n        let startTime = Date.now();\r\n        if (requestHandler || starRequestHandler) {\r\n            let cancellationSource = new cancellation_1.CancellationTokenSource();\r\n            let tokenKey = String(requestMessage.id);\r\n            requestTokens[tokenKey] = cancellationSource;\r\n            try {\r\n                let handlerResult;\r\n                if (requestMessage.params === void 0 || (type !== void 0 && type.numberOfParams === 0)) {\r\n                    handlerResult = requestHandler\r\n                        ? requestHandler(cancellationSource.token)\r\n                        : starRequestHandler(requestMessage.method, cancellationSource.token);\r\n                }\r\n                else if (Is.array(requestMessage.params) && (type === void 0 || type.numberOfParams > 1)) {\r\n                    handlerResult = requestHandler\r\n                        ? requestHandler(...requestMessage.params, cancellationSource.token)\r\n                        : starRequestHandler(requestMessage.method, ...requestMessage.params, cancellationSource.token);\r\n                }\r\n                else {\r\n                    handlerResult = requestHandler\r\n                        ? requestHandler(requestMessage.params, cancellationSource.token)\r\n                        : starRequestHandler(requestMessage.method, requestMessage.params, cancellationSource.token);\r\n                }\r\n                let promise = handlerResult;\r\n                if (!handlerResult) {\r\n                    delete requestTokens[tokenKey];\r\n                    replySuccess(handlerResult, requestMessage.method, startTime);\r\n                }\r\n                else if (promise.then) {\r\n                    promise.then((resultOrError) => {\r\n                        delete requestTokens[tokenKey];\r\n                        reply(resultOrError, requestMessage.method, startTime);\r\n                    }, error => {\r\n                        delete requestTokens[tokenKey];\r\n                        if (error instanceof messages_1.ResponseError) {\r\n                            replyError(error, requestMessage.method, startTime);\r\n                        }\r\n                        else if (error && Is.string(error.message)) {\r\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed with message: ${error.message}`), requestMessage.method, startTime);\r\n                        }\r\n                        else {\r\n                            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed unexpectedly without providing any details.`), requestMessage.method, startTime);\r\n                        }\r\n                    });\r\n                }\r\n                else {\r\n                    delete requestTokens[tokenKey];\r\n                    reply(handlerResult, requestMessage.method, startTime);\r\n                }\r\n            }\r\n            catch (error) {\r\n                delete requestTokens[tokenKey];\r\n                if (error instanceof messages_1.ResponseError) {\r\n                    reply(error, requestMessage.method, startTime);\r\n                }\r\n                else if (error && Is.string(error.message)) {\r\n                    replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed with message: ${error.message}`), requestMessage.method, startTime);\r\n                }\r\n                else {\r\n                    replyError(new messages_1.ResponseError(messages_1.ErrorCodes.InternalError, `Request ${requestMessage.method} failed unexpectedly without providing any details.`), requestMessage.method, startTime);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            replyError(new messages_1.ResponseError(messages_1.ErrorCodes.MethodNotFound, `Unhandled method ${requestMessage.method}`), requestMessage.method, startTime);\r\n        }\r\n    }\r\n    function handleResponse(responseMessage) {\r\n        if (isDisposed()) {\r\n            // See handle request.\r\n            return;\r\n        }\r\n        if (responseMessage.id === null) {\r\n            if (responseMessage.error) {\r\n                logger.error(`Received response message without id: Error is: \\n${JSON.stringify(responseMessage.error, undefined, 4)}`);\r\n            }\r\n            else {\r\n                logger.error(`Received response message without id. No further error information provided.`);\r\n            }\r\n        }\r\n        else {\r\n            let key = String(responseMessage.id);\r\n            let responsePromise = responsePromises[key];\r\n            traceReceivedResponse(responseMessage, responsePromise);\r\n            if (responsePromise) {\r\n                delete responsePromises[key];\r\n                try {\r\n                    if (responseMessage.error) {\r\n                        let error = responseMessage.error;\r\n                        responsePromise.reject(new messages_1.ResponseError(error.code, error.message, error.data));\r\n                    }\r\n                    else if (responseMessage.result !== void 0) {\r\n                        responsePromise.resolve(responseMessage.result);\r\n                    }\r\n                    else {\r\n                        throw new Error('Should never happen.');\r\n                    }\r\n                }\r\n                catch (error) {\r\n                    if (error.message) {\r\n                        logger.error(`Response handler '${responsePromise.method}' failed with message: ${error.message}`);\r\n                    }\r\n                    else {\r\n                        logger.error(`Response handler '${responsePromise.method}' failed unexpectedly.`);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    function handleNotification(message) {\r\n        if (isDisposed()) {\r\n            // See handle request.\r\n            return;\r\n        }\r\n        let type = undefined;\r\n        let notificationHandler;\r\n        if (message.method === CancelNotification.type.method) {\r\n            notificationHandler = (params) => {\r\n                let id = params.id;\r\n                let source = requestTokens[String(id)];\r\n                if (source) {\r\n                    source.cancel();\r\n                }\r\n            };\r\n        }\r\n        else {\r\n            let element = notificationHandlers[message.method];\r\n            if (element) {\r\n                notificationHandler = element.handler;\r\n                type = element.type;\r\n            }\r\n        }\r\n        if (notificationHandler || starNotificationHandler) {\r\n            try {\r\n                traceReceivedNotification(message);\r\n                if (message.params === void 0 || (type !== void 0 && type.numberOfParams === 0)) {\r\n                    notificationHandler ? notificationHandler() : starNotificationHandler(message.method);\r\n                }\r\n                else if (Is.array(message.params) && (type === void 0 || type.numberOfParams > 1)) {\r\n                    notificationHandler ? notificationHandler(...message.params) : starNotificationHandler(message.method, ...message.params);\r\n                }\r\n                else {\r\n                    notificationHandler ? notificationHandler(message.params) : starNotificationHandler(message.method, message.params);\r\n                }\r\n            }\r\n            catch (error) {\r\n                if (error.message) {\r\n                    logger.error(`Notification handler '${message.method}' failed with message: ${error.message}`);\r\n                }\r\n                else {\r\n                    logger.error(`Notification handler '${message.method}' failed unexpectedly.`);\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            unhandledNotificationEmitter.fire(message);\r\n        }\r\n    }\r\n    function handleInvalidMessage(message) {\r\n        if (!message) {\r\n            logger.error('Received empty message.');\r\n            return;\r\n        }\r\n        logger.error(`Received message which is neither a response nor a notification message:\\n${JSON.stringify(message, null, 4)}`);\r\n        // Test whether we find an id to reject the promise\r\n        let responseMessage = message;\r\n        if (Is.string(responseMessage.id) || Is.number(responseMessage.id)) {\r\n            let key = String(responseMessage.id);\r\n            let responseHandler = responsePromises[key];\r\n            if (responseHandler) {\r\n                responseHandler.reject(new Error('The received response has neither a result nor an error property.'));\r\n            }\r\n        }\r\n    }\r\n    function traceSendingRequest(message) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose && message.params) {\r\n                data = `Params: ${JSON.stringify(message.params, null, 4)}\\n\\n`;\r\n            }\r\n            tracer.log(`Sending request '${message.method} - (${message.id})'.`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('send-request', message);\r\n        }\r\n    }\r\n    function traceSendingNotification(message) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose) {\r\n                if (message.params) {\r\n                    data = `Params: ${JSON.stringify(message.params, null, 4)}\\n\\n`;\r\n                }\r\n                else {\r\n                    data = 'No parameters provided.\\n\\n';\r\n                }\r\n            }\r\n            tracer.log(`Sending notification '${message.method}'.`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('send-notification', message);\r\n        }\r\n    }\r\n    function traceSendingResponse(message, method, startTime) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose) {\r\n                if (message.error && message.error.data) {\r\n                    data = `Error data: ${JSON.stringify(message.error.data, null, 4)}\\n\\n`;\r\n                }\r\n                else {\r\n                    if (message.result) {\r\n                        data = `Result: ${JSON.stringify(message.result, null, 4)}\\n\\n`;\r\n                    }\r\n                    else if (message.error === void 0) {\r\n                        data = 'No result returned.\\n\\n';\r\n                    }\r\n                }\r\n            }\r\n            tracer.log(`Sending response '${method} - (${message.id})'. Processing request took ${Date.now() - startTime}ms`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('send-response', message);\r\n        }\r\n    }\r\n    function traceReceivedRequest(message) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose && message.params) {\r\n                data = `Params: ${JSON.stringify(message.params, null, 4)}\\n\\n`;\r\n            }\r\n            tracer.log(`Received request '${message.method} - (${message.id})'.`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('receive-request', message);\r\n        }\r\n    }\r\n    function traceReceivedNotification(message) {\r\n        if (trace === Trace.Off || !tracer || message.method === LogTraceNotification.type.method) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose) {\r\n                if (message.params) {\r\n                    data = `Params: ${JSON.stringify(message.params, null, 4)}\\n\\n`;\r\n                }\r\n                else {\r\n                    data = 'No parameters provided.\\n\\n';\r\n                }\r\n            }\r\n            tracer.log(`Received notification '${message.method}'.`, data);\r\n        }\r\n        else {\r\n            logLSPMessage('receive-notification', message);\r\n        }\r\n    }\r\n    function traceReceivedResponse(message, responsePromise) {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        if (traceFormat === TraceFormat.Text) {\r\n            let data = undefined;\r\n            if (trace === Trace.Verbose) {\r\n                if (message.error && message.error.data) {\r\n                    data = `Error data: ${JSON.stringify(message.error.data, null, 4)}\\n\\n`;\r\n                }\r\n                else {\r\n                    if (message.result) {\r\n                        data = `Result: ${JSON.stringify(message.result, null, 4)}\\n\\n`;\r\n                    }\r\n                    else if (message.error === void 0) {\r\n                        data = 'No result returned.\\n\\n';\r\n                    }\r\n                }\r\n            }\r\n            if (responsePromise) {\r\n                let error = message.error ? ` Request failed: ${message.error.message} (${message.error.code}).` : '';\r\n                tracer.log(`Received response '${responsePromise.method} - (${message.id})' in ${Date.now() - responsePromise.timerStart}ms.${error}`, data);\r\n            }\r\n            else {\r\n                tracer.log(`Received response ${message.id} without active response promise.`, data);\r\n            }\r\n        }\r\n        else {\r\n            logLSPMessage('receive-response', message);\r\n        }\r\n    }\r\n    function logLSPMessage(type, message) {\r\n        if (!tracer || trace === Trace.Off) {\r\n            return;\r\n        }\r\n        const lspMessage = {\r\n            isLSPMessage: true,\r\n            type,\r\n            message,\r\n            timestamp: Date.now()\r\n        };\r\n        tracer.log(lspMessage);\r\n    }\r\n    function throwIfClosedOrDisposed() {\r\n        if (isClosed()) {\r\n            throw new ConnectionError(ConnectionErrors.Closed, 'Connection is closed.');\r\n        }\r\n        if (isDisposed()) {\r\n            throw new ConnectionError(ConnectionErrors.Disposed, 'Connection is disposed.');\r\n        }\r\n    }\r\n    function throwIfListening() {\r\n        if (isListening()) {\r\n            throw new ConnectionError(ConnectionErrors.AlreadyListening, 'Connection is already listening');\r\n        }\r\n    }\r\n    function throwIfNotListening() {\r\n        if (!isListening()) {\r\n            throw new Error('Call listen() first.');\r\n        }\r\n    }\r\n    function undefinedToNull(param) {\r\n        if (param === void 0) {\r\n            return null;\r\n        }\r\n        else {\r\n            return param;\r\n        }\r\n    }\r\n    function computeMessageParams(type, params) {\r\n        let result;\r\n        let numberOfParams = type.numberOfParams;\r\n        switch (numberOfParams) {\r\n            case 0:\r\n                result = null;\r\n                break;\r\n            case 1:\r\n                result = undefinedToNull(params[0]);\r\n                break;\r\n            default:\r\n                result = [];\r\n                for (let i = 0; i < params.length && i < numberOfParams; i++) {\r\n                    result.push(undefinedToNull(params[i]));\r\n                }\r\n                if (params.length < numberOfParams) {\r\n                    for (let i = params.length; i < numberOfParams; i++) {\r\n                        result.push(null);\r\n                    }\r\n                }\r\n                break;\r\n        }\r\n        return result;\r\n    }\r\n    let connection = {\r\n        sendNotification: (type, ...params) => {\r\n            throwIfClosedOrDisposed();\r\n            let method;\r\n            let messageParams;\r\n            if (Is.string(type)) {\r\n                method = type;\r\n                switch (params.length) {\r\n                    case 0:\r\n                        messageParams = null;\r\n                        break;\r\n                    case 1:\r\n                        messageParams = params[0];\r\n                        break;\r\n                    default:\r\n                        messageParams = params;\r\n                        break;\r\n                }\r\n            }\r\n            else {\r\n                method = type.method;\r\n                messageParams = computeMessageParams(type, params);\r\n            }\r\n            let notificationMessage = {\r\n                jsonrpc: version,\r\n                method: method,\r\n                params: messageParams\r\n            };\r\n            traceSendingNotification(notificationMessage);\r\n            messageWriter.write(notificationMessage);\r\n        },\r\n        onNotification: (type, handler) => {\r\n            throwIfClosedOrDisposed();\r\n            if (Is.func(type)) {\r\n                starNotificationHandler = type;\r\n            }\r\n            else if (handler) {\r\n                if (Is.string(type)) {\r\n                    notificationHandlers[type] = { type: undefined, handler };\r\n                }\r\n                else {\r\n                    notificationHandlers[type.method] = { type, handler };\r\n                }\r\n            }\r\n        },\r\n        onProgress: (_type, token, handler) => {\r\n            if (progressHandlers.has(token)) {\r\n                throw new Error(`Progress handler for token ${token} already registered`);\r\n            }\r\n            progressHandlers.set(token, handler);\r\n            return {\r\n                dispose: () => {\r\n                    progressHandlers.delete(token);\r\n                }\r\n            };\r\n        },\r\n        sendProgress: (_type, token, value) => {\r\n            connection.sendNotification(ProgressNotification.type, { token, value });\r\n        },\r\n        onUnhandledProgress: unhandledProgressEmitter.event,\r\n        sendRequest: (type, ...params) => {\r\n            throwIfClosedOrDisposed();\r\n            throwIfNotListening();\r\n            let method;\r\n            let messageParams;\r\n            let token = undefined;\r\n            if (Is.string(type)) {\r\n                method = type;\r\n                switch (params.length) {\r\n                    case 0:\r\n                        messageParams = null;\r\n                        break;\r\n                    case 1:\r\n                        // The cancellation token is optional so it can also be undefined.\r\n                        if (cancellation_1.CancellationToken.is(params[0])) {\r\n                            messageParams = null;\r\n                            token = params[0];\r\n                        }\r\n                        else {\r\n                            messageParams = undefinedToNull(params[0]);\r\n                        }\r\n                        break;\r\n                    default:\r\n                        const last = params.length - 1;\r\n                        if (cancellation_1.CancellationToken.is(params[last])) {\r\n                            token = params[last];\r\n                            if (params.length === 2) {\r\n                                messageParams = undefinedToNull(params[0]);\r\n                            }\r\n                            else {\r\n                                messageParams = params.slice(0, last).map(value => undefinedToNull(value));\r\n                            }\r\n                        }\r\n                        else {\r\n                            messageParams = params.map(value => undefinedToNull(value));\r\n                        }\r\n                        break;\r\n                }\r\n            }\r\n            else {\r\n                method = type.method;\r\n                messageParams = computeMessageParams(type, params);\r\n                let numberOfParams = type.numberOfParams;\r\n                token = cancellation_1.CancellationToken.is(params[numberOfParams]) ? params[numberOfParams] : undefined;\r\n            }\r\n            let id = sequenceNumber++;\r\n            let result = new Promise((resolve, reject) => {\r\n                let requestMessage = {\r\n                    jsonrpc: version,\r\n                    id: id,\r\n                    method: method,\r\n                    params: messageParams\r\n                };\r\n                let responsePromise = { method: method, timerStart: Date.now(), resolve, reject };\r\n                traceSendingRequest(requestMessage);\r\n                try {\r\n                    messageWriter.write(requestMessage);\r\n                }\r\n                catch (e) {\r\n                    // Writing the message failed. So we need to reject the promise.\r\n                    responsePromise.reject(new messages_1.ResponseError(messages_1.ErrorCodes.MessageWriteError, e.message ? e.message : 'Unknown reason'));\r\n                    responsePromise = null;\r\n                }\r\n                if (responsePromise) {\r\n                    responsePromises[String(id)] = responsePromise;\r\n                }\r\n            });\r\n            if (token) {\r\n                token.onCancellationRequested(() => {\r\n                    connection.sendNotification(CancelNotification.type, { id });\r\n                });\r\n            }\r\n            return result;\r\n        },\r\n        onRequest: (type, handler) => {\r\n            throwIfClosedOrDisposed();\r\n            if (Is.func(type)) {\r\n                starRequestHandler = type;\r\n            }\r\n            else if (handler) {\r\n                if (Is.string(type)) {\r\n                    requestHandlers[type] = { type: undefined, handler };\r\n                }\r\n                else {\r\n                    requestHandlers[type.method] = { type, handler };\r\n                }\r\n            }\r\n        },\r\n        trace: (_value, _tracer, sendNotificationOrTraceOptions) => {\r\n            let _sendNotification = false;\r\n            let _traceFormat = TraceFormat.Text;\r\n            if (sendNotificationOrTraceOptions !== void 0) {\r\n                if (Is.boolean(sendNotificationOrTraceOptions)) {\r\n                    _sendNotification = sendNotificationOrTraceOptions;\r\n                }\r\n                else {\r\n                    _sendNotification = sendNotificationOrTraceOptions.sendNotification || false;\r\n                    _traceFormat = sendNotificationOrTraceOptions.traceFormat || TraceFormat.Text;\r\n                }\r\n            }\r\n            trace = _value;\r\n            traceFormat = _traceFormat;\r\n            if (trace === Trace.Off) {\r\n                tracer = undefined;\r\n            }\r\n            else {\r\n                tracer = _tracer;\r\n            }\r\n            if (_sendNotification && !isClosed() && !isDisposed()) {\r\n                connection.sendNotification(SetTraceNotification.type, { value: Trace.toString(_value) });\r\n            }\r\n        },\r\n        onError: errorEmitter.event,\r\n        onClose: closeEmitter.event,\r\n        onUnhandledNotification: unhandledNotificationEmitter.event,\r\n        onDispose: disposeEmitter.event,\r\n        dispose: () => {\r\n            if (isDisposed()) {\r\n                return;\r\n            }\r\n            state = ConnectionState.Disposed;\r\n            disposeEmitter.fire(undefined);\r\n            let error = new Error('Connection got disposed.');\r\n            Object.keys(responsePromises).forEach((key) => {\r\n                responsePromises[key].reject(error);\r\n            });\r\n            responsePromises = Object.create(null);\r\n            requestTokens = Object.create(null);\r\n            messageQueue = new linkedMap_1.LinkedMap();\r\n            // Test for backwards compatibility\r\n            if (Is.func(messageWriter.dispose)) {\r\n                messageWriter.dispose();\r\n            }\r\n            if (Is.func(messageReader.dispose)) {\r\n                messageReader.dispose();\r\n            }\r\n        },\r\n        listen: () => {\r\n            throwIfClosedOrDisposed();\r\n            throwIfListening();\r\n            state = ConnectionState.Listening;\r\n            messageReader.listen(callback);\r\n        },\r\n        inspect: () => {\r\n            // eslint-disable-next-line no-console\r\n            console.log('inspect');\r\n        }\r\n    };\r\n    connection.onNotification(LogTraceNotification.type, (params) => {\r\n        if (trace === Trace.Off || !tracer) {\r\n            return;\r\n        }\r\n        tracer.log(params.message, trace === Trace.Verbose ? params.verbose : undefined);\r\n    });\r\n    connection.onNotification(ProgressNotification.type, (params) => {\r\n        const handler = progressHandlers.get(params.token);\r\n        if (handler) {\r\n            handler(params.value);\r\n        }\r\n        else {\r\n            unhandledProgressEmitter.fire(params);\r\n        }\r\n    });\r\n    return connection;\r\n}\r\nfunction isMessageReader(value) {\r\n    return value.listen !== void 0 && value.read === void 0;\r\n}\r\nfunction isMessageWriter(value) {\r\n    return value.write !== void 0 && value.end === void 0;\r\n}\r\nfunction createMessageConnection(input, output, logger, strategy) {\r\n    if (!logger) {\r\n        logger = exports.NullLogger;\r\n    }\r\n    let reader = isMessageReader(input) ? input : new messageReader_1.StreamMessageReader(input);\r\n    let writer = isMessageWriter(output) ? output : new messageWriter_1.StreamMessageWriter(output);\r\n    return _createMessageConnection(reader, writer, logger, strategy);\r\n}\r\nexports.createMessageConnection = createMessageConnection;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst events_1 = require(\"./events\");\r\nconst Is = require(\"./is\");\r\nlet DefaultSize = 8192;\r\nlet CR = Buffer.from('\\r', 'ascii')[0];\r\nlet LF = Buffer.from('\\n', 'ascii')[0];\r\nlet CRLF = '\\r\\n';\r\nclass MessageBuffer {\r\n    constructor(encoding = 'utf8') {\r\n        this.encoding = encoding;\r\n        this.index = 0;\r\n        this.buffer = Buffer.allocUnsafe(DefaultSize);\r\n    }\r\n    append(chunk) {\r\n        var toAppend = chunk;\r\n        if (typeof (chunk) === 'string') {\r\n            var str = chunk;\r\n            var bufferLen = Buffer.byteLength(str, this.encoding);\r\n            toAppend = Buffer.allocUnsafe(bufferLen);\r\n            toAppend.write(str, 0, bufferLen, this.encoding);\r\n        }\r\n        if (this.buffer.length - this.index >= toAppend.length) {\r\n            toAppend.copy(this.buffer, this.index, 0, toAppend.length);\r\n        }\r\n        else {\r\n            var newSize = (Math.ceil((this.index + toAppend.length) / DefaultSize) + 1) * DefaultSize;\r\n            if (this.index === 0) {\r\n                this.buffer = Buffer.allocUnsafe(newSize);\r\n                toAppend.copy(this.buffer, 0, 0, toAppend.length);\r\n            }\r\n            else {\r\n                this.buffer = Buffer.concat([this.buffer.slice(0, this.index), toAppend], newSize);\r\n            }\r\n        }\r\n        this.index += toAppend.length;\r\n    }\r\n    tryReadHeaders() {\r\n        let result = undefined;\r\n        let current = 0;\r\n        while (current + 3 < this.index && (this.buffer[current] !== CR || this.buffer[current + 1] !== LF || this.buffer[current + 2] !== CR || this.buffer[current + 3] !== LF)) {\r\n            current++;\r\n        }\r\n        // No header / body separator found (e.g CRLFCRLF)\r\n        if (current + 3 >= this.index) {\r\n            return result;\r\n        }\r\n        result = Object.create(null);\r\n        let headers = this.buffer.toString('ascii', 0, current).split(CRLF);\r\n        headers.forEach((header) => {\r\n            let index = header.indexOf(':');\r\n            if (index === -1) {\r\n                throw new Error('Message header must separate key and value using :');\r\n            }\r\n            let key = header.substr(0, index);\r\n            let value = header.substr(index + 1).trim();\r\n            result[key] = value;\r\n        });\r\n        let nextStart = current + 4;\r\n        this.buffer = this.buffer.slice(nextStart);\r\n        this.index = this.index - nextStart;\r\n        return result;\r\n    }\r\n    tryReadContent(length) {\r\n        if (this.index < length) {\r\n            return null;\r\n        }\r\n        let result = this.buffer.toString(this.encoding, 0, length);\r\n        let nextStart = length;\r\n        this.buffer.copy(this.buffer, 0, nextStart);\r\n        this.index = this.index - nextStart;\r\n        return result;\r\n    }\r\n    get numberOfBytes() {\r\n        return this.index;\r\n    }\r\n}\r\nvar MessageReader;\r\n(function (MessageReader) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && Is.func(candidate.listen) && Is.func(candidate.dispose) &&\r\n            Is.func(candidate.onError) && Is.func(candidate.onClose) && Is.func(candidate.onPartialMessage);\r\n    }\r\n    MessageReader.is = is;\r\n})(MessageReader = exports.MessageReader || (exports.MessageReader = {}));\r\nclass AbstractMessageReader {\r\n    constructor() {\r\n        this.errorEmitter = new events_1.Emitter();\r\n        this.closeEmitter = new events_1.Emitter();\r\n        this.partialMessageEmitter = new events_1.Emitter();\r\n    }\r\n    dispose() {\r\n        this.errorEmitter.dispose();\r\n        this.closeEmitter.dispose();\r\n    }\r\n    get onError() {\r\n        return this.errorEmitter.event;\r\n    }\r\n    fireError(error) {\r\n        this.errorEmitter.fire(this.asError(error));\r\n    }\r\n    get onClose() {\r\n        return this.closeEmitter.event;\r\n    }\r\n    fireClose() {\r\n        this.closeEmitter.fire(undefined);\r\n    }\r\n    get onPartialMessage() {\r\n        return this.partialMessageEmitter.event;\r\n    }\r\n    firePartialMessage(info) {\r\n        this.partialMessageEmitter.fire(info);\r\n    }\r\n    asError(error) {\r\n        if (error instanceof Error) {\r\n            return error;\r\n        }\r\n        else {\r\n            return new Error(`Reader received error. Reason: ${Is.string(error.message) ? error.message : 'unknown'}`);\r\n        }\r\n    }\r\n}\r\nexports.AbstractMessageReader = AbstractMessageReader;\r\nclass StreamMessageReader extends AbstractMessageReader {\r\n    constructor(readable, encoding = 'utf8') {\r\n        super();\r\n        this.readable = readable;\r\n        this.buffer = new MessageBuffer(encoding);\r\n        this._partialMessageTimeout = 10000;\r\n    }\r\n    set partialMessageTimeout(timeout) {\r\n        this._partialMessageTimeout = timeout;\r\n    }\r\n    get partialMessageTimeout() {\r\n        return this._partialMessageTimeout;\r\n    }\r\n    listen(callback) {\r\n        this.nextMessageLength = -1;\r\n        this.messageToken = 0;\r\n        this.partialMessageTimer = undefined;\r\n        this.callback = callback;\r\n        this.readable.on('data', (data) => {\r\n            this.onData(data);\r\n        });\r\n        this.readable.on('error', (error) => this.fireError(error));\r\n        this.readable.on('close', () => this.fireClose());\r\n    }\r\n    onData(data) {\r\n        this.buffer.append(data);\r\n        while (true) {\r\n            if (this.nextMessageLength === -1) {\r\n                let headers = this.buffer.tryReadHeaders();\r\n                if (!headers) {\r\n                    return;\r\n                }\r\n                let contentLength = headers['Content-Length'];\r\n                if (!contentLength) {\r\n                    throw new Error('Header must provide a Content-Length property.');\r\n                }\r\n                let length = parseInt(contentLength);\r\n                if (isNaN(length)) {\r\n                    throw new Error('Content-Length value must be a number.');\r\n                }\r\n                this.nextMessageLength = length;\r\n                // Take the encoding form the header. For compatibility\r\n                // treat both utf-8 and utf8 as node utf8\r\n            }\r\n            var msg = this.buffer.tryReadContent(this.nextMessageLength);\r\n            if (msg === null) {\r\n                /** We haven't received the full message yet. */\r\n                this.setPartialMessageTimer();\r\n                return;\r\n            }\r\n            this.clearPartialMessageTimer();\r\n            this.nextMessageLength = -1;\r\n            this.messageToken++;\r\n            var json = JSON.parse(msg);\r\n            this.callback(json);\r\n        }\r\n    }\r\n    clearPartialMessageTimer() {\r\n        if (this.partialMessageTimer) {\r\n            clearTimeout(this.partialMessageTimer);\r\n            this.partialMessageTimer = undefined;\r\n        }\r\n    }\r\n    setPartialMessageTimer() {\r\n        this.clearPartialMessageTimer();\r\n        if (this._partialMessageTimeout <= 0) {\r\n            return;\r\n        }\r\n        this.partialMessageTimer = setTimeout((token, timeout) => {\r\n            this.partialMessageTimer = undefined;\r\n            if (token === this.messageToken) {\r\n                this.firePartialMessage({ messageToken: token, waitingTime: timeout });\r\n                this.setPartialMessageTimer();\r\n            }\r\n        }, this._partialMessageTimeout, this.messageToken, this._partialMessageTimeout);\r\n    }\r\n}\r\nexports.StreamMessageReader = StreamMessageReader;\r\nclass IPCMessageReader extends AbstractMessageReader {\r\n    constructor(process) {\r\n        super();\r\n        this.process = process;\r\n        let eventEmitter = this.process;\r\n        eventEmitter.on('error', (error) => this.fireError(error));\r\n        eventEmitter.on('close', () => this.fireClose());\r\n    }\r\n    listen(callback) {\r\n        this.process.on('message', callback);\r\n    }\r\n}\r\nexports.IPCMessageReader = IPCMessageReader;\r\nclass SocketMessageReader extends StreamMessageReader {\r\n    constructor(socket, encoding = 'utf-8') {\r\n        super(socket, encoding);\r\n    }\r\n}\r\nexports.SocketMessageReader = SocketMessageReader;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst events_1 = require(\"./events\");\r\nconst Is = require(\"./is\");\r\nlet ContentLength = 'Content-Length: ';\r\nlet CRLF = '\\r\\n';\r\nvar MessageWriter;\r\n(function (MessageWriter) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && Is.func(candidate.dispose) && Is.func(candidate.onClose) &&\r\n            Is.func(candidate.onError) && Is.func(candidate.write);\r\n    }\r\n    MessageWriter.is = is;\r\n})(MessageWriter = exports.MessageWriter || (exports.MessageWriter = {}));\r\nclass AbstractMessageWriter {\r\n    constructor() {\r\n        this.errorEmitter = new events_1.Emitter();\r\n        this.closeEmitter = new events_1.Emitter();\r\n    }\r\n    dispose() {\r\n        this.errorEmitter.dispose();\r\n        this.closeEmitter.dispose();\r\n    }\r\n    get onError() {\r\n        return this.errorEmitter.event;\r\n    }\r\n    fireError(error, message, count) {\r\n        this.errorEmitter.fire([this.asError(error), message, count]);\r\n    }\r\n    get onClose() {\r\n        return this.closeEmitter.event;\r\n    }\r\n    fireClose() {\r\n        this.closeEmitter.fire(undefined);\r\n    }\r\n    asError(error) {\r\n        if (error instanceof Error) {\r\n            return error;\r\n        }\r\n        else {\r\n            return new Error(`Writer received error. Reason: ${Is.string(error.message) ? error.message : 'unknown'}`);\r\n        }\r\n    }\r\n}\r\nexports.AbstractMessageWriter = AbstractMessageWriter;\r\nclass StreamMessageWriter extends AbstractMessageWriter {\r\n    constructor(writable, encoding = 'utf8') {\r\n        super();\r\n        this.writable = writable;\r\n        this.encoding = encoding;\r\n        this.errorCount = 0;\r\n        this.writable.on('error', (error) => this.fireError(error));\r\n        this.writable.on('close', () => this.fireClose());\r\n    }\r\n    write(msg) {\r\n        let json = JSON.stringify(msg);\r\n        let contentLength = Buffer.byteLength(json, this.encoding);\r\n        let headers = [\r\n            ContentLength, contentLength.toString(), CRLF,\r\n            CRLF\r\n        ];\r\n        try {\r\n            // Header must be written in ASCII encoding\r\n            this.writable.write(headers.join(''), 'ascii');\r\n            // Now write the content. This can be written in any encoding\r\n            this.writable.write(json, this.encoding);\r\n            this.errorCount = 0;\r\n        }\r\n        catch (error) {\r\n            this.errorCount++;\r\n            this.fireError(error, msg, this.errorCount);\r\n        }\r\n    }\r\n}\r\nexports.StreamMessageWriter = StreamMessageWriter;\r\nclass IPCMessageWriter extends AbstractMessageWriter {\r\n    constructor(process) {\r\n        super();\r\n        this.process = process;\r\n        this.errorCount = 0;\r\n        this.queue = [];\r\n        this.sending = false;\r\n        let eventEmitter = this.process;\r\n        eventEmitter.on('error', (error) => this.fireError(error));\r\n        eventEmitter.on('close', () => this.fireClose);\r\n    }\r\n    write(msg) {\r\n        if (!this.sending && this.queue.length === 0) {\r\n            // See https://github.com/nodejs/node/issues/7657\r\n            this.doWriteMessage(msg);\r\n        }\r\n        else {\r\n            this.queue.push(msg);\r\n        }\r\n    }\r\n    doWriteMessage(msg) {\r\n        try {\r\n            if (this.process.send) {\r\n                this.sending = true;\r\n                this.process.send(msg, undefined, undefined, (error) => {\r\n                    this.sending = false;\r\n                    if (error) {\r\n                        this.errorCount++;\r\n                        this.fireError(error, msg, this.errorCount);\r\n                    }\r\n                    else {\r\n                        this.errorCount = 0;\r\n                    }\r\n                    if (this.queue.length > 0) {\r\n                        this.doWriteMessage(this.queue.shift());\r\n                    }\r\n                });\r\n            }\r\n        }\r\n        catch (error) {\r\n            this.errorCount++;\r\n            this.fireError(error, msg, this.errorCount);\r\n        }\r\n    }\r\n}\r\nexports.IPCMessageWriter = IPCMessageWriter;\r\nclass SocketMessageWriter extends AbstractMessageWriter {\r\n    constructor(socket, encoding = 'utf8') {\r\n        super();\r\n        this.socket = socket;\r\n        this.queue = [];\r\n        this.sending = false;\r\n        this.encoding = encoding;\r\n        this.errorCount = 0;\r\n        this.socket.on('error', (error) => this.fireError(error));\r\n        this.socket.on('close', () => this.fireClose());\r\n    }\r\n    dispose() {\r\n        super.dispose();\r\n        this.socket.destroy();\r\n    }\r\n    write(msg) {\r\n        if (!this.sending && this.queue.length === 0) {\r\n            // See https://github.com/nodejs/node/issues/7657\r\n            this.doWriteMessage(msg);\r\n        }\r\n        else {\r\n            this.queue.push(msg);\r\n        }\r\n    }\r\n    doWriteMessage(msg) {\r\n        let json = JSON.stringify(msg);\r\n        let contentLength = Buffer.byteLength(json, this.encoding);\r\n        let headers = [\r\n            ContentLength, contentLength.toString(), CRLF,\r\n            CRLF\r\n        ];\r\n        try {\r\n            // Header must be written in ASCII encoding\r\n            this.sending = true;\r\n            this.socket.write(headers.join(''), 'ascii', (error) => {\r\n                if (error) {\r\n                    this.handleError(error, msg);\r\n                }\r\n                try {\r\n                    // Now write the content. This can be written in any encoding\r\n                    this.socket.write(json, this.encoding, (error) => {\r\n                        this.sending = false;\r\n                        if (error) {\r\n                            this.handleError(error, msg);\r\n                        }\r\n                        else {\r\n                            this.errorCount = 0;\r\n                        }\r\n                        if (this.queue.length > 0) {\r\n                            this.doWriteMessage(this.queue.shift());\r\n                        }\r\n                    });\r\n                }\r\n                catch (error) {\r\n                    this.handleError(error, msg);\r\n                }\r\n            });\r\n        }\r\n        catch (error) {\r\n            this.handleError(error, msg);\r\n        }\r\n    }\r\n    handleError(error, msg) {\r\n        this.errorCount++;\r\n        this.fireError(error, msg, this.errorCount);\r\n    }\r\n}\r\nexports.SocketMessageWriter = SocketMessageWriter;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst is = require(\"./is\");\r\n/**\r\n * Predefined error codes.\r\n */\r\nvar ErrorCodes;\r\n(function (ErrorCodes) {\r\n    // Defined by JSON RPC\r\n    ErrorCodes.ParseError = -32700;\r\n    ErrorCodes.InvalidRequest = -32600;\r\n    ErrorCodes.MethodNotFound = -32601;\r\n    ErrorCodes.InvalidParams = -32602;\r\n    ErrorCodes.InternalError = -32603;\r\n    ErrorCodes.serverErrorStart = -32099;\r\n    ErrorCodes.serverErrorEnd = -32000;\r\n    ErrorCodes.ServerNotInitialized = -32002;\r\n    ErrorCodes.UnknownErrorCode = -32001;\r\n    // Defined by the protocol.\r\n    ErrorCodes.RequestCancelled = -32800;\r\n    ErrorCodes.ContentModified = -32801;\r\n    // Defined by VSCode library.\r\n    ErrorCodes.MessageWriteError = 1;\r\n    ErrorCodes.MessageReadError = 2;\r\n})(ErrorCodes = exports.ErrorCodes || (exports.ErrorCodes = {}));\r\n/**\r\n * An error object return in a response in case a request\r\n * has failed.\r\n */\r\nclass ResponseError extends Error {\r\n    constructor(code, message, data) {\r\n        super(message);\r\n        this.code = is.number(code) ? code : ErrorCodes.UnknownErrorCode;\r\n        this.data = data;\r\n        Object.setPrototypeOf(this, ResponseError.prototype);\r\n    }\r\n    toJson() {\r\n        return {\r\n            code: this.code,\r\n            message: this.message,\r\n            data: this.data,\r\n        };\r\n    }\r\n}\r\nexports.ResponseError = ResponseError;\r\n/**\r\n * An abstract implementation of a MessageType.\r\n */\r\nclass AbstractMessageType {\r\n    constructor(_method, _numberOfParams) {\r\n        this._method = _method;\r\n        this._numberOfParams = _numberOfParams;\r\n    }\r\n    get method() {\r\n        return this._method;\r\n    }\r\n    get numberOfParams() {\r\n        return this._numberOfParams;\r\n    }\r\n}\r\nexports.AbstractMessageType = AbstractMessageType;\r\n/**\r\n * Classes to type request response pairs\r\n *\r\n * The type parameter RO will be removed in the next major version\r\n * of the JSON RPC library since it is a LSP concept and doesn't\r\n * belong here. For now it is tagged as default never.\r\n */\r\nclass RequestType0 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 0);\r\n    }\r\n}\r\nexports.RequestType0 = RequestType0;\r\nclass RequestType extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 1);\r\n    }\r\n}\r\nexports.RequestType = RequestType;\r\nclass RequestType1 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 1);\r\n    }\r\n}\r\nexports.RequestType1 = RequestType1;\r\nclass RequestType2 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 2);\r\n    }\r\n}\r\nexports.RequestType2 = RequestType2;\r\nclass RequestType3 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 3);\r\n    }\r\n}\r\nexports.RequestType3 = RequestType3;\r\nclass RequestType4 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 4);\r\n    }\r\n}\r\nexports.RequestType4 = RequestType4;\r\nclass RequestType5 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 5);\r\n    }\r\n}\r\nexports.RequestType5 = RequestType5;\r\nclass RequestType6 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 6);\r\n    }\r\n}\r\nexports.RequestType6 = RequestType6;\r\nclass RequestType7 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 7);\r\n    }\r\n}\r\nexports.RequestType7 = RequestType7;\r\nclass RequestType8 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 8);\r\n    }\r\n}\r\nexports.RequestType8 = RequestType8;\r\nclass RequestType9 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 9);\r\n    }\r\n}\r\nexports.RequestType9 = RequestType9;\r\n/**\r\n * The type parameter RO will be removed in the next major version\r\n * of the JSON RPC library since it is a LSP concept and doesn't\r\n * belong here. For now it is tagged as default never.\r\n */\r\nclass NotificationType extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 1);\r\n        this._ = undefined;\r\n    }\r\n}\r\nexports.NotificationType = NotificationType;\r\nclass NotificationType0 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 0);\r\n    }\r\n}\r\nexports.NotificationType0 = NotificationType0;\r\nclass NotificationType1 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 1);\r\n    }\r\n}\r\nexports.NotificationType1 = NotificationType1;\r\nclass NotificationType2 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 2);\r\n    }\r\n}\r\nexports.NotificationType2 = NotificationType2;\r\nclass NotificationType3 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 3);\r\n    }\r\n}\r\nexports.NotificationType3 = NotificationType3;\r\nclass NotificationType4 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 4);\r\n    }\r\n}\r\nexports.NotificationType4 = NotificationType4;\r\nclass NotificationType5 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 5);\r\n    }\r\n}\r\nexports.NotificationType5 = NotificationType5;\r\nclass NotificationType6 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 6);\r\n    }\r\n}\r\nexports.NotificationType6 = NotificationType6;\r\nclass NotificationType7 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 7);\r\n    }\r\n}\r\nexports.NotificationType7 = NotificationType7;\r\nclass NotificationType8 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 8);\r\n    }\r\n}\r\nexports.NotificationType8 = NotificationType8;\r\nclass NotificationType9 extends AbstractMessageType {\r\n    constructor(method) {\r\n        super(method, 9);\r\n    }\r\n}\r\nexports.NotificationType9 = NotificationType9;\r\n/**\r\n * Tests if the given message is a request message\r\n */\r\nfunction isRequestMessage(message) {\r\n    let candidate = message;\r\n    return candidate && is.string(candidate.method) && (is.string(candidate.id) || is.number(candidate.id));\r\n}\r\nexports.isRequestMessage = isRequestMessage;\r\n/**\r\n * Tests if the given message is a notification message\r\n */\r\nfunction isNotificationMessage(message) {\r\n    let candidate = message;\r\n    return candidate && is.string(candidate.method) && message.id === void 0;\r\n}\r\nexports.isNotificationMessage = isNotificationMessage;\r\n/**\r\n * Tests if the given message is a response message\r\n */\r\nfunction isResponseMessage(message) {\r\n    let candidate = message;\r\n    return candidate && (candidate.result !== void 0 || !!candidate.error) && (is.string(candidate.id) || is.number(candidate.id) || candidate.id === null);\r\n}\r\nexports.isResponseMessage = isResponseMessage;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst path_1 = require(\"path\");\r\nconst os_1 = require(\"os\");\r\nconst crypto_1 = require(\"crypto\");\r\nconst net_1 = require(\"net\");\r\nconst messageReader_1 = require(\"./messageReader\");\r\nconst messageWriter_1 = require(\"./messageWriter\");\r\nfunction generateRandomPipeName() {\r\n    const randomSuffix = crypto_1.randomBytes(21).toString('hex');\r\n    if (process.platform === 'win32') {\r\n        return `\\\\\\\\.\\\\pipe\\\\vscode-jsonrpc-${randomSuffix}-sock`;\r\n    }\r\n    else {\r\n        // Mac/Unix: use socket file\r\n        return path_1.join(os_1.tmpdir(), `vscode-${randomSuffix}.sock`);\r\n    }\r\n}\r\nexports.generateRandomPipeName = generateRandomPipeName;\r\nfunction createClientPipeTransport(pipeName, encoding = 'utf-8') {\r\n    let connectResolve;\r\n    let connected = new Promise((resolve, _reject) => {\r\n        connectResolve = resolve;\r\n    });\r\n    return new Promise((resolve, reject) => {\r\n        let server = net_1.createServer((socket) => {\r\n            server.close();\r\n            connectResolve([\r\n                new messageReader_1.SocketMessageReader(socket, encoding),\r\n                new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n            ]);\r\n        });\r\n        server.on('error', reject);\r\n        server.listen(pipeName, () => {\r\n            server.removeListener('error', reject);\r\n            resolve({\r\n                onConnected: () => { return connected; }\r\n            });\r\n        });\r\n    });\r\n}\r\nexports.createClientPipeTransport = createClientPipeTransport;\r\nfunction createServerPipeTransport(pipeName, encoding = 'utf-8') {\r\n    const socket = net_1.createConnection(pipeName);\r\n    return [\r\n        new messageReader_1.SocketMessageReader(socket, encoding),\r\n        new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n    ];\r\n}\r\nexports.createServerPipeTransport = createServerPipeTransport;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst net_1 = require(\"net\");\r\nconst messageReader_1 = require(\"./messageReader\");\r\nconst messageWriter_1 = require(\"./messageWriter\");\r\nfunction createClientSocketTransport(port, encoding = 'utf-8') {\r\n    let connectResolve;\r\n    let connected = new Promise((resolve, _reject) => {\r\n        connectResolve = resolve;\r\n    });\r\n    return new Promise((resolve, reject) => {\r\n        let server = net_1.createServer((socket) => {\r\n            server.close();\r\n            connectResolve([\r\n                new messageReader_1.SocketMessageReader(socket, encoding),\r\n                new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n            ]);\r\n        });\r\n        server.on('error', reject);\r\n        server.listen(port, '127.0.0.1', () => {\r\n            server.removeListener('error', reject);\r\n            resolve({\r\n                onConnected: () => { return connected; }\r\n            });\r\n        });\r\n    });\r\n}\r\nexports.createClientSocketTransport = createClientSocketTransport;\r\nfunction createServerSocketTransport(port, encoding = 'utf-8') {\r\n    const socket = net_1.createConnection(port, '127.0.0.1');\r\n    return [\r\n        new messageReader_1.SocketMessageReader(socket, encoding),\r\n        new messageWriter_1.SocketMessageWriter(socket, encoding)\r\n    ];\r\n}\r\nexports.createServerSocketTransport = createServerSocketTransport;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_1 = require(\"vscode\");\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nconst client_1 = require(\"./client\");\r\nfunction ensure(target, key) {\r\n    if (target[key] === void 0) {\r\n        target[key] = {};\r\n    }\r\n    return target[key];\r\n}\r\nvar protocol2code;\r\n(function (protocol2code) {\r\n    function asCallHierarchyItem(converter, item) {\r\n        if (item === null) {\r\n            return undefined;\r\n        }\r\n        let result = new vscode_1.CallHierarchyItem(converter.asSymbolKind(item.kind), item.name, item.detail || '', converter.asUri(item.uri), converter.asRange(item.range), converter.asRange(item.selectionRange));\r\n        if (item.tags !== undefined) {\r\n            result.tags = converter.asSymbolTags(item.tags);\r\n        }\r\n        return result;\r\n    }\r\n    protocol2code.asCallHierarchyItem = asCallHierarchyItem;\r\n    function asCallHierarchyItems(converter, items) {\r\n        if (items === null) {\r\n            return undefined;\r\n        }\r\n        let result = items.map(item => asCallHierarchyItem(converter, item));\r\n        return result[0];\r\n    }\r\n    protocol2code.asCallHierarchyItems = asCallHierarchyItems;\r\n    function asCallHierarchyIncomingCall(converter, item) {\r\n        return new vscode_1.CallHierarchyIncomingCall(asCallHierarchyItem(converter, item.from), converter.asRanges(item.fromRanges));\r\n    }\r\n    protocol2code.asCallHierarchyIncomingCall = asCallHierarchyIncomingCall;\r\n    function asCallHierarchyIncomingCalls(converter, items) {\r\n        if (items === null) {\r\n            return undefined;\r\n        }\r\n        return items.map(item => asCallHierarchyIncomingCall(converter, item));\r\n    }\r\n    protocol2code.asCallHierarchyIncomingCalls = asCallHierarchyIncomingCalls;\r\n    function asCallHierarchyOutgoingCall(converter, item) {\r\n        return new vscode_1.CallHierarchyOutgoingCall(asCallHierarchyItem(converter, item.to), converter.asRanges(item.fromRanges));\r\n    }\r\n    protocol2code.asCallHierarchyOutgoingCall = asCallHierarchyOutgoingCall;\r\n    function asCallHierarchyOutgoingCalls(converter, items) {\r\n        if (items === null) {\r\n            return undefined;\r\n        }\r\n        return items.map(item => asCallHierarchyOutgoingCall(converter, item));\r\n    }\r\n    protocol2code.asCallHierarchyOutgoingCalls = asCallHierarchyOutgoingCalls;\r\n})(protocol2code || (protocol2code = {}));\r\nvar code2protocol;\r\n(function (code2protocol) {\r\n    function asCallHierarchyItem(converter, value) {\r\n        const result = {\r\n            name: value.name,\r\n            kind: converter.asSymbolKind(value.kind),\r\n            uri: converter.asUri(value.uri),\r\n            range: converter.asRange(value.range),\r\n            selectionRange: converter.asRange(value.selectionRange)\r\n        };\r\n        if (value.detail !== undefined && value.detail.length > 0) {\r\n            result.detail = value.detail;\r\n        }\r\n        if (value.tags !== undefined) {\r\n            result.tags = converter.asSymbolTags(value.tags);\r\n        }\r\n        return result;\r\n    }\r\n    code2protocol.asCallHierarchyItem = asCallHierarchyItem;\r\n})(code2protocol || (code2protocol = {}));\r\nclass CallHierarchyProvider {\r\n    constructor(client) {\r\n        this.client = client;\r\n        this.middleware = client.clientOptions.middleware;\r\n    }\r\n    prepareCallHierarchy(document, position, token) {\r\n        const client = this.client;\r\n        const middleware = this.middleware;\r\n        const prepareCallHierarchy = (document, position, token) => {\r\n            const params = client.code2ProtocolConverter.asTextDocumentPositionParams(document, position);\r\n            return client.sendRequest(vscode_languageserver_protocol_1.Proposed.CallHierarchyPrepareRequest.type, params, token).then((result) => {\r\n                return protocol2code.asCallHierarchyItems(this.client.protocol2CodeConverter, result);\r\n            }, (error) => {\r\n                client.logFailedRequest(vscode_languageserver_protocol_1.Proposed.CallHierarchyPrepareRequest.type, error);\r\n                return Promise.resolve(null);\r\n            });\r\n        };\r\n        return middleware.prepareCallHierarchy\r\n            ? middleware.prepareCallHierarchy(document, position, token, prepareCallHierarchy)\r\n            : prepareCallHierarchy(document, position, token);\r\n    }\r\n    provideCallHierarchyIncomingCalls(item, token) {\r\n        const client = this.client;\r\n        const middleware = this.middleware;\r\n        const provideCallHierarchyIncomingCalls = (item, token) => {\r\n            const params = {\r\n                item: code2protocol.asCallHierarchyItem(client.code2ProtocolConverter, item)\r\n            };\r\n            return client.sendRequest(vscode_languageserver_protocol_1.Proposed.CallHierarchyIncomingCallsRequest.type, params, token).then((result) => {\r\n                return protocol2code.asCallHierarchyIncomingCalls(client.protocol2CodeConverter, result);\r\n            }, (error) => {\r\n                client.logFailedRequest(vscode_languageserver_protocol_1.Proposed.CallHierarchyIncomingCallsRequest.type, error);\r\n                return Promise.resolve(null);\r\n            });\r\n        };\r\n        return middleware.provideCallHierarchyIncomingCalls\r\n            ? middleware.provideCallHierarchyIncomingCalls(item, token, provideCallHierarchyIncomingCalls)\r\n            : provideCallHierarchyIncomingCalls(item, token);\r\n    }\r\n    provideCallHierarchyOutgoingCalls(item, token) {\r\n        const client = this.client;\r\n        const middleware = this.middleware;\r\n        const provideCallHierarchyOutgoingCalls = (item, token) => {\r\n            const params = {\r\n                item: code2protocol.asCallHierarchyItem(client.code2ProtocolConverter, item)\r\n            };\r\n            return client.sendRequest(vscode_languageserver_protocol_1.Proposed.CallHierarchyOutgoingCallsRequest.type, params, token).then((result) => {\r\n                return protocol2code.asCallHierarchyOutgoingCalls(client.protocol2CodeConverter, result);\r\n            }, (error) => {\r\n                client.logFailedRequest(vscode_languageserver_protocol_1.Proposed.CallHierarchyOutgoingCallsRequest.type, error);\r\n                return Promise.resolve(null);\r\n            });\r\n        };\r\n        return middleware.provideCallHierarchyOutgingCalls\r\n            ? middleware.provideCallHierarchyOutgingCalls(item, token, provideCallHierarchyOutgoingCalls)\r\n            : provideCallHierarchyOutgoingCalls(item, token);\r\n    }\r\n}\r\nclass CallHierarchyFeature extends client_1.TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.Proposed.CallHierarchyPrepareRequest.type);\r\n    }\r\n    fillClientCapabilities(cap) {\r\n        const capabilites = cap;\r\n        const capability = ensure(ensure(capabilites, 'textDocument'), 'callHierarchy');\r\n        capability.dynamicRegistration = true;\r\n    }\r\n    initialize(cap, documentSelector) {\r\n        const capabilities = cap;\r\n        const [id, options] = this.getRegistration(documentSelector, capabilities.callHierarchyProvider);\r\n        if (!id || !options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: id, registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const client = this._client;\r\n        const provider = new CallHierarchyProvider(client);\r\n        return [vscode_1.languages.registerCallHierarchyProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nexports.CallHierarchyFeature = CallHierarchyFeature;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_1 = require(\"vscode\");\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nconst c2p = require(\"./codeConverter\");\r\nconst p2c = require(\"./protocolConverter\");\r\nconst Is = require(\"./utils/is\");\r\nconst async_1 = require(\"./utils/async\");\r\nconst UUID = require(\"./utils/uuid\");\r\nconst progressPart_1 = require(\"./progressPart\");\r\n__export(require(\"vscode-languageserver-protocol\"));\r\nclass ConsoleLogger {\r\n    error(message) {\r\n        console.error(message);\r\n    }\r\n    warn(message) {\r\n        console.warn(message);\r\n    }\r\n    info(message) {\r\n        console.info(message);\r\n    }\r\n    log(message) {\r\n        console.log(message);\r\n    }\r\n}\r\nfunction createConnection(input, output, errorHandler, closeHandler) {\r\n    let logger = new ConsoleLogger();\r\n    let connection = vscode_languageserver_protocol_1.createProtocolConnection(input, output, logger);\r\n    connection.onError((data) => { errorHandler(data[0], data[1], data[2]); });\r\n    connection.onClose(closeHandler);\r\n    let result = {\r\n        listen: () => connection.listen(),\r\n        sendRequest: (type, ...params) => connection.sendRequest(Is.string(type) ? type : type.method, ...params),\r\n        onRequest: (type, handler) => connection.onRequest(Is.string(type) ? type : type.method, handler),\r\n        sendNotification: (type, params) => connection.sendNotification(Is.string(type) ? type : type.method, params),\r\n        onNotification: (type, handler) => connection.onNotification(Is.string(type) ? type : type.method, handler),\r\n        onProgress: connection.onProgress,\r\n        sendProgress: connection.sendProgress,\r\n        trace: (value, tracer, sendNotificationOrTraceOptions) => {\r\n            const defaultTraceOptions = {\r\n                sendNotification: false,\r\n                traceFormat: vscode_languageserver_protocol_1.TraceFormat.Text\r\n            };\r\n            if (sendNotificationOrTraceOptions === void 0) {\r\n                connection.trace(value, tracer, defaultTraceOptions);\r\n            }\r\n            else if (Is.boolean(sendNotificationOrTraceOptions)) {\r\n                connection.trace(value, tracer, sendNotificationOrTraceOptions);\r\n            }\r\n            else {\r\n                connection.trace(value, tracer, sendNotificationOrTraceOptions);\r\n            }\r\n        },\r\n        initialize: (params) => connection.sendRequest(vscode_languageserver_protocol_1.InitializeRequest.type, params),\r\n        shutdown: () => connection.sendRequest(vscode_languageserver_protocol_1.ShutdownRequest.type, undefined),\r\n        exit: () => connection.sendNotification(vscode_languageserver_protocol_1.ExitNotification.type),\r\n        onLogMessage: (handler) => connection.onNotification(vscode_languageserver_protocol_1.LogMessageNotification.type, handler),\r\n        onShowMessage: (handler) => connection.onNotification(vscode_languageserver_protocol_1.ShowMessageNotification.type, handler),\r\n        onTelemetry: (handler) => connection.onNotification(vscode_languageserver_protocol_1.TelemetryEventNotification.type, handler),\r\n        didChangeConfiguration: (params) => connection.sendNotification(vscode_languageserver_protocol_1.DidChangeConfigurationNotification.type, params),\r\n        didChangeWatchedFiles: (params) => connection.sendNotification(vscode_languageserver_protocol_1.DidChangeWatchedFilesNotification.type, params),\r\n        didOpenTextDocument: (params) => connection.sendNotification(vscode_languageserver_protocol_1.DidOpenTextDocumentNotification.type, params),\r\n        didChangeTextDocument: (params) => connection.sendNotification(vscode_languageserver_protocol_1.DidChangeTextDocumentNotification.type, params),\r\n        didCloseTextDocument: (params) => connection.sendNotification(vscode_languageserver_protocol_1.DidCloseTextDocumentNotification.type, params),\r\n        didSaveTextDocument: (params) => connection.sendNotification(vscode_languageserver_protocol_1.DidSaveTextDocumentNotification.type, params),\r\n        onDiagnostics: (handler) => connection.onNotification(vscode_languageserver_protocol_1.PublishDiagnosticsNotification.type, handler),\r\n        dispose: () => connection.dispose()\r\n    };\r\n    return result;\r\n}\r\n/**\r\n * An action to be performed when the connection is producing errors.\r\n */\r\nvar ErrorAction;\r\n(function (ErrorAction) {\r\n    /**\r\n     * Continue running the server.\r\n     */\r\n    ErrorAction[ErrorAction[\"Continue\"] = 1] = \"Continue\";\r\n    /**\r\n     * Shutdown the server.\r\n     */\r\n    ErrorAction[ErrorAction[\"Shutdown\"] = 2] = \"Shutdown\";\r\n})(ErrorAction = exports.ErrorAction || (exports.ErrorAction = {}));\r\n/**\r\n * An action to be performed when the connection to a server got closed.\r\n */\r\nvar CloseAction;\r\n(function (CloseAction) {\r\n    /**\r\n     * Don't restart the server. The connection stays closed.\r\n     */\r\n    CloseAction[CloseAction[\"DoNotRestart\"] = 1] = \"DoNotRestart\";\r\n    /**\r\n     * Restart the server.\r\n     */\r\n    CloseAction[CloseAction[\"Restart\"] = 2] = \"Restart\";\r\n})(CloseAction = exports.CloseAction || (exports.CloseAction = {}));\r\nclass DefaultErrorHandler {\r\n    constructor(name) {\r\n        this.name = name;\r\n        this.restarts = [];\r\n    }\r\n    error(_error, _message, count) {\r\n        if (count && count <= 3) {\r\n            return ErrorAction.Continue;\r\n        }\r\n        return ErrorAction.Shutdown;\r\n    }\r\n    closed() {\r\n        this.restarts.push(Date.now());\r\n        if (this.restarts.length < 5) {\r\n            return CloseAction.Restart;\r\n        }\r\n        else {\r\n            let diff = this.restarts[this.restarts.length - 1] - this.restarts[0];\r\n            if (diff <= 3 * 60 * 1000) {\r\n                vscode_1.window.showErrorMessage(`The ${this.name} server crashed 5 times in the last 3 minutes. The server will not be restarted.`);\r\n                return CloseAction.DoNotRestart;\r\n            }\r\n            else {\r\n                this.restarts.shift();\r\n                return CloseAction.Restart;\r\n            }\r\n        }\r\n    }\r\n}\r\nvar RevealOutputChannelOn;\r\n(function (RevealOutputChannelOn) {\r\n    RevealOutputChannelOn[RevealOutputChannelOn[\"Info\"] = 1] = \"Info\";\r\n    RevealOutputChannelOn[RevealOutputChannelOn[\"Warn\"] = 2] = \"Warn\";\r\n    RevealOutputChannelOn[RevealOutputChannelOn[\"Error\"] = 3] = \"Error\";\r\n    RevealOutputChannelOn[RevealOutputChannelOn[\"Never\"] = 4] = \"Never\";\r\n})(RevealOutputChannelOn = exports.RevealOutputChannelOn || (exports.RevealOutputChannelOn = {}));\r\nvar State;\r\n(function (State) {\r\n    State[State[\"Stopped\"] = 1] = \"Stopped\";\r\n    State[State[\"Starting\"] = 3] = \"Starting\";\r\n    State[State[\"Running\"] = 2] = \"Running\";\r\n})(State = exports.State || (exports.State = {}));\r\nvar ClientState;\r\n(function (ClientState) {\r\n    ClientState[ClientState[\"Initial\"] = 0] = \"Initial\";\r\n    ClientState[ClientState[\"Starting\"] = 1] = \"Starting\";\r\n    ClientState[ClientState[\"StartFailed\"] = 2] = \"StartFailed\";\r\n    ClientState[ClientState[\"Running\"] = 3] = \"Running\";\r\n    ClientState[ClientState[\"Stopping\"] = 4] = \"Stopping\";\r\n    ClientState[ClientState[\"Stopped\"] = 5] = \"Stopped\";\r\n})(ClientState || (ClientState = {}));\r\nconst SupportedSymbolKinds = [\r\n    vscode_languageserver_protocol_1.SymbolKind.File,\r\n    vscode_languageserver_protocol_1.SymbolKind.Module,\r\n    vscode_languageserver_protocol_1.SymbolKind.Namespace,\r\n    vscode_languageserver_protocol_1.SymbolKind.Package,\r\n    vscode_languageserver_protocol_1.SymbolKind.Class,\r\n    vscode_languageserver_protocol_1.SymbolKind.Method,\r\n    vscode_languageserver_protocol_1.SymbolKind.Property,\r\n    vscode_languageserver_protocol_1.SymbolKind.Field,\r\n    vscode_languageserver_protocol_1.SymbolKind.Constructor,\r\n    vscode_languageserver_protocol_1.SymbolKind.Enum,\r\n    vscode_languageserver_protocol_1.SymbolKind.Interface,\r\n    vscode_languageserver_protocol_1.SymbolKind.Function,\r\n    vscode_languageserver_protocol_1.SymbolKind.Variable,\r\n    vscode_languageserver_protocol_1.SymbolKind.Constant,\r\n    vscode_languageserver_protocol_1.SymbolKind.String,\r\n    vscode_languageserver_protocol_1.SymbolKind.Number,\r\n    vscode_languageserver_protocol_1.SymbolKind.Boolean,\r\n    vscode_languageserver_protocol_1.SymbolKind.Array,\r\n    vscode_languageserver_protocol_1.SymbolKind.Object,\r\n    vscode_languageserver_protocol_1.SymbolKind.Key,\r\n    vscode_languageserver_protocol_1.SymbolKind.Null,\r\n    vscode_languageserver_protocol_1.SymbolKind.EnumMember,\r\n    vscode_languageserver_protocol_1.SymbolKind.Struct,\r\n    vscode_languageserver_protocol_1.SymbolKind.Event,\r\n    vscode_languageserver_protocol_1.SymbolKind.Operator,\r\n    vscode_languageserver_protocol_1.SymbolKind.TypeParameter\r\n];\r\nconst SupportedCompletionItemKinds = [\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Text,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Method,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Function,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Constructor,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Field,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Variable,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Class,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Interface,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Module,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Property,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Unit,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Value,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Enum,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Keyword,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Snippet,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Color,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.File,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Reference,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Folder,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.EnumMember,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Constant,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Struct,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Event,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.Operator,\r\n    vscode_languageserver_protocol_1.CompletionItemKind.TypeParameter\r\n];\r\nfunction ensure(target, key) {\r\n    if (target[key] === void 0) {\r\n        target[key] = {};\r\n    }\r\n    return target[key];\r\n}\r\nvar DynamicFeature;\r\n(function (DynamicFeature) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && Is.func(candidate.register) && Is.func(candidate.unregister) && Is.func(candidate.dispose) && candidate.messages !== void 0;\r\n    }\r\n    DynamicFeature.is = is;\r\n})(DynamicFeature || (DynamicFeature = {}));\r\nclass DocumentNotifiactions {\r\n    constructor(_client, _event, _type, _middleware, _createParams, _selectorFilter) {\r\n        this._client = _client;\r\n        this._event = _event;\r\n        this._type = _type;\r\n        this._middleware = _middleware;\r\n        this._createParams = _createParams;\r\n        this._selectorFilter = _selectorFilter;\r\n        this._selectors = new Map();\r\n    }\r\n    static textDocumentFilter(selectors, textDocument) {\r\n        for (const selector of selectors) {\r\n            if (vscode_1.languages.match(selector, textDocument)) {\r\n                return true;\r\n            }\r\n        }\r\n        return false;\r\n    }\r\n    register(_message, data) {\r\n        if (!data.registerOptions.documentSelector) {\r\n            return;\r\n        }\r\n        if (!this._listener) {\r\n            this._listener = this._event(this.callback, this);\r\n        }\r\n        this._selectors.set(data.id, data.registerOptions.documentSelector);\r\n    }\r\n    callback(data) {\r\n        if (!this._selectorFilter || this._selectorFilter(this._selectors.values(), data)) {\r\n            if (this._middleware) {\r\n                this._middleware(data, (data) => this._client.sendNotification(this._type, this._createParams(data)));\r\n            }\r\n            else {\r\n                this._client.sendNotification(this._type, this._createParams(data));\r\n            }\r\n            this.notificationSent(data);\r\n        }\r\n    }\r\n    notificationSent(_data) {\r\n    }\r\n    unregister(id) {\r\n        this._selectors.delete(id);\r\n        if (this._selectors.size === 0 && this._listener) {\r\n            this._listener.dispose();\r\n            this._listener = undefined;\r\n        }\r\n    }\r\n    dispose() {\r\n        this._selectors.clear();\r\n        if (this._listener) {\r\n            this._listener.dispose();\r\n            this._listener = undefined;\r\n        }\r\n    }\r\n    getProvider(document) {\r\n        for (const selector of this._selectors.values()) {\r\n            if (vscode_1.languages.match(selector, document)) {\r\n                return {\r\n                    send: (data) => {\r\n                        this.callback(data);\r\n                    }\r\n                };\r\n            }\r\n        }\r\n        throw new Error(`No provider available for the given text document`);\r\n    }\r\n}\r\nclass DidOpenTextDocumentFeature extends DocumentNotifiactions {\r\n    constructor(client, _syncedDocuments) {\r\n        super(client, vscode_1.workspace.onDidOpenTextDocument, vscode_languageserver_protocol_1.DidOpenTextDocumentNotification.type, client.clientOptions.middleware.didOpen, (textDocument) => client.code2ProtocolConverter.asOpenTextDocumentParams(textDocument), DocumentNotifiactions.textDocumentFilter);\r\n        this._syncedDocuments = _syncedDocuments;\r\n    }\r\n    get messages() {\r\n        return vscode_languageserver_protocol_1.DidOpenTextDocumentNotification.type;\r\n    }\r\n    fillClientCapabilities(capabilities) {\r\n        ensure(ensure(capabilities, 'textDocument'), 'synchronization').dynamicRegistration = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        let textDocumentSyncOptions = capabilities.resolvedTextDocumentSync;\r\n        if (documentSelector && textDocumentSyncOptions && textDocumentSyncOptions.openClose) {\r\n            this.register(this.messages, { id: UUID.generateUuid(), registerOptions: { documentSelector: documentSelector } });\r\n        }\r\n    }\r\n    register(message, data) {\r\n        super.register(message, data);\r\n        if (!data.registerOptions.documentSelector) {\r\n            return;\r\n        }\r\n        let documentSelector = data.registerOptions.documentSelector;\r\n        vscode_1.workspace.textDocuments.forEach((textDocument) => {\r\n            let uri = textDocument.uri.toString();\r\n            if (this._syncedDocuments.has(uri)) {\r\n                return;\r\n            }\r\n            if (vscode_1.languages.match(documentSelector, textDocument)) {\r\n                let middleware = this._client.clientOptions.middleware;\r\n                let didOpen = (textDocument) => {\r\n                    this._client.sendNotification(this._type, this._createParams(textDocument));\r\n                };\r\n                if (middleware.didOpen) {\r\n                    middleware.didOpen(textDocument, didOpen);\r\n                }\r\n                else {\r\n                    didOpen(textDocument);\r\n                }\r\n                this._syncedDocuments.set(uri, textDocument);\r\n            }\r\n        });\r\n    }\r\n    notificationSent(textDocument) {\r\n        super.notificationSent(textDocument);\r\n        this._syncedDocuments.set(textDocument.uri.toString(), textDocument);\r\n    }\r\n}\r\nclass DidCloseTextDocumentFeature extends DocumentNotifiactions {\r\n    constructor(client, _syncedDocuments) {\r\n        super(client, vscode_1.workspace.onDidCloseTextDocument, vscode_languageserver_protocol_1.DidCloseTextDocumentNotification.type, client.clientOptions.middleware.didClose, (textDocument) => client.code2ProtocolConverter.asCloseTextDocumentParams(textDocument), DocumentNotifiactions.textDocumentFilter);\r\n        this._syncedDocuments = _syncedDocuments;\r\n    }\r\n    get messages() {\r\n        return vscode_languageserver_protocol_1.DidCloseTextDocumentNotification.type;\r\n    }\r\n    fillClientCapabilities(capabilities) {\r\n        ensure(ensure(capabilities, 'textDocument'), 'synchronization').dynamicRegistration = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        let textDocumentSyncOptions = capabilities.resolvedTextDocumentSync;\r\n        if (documentSelector && textDocumentSyncOptions && textDocumentSyncOptions.openClose) {\r\n            this.register(this.messages, { id: UUID.generateUuid(), registerOptions: { documentSelector: documentSelector } });\r\n        }\r\n    }\r\n    notificationSent(textDocument) {\r\n        super.notificationSent(textDocument);\r\n        this._syncedDocuments.delete(textDocument.uri.toString());\r\n    }\r\n    unregister(id) {\r\n        let selector = this._selectors.get(id);\r\n        // The super call removed the selector from the map\r\n        // of selectors.\r\n        super.unregister(id);\r\n        let selectors = this._selectors.values();\r\n        this._syncedDocuments.forEach((textDocument) => {\r\n            if (vscode_1.languages.match(selector, textDocument) && !this._selectorFilter(selectors, textDocument)) {\r\n                let middleware = this._client.clientOptions.middleware;\r\n                let didClose = (textDocument) => {\r\n                    this._client.sendNotification(this._type, this._createParams(textDocument));\r\n                };\r\n                this._syncedDocuments.delete(textDocument.uri.toString());\r\n                if (middleware.didClose) {\r\n                    middleware.didClose(textDocument, didClose);\r\n                }\r\n                else {\r\n                    didClose(textDocument);\r\n                }\r\n            }\r\n        });\r\n    }\r\n}\r\nclass DidChangeTextDocumentFeature {\r\n    constructor(_client) {\r\n        this._client = _client;\r\n        this._changeData = new Map();\r\n        this._forcingDelivery = false;\r\n    }\r\n    get messages() {\r\n        return vscode_languageserver_protocol_1.DidChangeTextDocumentNotification.type;\r\n    }\r\n    fillClientCapabilities(capabilities) {\r\n        ensure(ensure(capabilities, 'textDocument'), 'synchronization').dynamicRegistration = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        let textDocumentSyncOptions = capabilities.resolvedTextDocumentSync;\r\n        if (documentSelector && textDocumentSyncOptions && textDocumentSyncOptions.change !== void 0 && textDocumentSyncOptions.change !== vscode_languageserver_protocol_1.TextDocumentSyncKind.None) {\r\n            this.register(this.messages, {\r\n                id: UUID.generateUuid(),\r\n                registerOptions: Object.assign({}, { documentSelector: documentSelector }, { syncKind: textDocumentSyncOptions.change })\r\n            });\r\n        }\r\n    }\r\n    register(_message, data) {\r\n        if (!data.registerOptions.documentSelector) {\r\n            return;\r\n        }\r\n        if (!this._listener) {\r\n            this._listener = vscode_1.workspace.onDidChangeTextDocument(this.callback, this);\r\n        }\r\n        this._changeData.set(data.id, {\r\n            documentSelector: data.registerOptions.documentSelector,\r\n            syncKind: data.registerOptions.syncKind\r\n        });\r\n    }\r\n    callback(event) {\r\n        // Text document changes are send for dirty changes as well. We don't\r\n        // have dirty / undirty events in the LSP so we ignore content changes\r\n        // with length zero.\r\n        if (event.contentChanges.length === 0) {\r\n            return;\r\n        }\r\n        for (const changeData of this._changeData.values()) {\r\n            if (vscode_1.languages.match(changeData.documentSelector, event.document)) {\r\n                let middleware = this._client.clientOptions.middleware;\r\n                if (changeData.syncKind === vscode_languageserver_protocol_1.TextDocumentSyncKind.Incremental) {\r\n                    let params = this._client.code2ProtocolConverter.asChangeTextDocumentParams(event);\r\n                    if (middleware.didChange) {\r\n                        middleware.didChange(event, () => this._client.sendNotification(vscode_languageserver_protocol_1.DidChangeTextDocumentNotification.type, params));\r\n                    }\r\n                    else {\r\n                        this._client.sendNotification(vscode_languageserver_protocol_1.DidChangeTextDocumentNotification.type, params);\r\n                    }\r\n                }\r\n                else if (changeData.syncKind === vscode_languageserver_protocol_1.TextDocumentSyncKind.Full) {\r\n                    let didChange = (event) => {\r\n                        if (this._changeDelayer) {\r\n                            if (this._changeDelayer.uri !== event.document.uri.toString()) {\r\n                                // Use this force delivery to track boolean state. Otherwise we might call two times.\r\n                                this.forceDelivery();\r\n                                this._changeDelayer.uri = event.document.uri.toString();\r\n                            }\r\n                            this._changeDelayer.delayer.trigger(() => {\r\n                                this._client.sendNotification(vscode_languageserver_protocol_1.DidChangeTextDocumentNotification.type, this._client.code2ProtocolConverter.asChangeTextDocumentParams(event.document));\r\n                            });\r\n                        }\r\n                        else {\r\n                            this._changeDelayer = {\r\n                                uri: event.document.uri.toString(),\r\n                                delayer: new async_1.Delayer(200)\r\n                            };\r\n                            this._changeDelayer.delayer.trigger(() => {\r\n                                this._client.sendNotification(vscode_languageserver_protocol_1.DidChangeTextDocumentNotification.type, this._client.code2ProtocolConverter.asChangeTextDocumentParams(event.document));\r\n                            }, -1);\r\n                        }\r\n                    };\r\n                    if (middleware.didChange) {\r\n                        middleware.didChange(event, didChange);\r\n                    }\r\n                    else {\r\n                        didChange(event);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n    unregister(id) {\r\n        this._changeData.delete(id);\r\n        if (this._changeData.size === 0 && this._listener) {\r\n            this._listener.dispose();\r\n            this._listener = undefined;\r\n        }\r\n    }\r\n    dispose() {\r\n        this._changeDelayer = undefined;\r\n        this._forcingDelivery = false;\r\n        this._changeData.clear();\r\n        if (this._listener) {\r\n            this._listener.dispose();\r\n            this._listener = undefined;\r\n        }\r\n    }\r\n    forceDelivery() {\r\n        if (this._forcingDelivery || !this._changeDelayer) {\r\n            return;\r\n        }\r\n        try {\r\n            this._forcingDelivery = true;\r\n            this._changeDelayer.delayer.forceDelivery();\r\n        }\r\n        finally {\r\n            this._forcingDelivery = false;\r\n        }\r\n    }\r\n    getProvider(document) {\r\n        for (const changeData of this._changeData.values()) {\r\n            if (vscode_1.languages.match(changeData.documentSelector, document)) {\r\n                return {\r\n                    send: (event) => {\r\n                        this.callback(event);\r\n                    }\r\n                };\r\n            }\r\n        }\r\n        throw new Error(`No provider available for the given text document`);\r\n    }\r\n}\r\nclass WillSaveFeature extends DocumentNotifiactions {\r\n    constructor(client) {\r\n        super(client, vscode_1.workspace.onWillSaveTextDocument, vscode_languageserver_protocol_1.WillSaveTextDocumentNotification.type, client.clientOptions.middleware.willSave, (willSaveEvent) => client.code2ProtocolConverter.asWillSaveTextDocumentParams(willSaveEvent), (selectors, willSaveEvent) => DocumentNotifiactions.textDocumentFilter(selectors, willSaveEvent.document));\r\n    }\r\n    get messages() {\r\n        return vscode_languageserver_protocol_1.WillSaveTextDocumentNotification.type;\r\n    }\r\n    fillClientCapabilities(capabilities) {\r\n        let value = ensure(ensure(capabilities, 'textDocument'), 'synchronization');\r\n        value.willSave = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        let textDocumentSyncOptions = capabilities.resolvedTextDocumentSync;\r\n        if (documentSelector && textDocumentSyncOptions && textDocumentSyncOptions.willSave) {\r\n            this.register(this.messages, {\r\n                id: UUID.generateUuid(),\r\n                registerOptions: { documentSelector: documentSelector }\r\n            });\r\n        }\r\n    }\r\n}\r\nclass WillSaveWaitUntilFeature {\r\n    constructor(_client) {\r\n        this._client = _client;\r\n        this._selectors = new Map();\r\n    }\r\n    get messages() {\r\n        return vscode_languageserver_protocol_1.WillSaveTextDocumentWaitUntilRequest.type;\r\n    }\r\n    fillClientCapabilities(capabilities) {\r\n        let value = ensure(ensure(capabilities, 'textDocument'), 'synchronization');\r\n        value.willSaveWaitUntil = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        let textDocumentSyncOptions = capabilities.resolvedTextDocumentSync;\r\n        if (documentSelector && textDocumentSyncOptions && textDocumentSyncOptions.willSaveWaitUntil) {\r\n            this.register(this.messages, {\r\n                id: UUID.generateUuid(),\r\n                registerOptions: { documentSelector: documentSelector }\r\n            });\r\n        }\r\n    }\r\n    register(_message, data) {\r\n        if (!data.registerOptions.documentSelector) {\r\n            return;\r\n        }\r\n        if (!this._listener) {\r\n            this._listener = vscode_1.workspace.onWillSaveTextDocument(this.callback, this);\r\n        }\r\n        this._selectors.set(data.id, data.registerOptions.documentSelector);\r\n    }\r\n    callback(event) {\r\n        if (DocumentNotifiactions.textDocumentFilter(this._selectors.values(), event.document)) {\r\n            let middleware = this._client.clientOptions.middleware;\r\n            let willSaveWaitUntil = (event) => {\r\n                return this._client.sendRequest(vscode_languageserver_protocol_1.WillSaveTextDocumentWaitUntilRequest.type, this._client.code2ProtocolConverter.asWillSaveTextDocumentParams(event)).then((edits) => {\r\n                    let vEdits = this._client.protocol2CodeConverter.asTextEdits(edits);\r\n                    return vEdits === void 0 ? [] : vEdits;\r\n                });\r\n            };\r\n            event.waitUntil(middleware.willSaveWaitUntil\r\n                ? middleware.willSaveWaitUntil(event, willSaveWaitUntil)\r\n                : willSaveWaitUntil(event));\r\n        }\r\n    }\r\n    unregister(id) {\r\n        this._selectors.delete(id);\r\n        if (this._selectors.size === 0 && this._listener) {\r\n            this._listener.dispose();\r\n            this._listener = undefined;\r\n        }\r\n    }\r\n    dispose() {\r\n        this._selectors.clear();\r\n        if (this._listener) {\r\n            this._listener.dispose();\r\n            this._listener = undefined;\r\n        }\r\n    }\r\n}\r\nclass DidSaveTextDocumentFeature extends DocumentNotifiactions {\r\n    constructor(client) {\r\n        super(client, vscode_1.workspace.onDidSaveTextDocument, vscode_languageserver_protocol_1.DidSaveTextDocumentNotification.type, client.clientOptions.middleware.didSave, (textDocument) => client.code2ProtocolConverter.asSaveTextDocumentParams(textDocument, this._includeText), DocumentNotifiactions.textDocumentFilter);\r\n    }\r\n    get messages() {\r\n        return vscode_languageserver_protocol_1.DidSaveTextDocumentNotification.type;\r\n    }\r\n    fillClientCapabilities(capabilities) {\r\n        ensure(ensure(capabilities, 'textDocument'), 'synchronization').didSave = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        let textDocumentSyncOptions = capabilities.resolvedTextDocumentSync;\r\n        if (documentSelector && textDocumentSyncOptions && textDocumentSyncOptions.save) {\r\n            this.register(this.messages, {\r\n                id: UUID.generateUuid(),\r\n                registerOptions: Object.assign({}, { documentSelector: documentSelector }, { includeText: !!textDocumentSyncOptions.save.includeText })\r\n            });\r\n        }\r\n    }\r\n    register(method, data) {\r\n        this._includeText = !!data.registerOptions.includeText;\r\n        super.register(method, data);\r\n    }\r\n}\r\nclass FileSystemWatcherFeature {\r\n    constructor(_client, _notifyFileEvent) {\r\n        this._client = _client;\r\n        this._notifyFileEvent = _notifyFileEvent;\r\n        this._watchers = new Map();\r\n    }\r\n    get messages() {\r\n        return vscode_languageserver_protocol_1.DidChangeWatchedFilesNotification.type;\r\n    }\r\n    fillClientCapabilities(capabilities) {\r\n        ensure(ensure(capabilities, 'workspace'), 'didChangeWatchedFiles').dynamicRegistration = true;\r\n    }\r\n    initialize(_capabilities, _documentSelector) {\r\n    }\r\n    register(_method, data) {\r\n        if (!Array.isArray(data.registerOptions.watchers)) {\r\n            return;\r\n        }\r\n        let disposeables = [];\r\n        for (let watcher of data.registerOptions.watchers) {\r\n            if (!Is.string(watcher.globPattern)) {\r\n                continue;\r\n            }\r\n            let watchCreate = true, watchChange = true, watchDelete = true;\r\n            if (watcher.kind !== void 0 && watcher.kind !== null) {\r\n                watchCreate = (watcher.kind & vscode_languageserver_protocol_1.WatchKind.Create) !== 0;\r\n                watchChange = (watcher.kind & vscode_languageserver_protocol_1.WatchKind.Change) !== 0;\r\n                watchDelete = (watcher.kind & vscode_languageserver_protocol_1.WatchKind.Delete) !== 0;\r\n            }\r\n            let fileSystemWatcher = vscode_1.workspace.createFileSystemWatcher(watcher.globPattern, !watchCreate, !watchChange, !watchDelete);\r\n            this.hookListeners(fileSystemWatcher, watchCreate, watchChange, watchDelete);\r\n            disposeables.push(fileSystemWatcher);\r\n        }\r\n        this._watchers.set(data.id, disposeables);\r\n    }\r\n    registerRaw(id, fileSystemWatchers) {\r\n        let disposeables = [];\r\n        for (let fileSystemWatcher of fileSystemWatchers) {\r\n            this.hookListeners(fileSystemWatcher, true, true, true, disposeables);\r\n        }\r\n        this._watchers.set(id, disposeables);\r\n    }\r\n    hookListeners(fileSystemWatcher, watchCreate, watchChange, watchDelete, listeners) {\r\n        if (watchCreate) {\r\n            fileSystemWatcher.onDidCreate((resource) => this._notifyFileEvent({\r\n                uri: this._client.code2ProtocolConverter.asUri(resource),\r\n                type: vscode_languageserver_protocol_1.FileChangeType.Created\r\n            }), null, listeners);\r\n        }\r\n        if (watchChange) {\r\n            fileSystemWatcher.onDidChange((resource) => this._notifyFileEvent({\r\n                uri: this._client.code2ProtocolConverter.asUri(resource),\r\n                type: vscode_languageserver_protocol_1.FileChangeType.Changed\r\n            }), null, listeners);\r\n        }\r\n        if (watchDelete) {\r\n            fileSystemWatcher.onDidDelete((resource) => this._notifyFileEvent({\r\n                uri: this._client.code2ProtocolConverter.asUri(resource),\r\n                type: vscode_languageserver_protocol_1.FileChangeType.Deleted\r\n            }), null, listeners);\r\n        }\r\n    }\r\n    unregister(id) {\r\n        let disposeables = this._watchers.get(id);\r\n        if (disposeables) {\r\n            for (let disposable of disposeables) {\r\n                disposable.dispose();\r\n            }\r\n        }\r\n    }\r\n    dispose() {\r\n        this._watchers.forEach((disposeables) => {\r\n            for (let disposable of disposeables) {\r\n                disposable.dispose();\r\n            }\r\n        });\r\n        this._watchers.clear();\r\n    }\r\n}\r\nclass TextDocumentFeature {\r\n    constructor(_client, _message) {\r\n        this._client = _client;\r\n        this._message = _message;\r\n        this._registrations = new Map();\r\n    }\r\n    get messages() {\r\n        return this._message;\r\n    }\r\n    register(message, data) {\r\n        if (message.method !== this.messages.method) {\r\n            throw new Error(`Register called on wrong feature. Requested ${message.method} but reached feature ${this.messages.method}`);\r\n        }\r\n        if (!data.registerOptions.documentSelector) {\r\n            return;\r\n        }\r\n        let registration = this.registerLanguageProvider(data.registerOptions);\r\n        this._registrations.set(data.id, { disposable: registration[0], data, provider: registration[1] });\r\n    }\r\n    unregister(id) {\r\n        let registration = this._registrations.get(id);\r\n        if (registration !== undefined) {\r\n            registration.disposable.dispose();\r\n        }\r\n    }\r\n    dispose() {\r\n        this._registrations.forEach((value) => {\r\n            value.disposable.dispose();\r\n        });\r\n        this._registrations.clear();\r\n    }\r\n    getRegistration(documentSelector, capability) {\r\n        if (!capability) {\r\n            return [undefined, undefined];\r\n        }\r\n        else if (vscode_languageserver_protocol_1.TextDocumentRegistrationOptions.is(capability)) {\r\n            const id = vscode_languageserver_protocol_1.StaticRegistrationOptions.hasId(capability) ? capability.id : UUID.generateUuid();\r\n            const selector = capability.documentSelector || documentSelector;\r\n            if (selector) {\r\n                return [id, Object.assign({}, capability, { documentSelector: selector })];\r\n            }\r\n        }\r\n        else if (Is.boolean(capability) && capability === true || vscode_languageserver_protocol_1.WorkDoneProgressOptions.is(capability)) {\r\n            if (!documentSelector) {\r\n                return [undefined, undefined];\r\n            }\r\n            let options = (Is.boolean(capability) && capability === true ? { documentSelector } : Object.assign({}, capability, { documentSelector }));\r\n            return [UUID.generateUuid(), options];\r\n        }\r\n        return [undefined, undefined];\r\n    }\r\n    getRegistrationOptions(documentSelector, capability) {\r\n        if (!documentSelector || !capability) {\r\n            return undefined;\r\n        }\r\n        return (Is.boolean(capability) && capability === true ? { documentSelector } : Object.assign({}, capability, { documentSelector }));\r\n    }\r\n    getProvider(textDocument) {\r\n        for (const registration of this._registrations.values()) {\r\n            let selector = registration.data.registerOptions.documentSelector;\r\n            if (selector !== null && vscode_1.languages.match(selector, textDocument)) {\r\n                return registration.provider;\r\n            }\r\n        }\r\n        throw new Error(`The feature has no registration for the provided text document ${textDocument.uri.toString()}`);\r\n    }\r\n}\r\nexports.TextDocumentFeature = TextDocumentFeature;\r\nclass WorkspaceFeature {\r\n    constructor(_client, _message) {\r\n        this._client = _client;\r\n        this._message = _message;\r\n        this._registrations = new Map();\r\n    }\r\n    get messages() {\r\n        return this._message;\r\n    }\r\n    register(message, data) {\r\n        if (message.method !== this.messages.method) {\r\n            throw new Error(`Register called on wron feature. Requested ${message.method} but reached feature ${this.messages.method}`);\r\n        }\r\n        const registration = this.registerLanguageProvider(data.registerOptions);\r\n        this._registrations.set(data.id, { disposable: registration[0], provider: registration[1] });\r\n    }\r\n    unregister(id) {\r\n        let registration = this._registrations.get(id);\r\n        if (registration !== undefined) {\r\n            registration.disposable.dispose();\r\n        }\r\n    }\r\n    dispose() {\r\n        this._registrations.forEach((registration) => {\r\n            registration.disposable.dispose();\r\n        });\r\n        this._registrations.clear();\r\n    }\r\n    getProviders() {\r\n        const result = [];\r\n        for (const registration of this._registrations.values()) {\r\n            result.push(registration.provider);\r\n        }\r\n        return result;\r\n    }\r\n}\r\nclass CompletionItemFeature extends TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.CompletionRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        let completion = ensure(ensure(capabilites, 'textDocument'), 'completion');\r\n        completion.dynamicRegistration = true;\r\n        completion.contextSupport = true;\r\n        completion.completionItem = {\r\n            snippetSupport: true,\r\n            commitCharactersSupport: true,\r\n            documentationFormat: [vscode_languageserver_protocol_1.MarkupKind.Markdown, vscode_languageserver_protocol_1.MarkupKind.PlainText],\r\n            deprecatedSupport: true,\r\n            preselectSupport: true,\r\n            tagSupport: { valueSet: [vscode_languageserver_protocol_1.CompletionItemTag.Deprecated] }\r\n        };\r\n        completion.completionItemKind = { valueSet: SupportedCompletionItemKinds };\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const options = this.getRegistrationOptions(documentSelector, capabilities.completionProvider);\r\n        if (!options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, {\r\n            id: UUID.generateUuid(),\r\n            registerOptions: options\r\n        });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const triggerCharacters = options.triggerCharacters || [];\r\n        const provider = {\r\n            provideCompletionItems: (document, position, token, context) => {\r\n                const client = this._client;\r\n                const middleware = this._client.clientOptions.middleware;\r\n                const provideCompletionItems = (document, position, context, token) => {\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.CompletionRequest.type, client.code2ProtocolConverter.asCompletionParams(document, position, context), token).then(client.protocol2CodeConverter.asCompletionResult, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.CompletionRequest.type, error);\r\n                        return Promise.resolve([]);\r\n                    });\r\n                };\r\n                return middleware.provideCompletionItem\r\n                    ? middleware.provideCompletionItem(document, position, context, token, provideCompletionItems)\r\n                    : provideCompletionItems(document, position, context, token);\r\n            },\r\n            resolveCompletionItem: options.resolveProvider\r\n                ? (item, token) => {\r\n                    const client = this._client;\r\n                    const middleware = this._client.clientOptions.middleware;\r\n                    const resolveCompletionItem = (item, token) => {\r\n                        return client.sendRequest(vscode_languageserver_protocol_1.CompletionResolveRequest.type, client.code2ProtocolConverter.asCompletionItem(item), token).then(client.protocol2CodeConverter.asCompletionItem, (error) => {\r\n                            client.logFailedRequest(vscode_languageserver_protocol_1.CompletionResolveRequest.type, error);\r\n                            return Promise.resolve(item);\r\n                        });\r\n                    };\r\n                    return middleware.resolveCompletionItem\r\n                        ? middleware.resolveCompletionItem(item, token, resolveCompletionItem)\r\n                        : resolveCompletionItem(item, token);\r\n                }\r\n                : undefined\r\n        };\r\n        return [vscode_1.languages.registerCompletionItemProvider(options.documentSelector, provider, ...triggerCharacters), provider];\r\n    }\r\n}\r\nclass HoverFeature extends TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.HoverRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        const hoverCapability = (ensure(ensure(capabilites, 'textDocument'), 'hover'));\r\n        hoverCapability.dynamicRegistration = true;\r\n        hoverCapability.contentFormat = [vscode_languageserver_protocol_1.MarkupKind.Markdown, vscode_languageserver_protocol_1.MarkupKind.PlainText];\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const options = this.getRegistrationOptions(documentSelector, capabilities.hoverProvider);\r\n        if (!options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, {\r\n            id: UUID.generateUuid(),\r\n            registerOptions: options\r\n        });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideHover: (document, position, token) => {\r\n                const client = this._client;\r\n                const provideHover = (document, position, token) => {\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.HoverRequest.type, client.code2ProtocolConverter.asTextDocumentPositionParams(document, position), token).then(client.protocol2CodeConverter.asHover, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.HoverRequest.type, error);\r\n                        return Promise.resolve(null);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideHover\r\n                    ? middleware.provideHover(document, position, token, provideHover)\r\n                    : provideHover(document, position, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerHoverProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nclass SignatureHelpFeature extends TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.SignatureHelpRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        let config = ensure(ensure(capabilites, 'textDocument'), 'signatureHelp');\r\n        config.dynamicRegistration = true;\r\n        config.signatureInformation = { documentationFormat: [vscode_languageserver_protocol_1.MarkupKind.Markdown, vscode_languageserver_protocol_1.MarkupKind.PlainText] };\r\n        config.signatureInformation.parameterInformation = { labelOffsetSupport: true };\r\n        config.contextSupport = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const options = this.getRegistrationOptions(documentSelector, capabilities.signatureHelpProvider);\r\n        if (!options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, {\r\n            id: UUID.generateUuid(),\r\n            registerOptions: options\r\n        });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideSignatureHelp: (document, position, token, context) => {\r\n                const client = this._client;\r\n                const providerSignatureHelp = (document, position, context, token) => {\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.SignatureHelpRequest.type, client.code2ProtocolConverter.asSignatureHelpParams(document, position, context), token).then(client.protocol2CodeConverter.asSignatureHelp, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.SignatureHelpRequest.type, error);\r\n                        return Promise.resolve(null);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideSignatureHelp\r\n                    ? middleware.provideSignatureHelp(document, position, context, token, providerSignatureHelp)\r\n                    : providerSignatureHelp(document, position, context, token);\r\n            }\r\n        };\r\n        let disposable;\r\n        if (options.retriggerCharacters === undefined) {\r\n            const triggerCharacters = options.triggerCharacters || [];\r\n            disposable = vscode_1.languages.registerSignatureHelpProvider(options.documentSelector, provider, ...triggerCharacters);\r\n        }\r\n        else {\r\n            const metaData = {\r\n                triggerCharacters: options.triggerCharacters || [],\r\n                retriggerCharacters: options.retriggerCharacters || []\r\n            };\r\n            disposable = vscode_1.languages.registerSignatureHelpProvider(options.documentSelector, provider, metaData);\r\n        }\r\n        return [disposable, provider];\r\n    }\r\n}\r\nclass DefinitionFeature extends TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.DefinitionRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        let definitionSupport = ensure(ensure(capabilites, 'textDocument'), 'definition');\r\n        definitionSupport.dynamicRegistration = true;\r\n        definitionSupport.linkSupport = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const options = this.getRegistrationOptions(documentSelector, capabilities.definitionProvider);\r\n        if (!options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: UUID.generateUuid(), registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideDefinition: (document, position, token) => {\r\n                const client = this._client;\r\n                const provideDefinition = (document, position, token) => {\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.DefinitionRequest.type, client.code2ProtocolConverter.asTextDocumentPositionParams(document, position), token).then(client.protocol2CodeConverter.asDefinitionResult, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.DefinitionRequest.type, error);\r\n                        return Promise.resolve(null);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideDefinition\r\n                    ? middleware.provideDefinition(document, position, token, provideDefinition)\r\n                    : provideDefinition(document, position, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerDefinitionProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nclass ReferencesFeature extends TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.ReferencesRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        ensure(ensure(capabilites, 'textDocument'), 'references').dynamicRegistration = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const options = this.getRegistrationOptions(documentSelector, capabilities.referencesProvider);\r\n        if (!options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: UUID.generateUuid(), registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideReferences: (document, position, options, token) => {\r\n                const client = this._client;\r\n                const _providerReferences = (document, position, options, token) => {\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.ReferencesRequest.type, client.code2ProtocolConverter.asReferenceParams(document, position, options), token).then(client.protocol2CodeConverter.asReferences, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.ReferencesRequest.type, error);\r\n                        return Promise.resolve([]);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideReferences\r\n                    ? middleware.provideReferences(document, position, options, token, _providerReferences)\r\n                    : _providerReferences(document, position, options, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerReferenceProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nclass DocumentHighlightFeature extends TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.DocumentHighlightRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        ensure(ensure(capabilites, 'textDocument'), 'documentHighlight').dynamicRegistration = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const options = this.getRegistrationOptions(documentSelector, capabilities.documentHighlightProvider);\r\n        if (!options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: UUID.generateUuid(), registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideDocumentHighlights: (document, position, token) => {\r\n                const client = this._client;\r\n                const _provideDocumentHighlights = (document, position, token) => {\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.DocumentHighlightRequest.type, client.code2ProtocolConverter.asTextDocumentPositionParams(document, position), token).then(client.protocol2CodeConverter.asDocumentHighlights, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.DocumentHighlightRequest.type, error);\r\n                        return Promise.resolve([]);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideDocumentHighlights\r\n                    ? middleware.provideDocumentHighlights(document, position, token, _provideDocumentHighlights)\r\n                    : _provideDocumentHighlights(document, position, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerDocumentHighlightProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nclass DocumentSymbolFeature extends TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.DocumentSymbolRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        let symbolCapabilities = ensure(ensure(capabilites, 'textDocument'), 'documentSymbol');\r\n        symbolCapabilities.dynamicRegistration = true;\r\n        symbolCapabilities.symbolKind = {\r\n            valueSet: SupportedSymbolKinds\r\n        };\r\n        symbolCapabilities.hierarchicalDocumentSymbolSupport = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const options = this.getRegistrationOptions(documentSelector, capabilities.documentSymbolProvider);\r\n        if (!options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: UUID.generateUuid(), registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideDocumentSymbols: (document, token) => {\r\n                const client = this._client;\r\n                const _provideDocumentSymbols = (document, token) => {\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.DocumentSymbolRequest.type, client.code2ProtocolConverter.asDocumentSymbolParams(document), token).then((data) => {\r\n                        if (data === null) {\r\n                            return undefined;\r\n                        }\r\n                        if (data.length === 0) {\r\n                            return [];\r\n                        }\r\n                        else {\r\n                            let element = data[0];\r\n                            if (vscode_languageserver_protocol_1.DocumentSymbol.is(element)) {\r\n                                return client.protocol2CodeConverter.asDocumentSymbols(data);\r\n                            }\r\n                            else {\r\n                                return client.protocol2CodeConverter.asSymbolInformations(data);\r\n                            }\r\n                        }\r\n                    }, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.DocumentSymbolRequest.type, error);\r\n                        return Promise.resolve([]);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideDocumentSymbols\r\n                    ? middleware.provideDocumentSymbols(document, token, _provideDocumentSymbols)\r\n                    : _provideDocumentSymbols(document, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerDocumentSymbolProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nclass WorkspaceSymbolFeature extends WorkspaceFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.WorkspaceSymbolRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        let symbolCapabilities = ensure(ensure(capabilites, 'workspace'), 'symbol');\r\n        symbolCapabilities.dynamicRegistration = true;\r\n        symbolCapabilities.symbolKind = {\r\n            valueSet: SupportedSymbolKinds\r\n        };\r\n    }\r\n    initialize(capabilities) {\r\n        if (!capabilities.workspaceSymbolProvider) {\r\n            return;\r\n        }\r\n        this.register(this.messages, {\r\n            id: UUID.generateUuid(),\r\n            registerOptions: capabilities.workspaceSymbolProvider === true ? { workDoneProgress: false } : capabilities.workspaceSymbolProvider\r\n        });\r\n    }\r\n    registerLanguageProvider(_options) {\r\n        const provider = {\r\n            provideWorkspaceSymbols: (query, token) => {\r\n                const client = this._client;\r\n                const provideWorkspaceSymbols = (query, token) => {\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.WorkspaceSymbolRequest.type, { query }, token).then(client.protocol2CodeConverter.asSymbolInformations, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.WorkspaceSymbolRequest.type, error);\r\n                        return Promise.resolve([]);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideWorkspaceSymbols\r\n                    ? middleware.provideWorkspaceSymbols(query, token, provideWorkspaceSymbols)\r\n                    : provideWorkspaceSymbols(query, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerWorkspaceSymbolProvider(provider), provider];\r\n    }\r\n}\r\nclass CodeActionFeature extends TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.CodeActionRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        const cap = ensure(ensure(capabilites, 'textDocument'), 'codeAction');\r\n        cap.dynamicRegistration = true;\r\n        cap.isPreferredSupport = true;\r\n        cap.codeActionLiteralSupport = {\r\n            codeActionKind: {\r\n                valueSet: [\r\n                    vscode_languageserver_protocol_1.CodeActionKind.Empty,\r\n                    vscode_languageserver_protocol_1.CodeActionKind.QuickFix,\r\n                    vscode_languageserver_protocol_1.CodeActionKind.Refactor,\r\n                    vscode_languageserver_protocol_1.CodeActionKind.RefactorExtract,\r\n                    vscode_languageserver_protocol_1.CodeActionKind.RefactorInline,\r\n                    vscode_languageserver_protocol_1.CodeActionKind.RefactorRewrite,\r\n                    vscode_languageserver_protocol_1.CodeActionKind.Source,\r\n                    vscode_languageserver_protocol_1.CodeActionKind.SourceOrganizeImports\r\n                ]\r\n            }\r\n        };\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const options = this.getRegistrationOptions(documentSelector, capabilities.codeActionProvider);\r\n        if (!options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: UUID.generateUuid(), registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideCodeActions: (document, range, context, token) => {\r\n                const client = this._client;\r\n                const _provideCodeActions = (document, range, context, token) => {\r\n                    const params = {\r\n                        textDocument: client.code2ProtocolConverter.asTextDocumentIdentifier(document),\r\n                        range: client.code2ProtocolConverter.asRange(range),\r\n                        context: client.code2ProtocolConverter.asCodeActionContext(context)\r\n                    };\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.CodeActionRequest.type, params, token).then((values) => {\r\n                        if (values === null) {\r\n                            return undefined;\r\n                        }\r\n                        const result = [];\r\n                        for (let item of values) {\r\n                            if (vscode_languageserver_protocol_1.Command.is(item)) {\r\n                                result.push(client.protocol2CodeConverter.asCommand(item));\r\n                            }\r\n                            else {\r\n                                result.push(client.protocol2CodeConverter.asCodeAction(item));\r\n                            }\r\n                        }\r\n                        return result;\r\n                    }, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.CodeActionRequest.type, error);\r\n                        return Promise.resolve([]);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideCodeActions\r\n                    ? middleware.provideCodeActions(document, range, context, token, _provideCodeActions)\r\n                    : _provideCodeActions(document, range, context, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerCodeActionsProvider(options.documentSelector, provider, (options.codeActionKinds\r\n                ? { providedCodeActionKinds: this._client.protocol2CodeConverter.asCodeActionKinds(options.codeActionKinds) }\r\n                : undefined)), provider];\r\n    }\r\n}\r\nclass CodeLensFeature extends TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.CodeLensRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        ensure(ensure(capabilites, 'textDocument'), 'codeLens').dynamicRegistration = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const options = this.getRegistrationOptions(documentSelector, capabilities.codeLensProvider);\r\n        if (!options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: UUID.generateUuid(), registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideCodeLenses: (document, token) => {\r\n                const client = this._client;\r\n                const provideCodeLenses = (document, token) => {\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.CodeLensRequest.type, client.code2ProtocolConverter.asCodeLensParams(document), token).then(client.protocol2CodeConverter.asCodeLenses, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.CodeLensRequest.type, error);\r\n                        return Promise.resolve([]);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideCodeLenses\r\n                    ? middleware.provideCodeLenses(document, token, provideCodeLenses)\r\n                    : provideCodeLenses(document, token);\r\n            },\r\n            resolveCodeLens: (options.resolveProvider)\r\n                ? (codeLens, token) => {\r\n                    const client = this._client;\r\n                    const resolveCodeLens = (codeLens, token) => {\r\n                        return client.sendRequest(vscode_languageserver_protocol_1.CodeLensResolveRequest.type, client.code2ProtocolConverter.asCodeLens(codeLens), token).then(client.protocol2CodeConverter.asCodeLens, (error) => {\r\n                            client.logFailedRequest(vscode_languageserver_protocol_1.CodeLensResolveRequest.type, error);\r\n                            return codeLens;\r\n                        });\r\n                    };\r\n                    const middleware = client.clientOptions.middleware;\r\n                    return middleware.resolveCodeLens\r\n                        ? middleware.resolveCodeLens(codeLens, token, resolveCodeLens)\r\n                        : resolveCodeLens(codeLens, token);\r\n                }\r\n                : undefined\r\n        };\r\n        return [vscode_1.languages.registerCodeLensProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nclass DocumentFormattingFeature extends TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.DocumentFormattingRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        ensure(ensure(capabilites, 'textDocument'), 'formatting').dynamicRegistration = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const options = this.getRegistrationOptions(documentSelector, capabilities.documentFormattingProvider);\r\n        if (!options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: UUID.generateUuid(), registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideDocumentFormattingEdits: (document, options, token) => {\r\n                const client = this._client;\r\n                const provideDocumentFormattingEdits = (document, options, token) => {\r\n                    const params = {\r\n                        textDocument: client.code2ProtocolConverter.asTextDocumentIdentifier(document),\r\n                        options: client.code2ProtocolConverter.asFormattingOptions(options)\r\n                    };\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.DocumentFormattingRequest.type, params, token).then(client.protocol2CodeConverter.asTextEdits, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.DocumentFormattingRequest.type, error);\r\n                        return Promise.resolve([]);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideDocumentFormattingEdits\r\n                    ? middleware.provideDocumentFormattingEdits(document, options, token, provideDocumentFormattingEdits)\r\n                    : provideDocumentFormattingEdits(document, options, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerDocumentFormattingEditProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nclass DocumentRangeFormattingFeature extends TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.DocumentRangeFormattingRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        ensure(ensure(capabilites, 'textDocument'), 'rangeFormatting').dynamicRegistration = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const options = this.getRegistrationOptions(documentSelector, capabilities.documentRangeFormattingProvider);\r\n        if (!options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: UUID.generateUuid(), registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideDocumentRangeFormattingEdits: (document, range, options, token) => {\r\n                const client = this._client;\r\n                const provideDocumentRangeFormattingEdits = (document, range, options, token) => {\r\n                    let params = {\r\n                        textDocument: client.code2ProtocolConverter.asTextDocumentIdentifier(document),\r\n                        range: client.code2ProtocolConverter.asRange(range),\r\n                        options: client.code2ProtocolConverter.asFormattingOptions(options)\r\n                    };\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.DocumentRangeFormattingRequest.type, params, token).then(client.protocol2CodeConverter.asTextEdits, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.DocumentRangeFormattingRequest.type, error);\r\n                        return Promise.resolve([]);\r\n                    });\r\n                };\r\n                let middleware = client.clientOptions.middleware;\r\n                return middleware.provideDocumentRangeFormattingEdits\r\n                    ? middleware.provideDocumentRangeFormattingEdits(document, range, options, token, provideDocumentRangeFormattingEdits)\r\n                    : provideDocumentRangeFormattingEdits(document, range, options, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerDocumentRangeFormattingEditProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nclass DocumentOnTypeFormattingFeature extends TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.DocumentOnTypeFormattingRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        ensure(ensure(capabilites, 'textDocument'), 'onTypeFormatting').dynamicRegistration = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const options = this.getRegistrationOptions(documentSelector, capabilities.documentOnTypeFormattingProvider);\r\n        if (!options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: UUID.generateUuid(), registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideOnTypeFormattingEdits: (document, position, ch, options, token) => {\r\n                const client = this._client;\r\n                const provideOnTypeFormattingEdits = (document, position, ch, options, token) => {\r\n                    let params = {\r\n                        textDocument: client.code2ProtocolConverter.asTextDocumentIdentifier(document),\r\n                        position: client.code2ProtocolConverter.asPosition(position),\r\n                        ch: ch,\r\n                        options: client.code2ProtocolConverter.asFormattingOptions(options)\r\n                    };\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.DocumentOnTypeFormattingRequest.type, params, token).then(client.protocol2CodeConverter.asTextEdits, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.DocumentOnTypeFormattingRequest.type, error);\r\n                        return Promise.resolve([]);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideOnTypeFormattingEdits\r\n                    ? middleware.provideOnTypeFormattingEdits(document, position, ch, options, token, provideOnTypeFormattingEdits)\r\n                    : provideOnTypeFormattingEdits(document, position, ch, options, token);\r\n            }\r\n        };\r\n        const moreTriggerCharacter = options.moreTriggerCharacter || [];\r\n        return [vscode_1.languages.registerOnTypeFormattingEditProvider(options.documentSelector, provider, options.firstTriggerCharacter, ...moreTriggerCharacter), provider];\r\n    }\r\n}\r\nclass RenameFeature extends TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.RenameRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        let rename = ensure(ensure(capabilites, 'textDocument'), 'rename');\r\n        rename.dynamicRegistration = true;\r\n        rename.prepareSupport = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const options = this.getRegistrationOptions(documentSelector, capabilities.renameProvider);\r\n        if (!options) {\r\n            return;\r\n        }\r\n        if (Is.boolean(capabilities.renameProvider)) {\r\n            options.prepareProvider = false;\r\n        }\r\n        this.register(this.messages, { id: UUID.generateUuid(), registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideRenameEdits: (document, position, newName, token) => {\r\n                const client = this._client;\r\n                const provideRenameEdits = (document, position, newName, token) => {\r\n                    let params = {\r\n                        textDocument: client.code2ProtocolConverter.asTextDocumentIdentifier(document),\r\n                        position: client.code2ProtocolConverter.asPosition(position),\r\n                        newName: newName\r\n                    };\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.RenameRequest.type, params, token).then(client.protocol2CodeConverter.asWorkspaceEdit, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.RenameRequest.type, error);\r\n                        return Promise.reject(new Error(error.message));\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideRenameEdits\r\n                    ? middleware.provideRenameEdits(document, position, newName, token, provideRenameEdits)\r\n                    : provideRenameEdits(document, position, newName, token);\r\n            },\r\n            prepareRename: options.prepareProvider\r\n                ? (document, position, token) => {\r\n                    const client = this._client;\r\n                    const prepareRename = (document, position, token) => {\r\n                        let params = {\r\n                            textDocument: client.code2ProtocolConverter.asTextDocumentIdentifier(document),\r\n                            position: client.code2ProtocolConverter.asPosition(position),\r\n                        };\r\n                        return client.sendRequest(vscode_languageserver_protocol_1.PrepareRenameRequest.type, params, token).then((result) => {\r\n                            if (vscode_languageserver_protocol_1.Range.is(result)) {\r\n                                return client.protocol2CodeConverter.asRange(result);\r\n                            }\r\n                            else if (result && vscode_languageserver_protocol_1.Range.is(result.range)) {\r\n                                return {\r\n                                    range: client.protocol2CodeConverter.asRange(result.range),\r\n                                    placeholder: result.placeholder\r\n                                };\r\n                            }\r\n                            // To cancel the rename vscode API expects a rejected promise.\r\n                            return Promise.reject(new Error(`The element can't be renamed.`));\r\n                        }, (error) => {\r\n                            client.logFailedRequest(vscode_languageserver_protocol_1.PrepareRenameRequest.type, error);\r\n                            return Promise.reject(new Error(error.message));\r\n                        });\r\n                    };\r\n                    const middleware = client.clientOptions.middleware;\r\n                    return middleware.prepareRename\r\n                        ? middleware.prepareRename(document, position, token, prepareRename)\r\n                        : prepareRename(document, position, token);\r\n                }\r\n                : undefined\r\n        };\r\n        return [vscode_1.languages.registerRenameProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nclass DocumentLinkFeature extends TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.DocumentLinkRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        const documentLinkCapabilities = ensure(ensure(capabilites, 'textDocument'), 'documentLink');\r\n        documentLinkCapabilities.dynamicRegistration = true;\r\n        documentLinkCapabilities.tooltipSupport = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const options = this.getRegistrationOptions(documentSelector, capabilities.documentLinkProvider);\r\n        if (!options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: UUID.generateUuid(), registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideDocumentLinks: (document, token) => {\r\n                const client = this._client;\r\n                const provideDocumentLinks = (document, token) => {\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.DocumentLinkRequest.type, client.code2ProtocolConverter.asDocumentLinkParams(document), token).then(client.protocol2CodeConverter.asDocumentLinks, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.DocumentLinkRequest.type, error);\r\n                        return Promise.resolve([]);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideDocumentLinks\r\n                    ? middleware.provideDocumentLinks(document, token, provideDocumentLinks)\r\n                    : provideDocumentLinks(document, token);\r\n            },\r\n            resolveDocumentLink: options.resolveProvider\r\n                ? (link, token) => {\r\n                    const client = this._client;\r\n                    let resolveDocumentLink = (link, token) => {\r\n                        return client.sendRequest(vscode_languageserver_protocol_1.DocumentLinkResolveRequest.type, client.code2ProtocolConverter.asDocumentLink(link), token).then(client.protocol2CodeConverter.asDocumentLink, (error) => {\r\n                            client.logFailedRequest(vscode_languageserver_protocol_1.DocumentLinkResolveRequest.type, error);\r\n                            return Promise.resolve(link);\r\n                        });\r\n                    };\r\n                    const middleware = client.clientOptions.middleware;\r\n                    return middleware.resolveDocumentLink\r\n                        ? middleware.resolveDocumentLink(link, token, resolveDocumentLink)\r\n                        : resolveDocumentLink(link, token);\r\n                }\r\n                : undefined\r\n        };\r\n        return [vscode_1.languages.registerDocumentLinkProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nclass ConfigurationFeature {\r\n    constructor(_client) {\r\n        this._client = _client;\r\n        this._listeners = new Map();\r\n    }\r\n    get messages() {\r\n        return vscode_languageserver_protocol_1.DidChangeConfigurationNotification.type;\r\n    }\r\n    fillClientCapabilities(capabilities) {\r\n        ensure(ensure(capabilities, 'workspace'), 'didChangeConfiguration').dynamicRegistration = true;\r\n    }\r\n    initialize() {\r\n        let section = this._client.clientOptions.synchronize.configurationSection;\r\n        if (section !== void 0) {\r\n            this.register(this.messages, {\r\n                id: UUID.generateUuid(),\r\n                registerOptions: {\r\n                    section: section\r\n                }\r\n            });\r\n        }\r\n    }\r\n    register(_message, data) {\r\n        let disposable = vscode_1.workspace.onDidChangeConfiguration((event) => {\r\n            this.onDidChangeConfiguration(data.registerOptions.section, event);\r\n        });\r\n        this._listeners.set(data.id, disposable);\r\n        if (data.registerOptions.section !== void 0) {\r\n            this.onDidChangeConfiguration(data.registerOptions.section, undefined);\r\n        }\r\n    }\r\n    unregister(id) {\r\n        let disposable = this._listeners.get(id);\r\n        if (disposable) {\r\n            this._listeners.delete(id);\r\n            disposable.dispose();\r\n        }\r\n    }\r\n    dispose() {\r\n        for (let disposable of this._listeners.values()) {\r\n            disposable.dispose();\r\n        }\r\n        this._listeners.clear();\r\n    }\r\n    onDidChangeConfiguration(configurationSection, event) {\r\n        let sections;\r\n        if (Is.string(configurationSection)) {\r\n            sections = [configurationSection];\r\n        }\r\n        else {\r\n            sections = configurationSection;\r\n        }\r\n        if (sections !== void 0 && event !== void 0) {\r\n            let affected = sections.some((section) => event.affectsConfiguration(section));\r\n            if (!affected) {\r\n                return;\r\n            }\r\n        }\r\n        let didChangeConfiguration = (sections) => {\r\n            if (sections === void 0) {\r\n                this._client.sendNotification(vscode_languageserver_protocol_1.DidChangeConfigurationNotification.type, { settings: null });\r\n                return;\r\n            }\r\n            this._client.sendNotification(vscode_languageserver_protocol_1.DidChangeConfigurationNotification.type, { settings: this.extractSettingsInformation(sections) });\r\n        };\r\n        let middleware = this.getMiddleware();\r\n        middleware\r\n            ? middleware(sections, didChangeConfiguration)\r\n            : didChangeConfiguration(sections);\r\n    }\r\n    extractSettingsInformation(keys) {\r\n        function ensurePath(config, path) {\r\n            let current = config;\r\n            for (let i = 0; i < path.length - 1; i++) {\r\n                let obj = current[path[i]];\r\n                if (!obj) {\r\n                    obj = Object.create(null);\r\n                    current[path[i]] = obj;\r\n                }\r\n                current = obj;\r\n            }\r\n            return current;\r\n        }\r\n        let resource = this._client.clientOptions.workspaceFolder\r\n            ? this._client.clientOptions.workspaceFolder.uri\r\n            : undefined;\r\n        let result = Object.create(null);\r\n        for (let i = 0; i < keys.length; i++) {\r\n            let key = keys[i];\r\n            let index = key.indexOf('.');\r\n            let config = null;\r\n            if (index >= 0) {\r\n                config = vscode_1.workspace.getConfiguration(key.substr(0, index), resource).get(key.substr(index + 1));\r\n            }\r\n            else {\r\n                config = vscode_1.workspace.getConfiguration(key, resource);\r\n            }\r\n            if (config) {\r\n                let path = keys[i].split('.');\r\n                ensurePath(result, path)[path[path.length - 1]] = config;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    getMiddleware() {\r\n        let middleware = this._client.clientOptions.middleware;\r\n        if (middleware.workspace && middleware.workspace.didChangeConfiguration) {\r\n            return middleware.workspace.didChangeConfiguration;\r\n        }\r\n        else {\r\n            return undefined;\r\n        }\r\n    }\r\n}\r\nclass ExecuteCommandFeature {\r\n    constructor(_client) {\r\n        this._client = _client;\r\n        this._commands = new Map();\r\n    }\r\n    get messages() {\r\n        return vscode_languageserver_protocol_1.ExecuteCommandRequest.type;\r\n    }\r\n    fillClientCapabilities(capabilities) {\r\n        ensure(ensure(capabilities, 'workspace'), 'executeCommand').dynamicRegistration = true;\r\n    }\r\n    initialize(capabilities) {\r\n        if (!capabilities.executeCommandProvider) {\r\n            return;\r\n        }\r\n        this.register(this.messages, {\r\n            id: UUID.generateUuid(),\r\n            registerOptions: Object.assign({}, capabilities.executeCommandProvider)\r\n        });\r\n    }\r\n    register(_message, data) {\r\n        const client = this._client;\r\n        const middleware = client.clientOptions.middleware;\r\n        const executeCommand = (command, args) => {\r\n            let params = {\r\n                command,\r\n                arguments: args\r\n            };\r\n            return client.sendRequest(vscode_languageserver_protocol_1.ExecuteCommandRequest.type, params).then(undefined, (error) => {\r\n                client.logFailedRequest(vscode_languageserver_protocol_1.ExecuteCommandRequest.type, error);\r\n            });\r\n        };\r\n        if (data.registerOptions.commands) {\r\n            const disposeables = [];\r\n            for (const command of data.registerOptions.commands) {\r\n                disposeables.push(vscode_1.commands.registerCommand(command, (...args) => {\r\n                    return middleware.executeCommand\r\n                        ? middleware.executeCommand(command, args, executeCommand)\r\n                        : executeCommand(command, args);\r\n                }));\r\n            }\r\n            this._commands.set(data.id, disposeables);\r\n        }\r\n    }\r\n    unregister(id) {\r\n        let disposeables = this._commands.get(id);\r\n        if (disposeables) {\r\n            disposeables.forEach(disposable => disposable.dispose());\r\n        }\r\n    }\r\n    dispose() {\r\n        this._commands.forEach((value) => {\r\n            value.forEach(disposable => disposable.dispose());\r\n        });\r\n        this._commands.clear();\r\n    }\r\n}\r\nvar MessageTransports;\r\n(function (MessageTransports) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && vscode_languageserver_protocol_1.MessageReader.is(value.reader) && vscode_languageserver_protocol_1.MessageWriter.is(value.writer);\r\n    }\r\n    MessageTransports.is = is;\r\n})(MessageTransports = exports.MessageTransports || (exports.MessageTransports = {}));\r\nclass OnReady {\r\n    constructor(_resolve, _reject) {\r\n        this._resolve = _resolve;\r\n        this._reject = _reject;\r\n        this._used = false;\r\n    }\r\n    get isUsed() {\r\n        return this._used;\r\n    }\r\n    resolve() {\r\n        this._used = true;\r\n        this._resolve();\r\n    }\r\n    reject(error) {\r\n        this._used = true;\r\n        this._reject(error);\r\n    }\r\n}\r\nclass BaseLanguageClient {\r\n    constructor(id, name, clientOptions) {\r\n        this._traceFormat = vscode_languageserver_protocol_1.TraceFormat.Text;\r\n        this._features = [];\r\n        this._method2Message = new Map();\r\n        this._dynamicFeatures = new Map();\r\n        this._id = id;\r\n        this._name = name;\r\n        clientOptions = clientOptions || {};\r\n        this._clientOptions = {\r\n            documentSelector: clientOptions.documentSelector || [],\r\n            synchronize: clientOptions.synchronize || {},\r\n            diagnosticCollectionName: clientOptions.diagnosticCollectionName,\r\n            outputChannelName: clientOptions.outputChannelName || this._name,\r\n            revealOutputChannelOn: clientOptions.revealOutputChannelOn || RevealOutputChannelOn.Error,\r\n            stdioEncoding: clientOptions.stdioEncoding || 'utf8',\r\n            initializationOptions: clientOptions.initializationOptions,\r\n            initializationFailedHandler: clientOptions.initializationFailedHandler,\r\n            progressOnInitialization: !!clientOptions.progressOnInitialization,\r\n            errorHandler: clientOptions.errorHandler || new DefaultErrorHandler(this._name),\r\n            middleware: clientOptions.middleware || {},\r\n            uriConverters: clientOptions.uriConverters,\r\n            workspaceFolder: clientOptions.workspaceFolder\r\n        };\r\n        this._clientOptions.synchronize = this._clientOptions.synchronize || {};\r\n        this.state = ClientState.Initial;\r\n        this._connectionPromise = undefined;\r\n        this._resolvedConnection = undefined;\r\n        this._initializeResult = undefined;\r\n        if (clientOptions.outputChannel) {\r\n            this._outputChannel = clientOptions.outputChannel;\r\n            this._disposeOutputChannel = false;\r\n        }\r\n        else {\r\n            this._outputChannel = undefined;\r\n            this._disposeOutputChannel = true;\r\n        }\r\n        this._traceOutputChannel = clientOptions.traceOutputChannel;\r\n        this._listeners = undefined;\r\n        this._providers = undefined;\r\n        this._diagnostics = undefined;\r\n        this._fileEvents = [];\r\n        this._fileEventDelayer = new async_1.Delayer(250);\r\n        this._onReady = new Promise((resolve, reject) => {\r\n            this._onReadyCallbacks = new OnReady(resolve, reject);\r\n        });\r\n        this._onStop = undefined;\r\n        this._telemetryEmitter = new vscode_languageserver_protocol_1.Emitter();\r\n        this._stateChangeEmitter = new vscode_languageserver_protocol_1.Emitter();\r\n        this._tracer = {\r\n            log: (messageOrDataObject, data) => {\r\n                if (Is.string(messageOrDataObject)) {\r\n                    this.logTrace(messageOrDataObject, data);\r\n                }\r\n                else {\r\n                    this.logObjectTrace(messageOrDataObject);\r\n                }\r\n            },\r\n        };\r\n        this._c2p = c2p.createConverter(clientOptions.uriConverters ? clientOptions.uriConverters.code2Protocol : undefined);\r\n        this._p2c = p2c.createConverter(clientOptions.uriConverters ? clientOptions.uriConverters.protocol2Code : undefined);\r\n        this._syncedDocuments = new Map();\r\n        this.registerBuiltinFeatures();\r\n    }\r\n    get state() {\r\n        return this._state;\r\n    }\r\n    set state(value) {\r\n        let oldState = this.getPublicState();\r\n        this._state = value;\r\n        let newState = this.getPublicState();\r\n        if (newState !== oldState) {\r\n            this._stateChangeEmitter.fire({ oldState, newState });\r\n        }\r\n    }\r\n    getPublicState() {\r\n        if (this.state === ClientState.Running) {\r\n            return State.Running;\r\n        }\r\n        else if (this.state === ClientState.Starting) {\r\n            return State.Starting;\r\n        }\r\n        else {\r\n            return State.Stopped;\r\n        }\r\n    }\r\n    get initializeResult() {\r\n        return this._initializeResult;\r\n    }\r\n    sendRequest(type, ...params) {\r\n        if (!this.isConnectionActive()) {\r\n            throw new Error('Language client is not ready yet');\r\n        }\r\n        this.forceDocumentSync();\r\n        try {\r\n            return this._resolvedConnection.sendRequest(type, ...params);\r\n        }\r\n        catch (error) {\r\n            this.error(`Sending request ${Is.string(type) ? type : type.method} failed.`, error);\r\n            throw error;\r\n        }\r\n    }\r\n    onRequest(type, handler) {\r\n        if (!this.isConnectionActive()) {\r\n            throw new Error('Language client is not ready yet');\r\n        }\r\n        try {\r\n            this._resolvedConnection.onRequest(type, handler);\r\n        }\r\n        catch (error) {\r\n            this.error(`Registering request handler ${Is.string(type) ? type : type.method} failed.`, error);\r\n            throw error;\r\n        }\r\n    }\r\n    sendNotification(type, params) {\r\n        if (!this.isConnectionActive()) {\r\n            throw new Error('Language client is not ready yet');\r\n        }\r\n        this.forceDocumentSync();\r\n        try {\r\n            this._resolvedConnection.sendNotification(type, params);\r\n        }\r\n        catch (error) {\r\n            this.error(`Sending notification ${Is.string(type) ? type : type.method} failed.`, error);\r\n            throw error;\r\n        }\r\n    }\r\n    onNotification(type, handler) {\r\n        if (!this.isConnectionActive()) {\r\n            throw new Error('Language client is not ready yet');\r\n        }\r\n        try {\r\n            this._resolvedConnection.onNotification(type, handler);\r\n        }\r\n        catch (error) {\r\n            this.error(`Registering notification handler ${Is.string(type) ? type : type.method} failed.`, error);\r\n            throw error;\r\n        }\r\n    }\r\n    onProgress(type, token, handler) {\r\n        if (!this.isConnectionActive()) {\r\n            throw new Error('Language client is not ready yet');\r\n        }\r\n        try {\r\n            return this._resolvedConnection.onProgress(type, token, handler);\r\n        }\r\n        catch (error) {\r\n            this.error(`Registering progress handler for token ${token} failed.`, error);\r\n            throw error;\r\n        }\r\n    }\r\n    sendProgress(type, token, value) {\r\n        if (!this.isConnectionActive()) {\r\n            throw new Error('Language client is not ready yet');\r\n        }\r\n        this.forceDocumentSync();\r\n        try {\r\n            this._resolvedConnection.sendProgress(type, token, value);\r\n        }\r\n        catch (error) {\r\n            this.error(`Sending progress for token ${token} failed.`, error);\r\n            throw error;\r\n        }\r\n    }\r\n    get clientOptions() {\r\n        return this._clientOptions;\r\n    }\r\n    get protocol2CodeConverter() {\r\n        return this._p2c;\r\n    }\r\n    get code2ProtocolConverter() {\r\n        return this._c2p;\r\n    }\r\n    get onTelemetry() {\r\n        return this._telemetryEmitter.event;\r\n    }\r\n    get onDidChangeState() {\r\n        return this._stateChangeEmitter.event;\r\n    }\r\n    get outputChannel() {\r\n        if (!this._outputChannel) {\r\n            this._outputChannel = vscode_1.window.createOutputChannel(this._clientOptions.outputChannelName ? this._clientOptions.outputChannelName : this._name);\r\n        }\r\n        return this._outputChannel;\r\n    }\r\n    get traceOutputChannel() {\r\n        if (this._traceOutputChannel) {\r\n            return this._traceOutputChannel;\r\n        }\r\n        return this.outputChannel;\r\n    }\r\n    get diagnostics() {\r\n        return this._diagnostics;\r\n    }\r\n    createDefaultErrorHandler() {\r\n        return new DefaultErrorHandler(this._name);\r\n    }\r\n    set trace(value) {\r\n        this._trace = value;\r\n        this.onReady().then(() => {\r\n            this.resolveConnection().then((connection) => {\r\n                connection.trace(this._trace, this._tracer, {\r\n                    sendNotification: false,\r\n                    traceFormat: this._traceFormat\r\n                });\r\n            });\r\n        }, () => {\r\n        });\r\n    }\r\n    data2String(data) {\r\n        if (data instanceof vscode_languageserver_protocol_1.ResponseError) {\r\n            const responseError = data;\r\n            return `  Message: ${responseError.message}\\n  Code: ${responseError.code} ${responseError.data ? '\\n' + responseError.data.toString() : ''}`;\r\n        }\r\n        if (data instanceof Error) {\r\n            if (Is.string(data.stack)) {\r\n                return data.stack;\r\n            }\r\n            return data.message;\r\n        }\r\n        if (Is.string(data)) {\r\n            return data;\r\n        }\r\n        return data.toString();\r\n    }\r\n    info(message, data, showNotification = true) {\r\n        this.outputChannel.appendLine(`[Info  - ${(new Date().toLocaleTimeString())}] ${message}`);\r\n        if (data) {\r\n            this.outputChannel.appendLine(this.data2String(data));\r\n        }\r\n        if (showNotification && this._clientOptions.revealOutputChannelOn <= RevealOutputChannelOn.Info) {\r\n            this.showNotificationMessage();\r\n        }\r\n    }\r\n    warn(message, data, showNotification = true) {\r\n        this.outputChannel.appendLine(`[Warn  - ${(new Date().toLocaleTimeString())}] ${message}`);\r\n        if (data) {\r\n            this.outputChannel.appendLine(this.data2String(data));\r\n        }\r\n        if (showNotification && this._clientOptions.revealOutputChannelOn <= RevealOutputChannelOn.Warn) {\r\n            this.showNotificationMessage();\r\n        }\r\n    }\r\n    error(message, data, showNotification = true) {\r\n        this.outputChannel.appendLine(`[Error - ${(new Date().toLocaleTimeString())}] ${message}`);\r\n        if (data) {\r\n            this.outputChannel.appendLine(this.data2String(data));\r\n        }\r\n        if (showNotification && this._clientOptions.revealOutputChannelOn <= RevealOutputChannelOn.Error) {\r\n            this.showNotificationMessage();\r\n        }\r\n    }\r\n    showNotificationMessage() {\r\n        vscode_1.window.showInformationMessage('A request has failed. See the output for more information.', 'Go to output').then(() => {\r\n            this.outputChannel.show(true);\r\n        });\r\n    }\r\n    logTrace(message, data) {\r\n        this.traceOutputChannel.appendLine(`[Trace - ${(new Date().toLocaleTimeString())}] ${message}`);\r\n        if (data) {\r\n            this.traceOutputChannel.appendLine(this.data2String(data));\r\n        }\r\n    }\r\n    logObjectTrace(data) {\r\n        if (data.isLSPMessage && data.type) {\r\n            this.traceOutputChannel.append(`[LSP   - ${(new Date().toLocaleTimeString())}] `);\r\n        }\r\n        else {\r\n            this.traceOutputChannel.append(`[Trace - ${(new Date().toLocaleTimeString())}] `);\r\n        }\r\n        if (data) {\r\n            this.traceOutputChannel.appendLine(`${JSON.stringify(data)}`);\r\n        }\r\n    }\r\n    needsStart() {\r\n        return this.state === ClientState.Initial || this.state === ClientState.Stopping || this.state === ClientState.Stopped;\r\n    }\r\n    needsStop() {\r\n        return this.state === ClientState.Starting || this.state === ClientState.Running;\r\n    }\r\n    onReady() {\r\n        return this._onReady;\r\n    }\r\n    isConnectionActive() {\r\n        return this.state === ClientState.Running && !!this._resolvedConnection;\r\n    }\r\n    start() {\r\n        if (this._onReadyCallbacks.isUsed) {\r\n            this._onReady = new Promise((resolve, reject) => {\r\n                this._onReadyCallbacks = new OnReady(resolve, reject);\r\n            });\r\n        }\r\n        this._listeners = [];\r\n        this._providers = [];\r\n        // If we restart then the diagnostics collection is reused.\r\n        if (!this._diagnostics) {\r\n            this._diagnostics = this._clientOptions.diagnosticCollectionName\r\n                ? vscode_1.languages.createDiagnosticCollection(this._clientOptions.diagnosticCollectionName)\r\n                : vscode_1.languages.createDiagnosticCollection();\r\n        }\r\n        this.state = ClientState.Starting;\r\n        this.resolveConnection().then((connection) => {\r\n            connection.onLogMessage((message) => {\r\n                switch (message.type) {\r\n                    case vscode_languageserver_protocol_1.MessageType.Error:\r\n                        this.error(message.message, undefined, false);\r\n                        break;\r\n                    case vscode_languageserver_protocol_1.MessageType.Warning:\r\n                        this.warn(message.message, undefined, false);\r\n                        break;\r\n                    case vscode_languageserver_protocol_1.MessageType.Info:\r\n                        this.info(message.message, undefined, false);\r\n                        break;\r\n                    default:\r\n                        this.outputChannel.appendLine(message.message);\r\n                }\r\n            });\r\n            connection.onShowMessage((message) => {\r\n                switch (message.type) {\r\n                    case vscode_languageserver_protocol_1.MessageType.Error:\r\n                        vscode_1.window.showErrorMessage(message.message);\r\n                        break;\r\n                    case vscode_languageserver_protocol_1.MessageType.Warning:\r\n                        vscode_1.window.showWarningMessage(message.message);\r\n                        break;\r\n                    case vscode_languageserver_protocol_1.MessageType.Info:\r\n                        vscode_1.window.showInformationMessage(message.message);\r\n                        break;\r\n                    default:\r\n                        vscode_1.window.showInformationMessage(message.message);\r\n                }\r\n            });\r\n            connection.onRequest(vscode_languageserver_protocol_1.ShowMessageRequest.type, (params) => {\r\n                let messageFunc;\r\n                switch (params.type) {\r\n                    case vscode_languageserver_protocol_1.MessageType.Error:\r\n                        messageFunc = vscode_1.window.showErrorMessage;\r\n                        break;\r\n                    case vscode_languageserver_protocol_1.MessageType.Warning:\r\n                        messageFunc = vscode_1.window.showWarningMessage;\r\n                        break;\r\n                    case vscode_languageserver_protocol_1.MessageType.Info:\r\n                        messageFunc = vscode_1.window.showInformationMessage;\r\n                        break;\r\n                    default:\r\n                        messageFunc = vscode_1.window.showInformationMessage;\r\n                }\r\n                let actions = params.actions || [];\r\n                return messageFunc(params.message, ...actions);\r\n            });\r\n            connection.onTelemetry((data) => {\r\n                this._telemetryEmitter.fire(data);\r\n            });\r\n            connection.listen();\r\n            // Error is handled in the initialize call.\r\n            return this.initialize(connection);\r\n        }).then(undefined, (error) => {\r\n            this.state = ClientState.StartFailed;\r\n            this._onReadyCallbacks.reject(error);\r\n            this.error('Starting client failed', error);\r\n            vscode_1.window.showErrorMessage(`Couldn't start client ${this._name}`);\r\n        });\r\n        return new vscode_1.Disposable(() => {\r\n            if (this.needsStop()) {\r\n                this.stop();\r\n            }\r\n        });\r\n    }\r\n    resolveConnection() {\r\n        if (!this._connectionPromise) {\r\n            this._connectionPromise = this.createConnection();\r\n        }\r\n        return this._connectionPromise;\r\n    }\r\n    initialize(connection) {\r\n        this.refreshTrace(connection, false);\r\n        let initOption = this._clientOptions.initializationOptions;\r\n        let rootPath = this._clientOptions.workspaceFolder\r\n            ? this._clientOptions.workspaceFolder.uri.fsPath\r\n            : this._clientGetRootPath();\r\n        let initParams = {\r\n            processId: process.pid,\r\n            clientInfo: {\r\n                name: 'vscode',\r\n                version: vscode_1.version\r\n            },\r\n            rootPath: rootPath ? rootPath : null,\r\n            rootUri: rootPath ? this._c2p.asUri(vscode_1.Uri.file(rootPath)) : null,\r\n            capabilities: this.computeClientCapabilities(),\r\n            initializationOptions: Is.func(initOption) ? initOption() : initOption,\r\n            trace: vscode_languageserver_protocol_1.Trace.toString(this._trace),\r\n            workspaceFolders: null\r\n        };\r\n        this.fillInitializeParams(initParams);\r\n        if (this._clientOptions.progressOnInitialization) {\r\n            const token = UUID.generateUuid();\r\n            const part = new progressPart_1.ProgressPart(connection, token);\r\n            initParams.workDoneToken = token;\r\n            return this.doInitialize(connection, initParams).then((result) => {\r\n                part.done();\r\n                return result;\r\n            }, (error) => {\r\n                part.cancel();\r\n                throw error;\r\n            });\r\n        }\r\n        else {\r\n            return this.doInitialize(connection, initParams);\r\n        }\r\n    }\r\n    doInitialize(connection, initParams) {\r\n        return connection.initialize(initParams).then((result) => {\r\n            this._resolvedConnection = connection;\r\n            this._initializeResult = result;\r\n            this.state = ClientState.Running;\r\n            let textDocumentSyncOptions = undefined;\r\n            if (Is.number(result.capabilities.textDocumentSync)) {\r\n                if (result.capabilities.textDocumentSync === vscode_languageserver_protocol_1.TextDocumentSyncKind.None) {\r\n                    textDocumentSyncOptions = {\r\n                        openClose: false,\r\n                        change: vscode_languageserver_protocol_1.TextDocumentSyncKind.None,\r\n                        save: undefined\r\n                    };\r\n                }\r\n                else {\r\n                    textDocumentSyncOptions = {\r\n                        openClose: true,\r\n                        change: result.capabilities.textDocumentSync,\r\n                        save: {\r\n                            includeText: false\r\n                        }\r\n                    };\r\n                }\r\n            }\r\n            else if (result.capabilities.textDocumentSync !== void 0 && result.capabilities.textDocumentSync !== null) {\r\n                textDocumentSyncOptions = result.capabilities.textDocumentSync;\r\n            }\r\n            this._capabilities = Object.assign({}, result.capabilities, { resolvedTextDocumentSync: textDocumentSyncOptions });\r\n            connection.onDiagnostics(params => this.handleDiagnostics(params));\r\n            connection.onRequest(vscode_languageserver_protocol_1.RegistrationRequest.type, params => this.handleRegistrationRequest(params));\r\n            // See https://github.com/Microsoft/vscode-languageserver-node/issues/199\r\n            connection.onRequest('client/registerFeature', params => this.handleRegistrationRequest(params));\r\n            connection.onRequest(vscode_languageserver_protocol_1.UnregistrationRequest.type, params => this.handleUnregistrationRequest(params));\r\n            // See https://github.com/Microsoft/vscode-languageserver-node/issues/199\r\n            connection.onRequest('client/unregisterFeature', params => this.handleUnregistrationRequest(params));\r\n            connection.onRequest(vscode_languageserver_protocol_1.ApplyWorkspaceEditRequest.type, params => this.handleApplyWorkspaceEdit(params));\r\n            connection.sendNotification(vscode_languageserver_protocol_1.InitializedNotification.type, {});\r\n            this.hookFileEvents(connection);\r\n            this.hookConfigurationChanged(connection);\r\n            this.initializeFeatures(connection);\r\n            this._onReadyCallbacks.resolve();\r\n            return result;\r\n        }).then(undefined, (error) => {\r\n            if (this._clientOptions.initializationFailedHandler) {\r\n                if (this._clientOptions.initializationFailedHandler(error)) {\r\n                    this.initialize(connection);\r\n                }\r\n                else {\r\n                    this.stop();\r\n                    this._onReadyCallbacks.reject(error);\r\n                }\r\n            }\r\n            else if (error instanceof vscode_languageserver_protocol_1.ResponseError && error.data && error.data.retry) {\r\n                vscode_1.window.showErrorMessage(error.message, { title: 'Retry', id: 'retry' }).then(item => {\r\n                    if (item && item.id === 'retry') {\r\n                        this.initialize(connection);\r\n                    }\r\n                    else {\r\n                        this.stop();\r\n                        this._onReadyCallbacks.reject(error);\r\n                    }\r\n                });\r\n            }\r\n            else {\r\n                if (error && error.message) {\r\n                    vscode_1.window.showErrorMessage(error.message);\r\n                }\r\n                this.error('Server initialization failed.', error);\r\n                this.stop();\r\n                this._onReadyCallbacks.reject(error);\r\n            }\r\n            throw error;\r\n        });\r\n    }\r\n    _clientGetRootPath() {\r\n        let folders = vscode_1.workspace.workspaceFolders;\r\n        if (!folders || folders.length === 0) {\r\n            return undefined;\r\n        }\r\n        let folder = folders[0];\r\n        if (folder.uri.scheme === 'file') {\r\n            return folder.uri.fsPath;\r\n        }\r\n        return undefined;\r\n    }\r\n    stop() {\r\n        this._initializeResult = undefined;\r\n        if (!this._connectionPromise) {\r\n            this.state = ClientState.Stopped;\r\n            return Promise.resolve();\r\n        }\r\n        if (this.state === ClientState.Stopping && this._onStop) {\r\n            return this._onStop;\r\n        }\r\n        this.state = ClientState.Stopping;\r\n        this.cleanUp(false);\r\n        // unhook listeners\r\n        return this._onStop = this.resolveConnection().then(connection => {\r\n            return connection.shutdown().then(() => {\r\n                connection.exit();\r\n                connection.dispose();\r\n                this.state = ClientState.Stopped;\r\n                this.cleanUpChannel();\r\n                this._onStop = undefined;\r\n                this._connectionPromise = undefined;\r\n                this._resolvedConnection = undefined;\r\n            });\r\n        });\r\n    }\r\n    cleanUp(channel = true, diagnostics = true) {\r\n        if (this._listeners) {\r\n            this._listeners.forEach(listener => listener.dispose());\r\n            this._listeners = undefined;\r\n        }\r\n        if (this._providers) {\r\n            this._providers.forEach(provider => provider.dispose());\r\n            this._providers = undefined;\r\n        }\r\n        if (this._syncedDocuments) {\r\n            this._syncedDocuments.clear();\r\n        }\r\n        for (let handler of this._dynamicFeatures.values()) {\r\n            handler.dispose();\r\n        }\r\n        if (channel) {\r\n            this.cleanUpChannel();\r\n        }\r\n        if (diagnostics && this._diagnostics) {\r\n            this._diagnostics.dispose();\r\n            this._diagnostics = undefined;\r\n        }\r\n    }\r\n    cleanUpChannel() {\r\n        if (this._outputChannel && this._disposeOutputChannel) {\r\n            this._outputChannel.dispose();\r\n            this._outputChannel = undefined;\r\n        }\r\n    }\r\n    notifyFileEvent(event) {\r\n        var _a, _b;\r\n        const client = this;\r\n        function didChangeWatchedFile(event) {\r\n            client._fileEvents.push(event);\r\n            client._fileEventDelayer.trigger(() => {\r\n                client.onReady().then(() => {\r\n                    client.resolveConnection().then(connection => {\r\n                        if (client.isConnectionActive()) {\r\n                            client.forceDocumentSync();\r\n                            connection.didChangeWatchedFiles({ changes: client._fileEvents });\r\n                        }\r\n                        client._fileEvents = [];\r\n                    });\r\n                }, (error) => {\r\n                    client.error(`Notify file events failed.`, error);\r\n                });\r\n            });\r\n        }\r\n        const workSpaceMiddleware = (_a = this.clientOptions.middleware) === null || _a === void 0 ? void 0 : _a.workspace;\r\n        ((_b = workSpaceMiddleware) === null || _b === void 0 ? void 0 : _b.didChangeWatchedFile) ? workSpaceMiddleware.didChangeWatchedFile(event, didChangeWatchedFile) : didChangeWatchedFile(event);\r\n    }\r\n    forceDocumentSync() {\r\n        this._dynamicFeatures.get(vscode_languageserver_protocol_1.DidChangeTextDocumentNotification.type.method).forceDelivery();\r\n    }\r\n    handleDiagnostics(params) {\r\n        if (!this._diagnostics) {\r\n            return;\r\n        }\r\n        let uri = this._p2c.asUri(params.uri);\r\n        let diagnostics = this._p2c.asDiagnostics(params.diagnostics);\r\n        let middleware = this.clientOptions.middleware;\r\n        if (middleware.handleDiagnostics) {\r\n            middleware.handleDiagnostics(uri, diagnostics, (uri, diagnostics) => this.setDiagnostics(uri, diagnostics));\r\n        }\r\n        else {\r\n            this.setDiagnostics(uri, diagnostics);\r\n        }\r\n    }\r\n    setDiagnostics(uri, diagnostics) {\r\n        if (!this._diagnostics) {\r\n            return;\r\n        }\r\n        this._diagnostics.set(uri, diagnostics);\r\n    }\r\n    createConnection() {\r\n        let errorHandler = (error, message, count) => {\r\n            this.handleConnectionError(error, message, count);\r\n        };\r\n        let closeHandler = () => {\r\n            this.handleConnectionClosed();\r\n        };\r\n        return this.createMessageTransports(this._clientOptions.stdioEncoding || 'utf8').then((transports) => {\r\n            return createConnection(transports.reader, transports.writer, errorHandler, closeHandler);\r\n        });\r\n    }\r\n    handleConnectionClosed() {\r\n        // Check whether this is a normal shutdown in progress or the client stopped normally.\r\n        if (this.state === ClientState.Stopping || this.state === ClientState.Stopped) {\r\n            return;\r\n        }\r\n        try {\r\n            if (this._resolvedConnection) {\r\n                this._resolvedConnection.dispose();\r\n            }\r\n        }\r\n        catch (error) {\r\n            // Disposing a connection could fail if error cases.\r\n        }\r\n        let action = CloseAction.DoNotRestart;\r\n        try {\r\n            action = this._clientOptions.errorHandler.closed();\r\n        }\r\n        catch (error) {\r\n            // Ignore errors coming from the error handler.\r\n        }\r\n        this._connectionPromise = undefined;\r\n        this._resolvedConnection = undefined;\r\n        if (action === CloseAction.DoNotRestart) {\r\n            this.error('Connection to server got closed. Server will not be restarted.');\r\n            this.state = ClientState.Stopped;\r\n            this.cleanUp(false, true);\r\n        }\r\n        else if (action === CloseAction.Restart) {\r\n            this.info('Connection to server got closed. Server will restart.');\r\n            this.cleanUp(false, false);\r\n            this.state = ClientState.Initial;\r\n            this.start();\r\n        }\r\n    }\r\n    handleConnectionError(error, message, count) {\r\n        let action = this._clientOptions.errorHandler.error(error, message, count);\r\n        if (action === ErrorAction.Shutdown) {\r\n            this.error('Connection to server is erroring. Shutting down server.');\r\n            this.stop();\r\n        }\r\n    }\r\n    hookConfigurationChanged(connection) {\r\n        vscode_1.workspace.onDidChangeConfiguration(() => {\r\n            this.refreshTrace(connection, true);\r\n        });\r\n    }\r\n    refreshTrace(connection, sendNotification = false) {\r\n        let config = vscode_1.workspace.getConfiguration(this._id);\r\n        let trace = vscode_languageserver_protocol_1.Trace.Off;\r\n        let traceFormat = vscode_languageserver_protocol_1.TraceFormat.Text;\r\n        if (config) {\r\n            const traceConfig = config.get('trace.server', 'off');\r\n            if (typeof traceConfig === 'string') {\r\n                trace = vscode_languageserver_protocol_1.Trace.fromString(traceConfig);\r\n            }\r\n            else {\r\n                trace = vscode_languageserver_protocol_1.Trace.fromString(config.get('trace.server.verbosity', 'off'));\r\n                traceFormat = vscode_languageserver_protocol_1.TraceFormat.fromString(config.get('trace.server.format', 'text'));\r\n            }\r\n        }\r\n        this._trace = trace;\r\n        this._traceFormat = traceFormat;\r\n        connection.trace(this._trace, this._tracer, {\r\n            sendNotification,\r\n            traceFormat: this._traceFormat\r\n        });\r\n    }\r\n    hookFileEvents(_connection) {\r\n        let fileEvents = this._clientOptions.synchronize.fileEvents;\r\n        if (!fileEvents) {\r\n            return;\r\n        }\r\n        let watchers;\r\n        if (Is.array(fileEvents)) {\r\n            watchers = fileEvents;\r\n        }\r\n        else {\r\n            watchers = [fileEvents];\r\n        }\r\n        if (!watchers) {\r\n            return;\r\n        }\r\n        this._dynamicFeatures.get(vscode_languageserver_protocol_1.DidChangeWatchedFilesNotification.type.method).registerRaw(UUID.generateUuid(), watchers);\r\n    }\r\n    registerFeatures(features) {\r\n        for (let feature of features) {\r\n            this.registerFeature(feature);\r\n        }\r\n    }\r\n    registerFeature(feature) {\r\n        this._features.push(feature);\r\n        if (DynamicFeature.is(feature)) {\r\n            let messages = feature.messages;\r\n            if (Array.isArray(messages)) {\r\n                for (let message of messages) {\r\n                    this._method2Message.set(message.method, message);\r\n                    this._dynamicFeatures.set(message.method, feature);\r\n                }\r\n            }\r\n            else {\r\n                this._method2Message.set(messages.method, messages);\r\n                this._dynamicFeatures.set(messages.method, feature);\r\n            }\r\n        }\r\n    }\r\n    getFeature(request) {\r\n        return this._dynamicFeatures.get(request);\r\n    }\r\n    registerBuiltinFeatures() {\r\n        this.registerFeature(new ConfigurationFeature(this));\r\n        this.registerFeature(new DidOpenTextDocumentFeature(this, this._syncedDocuments));\r\n        this.registerFeature(new DidChangeTextDocumentFeature(this));\r\n        this.registerFeature(new WillSaveFeature(this));\r\n        this.registerFeature(new WillSaveWaitUntilFeature(this));\r\n        this.registerFeature(new DidSaveTextDocumentFeature(this));\r\n        this.registerFeature(new DidCloseTextDocumentFeature(this, this._syncedDocuments));\r\n        this.registerFeature(new FileSystemWatcherFeature(this, (event) => this.notifyFileEvent(event)));\r\n        this.registerFeature(new CompletionItemFeature(this));\r\n        this.registerFeature(new HoverFeature(this));\r\n        this.registerFeature(new SignatureHelpFeature(this));\r\n        this.registerFeature(new DefinitionFeature(this));\r\n        this.registerFeature(new ReferencesFeature(this));\r\n        this.registerFeature(new DocumentHighlightFeature(this));\r\n        this.registerFeature(new DocumentSymbolFeature(this));\r\n        this.registerFeature(new WorkspaceSymbolFeature(this));\r\n        this.registerFeature(new CodeActionFeature(this));\r\n        this.registerFeature(new CodeLensFeature(this));\r\n        this.registerFeature(new DocumentFormattingFeature(this));\r\n        this.registerFeature(new DocumentRangeFormattingFeature(this));\r\n        this.registerFeature(new DocumentOnTypeFormattingFeature(this));\r\n        this.registerFeature(new RenameFeature(this));\r\n        this.registerFeature(new DocumentLinkFeature(this));\r\n        this.registerFeature(new ExecuteCommandFeature(this));\r\n    }\r\n    fillInitializeParams(params) {\r\n        for (let feature of this._features) {\r\n            if (Is.func(feature.fillInitializeParams)) {\r\n                feature.fillInitializeParams(params);\r\n            }\r\n        }\r\n    }\r\n    computeClientCapabilities() {\r\n        let result = {};\r\n        ensure(result, 'workspace').applyEdit = true;\r\n        let workspaceEdit = ensure(ensure(result, 'workspace'), 'workspaceEdit');\r\n        workspaceEdit.documentChanges = true;\r\n        workspaceEdit.resourceOperations = [vscode_languageserver_protocol_1.ResourceOperationKind.Create, vscode_languageserver_protocol_1.ResourceOperationKind.Rename, vscode_languageserver_protocol_1.ResourceOperationKind.Delete];\r\n        workspaceEdit.failureHandling = vscode_languageserver_protocol_1.FailureHandlingKind.TextOnlyTransactional;\r\n        let diagnostics = ensure(ensure(result, 'textDocument'), 'publishDiagnostics');\r\n        diagnostics.relatedInformation = true;\r\n        diagnostics.versionSupport = false;\r\n        diagnostics.tagSupport = { valueSet: [vscode_languageserver_protocol_1.DiagnosticTag.Unnecessary, vscode_languageserver_protocol_1.DiagnosticTag.Deprecated] };\r\n        for (let feature of this._features) {\r\n            feature.fillClientCapabilities(result);\r\n        }\r\n        return result;\r\n    }\r\n    initializeFeatures(_connection) {\r\n        let documentSelector = this._clientOptions.documentSelector;\r\n        for (let feature of this._features) {\r\n            feature.initialize(this._capabilities, documentSelector);\r\n        }\r\n    }\r\n    handleRegistrationRequest(params) {\r\n        return new Promise((resolve, reject) => {\r\n            for (let registration of params.registrations) {\r\n                const feature = this._dynamicFeatures.get(registration.method);\r\n                if (!feature) {\r\n                    reject(new Error(`No feature implementation for ${registration.method} found. Registration failed.`));\r\n                    return;\r\n                }\r\n                const options = registration.registerOptions || {};\r\n                options.documentSelector = options.documentSelector || this._clientOptions.documentSelector;\r\n                const data = {\r\n                    id: registration.id,\r\n                    registerOptions: options\r\n                };\r\n                feature.register(this._method2Message.get(registration.method), data);\r\n            }\r\n            resolve();\r\n        });\r\n    }\r\n    handleUnregistrationRequest(params) {\r\n        return new Promise((resolve, reject) => {\r\n            for (let unregistration of params.unregisterations) {\r\n                const feature = this._dynamicFeatures.get(unregistration.method);\r\n                if (!feature) {\r\n                    reject(new Error(`No feature implementation for ${unregistration.method} found. Unregistration failed.`));\r\n                    return;\r\n                }\r\n                feature.unregister(unregistration.id);\r\n            }\r\n            resolve();\r\n        });\r\n    }\r\n    handleApplyWorkspaceEdit(params) {\r\n        // This is some sort of workaround since the version check should be done by VS Code in the Workspace.applyEdit.\r\n        // However doing it here adds some safety since the server can lag more behind then an extension.\r\n        let workspaceEdit = params.edit;\r\n        let openTextDocuments = new Map();\r\n        vscode_1.workspace.textDocuments.forEach((document) => openTextDocuments.set(document.uri.toString(), document));\r\n        let versionMismatch = false;\r\n        if (workspaceEdit.documentChanges) {\r\n            for (const change of workspaceEdit.documentChanges) {\r\n                if (vscode_languageserver_protocol_1.TextDocumentEdit.is(change) && change.textDocument.version && change.textDocument.version >= 0) {\r\n                    let textDocument = openTextDocuments.get(change.textDocument.uri);\r\n                    if (textDocument && textDocument.version !== change.textDocument.version) {\r\n                        versionMismatch = true;\r\n                        break;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        if (versionMismatch) {\r\n            return Promise.resolve({ applied: false });\r\n        }\r\n        return Is.asPromise(vscode_1.workspace.applyEdit(this._p2c.asWorkspaceEdit(params.edit)).then((value) => { return { applied: value }; }));\r\n    }\r\n    logFailedRequest(type, error) {\r\n        // If we get a request cancel or a content modified don't log anything.\r\n        if (error instanceof vscode_languageserver_protocol_1.ResponseError && (error.code === vscode_languageserver_protocol_1.ErrorCodes.RequestCancelled || error.code === vscode_languageserver_protocol_1.ErrorCodes.ContentModified)) {\r\n            return;\r\n        }\r\n        this.error(`Request ${type.method} failed.`, error);\r\n    }\r\n}\r\nexports.BaseLanguageClient = BaseLanguageClient;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst code = require(\"vscode\");\r\nconst proto = require(\"vscode-languageserver-protocol\");\r\nconst Is = require(\"./utils/is\");\r\nconst protocolCompletionItem_1 = require(\"./protocolCompletionItem\");\r\nconst protocolCodeLens_1 = require(\"./protocolCodeLens\");\r\nconst protocolDocumentLink_1 = require(\"./protocolDocumentLink\");\r\nfunction createConverter(uriConverter) {\r\n    const nullConverter = (value) => value.toString();\r\n    const _uriConverter = uriConverter || nullConverter;\r\n    function asUri(value) {\r\n        return _uriConverter(value);\r\n    }\r\n    function asTextDocumentIdentifier(textDocument) {\r\n        return {\r\n            uri: _uriConverter(textDocument.uri)\r\n        };\r\n    }\r\n    function asVersionedTextDocumentIdentifier(textDocument) {\r\n        return {\r\n            uri: _uriConverter(textDocument.uri),\r\n            version: textDocument.version\r\n        };\r\n    }\r\n    function asOpenTextDocumentParams(textDocument) {\r\n        return {\r\n            textDocument: {\r\n                uri: _uriConverter(textDocument.uri),\r\n                languageId: textDocument.languageId,\r\n                version: textDocument.version,\r\n                text: textDocument.getText()\r\n            }\r\n        };\r\n    }\r\n    function isTextDocumentChangeEvent(value) {\r\n        let candidate = value;\r\n        return !!candidate.document && !!candidate.contentChanges;\r\n    }\r\n    function isTextDocument(value) {\r\n        let candidate = value;\r\n        return !!candidate.uri && !!candidate.version;\r\n    }\r\n    function asChangeTextDocumentParams(arg) {\r\n        if (isTextDocument(arg)) {\r\n            let result = {\r\n                textDocument: {\r\n                    uri: _uriConverter(arg.uri),\r\n                    version: arg.version\r\n                },\r\n                contentChanges: [{ text: arg.getText() }]\r\n            };\r\n            return result;\r\n        }\r\n        else if (isTextDocumentChangeEvent(arg)) {\r\n            let document = arg.document;\r\n            let result = {\r\n                textDocument: {\r\n                    uri: _uriConverter(document.uri),\r\n                    version: document.version\r\n                },\r\n                contentChanges: arg.contentChanges.map((change) => {\r\n                    let range = change.range;\r\n                    return {\r\n                        range: {\r\n                            start: { line: range.start.line, character: range.start.character },\r\n                            end: { line: range.end.line, character: range.end.character }\r\n                        },\r\n                        rangeLength: change.rangeLength,\r\n                        text: change.text\r\n                    };\r\n                })\r\n            };\r\n            return result;\r\n        }\r\n        else {\r\n            throw Error('Unsupported text document change parameter');\r\n        }\r\n    }\r\n    function asCloseTextDocumentParams(textDocument) {\r\n        return {\r\n            textDocument: asTextDocumentIdentifier(textDocument)\r\n        };\r\n    }\r\n    function asSaveTextDocumentParams(textDocument, includeContent = false) {\r\n        let result = {\r\n            textDocument: asVersionedTextDocumentIdentifier(textDocument)\r\n        };\r\n        if (includeContent) {\r\n            result.text = textDocument.getText();\r\n        }\r\n        return result;\r\n    }\r\n    function asTextDocumentSaveReason(reason) {\r\n        switch (reason) {\r\n            case code.TextDocumentSaveReason.Manual:\r\n                return proto.TextDocumentSaveReason.Manual;\r\n            case code.TextDocumentSaveReason.AfterDelay:\r\n                return proto.TextDocumentSaveReason.AfterDelay;\r\n            case code.TextDocumentSaveReason.FocusOut:\r\n                return proto.TextDocumentSaveReason.FocusOut;\r\n        }\r\n        return proto.TextDocumentSaveReason.Manual;\r\n    }\r\n    function asWillSaveTextDocumentParams(event) {\r\n        return {\r\n            textDocument: asTextDocumentIdentifier(event.document),\r\n            reason: asTextDocumentSaveReason(event.reason)\r\n        };\r\n    }\r\n    function asTextDocumentPositionParams(textDocument, position) {\r\n        return {\r\n            textDocument: asTextDocumentIdentifier(textDocument),\r\n            position: asWorkerPosition(position)\r\n        };\r\n    }\r\n    function asCompletionTriggerKind(triggerKind) {\r\n        switch (triggerKind) {\r\n            case code.CompletionTriggerKind.TriggerCharacter:\r\n                return proto.CompletionTriggerKind.TriggerCharacter;\r\n            case code.CompletionTriggerKind.TriggerForIncompleteCompletions:\r\n                return proto.CompletionTriggerKind.TriggerForIncompleteCompletions;\r\n            default:\r\n                return proto.CompletionTriggerKind.Invoked;\r\n        }\r\n    }\r\n    function asCompletionParams(textDocument, position, context) {\r\n        return {\r\n            textDocument: asTextDocumentIdentifier(textDocument),\r\n            position: asWorkerPosition(position),\r\n            context: {\r\n                triggerKind: asCompletionTriggerKind(context.triggerKind),\r\n                triggerCharacter: context.triggerCharacter\r\n            }\r\n        };\r\n    }\r\n    function asSignatureHelpTriggerKind(triggerKind) {\r\n        switch (triggerKind) {\r\n            case code.SignatureHelpTriggerKind.Invoke:\r\n                return proto.SignatureHelpTriggerKind.Invoked;\r\n            case code.SignatureHelpTriggerKind.TriggerCharacter:\r\n                return proto.SignatureHelpTriggerKind.TriggerCharacter;\r\n            case code.SignatureHelpTriggerKind.ContentChange:\r\n                return proto.SignatureHelpTriggerKind.ContentChange;\r\n        }\r\n    }\r\n    function asParameterInformation(value) {\r\n        // We leave the documentation out on purpose since it usually adds no\r\n        // value for the server.\r\n        return {\r\n            label: value.label\r\n        };\r\n    }\r\n    function asParameterInformations(values) {\r\n        return values.map(asParameterInformation);\r\n    }\r\n    function asSignatureInformation(value) {\r\n        // We leave the documentation out on purpose since it usually adds no\r\n        // value for the server.\r\n        return {\r\n            label: value.label,\r\n            parameters: asParameterInformations(value.parameters)\r\n        };\r\n    }\r\n    function asSignatureInformations(values) {\r\n        return values.map(asSignatureInformation);\r\n    }\r\n    function asSignatureHelp(value) {\r\n        if (value === undefined) {\r\n            return value;\r\n        }\r\n        return {\r\n            signatures: asSignatureInformations(value.signatures),\r\n            activeSignature: value.activeSignature,\r\n            activeParameter: value.activeParameter\r\n        };\r\n    }\r\n    function asSignatureHelpParams(textDocument, position, context) {\r\n        return {\r\n            textDocument: asTextDocumentIdentifier(textDocument),\r\n            position: asWorkerPosition(position),\r\n            context: {\r\n                isRetrigger: context.isRetrigger,\r\n                triggerCharacter: context.triggerCharacter,\r\n                triggerKind: asSignatureHelpTriggerKind(context.triggerKind),\r\n                activeSignatureHelp: asSignatureHelp(context.activeSignatureHelp)\r\n            }\r\n        };\r\n    }\r\n    function asWorkerPosition(position) {\r\n        return { line: position.line, character: position.character };\r\n    }\r\n    function asPosition(value) {\r\n        if (value === undefined || value === null) {\r\n            return value;\r\n        }\r\n        return { line: value.line, character: value.character };\r\n    }\r\n    function asPositions(value) {\r\n        let result = [];\r\n        for (let elem of value) {\r\n            result.push(asPosition(elem));\r\n        }\r\n        return result;\r\n    }\r\n    function isInsertReplace(value) {\r\n        const candidate = value;\r\n        return candidate && !!candidate.inserting && !!candidate.replacing;\r\n    }\r\n    function asRange(value) {\r\n        if (value === undefined || value === null) {\r\n            return value;\r\n        }\r\n        // The LSP has no support yet for insert replace. So this can never happen.\r\n        if (isInsertReplace(value)) {\r\n            throw new Error(`Receving unknown insert replace range.`);\r\n        }\r\n        return { start: asPosition(value.start), end: asPosition(value.end) };\r\n    }\r\n    function asLocation(value) {\r\n        if (value === undefined || value === null) {\r\n            return value;\r\n        }\r\n        return proto.Location.create(asUri(value.uri), asRange(value.range));\r\n    }\r\n    function asDiagnosticSeverity(value) {\r\n        switch (value) {\r\n            case code.DiagnosticSeverity.Error:\r\n                return proto.DiagnosticSeverity.Error;\r\n            case code.DiagnosticSeverity.Warning:\r\n                return proto.DiagnosticSeverity.Warning;\r\n            case code.DiagnosticSeverity.Information:\r\n                return proto.DiagnosticSeverity.Information;\r\n            case code.DiagnosticSeverity.Hint:\r\n                return proto.DiagnosticSeverity.Hint;\r\n        }\r\n    }\r\n    function asDiagnosticTags(tags) {\r\n        if (!tags) {\r\n            return undefined;\r\n        }\r\n        let result = [];\r\n        for (let tag of tags) {\r\n            let converted = asDiagnosticTag(tag);\r\n            if (converted !== undefined) {\r\n                result.push(converted);\r\n            }\r\n        }\r\n        return result.length > 0 ? result : undefined;\r\n    }\r\n    function asDiagnosticTag(tag) {\r\n        switch (tag) {\r\n            case code.DiagnosticTag.Unnecessary:\r\n                return proto.DiagnosticTag.Unnecessary;\r\n            case code.DiagnosticTag.Deprecated:\r\n                return proto.DiagnosticTag.Deprecated;\r\n            default:\r\n                return undefined;\r\n        }\r\n    }\r\n    function asRelatedInformation(item) {\r\n        return {\r\n            message: item.message,\r\n            location: asLocation(item.location)\r\n        };\r\n    }\r\n    function asRelatedInformations(items) {\r\n        return items.map(asRelatedInformation);\r\n    }\r\n    function asDiagnostic(item) {\r\n        let result = proto.Diagnostic.create(asRange(item.range), item.message);\r\n        if (Is.number(item.severity)) {\r\n            result.severity = asDiagnosticSeverity(item.severity);\r\n        }\r\n        if (Is.number(item.code) || Is.string(item.code)) {\r\n            result.code = item.code;\r\n        }\r\n        if (Array.isArray(item.tags)) {\r\n            result.tags = asDiagnosticTags(item.tags);\r\n        }\r\n        if (item.relatedInformation) {\r\n            result.relatedInformation = asRelatedInformations(item.relatedInformation);\r\n        }\r\n        if (item.source) {\r\n            result.source = item.source;\r\n        }\r\n        return result;\r\n    }\r\n    function asDiagnostics(items) {\r\n        if (items === undefined || items === null) {\r\n            return items;\r\n        }\r\n        return items.map(asDiagnostic);\r\n    }\r\n    function asDocumentation(format, documentation) {\r\n        switch (format) {\r\n            case '$string':\r\n                return documentation;\r\n            case proto.MarkupKind.PlainText:\r\n                return { kind: format, value: documentation };\r\n            case proto.MarkupKind.Markdown:\r\n                return { kind: format, value: documentation.value };\r\n            default:\r\n                return `Unsupported Markup content received. Kind is: ${format}`;\r\n        }\r\n    }\r\n    function asCompletionItemTag(tag) {\r\n        switch (tag) {\r\n            case code.CompletionItemTag.Deprecated:\r\n                return proto.CompletionItemTag.Deprecated;\r\n        }\r\n        return undefined;\r\n    }\r\n    function asCompletionItemTags(tags) {\r\n        if (tags === undefined) {\r\n            return tags;\r\n        }\r\n        const result = [];\r\n        for (let tag of tags) {\r\n            const converted = asCompletionItemTag(tag);\r\n            if (converted !== undefined) {\r\n                result.push(converted);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    function asCompletionItemKind(value, original) {\r\n        if (original !== undefined) {\r\n            return original;\r\n        }\r\n        return value + 1;\r\n    }\r\n    function asCompletionItem(item) {\r\n        let result = { label: item.label };\r\n        let protocolItem = item instanceof protocolCompletionItem_1.default ? item : undefined;\r\n        if (item.detail) {\r\n            result.detail = item.detail;\r\n        }\r\n        // We only send items back we created. So this can't be something else than\r\n        // a string right now.\r\n        if (item.documentation) {\r\n            if (!protocolItem || protocolItem.documentationFormat === '$string') {\r\n                result.documentation = item.documentation;\r\n            }\r\n            else {\r\n                result.documentation = asDocumentation(protocolItem.documentationFormat, item.documentation);\r\n            }\r\n        }\r\n        if (item.filterText) {\r\n            result.filterText = item.filterText;\r\n        }\r\n        fillPrimaryInsertText(result, item);\r\n        if (Is.number(item.kind)) {\r\n            result.kind = asCompletionItemKind(item.kind, protocolItem && protocolItem.originalItemKind);\r\n        }\r\n        if (item.sortText) {\r\n            result.sortText = item.sortText;\r\n        }\r\n        if (item.additionalTextEdits) {\r\n            result.additionalTextEdits = asTextEdits(item.additionalTextEdits);\r\n        }\r\n        if (item.commitCharacters) {\r\n            result.commitCharacters = item.commitCharacters.slice();\r\n        }\r\n        if (item.command) {\r\n            result.command = asCommand(item.command);\r\n        }\r\n        if (item.preselect === true || item.preselect === false) {\r\n            result.preselect = item.preselect;\r\n        }\r\n        const tags = asCompletionItemTags(item.tags);\r\n        if (protocolItem) {\r\n            if (protocolItem.data !== undefined) {\r\n                result.data = protocolItem.data;\r\n            }\r\n            if (protocolItem.deprecated === true || protocolItem.deprecated === false) {\r\n                if (protocolItem.deprecated === true && tags !== undefined && tags.length > 0) {\r\n                    const index = tags.indexOf(code.CompletionItemTag.Deprecated);\r\n                    if (index !== -1) {\r\n                        tags.splice(index, 1);\r\n                    }\r\n                }\r\n                result.deprecated = protocolItem.deprecated;\r\n            }\r\n        }\r\n        if (tags !== undefined && tags.length > 0) {\r\n            result.tags = tags;\r\n        }\r\n        return result;\r\n    }\r\n    function fillPrimaryInsertText(target, source) {\r\n        let format = proto.InsertTextFormat.PlainText;\r\n        let text = undefined;\r\n        let range = undefined;\r\n        if (source.textEdit) {\r\n            text = source.textEdit.newText;\r\n            range = asRange(source.textEdit.range);\r\n        }\r\n        else if (source.insertText instanceof code.SnippetString) {\r\n            format = proto.InsertTextFormat.Snippet;\r\n            text = source.insertText.value;\r\n        }\r\n        else {\r\n            text = source.insertText;\r\n        }\r\n        if (source.range) {\r\n            range = asRange(source.range);\r\n        }\r\n        target.insertTextFormat = format;\r\n        if (source.fromEdit && text !== undefined && range !== undefined) {\r\n            target.textEdit = { newText: text, range: range };\r\n        }\r\n        else {\r\n            target.insertText = text;\r\n        }\r\n    }\r\n    function asTextEdit(edit) {\r\n        return { range: asRange(edit.range), newText: edit.newText };\r\n    }\r\n    function asTextEdits(edits) {\r\n        if (edits === undefined || edits === null) {\r\n            return edits;\r\n        }\r\n        return edits.map(asTextEdit);\r\n    }\r\n    function asSymbolKind(item) {\r\n        if (item <= code.SymbolKind.TypeParameter) {\r\n            // Symbol kind is one based in the protocol and zero based in code.\r\n            return (item + 1);\r\n        }\r\n        return proto.SymbolKind.Property;\r\n    }\r\n    function asSymbolTag(item) {\r\n        return item;\r\n    }\r\n    function asSymbolTags(items) {\r\n        return items.map(asSymbolTag);\r\n    }\r\n    function asReferenceParams(textDocument, position, options) {\r\n        return {\r\n            textDocument: asTextDocumentIdentifier(textDocument),\r\n            position: asWorkerPosition(position),\r\n            context: { includeDeclaration: options.includeDeclaration }\r\n        };\r\n    }\r\n    function asCodeActionContext(context) {\r\n        if (context === undefined || context === null) {\r\n            return context;\r\n        }\r\n        let only;\r\n        if (context.only && Is.string(context.only.value)) {\r\n            only = [context.only.value];\r\n        }\r\n        return proto.CodeActionContext.create(asDiagnostics(context.diagnostics), only);\r\n    }\r\n    function asCommand(item) {\r\n        let result = proto.Command.create(item.title, item.command);\r\n        if (item.arguments) {\r\n            result.arguments = item.arguments;\r\n        }\r\n        return result;\r\n    }\r\n    function asCodeLens(item) {\r\n        let result = proto.CodeLens.create(asRange(item.range));\r\n        if (item.command) {\r\n            result.command = asCommand(item.command);\r\n        }\r\n        if (item instanceof protocolCodeLens_1.default) {\r\n            if (item.data) {\r\n                result.data = item.data;\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    function asFormattingOptions(item) {\r\n        return { tabSize: item.tabSize, insertSpaces: item.insertSpaces };\r\n    }\r\n    function asDocumentSymbolParams(textDocument) {\r\n        return {\r\n            textDocument: asTextDocumentIdentifier(textDocument)\r\n        };\r\n    }\r\n    function asCodeLensParams(textDocument) {\r\n        return {\r\n            textDocument: asTextDocumentIdentifier(textDocument)\r\n        };\r\n    }\r\n    function asDocumentLink(item) {\r\n        let result = proto.DocumentLink.create(asRange(item.range));\r\n        if (item.target) {\r\n            result.target = asUri(item.target);\r\n        }\r\n        if (item.tooltip !== undefined) {\r\n            result.tooltip = item.tooltip;\r\n        }\r\n        let protocolItem = item instanceof protocolDocumentLink_1.default ? item : undefined;\r\n        if (protocolItem && protocolItem.data) {\r\n            result.data = protocolItem.data;\r\n        }\r\n        return result;\r\n    }\r\n    function asDocumentLinkParams(textDocument) {\r\n        return {\r\n            textDocument: asTextDocumentIdentifier(textDocument)\r\n        };\r\n    }\r\n    return {\r\n        asUri,\r\n        asTextDocumentIdentifier,\r\n        asVersionedTextDocumentIdentifier,\r\n        asOpenTextDocumentParams,\r\n        asChangeTextDocumentParams,\r\n        asCloseTextDocumentParams,\r\n        asSaveTextDocumentParams,\r\n        asWillSaveTextDocumentParams,\r\n        asTextDocumentPositionParams,\r\n        asCompletionParams,\r\n        asSignatureHelpParams,\r\n        asWorkerPosition,\r\n        asRange,\r\n        asPosition,\r\n        asPositions,\r\n        asLocation,\r\n        asDiagnosticSeverity,\r\n        asDiagnosticTag,\r\n        asDiagnostic,\r\n        asDiagnostics,\r\n        asCompletionItem,\r\n        asTextEdit,\r\n        asSymbolKind,\r\n        asSymbolTag,\r\n        asSymbolTags,\r\n        asReferenceParams,\r\n        asCodeActionContext,\r\n        asCommand,\r\n        asCodeLens,\r\n        asFormattingOptions,\r\n        asDocumentSymbolParams,\r\n        asCodeLensParams,\r\n        asDocumentLink,\r\n        asDocumentLinkParams\r\n    };\r\n}\r\nexports.createConverter = createConverter;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_1 = require(\"vscode\");\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nconst client_1 = require(\"./client\");\r\nfunction ensure(target, key) {\r\n    if (target[key] === void 0) {\r\n        target[key] = {};\r\n    }\r\n    return target[key];\r\n}\r\nclass ColorProviderFeature extends client_1.TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.DocumentColorRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        ensure(ensure(capabilites, 'textDocument'), 'colorProvider').dynamicRegistration = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        let [id, options] = this.getRegistration(documentSelector, capabilities.colorProvider);\r\n        if (!id || !options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: id, registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideColorPresentations: (color, context, token) => {\r\n                const client = this._client;\r\n                const provideColorPresentations = (color, context, token) => {\r\n                    const requestParams = {\r\n                        color,\r\n                        textDocument: client.code2ProtocolConverter.asTextDocumentIdentifier(context.document),\r\n                        range: client.code2ProtocolConverter.asRange(context.range)\r\n                    };\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.ColorPresentationRequest.type, requestParams, token).then(this.asColorPresentations.bind(this), (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.ColorPresentationRequest.type, error);\r\n                        return Promise.resolve(null);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideColorPresentations\r\n                    ? middleware.provideColorPresentations(color, context, token, provideColorPresentations)\r\n                    : provideColorPresentations(color, context, token);\r\n            },\r\n            provideDocumentColors: (document, token) => {\r\n                const client = this._client;\r\n                const provideDocumentColors = (document, token) => {\r\n                    const requestParams = {\r\n                        textDocument: client.code2ProtocolConverter.asTextDocumentIdentifier(document)\r\n                    };\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.DocumentColorRequest.type, requestParams, token).then(this.asColorInformations.bind(this), (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.ColorPresentationRequest.type, error);\r\n                        return Promise.resolve(null);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideDocumentColors\r\n                    ? middleware.provideDocumentColors(document, token, provideDocumentColors)\r\n                    : provideDocumentColors(document, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerColorProvider(options.documentSelector, provider), provider];\r\n    }\r\n    asColor(color) {\r\n        return new vscode_1.Color(color.red, color.green, color.blue, color.alpha);\r\n    }\r\n    asColorInformations(colorInformation) {\r\n        if (Array.isArray(colorInformation)) {\r\n            return colorInformation.map(ci => {\r\n                return new vscode_1.ColorInformation(this._client.protocol2CodeConverter.asRange(ci.range), this.asColor(ci.color));\r\n            });\r\n        }\r\n        return [];\r\n    }\r\n    asColorPresentations(colorPresentations) {\r\n        if (Array.isArray(colorPresentations)) {\r\n            return colorPresentations.map(cp => {\r\n                let presentation = new vscode_1.ColorPresentation(cp.label);\r\n                presentation.additionalTextEdits = this._client.protocol2CodeConverter.asTextEdits(cp.additionalTextEdits);\r\n                presentation.textEdit = this._client.protocol2CodeConverter.asTextEdit(cp.textEdit);\r\n                return presentation;\r\n            });\r\n        }\r\n        return [];\r\n    }\r\n}\r\nexports.ColorProviderFeature = ColorProviderFeature;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_1 = require(\"vscode\");\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nclass ConfigurationFeature {\r\n    constructor(_client) {\r\n        this._client = _client;\r\n    }\r\n    fillClientCapabilities(capabilities) {\r\n        capabilities.workspace = capabilities.workspace || {};\r\n        capabilities.workspace.configuration = true;\r\n    }\r\n    initialize() {\r\n        let client = this._client;\r\n        client.onRequest(vscode_languageserver_protocol_1.ConfigurationRequest.type, (params, token) => {\r\n            let configuration = (params) => {\r\n                let result = [];\r\n                for (let item of params.items) {\r\n                    let resource = item.scopeUri !== void 0 && item.scopeUri !== null ? this._client.protocol2CodeConverter.asUri(item.scopeUri) : undefined;\r\n                    result.push(this.getConfiguration(resource, item.section !== null ? item.section : undefined));\r\n                }\r\n                return result;\r\n            };\r\n            let middleware = client.clientOptions.middleware.workspace;\r\n            return middleware && middleware.configuration\r\n                ? middleware.configuration(params, token, configuration)\r\n                : configuration(params, token);\r\n        });\r\n    }\r\n    getConfiguration(resource, section) {\r\n        let result = null;\r\n        if (section) {\r\n            let index = section.lastIndexOf('.');\r\n            if (index === -1) {\r\n                result = vscode_1.workspace.getConfiguration(undefined, resource).get(section);\r\n            }\r\n            else {\r\n                let config = vscode_1.workspace.getConfiguration(section.substr(0, index), resource);\r\n                if (config) {\r\n                    result = config.get(section.substr(index + 1));\r\n                }\r\n            }\r\n        }\r\n        else {\r\n            let config = vscode_1.workspace.getConfiguration(undefined, resource);\r\n            result = {};\r\n            for (let key of Object.keys(config)) {\r\n                if (config.has(key)) {\r\n                    result[key] = config.get(key);\r\n                }\r\n            }\r\n        }\r\n        if (!result) {\r\n            return null;\r\n        }\r\n        return result;\r\n    }\r\n}\r\nexports.ConfigurationFeature = ConfigurationFeature;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_1 = require(\"vscode\");\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nconst client_1 = require(\"./client\");\r\nfunction ensure(target, key) {\r\n    if (target[key] === void 0) {\r\n        target[key] = {};\r\n    }\r\n    return target[key];\r\n}\r\nclass DeclarationFeature extends client_1.TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.DeclarationRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        const declarationSupport = ensure(ensure(capabilites, 'textDocument'), 'declaration');\r\n        declarationSupport.dynamicRegistration = true;\r\n        declarationSupport.linkSupport = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        const [id, options] = this.getRegistration(documentSelector, capabilities.declarationProvider);\r\n        if (!id || !options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: id, registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideDeclaration: (document, position, token) => {\r\n                const client = this._client;\r\n                const provideDeclaration = (document, position, token) => {\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.DeclarationRequest.type, client.code2ProtocolConverter.asTextDocumentPositionParams(document, position), token).then(client.protocol2CodeConverter.asDeclarationResult, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.DeclarationRequest.type, error);\r\n                        return Promise.resolve(null);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideDeclaration\r\n                    ? middleware.provideDeclaration(document, position, token, provideDeclaration)\r\n                    : provideDeclaration(document, position, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerDeclarationProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nexports.DeclarationFeature = DeclarationFeature;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_1 = require(\"vscode\");\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nconst client_1 = require(\"./client\");\r\nfunction ensure(target, key) {\r\n    if (target[key] === void 0) {\r\n        target[key] = {};\r\n    }\r\n    return target[key];\r\n}\r\nclass FoldingRangeFeature extends client_1.TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.FoldingRangeRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        let capability = ensure(ensure(capabilites, 'textDocument'), 'foldingRange');\r\n        capability.dynamicRegistration = true;\r\n        capability.rangeLimit = 5000;\r\n        capability.lineFoldingOnly = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        let [id, options] = this.getRegistration(documentSelector, capabilities.foldingRangeProvider);\r\n        if (!id || !options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: id, registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideFoldingRanges: (document, context, token) => {\r\n                const client = this._client;\r\n                const provideFoldingRanges = (document, _, token) => {\r\n                    const requestParams = {\r\n                        textDocument: client.code2ProtocolConverter.asTextDocumentIdentifier(document)\r\n                    };\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.FoldingRangeRequest.type, requestParams, token).then(this.asFoldingRanges.bind(this), (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.FoldingRangeRequest.type, error);\r\n                        return Promise.resolve(null);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideFoldingRanges\r\n                    ? middleware.provideFoldingRanges(document, context, token, provideFoldingRanges)\r\n                    : provideFoldingRanges(document, context, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerFoldingRangeProvider(options.documentSelector, provider), provider];\r\n    }\r\n    asFoldingRangeKind(kind) {\r\n        if (kind) {\r\n            switch (kind) {\r\n                case vscode_languageserver_protocol_1.FoldingRangeKind.Comment:\r\n                    return vscode_1.FoldingRangeKind.Comment;\r\n                case vscode_languageserver_protocol_1.FoldingRangeKind.Imports:\r\n                    return vscode_1.FoldingRangeKind.Imports;\r\n                case vscode_languageserver_protocol_1.FoldingRangeKind.Region:\r\n                    return vscode_1.FoldingRangeKind.Region;\r\n            }\r\n        }\r\n        return void 0;\r\n    }\r\n    asFoldingRanges(foldingRanges) {\r\n        if (Array.isArray(foldingRanges)) {\r\n            return foldingRanges.map(r => {\r\n                return new vscode_1.FoldingRange(r.startLine, r.endLine, this.asFoldingRangeKind(r.kind));\r\n            });\r\n        }\r\n        return [];\r\n    }\r\n}\r\nexports.FoldingRangeFeature = FoldingRangeFeature;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_1 = require(\"vscode\");\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nconst client_1 = require(\"./client\");\r\nfunction ensure(target, key) {\r\n    if (target[key] === void 0) {\r\n        target[key] = {};\r\n    }\r\n    return target[key];\r\n}\r\nclass ImplementationFeature extends client_1.TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.ImplementationRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        let implementationSupport = ensure(ensure(capabilites, 'textDocument'), 'implementation');\r\n        implementationSupport.dynamicRegistration = true;\r\n        implementationSupport.linkSupport = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        let [id, options] = this.getRegistration(documentSelector, capabilities.implementationProvider);\r\n        if (!id || !options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: id, registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideImplementation: (document, position, token) => {\r\n                const client = this._client;\r\n                const provideImplementation = (document, position, token) => {\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.ImplementationRequest.type, client.code2ProtocolConverter.asTextDocumentPositionParams(document, position), token).then(client.protocol2CodeConverter.asDefinitionResult, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.ImplementationRequest.type, error);\r\n                        return Promise.resolve(null);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideImplementation\r\n                    ? middleware.provideImplementation(document, position, token, provideImplementation)\r\n                    : provideImplementation(document, position, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerImplementationProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nexports.ImplementationFeature = ImplementationFeature;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst cp = require(\"child_process\");\r\nconst fs = require(\"fs\");\r\nconst SemVer = require(\"semver\");\r\nconst client_1 = require(\"./client\");\r\nconst vscode_1 = require(\"vscode\");\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nconst colorProvider_1 = require(\"./colorProvider\");\r\nconst configuration_1 = require(\"./configuration\");\r\nconst implementation_1 = require(\"./implementation\");\r\nconst typeDefinition_1 = require(\"./typeDefinition\");\r\nconst workspaceFolders_1 = require(\"./workspaceFolders\");\r\nconst foldingRange_1 = require(\"./foldingRange\");\r\nconst declaration_1 = require(\"./declaration\");\r\nconst selectionRange_1 = require(\"./selectionRange\");\r\nconst progress_1 = require(\"./progress\");\r\nconst callHierarchy_proposed_1 = require(\"./callHierarchy.proposed\");\r\nconst semanticTokens_proposed_1 = require(\"./semanticTokens.proposed\");\r\nconst Is = require(\"./utils/is\");\r\nconst processes_1 = require(\"./utils/processes\");\r\n__export(require(\"./client\"));\r\nconst REQUIRED_VSCODE_VERSION = '^1.41.0'; // do not change format, updated by `updateVSCode` script\r\nvar Executable;\r\n(function (Executable) {\r\n    function is(value) {\r\n        return Is.string(value.command);\r\n    }\r\n    Executable.is = is;\r\n})(Executable || (Executable = {}));\r\nvar TransportKind;\r\n(function (TransportKind) {\r\n    TransportKind[TransportKind[\"stdio\"] = 0] = \"stdio\";\r\n    TransportKind[TransportKind[\"ipc\"] = 1] = \"ipc\";\r\n    TransportKind[TransportKind[\"pipe\"] = 2] = \"pipe\";\r\n    TransportKind[TransportKind[\"socket\"] = 3] = \"socket\";\r\n})(TransportKind = exports.TransportKind || (exports.TransportKind = {}));\r\nvar Transport;\r\n(function (Transport) {\r\n    function isSocket(value) {\r\n        let candidate = value;\r\n        return candidate && candidate.kind === TransportKind.socket && Is.number(candidate.port);\r\n    }\r\n    Transport.isSocket = isSocket;\r\n})(Transport || (Transport = {}));\r\nvar NodeModule;\r\n(function (NodeModule) {\r\n    function is(value) {\r\n        return Is.string(value.module);\r\n    }\r\n    NodeModule.is = is;\r\n})(NodeModule || (NodeModule = {}));\r\nvar StreamInfo;\r\n(function (StreamInfo) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && candidate.writer !== void 0 && candidate.reader !== void 0;\r\n    }\r\n    StreamInfo.is = is;\r\n})(StreamInfo || (StreamInfo = {}));\r\nvar ChildProcessInfo;\r\n(function (ChildProcessInfo) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && candidate.process !== void 0 && typeof candidate.detached === 'boolean';\r\n    }\r\n    ChildProcessInfo.is = is;\r\n})(ChildProcessInfo || (ChildProcessInfo = {}));\r\nclass LanguageClient extends client_1.BaseLanguageClient {\r\n    constructor(arg1, arg2, arg3, arg4, arg5) {\r\n        let id;\r\n        let name;\r\n        let serverOptions;\r\n        let clientOptions;\r\n        let forceDebug;\r\n        if (Is.string(arg2)) {\r\n            id = arg1;\r\n            name = arg2;\r\n            serverOptions = arg3;\r\n            clientOptions = arg4;\r\n            forceDebug = !!arg5;\r\n        }\r\n        else {\r\n            id = arg1.toLowerCase();\r\n            name = arg1;\r\n            serverOptions = arg2;\r\n            clientOptions = arg3;\r\n            forceDebug = arg4;\r\n        }\r\n        if (forceDebug === void 0) {\r\n            forceDebug = false;\r\n        }\r\n        super(id, name, clientOptions);\r\n        this._serverOptions = serverOptions;\r\n        this._forceDebug = forceDebug;\r\n        try {\r\n            this.checkVersion();\r\n        }\r\n        catch (error) {\r\n            if (Is.string(error.message)) {\r\n                this.outputChannel.appendLine(error.message);\r\n            }\r\n            throw error;\r\n        }\r\n    }\r\n    checkVersion() {\r\n        let codeVersion = SemVer.parse(vscode_1.version);\r\n        if (!codeVersion) {\r\n            throw new Error(`No valid VS Code version detected. Version string is: ${vscode_1.version}`);\r\n        }\r\n        // Remove the insider pre-release since we stay API compatible.\r\n        if (codeVersion.prerelease && codeVersion.prerelease.length > 0) {\r\n            codeVersion.prerelease = [];\r\n        }\r\n        if (!SemVer.satisfies(codeVersion, REQUIRED_VSCODE_VERSION)) {\r\n            throw new Error(`The language client requires VS Code version ${REQUIRED_VSCODE_VERSION} but received version ${vscode_1.version}`);\r\n        }\r\n    }\r\n    stop() {\r\n        return super.stop().then(() => {\r\n            if (this._serverProcess) {\r\n                let toCheck = this._serverProcess;\r\n                this._serverProcess = undefined;\r\n                if (this._isDetached === void 0 || !this._isDetached) {\r\n                    this.checkProcessDied(toCheck);\r\n                }\r\n                this._isDetached = undefined;\r\n            }\r\n        });\r\n    }\r\n    checkProcessDied(childProcess) {\r\n        if (!childProcess) {\r\n            return;\r\n        }\r\n        setTimeout(() => {\r\n            // Test if the process is still alive. Throws an exception if not\r\n            try {\r\n                process.kill(childProcess.pid, 0);\r\n                processes_1.terminate(childProcess);\r\n            }\r\n            catch (error) {\r\n                // All is fine.\r\n            }\r\n        }, 2000);\r\n    }\r\n    handleConnectionClosed() {\r\n        this._serverProcess = undefined;\r\n        super.handleConnectionClosed();\r\n    }\r\n    createMessageTransports(encoding) {\r\n        function getEnvironment(env, fork) {\r\n            if (!env && !fork) {\r\n                return undefined;\r\n            }\r\n            let result = Object.create(null);\r\n            Object.keys(process.env).forEach(key => result[key] = process.env[key]);\r\n            if (fork) {\r\n                result['ELECTRON_RUN_AS_NODE'] = '1';\r\n                result['ELECTRON_NO_ASAR'] = '1';\r\n            }\r\n            if (env) {\r\n                Object.keys(env).forEach(key => result[key] = env[key]);\r\n            }\r\n            return result;\r\n        }\r\n        const debugStartWith = ['--debug=', '--debug-brk=', '--inspect=', '--inspect-brk='];\r\n        const debugEquals = ['--debug', '--debug-brk', '--inspect', '--inspect-brk'];\r\n        function startedInDebugMode() {\r\n            let args = process.execArgv;\r\n            if (args) {\r\n                return args.some((arg) => {\r\n                    return debugStartWith.some(value => arg.startsWith(value)) ||\r\n                        debugEquals.some(value => arg === value);\r\n                });\r\n            }\r\n            return false;\r\n        }\r\n        function assertStdio(process) {\r\n            if (process.stdin === null || process.stdout === null || process.stderr === null) {\r\n                throw new Error('Process created without stdio streams');\r\n            }\r\n        }\r\n        let server = this._serverOptions;\r\n        // We got a function.\r\n        if (Is.func(server)) {\r\n            return server().then((result) => {\r\n                if (client_1.MessageTransports.is(result)) {\r\n                    this._isDetached = !!result.detached;\r\n                    return result;\r\n                }\r\n                else if (StreamInfo.is(result)) {\r\n                    this._isDetached = !!result.detached;\r\n                    return { reader: new vscode_languageserver_protocol_1.StreamMessageReader(result.reader), writer: new vscode_languageserver_protocol_1.StreamMessageWriter(result.writer) };\r\n                }\r\n                else {\r\n                    let cp;\r\n                    if (ChildProcessInfo.is(result)) {\r\n                        cp = result.process;\r\n                        this._isDetached = result.detached;\r\n                    }\r\n                    else {\r\n                        cp = result;\r\n                        this._isDetached = false;\r\n                    }\r\n                    cp.stderr.on('data', data => this.outputChannel.append(Is.string(data) ? data : data.toString(encoding)));\r\n                    return { reader: new vscode_languageserver_protocol_1.StreamMessageReader(cp.stdout), writer: new vscode_languageserver_protocol_1.StreamMessageWriter(cp.stdin) };\r\n                }\r\n            });\r\n        }\r\n        let json;\r\n        let runDebug = server;\r\n        if (runDebug.run || runDebug.debug) {\r\n            if (this._forceDebug || startedInDebugMode()) {\r\n                json = runDebug.debug;\r\n            }\r\n            else {\r\n                json = runDebug.run;\r\n            }\r\n        }\r\n        else {\r\n            json = server;\r\n        }\r\n        return this._getServerWorkingDir(json.options).then(serverWorkingDir => {\r\n            if (NodeModule.is(json) && json.module) {\r\n                let node = json;\r\n                let transport = node.transport || TransportKind.stdio;\r\n                if (node.runtime) {\r\n                    let args = [];\r\n                    let options = node.options || Object.create(null);\r\n                    if (options.execArgv) {\r\n                        options.execArgv.forEach(element => args.push(element));\r\n                    }\r\n                    args.push(node.module);\r\n                    if (node.args) {\r\n                        node.args.forEach(element => args.push(element));\r\n                    }\r\n                    let execOptions = Object.create(null);\r\n                    execOptions.cwd = serverWorkingDir;\r\n                    execOptions.env = getEnvironment(options.env, false);\r\n                    let pipeName = undefined;\r\n                    if (transport === TransportKind.ipc) {\r\n                        // exec options not correctly typed in lib\r\n                        execOptions.stdio = [null, null, null, 'ipc'];\r\n                        args.push('--node-ipc');\r\n                    }\r\n                    else if (transport === TransportKind.stdio) {\r\n                        args.push('--stdio');\r\n                    }\r\n                    else if (transport === TransportKind.pipe) {\r\n                        pipeName = vscode_languageserver_protocol_1.generateRandomPipeName();\r\n                        args.push(`--pipe=${pipeName}`);\r\n                    }\r\n                    else if (Transport.isSocket(transport)) {\r\n                        args.push(`--socket=${transport.port}`);\r\n                    }\r\n                    args.push(`--clientProcessId=${process.pid.toString()}`);\r\n                    if (transport === TransportKind.ipc || transport === TransportKind.stdio) {\r\n                        let serverProcess = cp.spawn(node.runtime, args, execOptions);\r\n                        if (!serverProcess || !serverProcess.pid) {\r\n                            return Promise.reject(`Launching server using runtime ${node.runtime} failed.`);\r\n                        }\r\n                        this._serverProcess = serverProcess;\r\n                        serverProcess.stderr.on('data', data => this.outputChannel.append(Is.string(data) ? data : data.toString(encoding)));\r\n                        if (transport === TransportKind.ipc) {\r\n                            serverProcess.stdout.on('data', data => this.outputChannel.append(Is.string(data) ? data : data.toString(encoding)));\r\n                            return Promise.resolve({ reader: new vscode_languageserver_protocol_1.IPCMessageReader(serverProcess), writer: new vscode_languageserver_protocol_1.IPCMessageWriter(serverProcess) });\r\n                        }\r\n                        else {\r\n                            return Promise.resolve({ reader: new vscode_languageserver_protocol_1.StreamMessageReader(serverProcess.stdout), writer: new vscode_languageserver_protocol_1.StreamMessageWriter(serverProcess.stdin) });\r\n                        }\r\n                    }\r\n                    else if (transport === TransportKind.pipe) {\r\n                        return vscode_languageserver_protocol_1.createClientPipeTransport(pipeName).then((transport) => {\r\n                            let process = cp.spawn(node.runtime, args, execOptions);\r\n                            if (!process || !process.pid) {\r\n                                return Promise.reject(`Launching server using runtime ${node.runtime} failed.`);\r\n                            }\r\n                            this._serverProcess = process;\r\n                            process.stderr.on('data', data => this.outputChannel.append(Is.string(data) ? data : data.toString(encoding)));\r\n                            process.stdout.on('data', data => this.outputChannel.append(Is.string(data) ? data : data.toString(encoding)));\r\n                            return transport.onConnected().then((protocol) => {\r\n                                return { reader: protocol[0], writer: protocol[1] };\r\n                            });\r\n                        });\r\n                    }\r\n                    else if (Transport.isSocket(transport)) {\r\n                        return vscode_languageserver_protocol_1.createClientSocketTransport(transport.port).then((transport) => {\r\n                            let process = cp.spawn(node.runtime, args, execOptions);\r\n                            if (!process || !process.pid) {\r\n                                return Promise.reject(`Launching server using runtime ${node.runtime} failed.`);\r\n                            }\r\n                            this._serverProcess = process;\r\n                            process.stderr.on('data', data => this.outputChannel.append(Is.string(data) ? data : data.toString(encoding)));\r\n                            process.stdout.on('data', data => this.outputChannel.append(Is.string(data) ? data : data.toString(encoding)));\r\n                            return transport.onConnected().then((protocol) => {\r\n                                return { reader: protocol[0], writer: protocol[1] };\r\n                            });\r\n                        });\r\n                    }\r\n                }\r\n                else {\r\n                    let pipeName = undefined;\r\n                    return new Promise((resolve, _reject) => {\r\n                        let args = node.args && node.args.slice() || [];\r\n                        if (transport === TransportKind.ipc) {\r\n                            args.push('--node-ipc');\r\n                        }\r\n                        else if (transport === TransportKind.stdio) {\r\n                            args.push('--stdio');\r\n                        }\r\n                        else if (transport === TransportKind.pipe) {\r\n                            pipeName = vscode_languageserver_protocol_1.generateRandomPipeName();\r\n                            args.push(`--pipe=${pipeName}`);\r\n                        }\r\n                        else if (Transport.isSocket(transport)) {\r\n                            args.push(`--socket=${transport.port}`);\r\n                        }\r\n                        args.push(`--clientProcessId=${process.pid.toString()}`);\r\n                        let options = node.options || Object.create(null);\r\n                        options.env = getEnvironment(options.env, true);\r\n                        options.execArgv = options.execArgv || [];\r\n                        options.cwd = serverWorkingDir;\r\n                        options.silent = true;\r\n                        if (transport === TransportKind.ipc || transport === TransportKind.stdio) {\r\n                            let sp = cp.fork(node.module, args || [], options);\r\n                            assertStdio(sp);\r\n                            this._serverProcess = sp;\r\n                            sp.stderr.on('data', data => this.outputChannel.append(Is.string(data) ? data : data.toString(encoding)));\r\n                            if (transport === TransportKind.ipc) {\r\n                                sp.stdout.on('data', data => this.outputChannel.append(Is.string(data) ? data : data.toString(encoding)));\r\n                                resolve({ reader: new vscode_languageserver_protocol_1.IPCMessageReader(this._serverProcess), writer: new vscode_languageserver_protocol_1.IPCMessageWriter(this._serverProcess) });\r\n                            }\r\n                            else {\r\n                                resolve({ reader: new vscode_languageserver_protocol_1.StreamMessageReader(sp.stdout), writer: new vscode_languageserver_protocol_1.StreamMessageWriter(sp.stdin) });\r\n                            }\r\n                        }\r\n                        else if (transport === TransportKind.pipe) {\r\n                            vscode_languageserver_protocol_1.createClientPipeTransport(pipeName).then((transport) => {\r\n                                let sp = cp.fork(node.module, args || [], options);\r\n                                assertStdio(sp);\r\n                                this._serverProcess = sp;\r\n                                sp.stderr.on('data', data => this.outputChannel.append(Is.string(data) ? data : data.toString(encoding)));\r\n                                sp.stdout.on('data', data => this.outputChannel.append(Is.string(data) ? data : data.toString(encoding)));\r\n                                transport.onConnected().then((protocol) => {\r\n                                    resolve({ reader: protocol[0], writer: protocol[1] });\r\n                                });\r\n                            });\r\n                        }\r\n                        else if (Transport.isSocket(transport)) {\r\n                            vscode_languageserver_protocol_1.createClientSocketTransport(transport.port).then((transport) => {\r\n                                let sp = cp.fork(node.module, args || [], options);\r\n                                assertStdio(sp);\r\n                                this._serverProcess = sp;\r\n                                sp.stderr.on('data', data => this.outputChannel.append(Is.string(data) ? data : data.toString(encoding)));\r\n                                sp.stdout.on('data', data => this.outputChannel.append(Is.string(data) ? data : data.toString(encoding)));\r\n                                transport.onConnected().then((protocol) => {\r\n                                    resolve({ reader: protocol[0], writer: protocol[1] });\r\n                                });\r\n                            });\r\n                        }\r\n                    });\r\n                }\r\n            }\r\n            else if (Executable.is(json) && json.command) {\r\n                let command = json;\r\n                let args = command.args || [];\r\n                let options = Object.assign({}, command.options);\r\n                options.cwd = options.cwd || serverWorkingDir;\r\n                let serverProcess = cp.spawn(command.command, args, options);\r\n                if (!serverProcess || !serverProcess.pid) {\r\n                    return Promise.reject(`Launching server using command ${command.command} failed.`);\r\n                }\r\n                serverProcess.stderr.on('data', data => this.outputChannel.append(Is.string(data) ? data : data.toString(encoding)));\r\n                this._serverProcess = serverProcess;\r\n                this._isDetached = !!options.detached;\r\n                return Promise.resolve({ reader: new vscode_languageserver_protocol_1.StreamMessageReader(serverProcess.stdout), writer: new vscode_languageserver_protocol_1.StreamMessageWriter(serverProcess.stdin) });\r\n            }\r\n            return Promise.reject(new Error(`Unsupported server configuration ` + JSON.stringify(server, null, 4)));\r\n        });\r\n    }\r\n    registerProposedFeatures() {\r\n        this.registerFeatures(ProposedFeatures.createAll(this));\r\n    }\r\n    registerBuiltinFeatures() {\r\n        super.registerBuiltinFeatures();\r\n        this.registerFeature(new configuration_1.ConfigurationFeature(this));\r\n        this.registerFeature(new typeDefinition_1.TypeDefinitionFeature(this));\r\n        this.registerFeature(new implementation_1.ImplementationFeature(this));\r\n        this.registerFeature(new colorProvider_1.ColorProviderFeature(this));\r\n        this.registerFeature(new workspaceFolders_1.WorkspaceFoldersFeature(this));\r\n        this.registerFeature(new foldingRange_1.FoldingRangeFeature(this));\r\n        this.registerFeature(new declaration_1.DeclarationFeature(this));\r\n        this.registerFeature(new selectionRange_1.SelectionRangeFeature(this));\r\n        this.registerFeature(new progress_1.ProgressFeature(this));\r\n    }\r\n    _mainGetRootPath() {\r\n        let folders = vscode_1.workspace.workspaceFolders;\r\n        if (!folders || folders.length === 0) {\r\n            return undefined;\r\n        }\r\n        let folder = folders[0];\r\n        if (folder.uri.scheme === 'file') {\r\n            return folder.uri.fsPath;\r\n        }\r\n        return undefined;\r\n    }\r\n    _getServerWorkingDir(options) {\r\n        let cwd = options && options.cwd;\r\n        if (!cwd) {\r\n            cwd = this.clientOptions.workspaceFolder\r\n                ? this.clientOptions.workspaceFolder.uri.fsPath\r\n                : this._mainGetRootPath();\r\n        }\r\n        if (cwd) {\r\n            // make sure the folder exists otherwise creating the process will fail\r\n            return new Promise(s => {\r\n                fs.lstat(cwd, (err, stats) => {\r\n                    s(!err && stats.isDirectory() ? cwd : undefined);\r\n                });\r\n            });\r\n        }\r\n        return Promise.resolve(undefined);\r\n    }\r\n}\r\nexports.LanguageClient = LanguageClient;\r\nclass SettingMonitor {\r\n    constructor(_client, _setting) {\r\n        this._client = _client;\r\n        this._setting = _setting;\r\n        this._listeners = [];\r\n    }\r\n    start() {\r\n        vscode_1.workspace.onDidChangeConfiguration(this.onDidChangeConfiguration, this, this._listeners);\r\n        this.onDidChangeConfiguration();\r\n        return new vscode_1.Disposable(() => {\r\n            if (this._client.needsStop()) {\r\n                this._client.stop();\r\n            }\r\n        });\r\n    }\r\n    onDidChangeConfiguration() {\r\n        let index = this._setting.indexOf('.');\r\n        let primary = index >= 0 ? this._setting.substr(0, index) : this._setting;\r\n        let rest = index >= 0 ? this._setting.substr(index + 1) : undefined;\r\n        let enabled = rest ? vscode_1.workspace.getConfiguration(primary).get(rest, false) : vscode_1.workspace.getConfiguration(primary);\r\n        if (enabled && this._client.needsStart()) {\r\n            this._client.start();\r\n        }\r\n        else if (!enabled && this._client.needsStop()) {\r\n            this._client.stop();\r\n        }\r\n    }\r\n}\r\nexports.SettingMonitor = SettingMonitor;\r\n// Exporting proposed protocol.\r\nvar ProposedFeatures;\r\n(function (ProposedFeatures) {\r\n    function createAll(client) {\r\n        let result = [\r\n            new callHierarchy_proposed_1.CallHierarchyFeature(client),\r\n            new semanticTokens_proposed_1.SemanticTokensFeature(client)\r\n        ];\r\n        return result;\r\n    }\r\n    ProposedFeatures.createAll = createAll;\r\n})(ProposedFeatures = exports.ProposedFeatures || (exports.ProposedFeatures = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nconst progressPart_1 = require(\"./progressPart\");\r\nfunction ensure(target, key) {\r\n    if (target[key] === void 0) {\r\n        target[key] = Object.create(null);\r\n    }\r\n    return target[key];\r\n}\r\nclass ProgressFeature {\r\n    constructor(_client) {\r\n        this._client = _client;\r\n    }\r\n    fillClientCapabilities(capabilities) {\r\n        ensure(capabilities, 'window').workDoneProgress = true;\r\n    }\r\n    initialize() {\r\n        let client = this._client;\r\n        let createHandler = (params) => {\r\n            new progressPart_1.ProgressPart(this._client, params.token);\r\n        };\r\n        client.onRequest(vscode_languageserver_protocol_1.WorkDoneProgressCreateRequest.type, createHandler);\r\n    }\r\n}\r\nexports.ProgressFeature = ProgressFeature;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_1 = require(\"vscode\");\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nconst Is = require(\"./utils/is\");\r\nclass ProgressPart {\r\n    constructor(_client, _token) {\r\n        this._client = _client;\r\n        this._token = _token;\r\n        this._reported = 0;\r\n        this._disposable = this._client.onProgress(vscode_languageserver_protocol_1.WorkDoneProgress.type, this._token, (value) => {\r\n            switch (value.kind) {\r\n                case 'begin':\r\n                    this.begin(value);\r\n                    break;\r\n                case 'report':\r\n                    this.report(value);\r\n                    break;\r\n                case 'end':\r\n                    this.done();\r\n                    break;\r\n            }\r\n        });\r\n    }\r\n    begin(params) {\r\n        let location = params.cancellable ? vscode_1.ProgressLocation.Notification : vscode_1.ProgressLocation.Window;\r\n        vscode_1.window.withProgress({ location, cancellable: params.cancellable, title: params.title }, async (progress, cancellationToken) => {\r\n            this._progress = progress;\r\n            this._infinite = params.percentage === undefined;\r\n            this._cancellationToken = cancellationToken;\r\n            this._cancellationToken.onCancellationRequested(() => {\r\n                this._client.sendNotification(vscode_languageserver_protocol_1.WorkDoneProgressCancelNotification.type, { token: this._token });\r\n            });\r\n            this.report(params);\r\n            return new Promise((resolve, reject) => {\r\n                this._resolve = resolve;\r\n                this._reject = reject;\r\n            });\r\n        });\r\n    }\r\n    report(params) {\r\n        if (this._infinite && Is.string(params.message)) {\r\n            this._progress.report({ message: params.message });\r\n        }\r\n        else if (Is.number(params.percentage)) {\r\n            let percentage = Math.max(0, Math.min(params.percentage, 100));\r\n            let delta = Math.max(0, percentage - this._reported);\r\n            this._progress.report({ message: params.message, increment: delta });\r\n            this._reported += delta;\r\n        }\r\n    }\r\n    cancel() {\r\n        if (this._disposable) {\r\n            this._disposable.dispose();\r\n            this._disposable = undefined;\r\n        }\r\n        if (this._reject) {\r\n            this._reject();\r\n            this._resolve = undefined;\r\n            this._reject = undefined;\r\n        }\r\n    }\r\n    done() {\r\n        if (this._disposable) {\r\n            this._disposable.dispose();\r\n            this._disposable = undefined;\r\n        }\r\n        if (this._resolve) {\r\n            this._resolve();\r\n            this._resolve = undefined;\r\n            this._reject = undefined;\r\n        }\r\n    }\r\n}\r\nexports.ProgressPart = ProgressPart;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst code = require(\"vscode\");\r\nclass ProtocolCodeLens extends code.CodeLens {\r\n    constructor(range) {\r\n        super(range);\r\n    }\r\n}\r\nexports.default = ProtocolCodeLens;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst code = require(\"vscode\");\r\nclass ProtocolCompletionItem extends code.CompletionItem {\r\n    constructor(label) {\r\n        super(label);\r\n    }\r\n}\r\nexports.default = ProtocolCompletionItem;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst code = require(\"vscode\");\r\nconst ls = require(\"vscode-languageserver-protocol\");\r\nconst Is = require(\"./utils/is\");\r\nconst protocolCompletionItem_1 = require(\"./protocolCompletionItem\");\r\nconst protocolCodeLens_1 = require(\"./protocolCodeLens\");\r\nconst protocolDocumentLink_1 = require(\"./protocolDocumentLink\");\r\nvar CodeBlock;\r\n(function (CodeBlock) {\r\n    function is(value) {\r\n        let candidate = value;\r\n        return candidate && Is.string(candidate.language) && Is.string(candidate.value);\r\n    }\r\n    CodeBlock.is = is;\r\n})(CodeBlock || (CodeBlock = {}));\r\nfunction createConverter(uriConverter) {\r\n    const nullConverter = (value) => code.Uri.parse(value);\r\n    const _uriConverter = uriConverter || nullConverter;\r\n    function asUri(value) {\r\n        return _uriConverter(value);\r\n    }\r\n    function asDiagnostics(diagnostics) {\r\n        return diagnostics.map(asDiagnostic);\r\n    }\r\n    function asDiagnostic(diagnostic) {\r\n        let result = new code.Diagnostic(asRange(diagnostic.range), diagnostic.message, asDiagnosticSeverity(diagnostic.severity));\r\n        if (Is.number(diagnostic.code) || Is.string(diagnostic.code)) {\r\n            result.code = diagnostic.code;\r\n        }\r\n        if (diagnostic.source) {\r\n            result.source = diagnostic.source;\r\n        }\r\n        if (diagnostic.relatedInformation) {\r\n            result.relatedInformation = asRelatedInformation(diagnostic.relatedInformation);\r\n        }\r\n        if (Array.isArray(diagnostic.tags)) {\r\n            result.tags = asDiagnosticTags(diagnostic.tags);\r\n        }\r\n        return result;\r\n    }\r\n    function asRelatedInformation(relatedInformation) {\r\n        return relatedInformation.map(asDiagnosticRelatedInformation);\r\n    }\r\n    function asDiagnosticRelatedInformation(information) {\r\n        return new code.DiagnosticRelatedInformation(asLocation(information.location), information.message);\r\n    }\r\n    function asDiagnosticTags(tags) {\r\n        if (!tags) {\r\n            return undefined;\r\n        }\r\n        let result = [];\r\n        for (let tag of tags) {\r\n            let converted = asDiagnosticTag(tag);\r\n            if (converted !== undefined) {\r\n                result.push(converted);\r\n            }\r\n        }\r\n        return result.length > 0 ? result : undefined;\r\n    }\r\n    function asDiagnosticTag(tag) {\r\n        switch (tag) {\r\n            case ls.DiagnosticTag.Unnecessary:\r\n                return code.DiagnosticTag.Unnecessary;\r\n            case ls.DiagnosticTag.Deprecated:\r\n                return code.DiagnosticTag.Deprecated;\r\n            default:\r\n                return undefined;\r\n        }\r\n    }\r\n    function asPosition(value) {\r\n        if (!value) {\r\n            return undefined;\r\n        }\r\n        return new code.Position(value.line, value.character);\r\n    }\r\n    function asRange(value) {\r\n        if (!value) {\r\n            return undefined;\r\n        }\r\n        return new code.Range(asPosition(value.start), asPosition(value.end));\r\n    }\r\n    function asRanges(value) {\r\n        return value.map(value => asRange(value));\r\n    }\r\n    function asDiagnosticSeverity(value) {\r\n        if (value === undefined || value === null) {\r\n            return code.DiagnosticSeverity.Error;\r\n        }\r\n        switch (value) {\r\n            case ls.DiagnosticSeverity.Error:\r\n                return code.DiagnosticSeverity.Error;\r\n            case ls.DiagnosticSeverity.Warning:\r\n                return code.DiagnosticSeverity.Warning;\r\n            case ls.DiagnosticSeverity.Information:\r\n                return code.DiagnosticSeverity.Information;\r\n            case ls.DiagnosticSeverity.Hint:\r\n                return code.DiagnosticSeverity.Hint;\r\n        }\r\n        return code.DiagnosticSeverity.Error;\r\n    }\r\n    function asHoverContent(value) {\r\n        if (Is.string(value)) {\r\n            return new code.MarkdownString(value);\r\n        }\r\n        else if (CodeBlock.is(value)) {\r\n            let result = new code.MarkdownString();\r\n            return result.appendCodeblock(value.value, value.language);\r\n        }\r\n        else if (Array.isArray(value)) {\r\n            let result = [];\r\n            for (let element of value) {\r\n                let item = new code.MarkdownString();\r\n                if (CodeBlock.is(element)) {\r\n                    item.appendCodeblock(element.value, element.language);\r\n                }\r\n                else {\r\n                    item.appendMarkdown(element);\r\n                }\r\n                result.push(item);\r\n            }\r\n            return result;\r\n        }\r\n        else {\r\n            let result;\r\n            switch (value.kind) {\r\n                case ls.MarkupKind.Markdown:\r\n                    return new code.MarkdownString(value.value);\r\n                case ls.MarkupKind.PlainText:\r\n                    result = new code.MarkdownString();\r\n                    result.appendText(value.value);\r\n                    return result;\r\n                default:\r\n                    result = new code.MarkdownString();\r\n                    result.appendText(`Unsupported Markup content received. Kind is: ${value.kind}`);\r\n                    return result;\r\n            }\r\n        }\r\n    }\r\n    function asDocumentation(value) {\r\n        if (Is.string(value)) {\r\n            return value;\r\n        }\r\n        else {\r\n            switch (value.kind) {\r\n                case ls.MarkupKind.Markdown:\r\n                    return new code.MarkdownString(value.value);\r\n                case ls.MarkupKind.PlainText:\r\n                    return value.value;\r\n                default:\r\n                    return `Unsupported Markup content received. Kind is: ${value.kind}`;\r\n            }\r\n        }\r\n    }\r\n    function asHover(hover) {\r\n        if (!hover) {\r\n            return undefined;\r\n        }\r\n        return new code.Hover(asHoverContent(hover.contents), asRange(hover.range));\r\n    }\r\n    function asCompletionResult(result) {\r\n        if (!result) {\r\n            return undefined;\r\n        }\r\n        if (Array.isArray(result)) {\r\n            let items = result;\r\n            return items.map(asCompletionItem);\r\n        }\r\n        let list = result;\r\n        return new code.CompletionList(list.items.map(asCompletionItem), list.isIncomplete);\r\n    }\r\n    function asCompletionItemKind(value) {\r\n        // Protocol item kind is 1 based, codes item kind is zero based.\r\n        if (ls.CompletionItemKind.Text <= value && value <= ls.CompletionItemKind.TypeParameter) {\r\n            return [value - 1, undefined];\r\n        }\r\n        return [code.CompletionItemKind.Text, value];\r\n    }\r\n    function asCompletionItemTag(tag) {\r\n        switch (tag) {\r\n            case ls.CompletionItemTag.Deprecated:\r\n                return code.CompletionItemTag.Deprecated;\r\n        }\r\n        return undefined;\r\n    }\r\n    function asCompletionItemTags(tags) {\r\n        if (tags === undefined || tags === null) {\r\n            return [];\r\n        }\r\n        const result = [];\r\n        for (let tag of tags) {\r\n            const converted = asCompletionItemTag(tag);\r\n            if (converted !== undefined) {\r\n                result.push(converted);\r\n            }\r\n        }\r\n        return result;\r\n    }\r\n    function asCompletionItem(item) {\r\n        let tags = asCompletionItemTags(item.tags);\r\n        let result = new protocolCompletionItem_1.default(item.label);\r\n        if (item.detail) {\r\n            result.detail = item.detail;\r\n        }\r\n        if (item.documentation) {\r\n            result.documentation = asDocumentation(item.documentation);\r\n            result.documentationFormat = Is.string(item.documentation) ? '$string' : item.documentation.kind;\r\n        }\r\n        if (item.filterText) {\r\n            result.filterText = item.filterText;\r\n        }\r\n        let insertText = asCompletionInsertText(item);\r\n        if (insertText) {\r\n            result.insertText = insertText.text;\r\n            result.range = insertText.range;\r\n            result.fromEdit = insertText.fromEdit;\r\n        }\r\n        if (Is.number(item.kind)) {\r\n            let [itemKind, original] = asCompletionItemKind(item.kind);\r\n            result.kind = itemKind;\r\n            if (original) {\r\n                result.originalItemKind = original;\r\n            }\r\n        }\r\n        if (item.sortText) {\r\n            result.sortText = item.sortText;\r\n        }\r\n        if (item.additionalTextEdits) {\r\n            result.additionalTextEdits = asTextEdits(item.additionalTextEdits);\r\n        }\r\n        if (Is.stringArray(item.commitCharacters)) {\r\n            result.commitCharacters = item.commitCharacters.slice();\r\n        }\r\n        if (item.command) {\r\n            result.command = asCommand(item.command);\r\n        }\r\n        if (item.deprecated === true || item.deprecated === false) {\r\n            result.deprecated = item.deprecated;\r\n            if (item.deprecated === true) {\r\n                tags.push(code.CompletionItemTag.Deprecated);\r\n            }\r\n        }\r\n        if (item.preselect === true || item.preselect === false) {\r\n            result.preselect = item.preselect;\r\n        }\r\n        if (item.data !== undefined) {\r\n            result.data = item.data;\r\n        }\r\n        if (tags.length > 0) {\r\n            result.tags = tags;\r\n        }\r\n        return result;\r\n    }\r\n    function asCompletionInsertText(item) {\r\n        if (item.textEdit) {\r\n            if (item.insertTextFormat === ls.InsertTextFormat.Snippet) {\r\n                return { text: new code.SnippetString(item.textEdit.newText), range: asRange(item.textEdit.range), fromEdit: true };\r\n            }\r\n            else {\r\n                return { text: item.textEdit.newText, range: asRange(item.textEdit.range), fromEdit: true };\r\n            }\r\n        }\r\n        else if (item.insertText) {\r\n            if (item.insertTextFormat === ls.InsertTextFormat.Snippet) {\r\n                return { text: new code.SnippetString(item.insertText), fromEdit: false };\r\n            }\r\n            else {\r\n                return { text: item.insertText, fromEdit: false };\r\n            }\r\n        }\r\n        else {\r\n            return undefined;\r\n        }\r\n    }\r\n    function asTextEdit(edit) {\r\n        if (!edit) {\r\n            return undefined;\r\n        }\r\n        return new code.TextEdit(asRange(edit.range), edit.newText);\r\n    }\r\n    function asTextEdits(items) {\r\n        if (!items) {\r\n            return undefined;\r\n        }\r\n        return items.map(asTextEdit);\r\n    }\r\n    function asSignatureHelp(item) {\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        let result = new code.SignatureHelp();\r\n        if (Is.number(item.activeSignature)) {\r\n            result.activeSignature = item.activeSignature;\r\n        }\r\n        else {\r\n            // activeSignature was optional in the past\r\n            result.activeSignature = 0;\r\n        }\r\n        if (Is.number(item.activeParameter)) {\r\n            result.activeParameter = item.activeParameter;\r\n        }\r\n        else {\r\n            // activeParameter was optional in the past\r\n            result.activeParameter = 0;\r\n        }\r\n        if (item.signatures) {\r\n            result.signatures = asSignatureInformations(item.signatures);\r\n        }\r\n        return result;\r\n    }\r\n    function asSignatureInformations(items) {\r\n        return items.map(asSignatureInformation);\r\n    }\r\n    function asSignatureInformation(item) {\r\n        let result = new code.SignatureInformation(item.label);\r\n        if (item.documentation) {\r\n            result.documentation = asDocumentation(item.documentation);\r\n        }\r\n        if (item.parameters) {\r\n            result.parameters = asParameterInformations(item.parameters);\r\n        }\r\n        return result;\r\n    }\r\n    function asParameterInformations(item) {\r\n        return item.map(asParameterInformation);\r\n    }\r\n    function asParameterInformation(item) {\r\n        let result = new code.ParameterInformation(item.label);\r\n        if (item.documentation) {\r\n            result.documentation = asDocumentation(item.documentation);\r\n        }\r\n        return result;\r\n    }\r\n    function asLocation(item) {\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        return new code.Location(_uriConverter(item.uri), asRange(item.range));\r\n    }\r\n    function asDeclarationResult(item) {\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        return asLocationResult(item);\r\n    }\r\n    function asDefinitionResult(item) {\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        return asLocationResult(item);\r\n    }\r\n    function asLocationLink(item) {\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        let result = {\r\n            targetUri: _uriConverter(item.targetUri),\r\n            targetRange: asRange(item.targetSelectionRange),\r\n            originSelectionRange: asRange(item.originSelectionRange),\r\n            targetSelectionRange: asRange(item.targetSelectionRange)\r\n        };\r\n        if (!result.targetSelectionRange) {\r\n            throw new Error(`targetSelectionRange must not be undefined or null`);\r\n        }\r\n        return result;\r\n    }\r\n    function asLocationResult(item) {\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        if (Is.array(item)) {\r\n            if (item.length === 0) {\r\n                return [];\r\n            }\r\n            else if (ls.LocationLink.is(item[0])) {\r\n                let links = item;\r\n                return links.map((link) => asLocationLink(link));\r\n            }\r\n            else {\r\n                let locations = item;\r\n                return locations.map((location) => asLocation(location));\r\n            }\r\n        }\r\n        else if (ls.LocationLink.is(item)) {\r\n            return [asLocationLink(item)];\r\n        }\r\n        else {\r\n            return asLocation(item);\r\n        }\r\n    }\r\n    function asReferences(values) {\r\n        if (!values) {\r\n            return undefined;\r\n        }\r\n        return values.map(location => asLocation(location));\r\n    }\r\n    function asDocumentHighlights(values) {\r\n        if (!values) {\r\n            return undefined;\r\n        }\r\n        return values.map(asDocumentHighlight);\r\n    }\r\n    function asDocumentHighlight(item) {\r\n        let result = new code.DocumentHighlight(asRange(item.range));\r\n        if (Is.number(item.kind)) {\r\n            result.kind = asDocumentHighlightKind(item.kind);\r\n        }\r\n        return result;\r\n    }\r\n    function asDocumentHighlightKind(item) {\r\n        switch (item) {\r\n            case ls.DocumentHighlightKind.Text:\r\n                return code.DocumentHighlightKind.Text;\r\n            case ls.DocumentHighlightKind.Read:\r\n                return code.DocumentHighlightKind.Read;\r\n            case ls.DocumentHighlightKind.Write:\r\n                return code.DocumentHighlightKind.Write;\r\n        }\r\n        return code.DocumentHighlightKind.Text;\r\n    }\r\n    function asSymbolInformations(values, uri) {\r\n        if (!values) {\r\n            return undefined;\r\n        }\r\n        return values.map(information => asSymbolInformation(information, uri));\r\n    }\r\n    function asSymbolKind(item) {\r\n        if (item <= ls.SymbolKind.TypeParameter) {\r\n            // Symbol kind is one based in the protocol and zero based in code.\r\n            return item - 1;\r\n        }\r\n        return code.SymbolKind.Property;\r\n    }\r\n    function asSymbolTag(value) {\r\n        return value;\r\n    }\r\n    function asSymbolTags(items) {\r\n        if (items === undefined || items === null) {\r\n            return undefined;\r\n        }\r\n        return items.map(asSymbolTag);\r\n    }\r\n    function asSymbolInformation(item, uri) {\r\n        // Symbol kind is one based in the protocol and zero based in code.\r\n        let result = new code.SymbolInformation(item.name, asSymbolKind(item.kind), asRange(item.location.range), item.location.uri ? _uriConverter(item.location.uri) : uri);\r\n        if (item.containerName) {\r\n            result.containerName = item.containerName;\r\n        }\r\n        return result;\r\n    }\r\n    function asDocumentSymbols(values) {\r\n        if (values === undefined || values === null) {\r\n            return undefined;\r\n        }\r\n        return values.map(asDocumentSymbol);\r\n    }\r\n    function asDocumentSymbol(value) {\r\n        let result = new code.DocumentSymbol(value.name, value.detail || '', asSymbolKind(value.kind), asRange(value.range), asRange(value.selectionRange));\r\n        if (value.children !== undefined && value.children.length > 0) {\r\n            let children = [];\r\n            for (let child of value.children) {\r\n                children.push(asDocumentSymbol(child));\r\n            }\r\n            result.children = children;\r\n        }\r\n        return result;\r\n    }\r\n    function asCommand(item) {\r\n        let result = { title: item.title, command: item.command };\r\n        if (item.arguments) {\r\n            result.arguments = item.arguments;\r\n        }\r\n        return result;\r\n    }\r\n    function asCommands(items) {\r\n        if (!items) {\r\n            return undefined;\r\n        }\r\n        return items.map(asCommand);\r\n    }\r\n    const kindMapping = new Map();\r\n    kindMapping.set(ls.CodeActionKind.Empty, code.CodeActionKind.Empty);\r\n    kindMapping.set(ls.CodeActionKind.QuickFix, code.CodeActionKind.QuickFix);\r\n    kindMapping.set(ls.CodeActionKind.Refactor, code.CodeActionKind.Refactor);\r\n    kindMapping.set(ls.CodeActionKind.RefactorExtract, code.CodeActionKind.RefactorExtract);\r\n    kindMapping.set(ls.CodeActionKind.RefactorInline, code.CodeActionKind.RefactorInline);\r\n    kindMapping.set(ls.CodeActionKind.RefactorRewrite, code.CodeActionKind.RefactorRewrite);\r\n    kindMapping.set(ls.CodeActionKind.Source, code.CodeActionKind.Source);\r\n    kindMapping.set(ls.CodeActionKind.SourceOrganizeImports, code.CodeActionKind.SourceOrganizeImports);\r\n    function asCodeActionKind(item) {\r\n        if (item === undefined || item === null) {\r\n            return undefined;\r\n        }\r\n        let result = kindMapping.get(item);\r\n        if (result) {\r\n            return result;\r\n        }\r\n        let parts = item.split('.');\r\n        result = code.CodeActionKind.Empty;\r\n        for (let part of parts) {\r\n            result = result.append(part);\r\n        }\r\n        return result;\r\n    }\r\n    function asCodeActionKinds(items) {\r\n        if (items === undefined || items === null) {\r\n            return undefined;\r\n        }\r\n        return items.map(kind => asCodeActionKind(kind));\r\n    }\r\n    function asCodeAction(item) {\r\n        if (item === undefined || item === null) {\r\n            return undefined;\r\n        }\r\n        let result = new code.CodeAction(item.title);\r\n        if (item.kind !== undefined) {\r\n            result.kind = asCodeActionKind(item.kind);\r\n        }\r\n        if (item.diagnostics) {\r\n            result.diagnostics = asDiagnostics(item.diagnostics);\r\n        }\r\n        if (item.edit) {\r\n            result.edit = asWorkspaceEdit(item.edit);\r\n        }\r\n        if (item.command) {\r\n            result.command = asCommand(item.command);\r\n        }\r\n        if (item.isPreferred !== undefined) {\r\n            result.isPreferred = item.isPreferred;\r\n        }\r\n        return result;\r\n    }\r\n    function asCodeLens(item) {\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        let result = new protocolCodeLens_1.default(asRange(item.range));\r\n        if (item.command) {\r\n            result.command = asCommand(item.command);\r\n        }\r\n        if (item.data !== undefined && item.data !== null) {\r\n            result.data = item.data;\r\n        }\r\n        return result;\r\n    }\r\n    function asCodeLenses(items) {\r\n        if (!items) {\r\n            return undefined;\r\n        }\r\n        return items.map((codeLens) => asCodeLens(codeLens));\r\n    }\r\n    function asWorkspaceEdit(item) {\r\n        if (!item) {\r\n            return undefined;\r\n        }\r\n        let result = new code.WorkspaceEdit();\r\n        if (item.documentChanges) {\r\n            item.documentChanges.forEach(change => {\r\n                if (ls.CreateFile.is(change)) {\r\n                    result.createFile(_uriConverter(change.uri), change.options);\r\n                }\r\n                else if (ls.RenameFile.is(change)) {\r\n                    result.renameFile(_uriConverter(change.oldUri), _uriConverter(change.newUri), change.options);\r\n                }\r\n                else if (ls.DeleteFile.is(change)) {\r\n                    result.deleteFile(_uriConverter(change.uri), change.options);\r\n                }\r\n                else if (ls.TextDocumentEdit.is(change)) {\r\n                    result.set(_uriConverter(change.textDocument.uri), asTextEdits(change.edits));\r\n                }\r\n                else {\r\n                    console.error(`Unknown workspace edit change received:\\n${JSON.stringify(change, undefined, 4)}`);\r\n                }\r\n            });\r\n        }\r\n        else if (item.changes) {\r\n            Object.keys(item.changes).forEach(key => {\r\n                result.set(_uriConverter(key), asTextEdits(item.changes[key]));\r\n            });\r\n        }\r\n        return result;\r\n    }\r\n    function asDocumentLink(item) {\r\n        let range = asRange(item.range);\r\n        let target = item.target ? asUri(item.target) : undefined;\r\n        // target must be optional in DocumentLink\r\n        let link = new protocolDocumentLink_1.default(range, target);\r\n        if (item.tooltip !== undefined) {\r\n            link.tooltip = item.tooltip;\r\n        }\r\n        if (item.data !== undefined && item.data !== null) {\r\n            link.data = item.data;\r\n        }\r\n        return link;\r\n    }\r\n    function asDocumentLinks(items) {\r\n        if (!items) {\r\n            return undefined;\r\n        }\r\n        return items.map(asDocumentLink);\r\n    }\r\n    function asColor(color) {\r\n        return new code.Color(color.red, color.green, color.blue, color.alpha);\r\n    }\r\n    function asColorInformation(ci) {\r\n        return new code.ColorInformation(asRange(ci.range), asColor(ci.color));\r\n    }\r\n    function asColorInformations(colorInformation) {\r\n        if (Array.isArray(colorInformation)) {\r\n            return colorInformation.map(asColorInformation);\r\n        }\r\n        return undefined;\r\n    }\r\n    function asColorPresentation(cp) {\r\n        let presentation = new code.ColorPresentation(cp.label);\r\n        presentation.additionalTextEdits = asTextEdits(cp.additionalTextEdits);\r\n        if (cp.textEdit) {\r\n            presentation.textEdit = asTextEdit(cp.textEdit);\r\n        }\r\n        return presentation;\r\n    }\r\n    function asColorPresentations(colorPresentations) {\r\n        if (Array.isArray(colorPresentations)) {\r\n            return colorPresentations.map(asColorPresentation);\r\n        }\r\n        return undefined;\r\n    }\r\n    function asFoldingRangeKind(kind) {\r\n        if (kind) {\r\n            switch (kind) {\r\n                case ls.FoldingRangeKind.Comment:\r\n                    return code.FoldingRangeKind.Comment;\r\n                case ls.FoldingRangeKind.Imports:\r\n                    return code.FoldingRangeKind.Imports;\r\n                case ls.FoldingRangeKind.Region:\r\n                    return code.FoldingRangeKind.Region;\r\n            }\r\n        }\r\n        return undefined;\r\n    }\r\n    function asFoldingRange(r) {\r\n        return new code.FoldingRange(r.startLine, r.endLine, asFoldingRangeKind(r.kind));\r\n    }\r\n    function asFoldingRanges(foldingRanges) {\r\n        if (Array.isArray(foldingRanges)) {\r\n            return foldingRanges.map(asFoldingRange);\r\n        }\r\n        return undefined;\r\n    }\r\n    function asSelectionRange(selectionRange) {\r\n        return new code.SelectionRange(asRange(selectionRange.range), selectionRange.parent ? asSelectionRange(selectionRange.parent) : undefined);\r\n    }\r\n    function asSelectionRanges(selectionRanges) {\r\n        if (!Array.isArray(selectionRanges)) {\r\n            return [];\r\n        }\r\n        let result = [];\r\n        for (let range of selectionRanges) {\r\n            result.push(asSelectionRange(range));\r\n        }\r\n        return result;\r\n    }\r\n    return {\r\n        asUri,\r\n        asDiagnostics,\r\n        asDiagnostic,\r\n        asRange,\r\n        asRanges,\r\n        asPosition,\r\n        asDiagnosticSeverity,\r\n        asDiagnosticTag,\r\n        asHover,\r\n        asCompletionResult,\r\n        asCompletionItem,\r\n        asTextEdit,\r\n        asTextEdits,\r\n        asSignatureHelp,\r\n        asSignatureInformations,\r\n        asSignatureInformation,\r\n        asParameterInformations,\r\n        asParameterInformation,\r\n        asDeclarationResult,\r\n        asDefinitionResult,\r\n        asLocation,\r\n        asReferences,\r\n        asDocumentHighlights,\r\n        asDocumentHighlight,\r\n        asDocumentHighlightKind,\r\n        asSymbolKind,\r\n        asSymbolTag,\r\n        asSymbolTags,\r\n        asSymbolInformations,\r\n        asSymbolInformation,\r\n        asDocumentSymbols,\r\n        asDocumentSymbol,\r\n        asCommand,\r\n        asCommands,\r\n        asCodeAction,\r\n        asCodeActionKind,\r\n        asCodeActionKinds,\r\n        asCodeLens,\r\n        asCodeLenses,\r\n        asWorkspaceEdit,\r\n        asDocumentLink,\r\n        asDocumentLinks,\r\n        asFoldingRangeKind,\r\n        asFoldingRange,\r\n        asFoldingRanges,\r\n        asColor,\r\n        asColorInformation,\r\n        asColorInformations,\r\n        asColorPresentation,\r\n        asColorPresentations,\r\n        asSelectionRange,\r\n        asSelectionRanges\r\n    };\r\n}\r\nexports.createConverter = createConverter;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst code = require(\"vscode\");\r\nclass ProtocolDocumentLink extends code.DocumentLink {\r\n    constructor(range, target) {\r\n        super(range, target);\r\n    }\r\n}\r\nexports.default = ProtocolDocumentLink;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_1 = require(\"vscode\");\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nconst client_1 = require(\"./client\");\r\nfunction ensure(target, key) {\r\n    if (target[key] === void 0) {\r\n        target[key] = Object.create(null);\r\n    }\r\n    return target[key];\r\n}\r\nclass SelectionRangeFeature extends client_1.TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.SelectionRangeRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        let capability = ensure(ensure(capabilites, 'textDocument'), 'selectionRange');\r\n        capability.dynamicRegistration = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        let [id, options] = this.getRegistration(documentSelector, capabilities.selectionRangeProvider);\r\n        if (!id || !options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: id, registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideSelectionRanges: (document, positions, token) => {\r\n                const client = this._client;\r\n                const provideSelectionRanges = (document, positions, token) => {\r\n                    const requestParams = {\r\n                        textDocument: client.code2ProtocolConverter.asTextDocumentIdentifier(document),\r\n                        positions: client.code2ProtocolConverter.asPositions(positions)\r\n                    };\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.SelectionRangeRequest.type, requestParams, token).then((ranges) => client.protocol2CodeConverter.asSelectionRanges(ranges), (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.SelectionRangeRequest.type, error);\r\n                        return Promise.resolve(null);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideSelectionRanges\r\n                    ? middleware.provideSelectionRanges(document, positions, token, provideSelectionRanges)\r\n                    : provideSelectionRanges(document, positions, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerSelectionRangeProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nexports.SelectionRangeFeature = SelectionRangeFeature;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode = require(\"vscode\");\r\nconst client_1 = require(\"./client\");\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nfunction ensure(target, key) {\r\n    if (target[key] === void 0) {\r\n        target[key] = {};\r\n    }\r\n    return target[key];\r\n}\r\nvar protocol2code;\r\n(function (protocol2code) {\r\n    function asSemanticTokens(value) {\r\n        if (value === undefined || value === null) {\r\n            return undefined;\r\n        }\r\n        return new vscode.SemanticTokens(new Uint32Array(value.data), value.resultId);\r\n    }\r\n    protocol2code.asSemanticTokens = asSemanticTokens;\r\n    function asSemanticTokensEdit(value) {\r\n        return new vscode.SemanticTokensEdit(value.start, value.deleteCount, value.data !== undefined ? new Uint32Array(value.data) : undefined);\r\n    }\r\n    protocol2code.asSemanticTokensEdit = asSemanticTokensEdit;\r\n    function asSemanticTokensEdits(value) {\r\n        if (value === undefined || value === null) {\r\n            return undefined;\r\n        }\r\n        return new vscode.SemanticTokensEdits(value.edits.map(asSemanticTokensEdit), value.resultId);\r\n    }\r\n    protocol2code.asSemanticTokensEdits = asSemanticTokensEdits;\r\n    function asLegend(value) {\r\n        return value;\r\n    }\r\n    protocol2code.asLegend = asLegend;\r\n})(protocol2code || (protocol2code = {}));\r\nclass SemanticTokensFeature extends client_1.TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.Proposed.SemanticTokensRequest.type);\r\n    }\r\n    fillClientCapabilities(cap) {\r\n        const capabilites = cap;\r\n        let capability = ensure(ensure(capabilites, 'textDocument'), 'semanticTokens');\r\n        capability.dynamicRegistration = true;\r\n        capability.tokenTypes = [\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.comment,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.keyword,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.number,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.regexp,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.operator,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.namespace,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.type,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.struct,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.class,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.interface,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.enum,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.typeParameter,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.function,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.member,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.macro,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.variable,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.parameter,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.property,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenTypes.label\r\n        ];\r\n        capability.tokenModifiers = [\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenModifiers.declaration,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenModifiers.documentation,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenModifiers.static,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenModifiers.abstract,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenModifiers.deprecated,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenModifiers.async,\r\n            vscode_languageserver_protocol_1.Proposed.SemanticTokenModifiers.readonly\r\n        ];\r\n    }\r\n    initialize(cap, documentSelector) {\r\n        const capabilities = cap;\r\n        let [id, options] = this.getRegistration(documentSelector, capabilities.semanticTokensProvider);\r\n        if (!id || !options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: id, registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const hasEditProvider = options.documentProvider !== undefined && typeof options.documentProvider !== 'boolean' && options.documentProvider.edits === true;\r\n        const documentProvider = {\r\n            provideDocumentSemanticTokens: (document, token) => {\r\n                const client = this._client;\r\n                const middleware = client.clientOptions.middleware;\r\n                const provideDocumentSemanticTokens = (document, token) => {\r\n                    const params = {\r\n                        textDocument: client.code2ProtocolConverter.asTextDocumentIdentifier(document)\r\n                    };\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.Proposed.SemanticTokensRequest.type, params, token).then((result) => {\r\n                        return protocol2code.asSemanticTokens(result);\r\n                    }, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.Proposed.SemanticTokensRequest.type, error);\r\n                        return undefined;\r\n                    });\r\n                };\r\n                return middleware.provideDocumentSemanticTokens\r\n                    ? middleware.provideDocumentSemanticTokens(document, token, provideDocumentSemanticTokens)\r\n                    : provideDocumentSemanticTokens(document, token);\r\n            },\r\n            provideDocumentSemanticTokensEdits: hasEditProvider\r\n                ? (document, previousResultId, token) => {\r\n                    const client = this._client;\r\n                    const middleware = client.clientOptions.middleware;\r\n                    const provideDocumentSemanticTokensEdits = (document, previousResultId, token) => {\r\n                        const params = {\r\n                            textDocument: client.code2ProtocolConverter.asTextDocumentIdentifier(document),\r\n                            previousResultId\r\n                        };\r\n                        return client.sendRequest(vscode_languageserver_protocol_1.Proposed.SemanticTokensEditsRequest.type, params, token).then((result) => {\r\n                            if (vscode_languageserver_protocol_1.Proposed.SemanticTokens.is(result)) {\r\n                                return protocol2code.asSemanticTokens(result);\r\n                            }\r\n                            else {\r\n                                return protocol2code.asSemanticTokensEdits(result);\r\n                            }\r\n                        }, (error) => {\r\n                            client.logFailedRequest(vscode_languageserver_protocol_1.Proposed.SemanticTokensEditsRequest.type, error);\r\n                            return undefined;\r\n                        });\r\n                    };\r\n                    return middleware.provideDocumentSemanticTokensEdits\r\n                        ? middleware.provideDocumentSemanticTokensEdits(document, previousResultId, token, provideDocumentSemanticTokensEdits)\r\n                        : provideDocumentSemanticTokensEdits(document, previousResultId, token);\r\n                }\r\n                : undefined\r\n        };\r\n        const hasRangeProvider = options.rangeProvider === true;\r\n        const rangeProvider = hasRangeProvider\r\n            ? {\r\n                provideDocumentRangeSemanticTokens: (document, range, token) => {\r\n                    const client = this._client;\r\n                    const middleware = client.clientOptions.middleware;\r\n                    const provideDocumentRangeSemanticTokens = (document, range, token) => {\r\n                        const params = {\r\n                            textDocument: client.code2ProtocolConverter.asTextDocumentIdentifier(document),\r\n                            range: client.code2ProtocolConverter.asRange(range)\r\n                        };\r\n                        return client.sendRequest(vscode_languageserver_protocol_1.Proposed.SemanticTokensRangeRequest.type, params, token).then((result) => {\r\n                            return protocol2code.asSemanticTokens(result);\r\n                        }, (error) => {\r\n                            client.logFailedRequest(vscode_languageserver_protocol_1.Proposed.SemanticTokensRangeRequest.type, error);\r\n                            return undefined;\r\n                        });\r\n                    };\r\n                    return middleware.provideDocumentRangeSemanticTokens\r\n                        ? middleware.provideDocumentRangeSemanticTokens(document, range, token, provideDocumentRangeSemanticTokens)\r\n                        : provideDocumentRangeSemanticTokens(document, range, token);\r\n                }\r\n            }\r\n            : undefined;\r\n        const disposables = [];\r\n        const legend = protocol2code.asLegend(options.legend);\r\n        disposables.push(vscode.languages.registerDocumentSemanticTokensProvider(options.documentSelector, documentProvider, legend));\r\n        if (rangeProvider !== undefined) {\r\n            disposables.push(vscode.languages.registerDocumentRangeSemanticTokensProvider(options.documentSelector, rangeProvider, legend));\r\n        }\r\n        return [new vscode.Disposable(() => disposables.forEach(item => item.dispose())), { document: documentProvider, range: rangeProvider }];\r\n    }\r\n}\r\nexports.SemanticTokensFeature = SemanticTokensFeature;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_1 = require(\"vscode\");\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nconst client_1 = require(\"./client\");\r\nfunction ensure(target, key) {\r\n    if (target[key] === void 0) {\r\n        target[key] = {};\r\n    }\r\n    return target[key];\r\n}\r\nclass TypeDefinitionFeature extends client_1.TextDocumentFeature {\r\n    constructor(client) {\r\n        super(client, vscode_languageserver_protocol_1.TypeDefinitionRequest.type);\r\n    }\r\n    fillClientCapabilities(capabilites) {\r\n        ensure(ensure(capabilites, 'textDocument'), 'typeDefinition').dynamicRegistration = true;\r\n        let typeDefinitionSupport = ensure(ensure(capabilites, 'textDocument'), 'typeDefinition');\r\n        typeDefinitionSupport.dynamicRegistration = true;\r\n        typeDefinitionSupport.linkSupport = true;\r\n    }\r\n    initialize(capabilities, documentSelector) {\r\n        let [id, options] = this.getRegistration(documentSelector, capabilities.typeDefinitionProvider);\r\n        if (!id || !options) {\r\n            return;\r\n        }\r\n        this.register(this.messages, { id: id, registerOptions: options });\r\n    }\r\n    registerLanguageProvider(options) {\r\n        const provider = {\r\n            provideTypeDefinition: (document, position, token) => {\r\n                const client = this._client;\r\n                const provideTypeDefinition = (document, position, token) => {\r\n                    return client.sendRequest(vscode_languageserver_protocol_1.TypeDefinitionRequest.type, client.code2ProtocolConverter.asTextDocumentPositionParams(document, position), token).then(client.protocol2CodeConverter.asDefinitionResult, (error) => {\r\n                        client.logFailedRequest(vscode_languageserver_protocol_1.TypeDefinitionRequest.type, error);\r\n                        return Promise.resolve(null);\r\n                    });\r\n                };\r\n                const middleware = client.clientOptions.middleware;\r\n                return middleware.provideTypeDefinition\r\n                    ? middleware.provideTypeDefinition(document, position, token, provideTypeDefinition)\r\n                    : provideTypeDefinition(document, position, token);\r\n            }\r\n        };\r\n        return [vscode_1.languages.registerTypeDefinitionProvider(options.documentSelector, provider), provider];\r\n    }\r\n}\r\nexports.TypeDefinitionFeature = TypeDefinitionFeature;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass Delayer {\r\n    constructor(defaultDelay) {\r\n        this.defaultDelay = defaultDelay;\r\n        this.timeout = undefined;\r\n        this.completionPromise = undefined;\r\n        this.onSuccess = undefined;\r\n        this.task = undefined;\r\n    }\r\n    trigger(task, delay = this.defaultDelay) {\r\n        this.task = task;\r\n        if (delay >= 0) {\r\n            this.cancelTimeout();\r\n        }\r\n        if (!this.completionPromise) {\r\n            this.completionPromise = new Promise((resolve) => {\r\n                this.onSuccess = resolve;\r\n            }).then(() => {\r\n                this.completionPromise = undefined;\r\n                this.onSuccess = undefined;\r\n                var result = this.task();\r\n                this.task = undefined;\r\n                return result;\r\n            });\r\n        }\r\n        if (delay >= 0 || this.timeout === void 0) {\r\n            this.timeout = setTimeout(() => {\r\n                this.timeout = undefined;\r\n                this.onSuccess(undefined);\r\n            }, delay >= 0 ? delay : this.defaultDelay);\r\n        }\r\n        return this.completionPromise;\r\n    }\r\n    forceDelivery() {\r\n        if (!this.completionPromise) {\r\n            return undefined;\r\n        }\r\n        this.cancelTimeout();\r\n        let result = this.task();\r\n        this.completionPromise = undefined;\r\n        this.onSuccess = undefined;\r\n        this.task = undefined;\r\n        return result;\r\n    }\r\n    isTriggered() {\r\n        return this.timeout !== void 0;\r\n    }\r\n    cancel() {\r\n        this.cancelTimeout();\r\n        this.completionPromise = undefined;\r\n    }\r\n    cancelTimeout() {\r\n        if (this.timeout !== void 0) {\r\n            clearTimeout(this.timeout);\r\n            this.timeout = undefined;\r\n        }\r\n    }\r\n}\r\nexports.Delayer = Delayer;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction boolean(value) {\r\n    return value === true || value === false;\r\n}\r\nexports.boolean = boolean;\r\nfunction string(value) {\r\n    return typeof value === 'string' || value instanceof String;\r\n}\r\nexports.string = string;\r\nfunction number(value) {\r\n    return typeof value === 'number' || value instanceof Number;\r\n}\r\nexports.number = number;\r\nfunction error(value) {\r\n    return value instanceof Error;\r\n}\r\nexports.error = error;\r\nfunction func(value) {\r\n    return typeof value === 'function';\r\n}\r\nexports.func = func;\r\nfunction array(value) {\r\n    return Array.isArray(value);\r\n}\r\nexports.array = array;\r\nfunction stringArray(value) {\r\n    return array(value) && value.every(elem => string(elem));\r\n}\r\nexports.stringArray = stringArray;\r\nfunction typedArray(value, check) {\r\n    return Array.isArray(value) && value.every(check);\r\n}\r\nexports.typedArray = typedArray;\r\nfunction thenable(value) {\r\n    return value && func(value.then);\r\n}\r\nexports.thenable = thenable;\r\nfunction asPromise(value) {\r\n    if (value instanceof Promise) {\r\n        return value;\r\n    }\r\n    else if (thenable(value)) {\r\n        return new Promise((resolve, reject) => {\r\n            value.then((resolved) => resolve(resolved), (error) => reject(error));\r\n        });\r\n    }\r\n    else {\r\n        return Promise.resolve(value);\r\n    }\r\n}\r\nexports.asPromise = asPromise;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst cp = require(\"child_process\");\r\nconst path_1 = require(\"path\");\r\nconst isWindows = (process.platform === 'win32');\r\nconst isMacintosh = (process.platform === 'darwin');\r\nconst isLinux = (process.platform === 'linux');\r\nfunction terminate(process, cwd) {\r\n    if (isWindows) {\r\n        try {\r\n            // This we run in Atom execFileSync is available.\r\n            // Ignore stderr since this is otherwise piped to parent.stderr\r\n            // which might be already closed.\r\n            let options = {\r\n                stdio: ['pipe', 'pipe', 'ignore']\r\n            };\r\n            if (cwd) {\r\n                options.cwd = cwd;\r\n            }\r\n            cp.execFileSync('taskkill', ['/T', '/F', '/PID', process.pid.toString()], options);\r\n            return true;\r\n        }\r\n        catch (err) {\r\n            return false;\r\n        }\r\n    }\r\n    else if (isLinux || isMacintosh) {\r\n        try {\r\n            var cmd = path_1.join(__dirname, 'terminateProcess.sh');\r\n            var result = cp.spawnSync(cmd, [process.pid.toString()]);\r\n            return result.error ? false : true;\r\n        }\r\n        catch (err) {\r\n            return false;\r\n        }\r\n    }\r\n    else {\r\n        process.kill('SIGKILL');\r\n        return true;\r\n    }\r\n}\r\nexports.terminate = terminate;\r\n","/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nclass ValueUUID {\r\n    constructor(_value) {\r\n        this._value = _value;\r\n        // empty\r\n    }\r\n    asHex() {\r\n        return this._value;\r\n    }\r\n    equals(other) {\r\n        return this.asHex() === other.asHex();\r\n    }\r\n}\r\nclass V4UUID extends ValueUUID {\r\n    constructor() {\r\n        super([\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            '-',\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            '-',\r\n            '4',\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            '-',\r\n            V4UUID._oneOf(V4UUID._timeHighBits),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            '-',\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n            V4UUID._randomHex(),\r\n        ].join(''));\r\n    }\r\n    static _oneOf(array) {\r\n        return array[Math.floor(array.length * Math.random())];\r\n    }\r\n    static _randomHex() {\r\n        return V4UUID._oneOf(V4UUID._chars);\r\n    }\r\n}\r\nV4UUID._chars = ['0', '1', '2', '3', '4', '5', '6', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f'];\r\nV4UUID._timeHighBits = ['8', '9', 'a', 'b'];\r\n/**\r\n * An empty UUID that contains only zeros.\r\n */\r\nexports.empty = new ValueUUID('00000000-0000-0000-0000-000000000000');\r\nfunction v4() {\r\n    return new V4UUID();\r\n}\r\nexports.v4 = v4;\r\nconst _UUIDPattern = /^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i;\r\nfunction isUUID(value) {\r\n    return _UUIDPattern.test(value);\r\n}\r\nexports.isUUID = isUUID;\r\n/**\r\n * Parses a UUID that is of the format xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx.\r\n * @param value A uuid string.\r\n */\r\nfunction parse(value) {\r\n    if (!isUUID(value)) {\r\n        throw new Error('invalid uuid');\r\n    }\r\n    return new ValueUUID(value);\r\n}\r\nexports.parse = parse;\r\nfunction generateUuid() {\r\n    return v4().asHex();\r\n}\r\nexports.generateUuid = generateUuid;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst UUID = require(\"./utils/uuid\");\r\nconst vscode_1 = require(\"vscode\");\r\nconst vscode_languageserver_protocol_1 = require(\"vscode-languageserver-protocol\");\r\nfunction access(target, key) {\r\n    if (target === void 0) {\r\n        return undefined;\r\n    }\r\n    return target[key];\r\n}\r\nfunction arrayDiff(left, right) {\r\n    return left.filter(element => right.indexOf(element) < 0);\r\n}\r\nexports.arrayDiff = arrayDiff;\r\nclass WorkspaceFoldersFeature {\r\n    constructor(_client) {\r\n        this._client = _client;\r\n        this._listeners = new Map();\r\n    }\r\n    get messages() {\r\n        return vscode_languageserver_protocol_1.DidChangeWorkspaceFoldersNotification.type;\r\n    }\r\n    fillInitializeParams(params) {\r\n        let folders = vscode_1.workspace.workspaceFolders;\r\n        this.initializeWithFolders(folders);\r\n        if (folders === void 0) {\r\n            params.workspaceFolders = null;\r\n        }\r\n        else {\r\n            params.workspaceFolders = folders.map(folder => this.asProtocol(folder));\r\n        }\r\n    }\r\n    initializeWithFolders(currentWorkspaceFolders) {\r\n        this._initialFolders = currentWorkspaceFolders;\r\n    }\r\n    fillClientCapabilities(capabilities) {\r\n        capabilities.workspace = capabilities.workspace || {};\r\n        capabilities.workspace.workspaceFolders = true;\r\n    }\r\n    initialize(capabilities) {\r\n        let client = this._client;\r\n        client.onRequest(vscode_languageserver_protocol_1.WorkspaceFoldersRequest.type, (token) => {\r\n            let workspaceFolders = () => {\r\n                let folders = vscode_1.workspace.workspaceFolders;\r\n                if (folders === void 0) {\r\n                    return null;\r\n                }\r\n                let result = folders.map((folder) => {\r\n                    return this.asProtocol(folder);\r\n                });\r\n                return result;\r\n            };\r\n            let middleware = client.clientOptions.middleware.workspace;\r\n            return middleware && middleware.workspaceFolders\r\n                ? middleware.workspaceFolders(token, workspaceFolders)\r\n                : workspaceFolders(token);\r\n        });\r\n        let value = access(access(access(capabilities, 'workspace'), 'workspaceFolders'), 'changeNotifications');\r\n        let id;\r\n        if (typeof value === 'string') {\r\n            id = value;\r\n        }\r\n        else if (value === true) {\r\n            id = UUID.generateUuid();\r\n        }\r\n        if (id) {\r\n            this.register(this.messages, {\r\n                id: id,\r\n                registerOptions: undefined\r\n            });\r\n        }\r\n    }\r\n    sendInitialEvent(currentWorkspaceFolders) {\r\n        if (this._initialFolders && currentWorkspaceFolders) {\r\n            const removed = arrayDiff(this._initialFolders, currentWorkspaceFolders);\r\n            const added = arrayDiff(currentWorkspaceFolders, this._initialFolders);\r\n            if (added.length > 0 || removed.length > 0) {\r\n                this.doSendEvent(added, removed);\r\n            }\r\n        }\r\n        else if (this._initialFolders) {\r\n            this.doSendEvent([], this._initialFolders);\r\n        }\r\n        else if (currentWorkspaceFolders) {\r\n            this.doSendEvent(currentWorkspaceFolders, []);\r\n        }\r\n    }\r\n    doSendEvent(addedFolders, removedFolders) {\r\n        let params = {\r\n            event: {\r\n                added: addedFolders.map(folder => this.asProtocol(folder)),\r\n                removed: removedFolders.map(folder => this.asProtocol(folder))\r\n            }\r\n        };\r\n        this._client.sendNotification(vscode_languageserver_protocol_1.DidChangeWorkspaceFoldersNotification.type, params);\r\n    }\r\n    register(_message, data) {\r\n        let id = data.id;\r\n        let client = this._client;\r\n        let disposable = vscode_1.workspace.onDidChangeWorkspaceFolders((event) => {\r\n            let didChangeWorkspaceFolders = (event) => {\r\n                this.doSendEvent(event.added, event.removed);\r\n            };\r\n            let middleware = client.clientOptions.middleware.workspace;\r\n            middleware && middleware.didChangeWorkspaceFolders\r\n                ? middleware.didChangeWorkspaceFolders(event, didChangeWorkspaceFolders)\r\n                : didChangeWorkspaceFolders(event);\r\n        });\r\n        this._listeners.set(id, disposable);\r\n        this.sendInitialEvent(vscode_1.workspace.workspaceFolders);\r\n    }\r\n    unregister(id) {\r\n        let disposable = this._listeners.get(id);\r\n        if (disposable === void 0) {\r\n            return;\r\n        }\r\n        this._listeners.delete(id);\r\n        disposable.dispose();\r\n    }\r\n    dispose() {\r\n        for (let disposable of this._listeners.values()) {\r\n            disposable.dispose();\r\n        }\r\n        this._listeners.clear();\r\n    }\r\n    asProtocol(workspaceFolder) {\r\n        if (workspaceFolder === void 0) {\r\n            return null;\r\n        }\r\n        return { uri: this._client.code2ProtocolConverter.asUri(workspaceFolder.uri), name: workspaceFolder.name };\r\n    }\r\n}\r\nexports.WorkspaceFoldersFeature = WorkspaceFoldersFeature;\r\n","exports = module.exports = SemVer\n\nvar debug\n/* istanbul ignore next */\nif (typeof process === 'object' &&\n    process.env &&\n    process.env.NODE_DEBUG &&\n    /\\bsemver\\b/i.test(process.env.NODE_DEBUG)) {\n  debug = function () {\n    var args = Array.prototype.slice.call(arguments, 0)\n    args.unshift('SEMVER')\n    console.log.apply(console, args)\n  }\n} else {\n  debug = function () {}\n}\n\n// Note: this is the semver.org version of the spec that it implements\n// Not necessarily the package version of this code.\nexports.SEMVER_SPEC_VERSION = '2.0.0'\n\nvar MAX_LENGTH = 256\nvar MAX_SAFE_INTEGER = Number.MAX_SAFE_INTEGER ||\n  /* istanbul ignore next */ 9007199254740991\n\n// Max safe segment length for coercion.\nvar MAX_SAFE_COMPONENT_LENGTH = 16\n\n// The actual regexps go on exports.re\nvar re = exports.re = []\nvar src = exports.src = []\nvar t = exports.tokens = {}\nvar R = 0\n\nfunction tok (n) {\n  t[n] = R++\n}\n\n// The following Regular Expressions can be used for tokenizing,\n// validating, and parsing SemVer version strings.\n\n// ## Numeric Identifier\n// A single `0`, or a non-zero digit followed by zero or more digits.\n\ntok('NUMERICIDENTIFIER')\nsrc[t.NUMERICIDENTIFIER] = '0|[1-9]\\\\d*'\ntok('NUMERICIDENTIFIERLOOSE')\nsrc[t.NUMERICIDENTIFIERLOOSE] = '[0-9]+'\n\n// ## Non-numeric Identifier\n// Zero or more digits, followed by a letter or hyphen, and then zero or\n// more letters, digits, or hyphens.\n\ntok('NONNUMERICIDENTIFIER')\nsrc[t.NONNUMERICIDENTIFIER] = '\\\\d*[a-zA-Z-][a-zA-Z0-9-]*'\n\n// ## Main Version\n// Three dot-separated numeric identifiers.\n\ntok('MAINVERSION')\nsrc[t.MAINVERSION] = '(' + src[t.NUMERICIDENTIFIER] + ')\\\\.' +\n                   '(' + src[t.NUMERICIDENTIFIER] + ')\\\\.' +\n                   '(' + src[t.NUMERICIDENTIFIER] + ')'\n\ntok('MAINVERSIONLOOSE')\nsrc[t.MAINVERSIONLOOSE] = '(' + src[t.NUMERICIDENTIFIERLOOSE] + ')\\\\.' +\n                        '(' + src[t.NUMERICIDENTIFIERLOOSE] + ')\\\\.' +\n                        '(' + src[t.NUMERICIDENTIFIERLOOSE] + ')'\n\n// ## Pre-release Version Identifier\n// A numeric identifier, or a non-numeric identifier.\n\ntok('PRERELEASEIDENTIFIER')\nsrc[t.PRERELEASEIDENTIFIER] = '(?:' + src[t.NUMERICIDENTIFIER] +\n                            '|' + src[t.NONNUMERICIDENTIFIER] + ')'\n\ntok('PRERELEASEIDENTIFIERLOOSE')\nsrc[t.PRERELEASEIDENTIFIERLOOSE] = '(?:' + src[t.NUMERICIDENTIFIERLOOSE] +\n                                 '|' + src[t.NONNUMERICIDENTIFIER] + ')'\n\n// ## Pre-release Version\n// Hyphen, followed by one or more dot-separated pre-release version\n// identifiers.\n\ntok('PRERELEASE')\nsrc[t.PRERELEASE] = '(?:-(' + src[t.PRERELEASEIDENTIFIER] +\n                  '(?:\\\\.' + src[t.PRERELEASEIDENTIFIER] + ')*))'\n\ntok('PRERELEASELOOSE')\nsrc[t.PRERELEASELOOSE] = '(?:-?(' + src[t.PRERELEASEIDENTIFIERLOOSE] +\n                       '(?:\\\\.' + src[t.PRERELEASEIDENTIFIERLOOSE] + ')*))'\n\n// ## Build Metadata Identifier\n// Any combination of digits, letters, or hyphens.\n\ntok('BUILDIDENTIFIER')\nsrc[t.BUILDIDENTIFIER] = '[0-9A-Za-z-]+'\n\n// ## Build Metadata\n// Plus sign, followed by one or more period-separated build metadata\n// identifiers.\n\ntok('BUILD')\nsrc[t.BUILD] = '(?:\\\\+(' + src[t.BUILDIDENTIFIER] +\n             '(?:\\\\.' + src[t.BUILDIDENTIFIER] + ')*))'\n\n// ## Full Version String\n// A main version, followed optionally by a pre-release version and\n// build metadata.\n\n// Note that the only major, minor, patch, and pre-release sections of\n// the version string are capturing groups.  The build metadata is not a\n// capturing group, because it should not ever be used in version\n// comparison.\n\ntok('FULL')\ntok('FULLPLAIN')\nsrc[t.FULLPLAIN] = 'v?' + src[t.MAINVERSION] +\n                  src[t.PRERELEASE] + '?' +\n                  src[t.BUILD] + '?'\n\nsrc[t.FULL] = '^' + src[t.FULLPLAIN] + '$'\n\n// like full, but allows v1.2.3 and =1.2.3, which people do sometimes.\n// also, 1.0.0alpha1 (prerelease without the hyphen) which is pretty\n// common in the npm registry.\ntok('LOOSEPLAIN')\nsrc[t.LOOSEPLAIN] = '[v=\\\\s]*' + src[t.MAINVERSIONLOOSE] +\n                  src[t.PRERELEASELOOSE] + '?' +\n                  src[t.BUILD] + '?'\n\ntok('LOOSE')\nsrc[t.LOOSE] = '^' + src[t.LOOSEPLAIN] + '$'\n\ntok('GTLT')\nsrc[t.GTLT] = '((?:<|>)?=?)'\n\n// Something like \"2.*\" or \"1.2.x\".\n// Note that \"x.x\" is a valid xRange identifer, meaning \"any version\"\n// Only the first item is strictly required.\ntok('XRANGEIDENTIFIERLOOSE')\nsrc[t.XRANGEIDENTIFIERLOOSE] = src[t.NUMERICIDENTIFIERLOOSE] + '|x|X|\\\\*'\ntok('XRANGEIDENTIFIER')\nsrc[t.XRANGEIDENTIFIER] = src[t.NUMERICIDENTIFIER] + '|x|X|\\\\*'\n\ntok('XRANGEPLAIN')\nsrc[t.XRANGEPLAIN] = '[v=\\\\s]*(' + src[t.XRANGEIDENTIFIER] + ')' +\n                   '(?:\\\\.(' + src[t.XRANGEIDENTIFIER] + ')' +\n                   '(?:\\\\.(' + src[t.XRANGEIDENTIFIER] + ')' +\n                   '(?:' + src[t.PRERELEASE] + ')?' +\n                   src[t.BUILD] + '?' +\n                   ')?)?'\n\ntok('XRANGEPLAINLOOSE')\nsrc[t.XRANGEPLAINLOOSE] = '[v=\\\\s]*(' + src[t.XRANGEIDENTIFIERLOOSE] + ')' +\n                        '(?:\\\\.(' + src[t.XRANGEIDENTIFIERLOOSE] + ')' +\n                        '(?:\\\\.(' + src[t.XRANGEIDENTIFIERLOOSE] + ')' +\n                        '(?:' + src[t.PRERELEASELOOSE] + ')?' +\n                        src[t.BUILD] + '?' +\n                        ')?)?'\n\ntok('XRANGE')\nsrc[t.XRANGE] = '^' + src[t.GTLT] + '\\\\s*' + src[t.XRANGEPLAIN] + '$'\ntok('XRANGELOOSE')\nsrc[t.XRANGELOOSE] = '^' + src[t.GTLT] + '\\\\s*' + src[t.XRANGEPLAINLOOSE] + '$'\n\n// Coercion.\n// Extract anything that could conceivably be a part of a valid semver\ntok('COERCE')\nsrc[t.COERCE] = '(^|[^\\\\d])' +\n              '(\\\\d{1,' + MAX_SAFE_COMPONENT_LENGTH + '})' +\n              '(?:\\\\.(\\\\d{1,' + MAX_SAFE_COMPONENT_LENGTH + '}))?' +\n              '(?:\\\\.(\\\\d{1,' + MAX_SAFE_COMPONENT_LENGTH + '}))?' +\n              '(?:$|[^\\\\d])'\ntok('COERCERTL')\nre[t.COERCERTL] = new RegExp(src[t.COERCE], 'g')\n\n// Tilde ranges.\n// Meaning is \"reasonably at or greater than\"\ntok('LONETILDE')\nsrc[t.LONETILDE] = '(?:~>?)'\n\ntok('TILDETRIM')\nsrc[t.TILDETRIM] = '(\\\\s*)' + src[t.LONETILDE] + '\\\\s+'\nre[t.TILDETRIM] = new RegExp(src[t.TILDETRIM], 'g')\nvar tildeTrimReplace = '$1~'\n\ntok('TILDE')\nsrc[t.TILDE] = '^' + src[t.LONETILDE] + src[t.XRANGEPLAIN] + '$'\ntok('TILDELOOSE')\nsrc[t.TILDELOOSE] = '^' + src[t.LONETILDE] + src[t.XRANGEPLAINLOOSE] + '$'\n\n// Caret ranges.\n// Meaning is \"at least and backwards compatible with\"\ntok('LONECARET')\nsrc[t.LONECARET] = '(?:\\\\^)'\n\ntok('CARETTRIM')\nsrc[t.CARETTRIM] = '(\\\\s*)' + src[t.LONECARET] + '\\\\s+'\nre[t.CARETTRIM] = new RegExp(src[t.CARETTRIM], 'g')\nvar caretTrimReplace = '$1^'\n\ntok('CARET')\nsrc[t.CARET] = '^' + src[t.LONECARET] + src[t.XRANGEPLAIN] + '$'\ntok('CARETLOOSE')\nsrc[t.CARETLOOSE] = '^' + src[t.LONECARET] + src[t.XRANGEPLAINLOOSE] + '$'\n\n// A simple gt/lt/eq thing, or just \"\" to indicate \"any version\"\ntok('COMPARATORLOOSE')\nsrc[t.COMPARATORLOOSE] = '^' + src[t.GTLT] + '\\\\s*(' + src[t.LOOSEPLAIN] + ')$|^$'\ntok('COMPARATOR')\nsrc[t.COMPARATOR] = '^' + src[t.GTLT] + '\\\\s*(' + src[t.FULLPLAIN] + ')$|^$'\n\n// An expression to strip any whitespace between the gtlt and the thing\n// it modifies, so that `> 1.2.3` ==> `>1.2.3`\ntok('COMPARATORTRIM')\nsrc[t.COMPARATORTRIM] = '(\\\\s*)' + src[t.GTLT] +\n                      '\\\\s*(' + src[t.LOOSEPLAIN] + '|' + src[t.XRANGEPLAIN] + ')'\n\n// this one has to use the /g flag\nre[t.COMPARATORTRIM] = new RegExp(src[t.COMPARATORTRIM], 'g')\nvar comparatorTrimReplace = '$1$2$3'\n\n// Something like `1.2.3 - 1.2.4`\n// Note that these all use the loose form, because they'll be\n// checked against either the strict or loose comparator form\n// later.\ntok('HYPHENRANGE')\nsrc[t.HYPHENRANGE] = '^\\\\s*(' + src[t.XRANGEPLAIN] + ')' +\n                   '\\\\s+-\\\\s+' +\n                   '(' + src[t.XRANGEPLAIN] + ')' +\n                   '\\\\s*$'\n\ntok('HYPHENRANGELOOSE')\nsrc[t.HYPHENRANGELOOSE] = '^\\\\s*(' + src[t.XRANGEPLAINLOOSE] + ')' +\n                        '\\\\s+-\\\\s+' +\n                        '(' + src[t.XRANGEPLAINLOOSE] + ')' +\n                        '\\\\s*$'\n\n// Star ranges basically just allow anything at all.\ntok('STAR')\nsrc[t.STAR] = '(<|>)?=?\\\\s*\\\\*'\n\n// Compile to actual regexp objects.\n// All are flag-free, unless they were created above with a flag.\nfor (var i = 0; i < R; i++) {\n  debug(i, src[i])\n  if (!re[i]) {\n    re[i] = new RegExp(src[i])\n  }\n}\n\nexports.parse = parse\nfunction parse (version, options) {\n  if (!options || typeof options !== 'object') {\n    options = {\n      loose: !!options,\n      includePrerelease: false\n    }\n  }\n\n  if (version instanceof SemVer) {\n    return version\n  }\n\n  if (typeof version !== 'string') {\n    return null\n  }\n\n  if (version.length > MAX_LENGTH) {\n    return null\n  }\n\n  var r = options.loose ? re[t.LOOSE] : re[t.FULL]\n  if (!r.test(version)) {\n    return null\n  }\n\n  try {\n    return new SemVer(version, options)\n  } catch (er) {\n    return null\n  }\n}\n\nexports.valid = valid\nfunction valid (version, options) {\n  var v = parse(version, options)\n  return v ? v.version : null\n}\n\nexports.clean = clean\nfunction clean (version, options) {\n  var s = parse(version.trim().replace(/^[=v]+/, ''), options)\n  return s ? s.version : null\n}\n\nexports.SemVer = SemVer\n\nfunction SemVer (version, options) {\n  if (!options || typeof options !== 'object') {\n    options = {\n      loose: !!options,\n      includePrerelease: false\n    }\n  }\n  if (version instanceof SemVer) {\n    if (version.loose === options.loose) {\n      return version\n    } else {\n      version = version.version\n    }\n  } else if (typeof version !== 'string') {\n    throw new TypeError('Invalid Version: ' + version)\n  }\n\n  if (version.length > MAX_LENGTH) {\n    throw new TypeError('version is longer than ' + MAX_LENGTH + ' characters')\n  }\n\n  if (!(this instanceof SemVer)) {\n    return new SemVer(version, options)\n  }\n\n  debug('SemVer', version, options)\n  this.options = options\n  this.loose = !!options.loose\n\n  var m = version.trim().match(options.loose ? re[t.LOOSE] : re[t.FULL])\n\n  if (!m) {\n    throw new TypeError('Invalid Version: ' + version)\n  }\n\n  this.raw = version\n\n  // these are actually numbers\n  this.major = +m[1]\n  this.minor = +m[2]\n  this.patch = +m[3]\n\n  if (this.major > MAX_SAFE_INTEGER || this.major < 0) {\n    throw new TypeError('Invalid major version')\n  }\n\n  if (this.minor > MAX_SAFE_INTEGER || this.minor < 0) {\n    throw new TypeError('Invalid minor version')\n  }\n\n  if (this.patch > MAX_SAFE_INTEGER || this.patch < 0) {\n    throw new TypeError('Invalid patch version')\n  }\n\n  // numberify any prerelease numeric ids\n  if (!m[4]) {\n    this.prerelease = []\n  } else {\n    this.prerelease = m[4].split('.').map(function (id) {\n      if (/^[0-9]+$/.test(id)) {\n        var num = +id\n        if (num >= 0 && num < MAX_SAFE_INTEGER) {\n          return num\n        }\n      }\n      return id\n    })\n  }\n\n  this.build = m[5] ? m[5].split('.') : []\n  this.format()\n}\n\nSemVer.prototype.format = function () {\n  this.version = this.major + '.' + this.minor + '.' + this.patch\n  if (this.prerelease.length) {\n    this.version += '-' + this.prerelease.join('.')\n  }\n  return this.version\n}\n\nSemVer.prototype.toString = function () {\n  return this.version\n}\n\nSemVer.prototype.compare = function (other) {\n  debug('SemVer.compare', this.version, this.options, other)\n  if (!(other instanceof SemVer)) {\n    other = new SemVer(other, this.options)\n  }\n\n  return this.compareMain(other) || this.comparePre(other)\n}\n\nSemVer.prototype.compareMain = function (other) {\n  if (!(other instanceof SemVer)) {\n    other = new SemVer(other, this.options)\n  }\n\n  return compareIdentifiers(this.major, other.major) ||\n         compareIdentifiers(this.minor, other.minor) ||\n         compareIdentifiers(this.patch, other.patch)\n}\n\nSemVer.prototype.comparePre = function (other) {\n  if (!(other instanceof SemVer)) {\n    other = new SemVer(other, this.options)\n  }\n\n  // NOT having a prerelease is > having one\n  if (this.prerelease.length && !other.prerelease.length) {\n    return -1\n  } else if (!this.prerelease.length && other.prerelease.length) {\n    return 1\n  } else if (!this.prerelease.length && !other.prerelease.length) {\n    return 0\n  }\n\n  var i = 0\n  do {\n    var a = this.prerelease[i]\n    var b = other.prerelease[i]\n    debug('prerelease compare', i, a, b)\n    if (a === undefined && b === undefined) {\n      return 0\n    } else if (b === undefined) {\n      return 1\n    } else if (a === undefined) {\n      return -1\n    } else if (a === b) {\n      continue\n    } else {\n      return compareIdentifiers(a, b)\n    }\n  } while (++i)\n}\n\nSemVer.prototype.compareBuild = function (other) {\n  if (!(other instanceof SemVer)) {\n    other = new SemVer(other, this.options)\n  }\n\n  var i = 0\n  do {\n    var a = this.build[i]\n    var b = other.build[i]\n    debug('prerelease compare', i, a, b)\n    if (a === undefined && b === undefined) {\n      return 0\n    } else if (b === undefined) {\n      return 1\n    } else if (a === undefined) {\n      return -1\n    } else if (a === b) {\n      continue\n    } else {\n      return compareIdentifiers(a, b)\n    }\n  } while (++i)\n}\n\n// preminor will bump the version up to the next minor release, and immediately\n// down to pre-release. premajor and prepatch work the same way.\nSemVer.prototype.inc = function (release, identifier) {\n  switch (release) {\n    case 'premajor':\n      this.prerelease.length = 0\n      this.patch = 0\n      this.minor = 0\n      this.major++\n      this.inc('pre', identifier)\n      break\n    case 'preminor':\n      this.prerelease.length = 0\n      this.patch = 0\n      this.minor++\n      this.inc('pre', identifier)\n      break\n    case 'prepatch':\n      // If this is already a prerelease, it will bump to the next version\n      // drop any prereleases that might already exist, since they are not\n      // relevant at this point.\n      this.prerelease.length = 0\n      this.inc('patch', identifier)\n      this.inc('pre', identifier)\n      break\n    // If the input is a non-prerelease version, this acts the same as\n    // prepatch.\n    case 'prerelease':\n      if (this.prerelease.length === 0) {\n        this.inc('patch', identifier)\n      }\n      this.inc('pre', identifier)\n      break\n\n    case 'major':\n      // If this is a pre-major version, bump up to the same major version.\n      // Otherwise increment major.\n      // 1.0.0-5 bumps to 1.0.0\n      // 1.1.0 bumps to 2.0.0\n      if (this.minor !== 0 ||\n          this.patch !== 0 ||\n          this.prerelease.length === 0) {\n        this.major++\n      }\n      this.minor = 0\n      this.patch = 0\n      this.prerelease = []\n      break\n    case 'minor':\n      // If this is a pre-minor version, bump up to the same minor version.\n      // Otherwise increment minor.\n      // 1.2.0-5 bumps to 1.2.0\n      // 1.2.1 bumps to 1.3.0\n      if (this.patch !== 0 || this.prerelease.length === 0) {\n        this.minor++\n      }\n      this.patch = 0\n      this.prerelease = []\n      break\n    case 'patch':\n      // If this is not a pre-release version, it will increment the patch.\n      // If it is a pre-release it will bump up to the same patch version.\n      // 1.2.0-5 patches to 1.2.0\n      // 1.2.0 patches to 1.2.1\n      if (this.prerelease.length === 0) {\n        this.patch++\n      }\n      this.prerelease = []\n      break\n    // This probably shouldn't be used publicly.\n    // 1.0.0 \"pre\" would become 1.0.0-0 which is the wrong direction.\n    case 'pre':\n      if (this.prerelease.length === 0) {\n        this.prerelease = [0]\n      } else {\n        var i = this.prerelease.length\n        while (--i >= 0) {\n          if (typeof this.prerelease[i] === 'number') {\n            this.prerelease[i]++\n            i = -2\n          }\n        }\n        if (i === -1) {\n          // didn't increment anything\n          this.prerelease.push(0)\n        }\n      }\n      if (identifier) {\n        // 1.2.0-beta.1 bumps to 1.2.0-beta.2,\n        // 1.2.0-beta.fooblz or 1.2.0-beta bumps to 1.2.0-beta.0\n        if (this.prerelease[0] === identifier) {\n          if (isNaN(this.prerelease[1])) {\n            this.prerelease = [identifier, 0]\n          }\n        } else {\n          this.prerelease = [identifier, 0]\n        }\n      }\n      break\n\n    default:\n      throw new Error('invalid increment argument: ' + release)\n  }\n  this.format()\n  this.raw = this.version\n  return this\n}\n\nexports.inc = inc\nfunction inc (version, release, loose, identifier) {\n  if (typeof (loose) === 'string') {\n    identifier = loose\n    loose = undefined\n  }\n\n  try {\n    return new SemVer(version, loose).inc(release, identifier).version\n  } catch (er) {\n    return null\n  }\n}\n\nexports.diff = diff\nfunction diff (version1, version2) {\n  if (eq(version1, version2)) {\n    return null\n  } else {\n    var v1 = parse(version1)\n    var v2 = parse(version2)\n    var prefix = ''\n    if (v1.prerelease.length || v2.prerelease.length) {\n      prefix = 'pre'\n      var defaultResult = 'prerelease'\n    }\n    for (var key in v1) {\n      if (key === 'major' || key === 'minor' || key === 'patch') {\n        if (v1[key] !== v2[key]) {\n          return prefix + key\n        }\n      }\n    }\n    return defaultResult // may be undefined\n  }\n}\n\nexports.compareIdentifiers = compareIdentifiers\n\nvar numeric = /^[0-9]+$/\nfunction compareIdentifiers (a, b) {\n  var anum = numeric.test(a)\n  var bnum = numeric.test(b)\n\n  if (anum && bnum) {\n    a = +a\n    b = +b\n  }\n\n  return a === b ? 0\n    : (anum && !bnum) ? -1\n    : (bnum && !anum) ? 1\n    : a < b ? -1\n    : 1\n}\n\nexports.rcompareIdentifiers = rcompareIdentifiers\nfunction rcompareIdentifiers (a, b) {\n  return compareIdentifiers(b, a)\n}\n\nexports.major = major\nfunction major (a, loose) {\n  return new SemVer(a, loose).major\n}\n\nexports.minor = minor\nfunction minor (a, loose) {\n  return new SemVer(a, loose).minor\n}\n\nexports.patch = patch\nfunction patch (a, loose) {\n  return new SemVer(a, loose).patch\n}\n\nexports.compare = compare\nfunction compare (a, b, loose) {\n  return new SemVer(a, loose).compare(new SemVer(b, loose))\n}\n\nexports.compareLoose = compareLoose\nfunction compareLoose (a, b) {\n  return compare(a, b, true)\n}\n\nexports.compareBuild = compareBuild\nfunction compareBuild (a, b, loose) {\n  var versionA = new SemVer(a, loose)\n  var versionB = new SemVer(b, loose)\n  return versionA.compare(versionB) || versionA.compareBuild(versionB)\n}\n\nexports.rcompare = rcompare\nfunction rcompare (a, b, loose) {\n  return compare(b, a, loose)\n}\n\nexports.sort = sort\nfunction sort (list, loose) {\n  return list.sort(function (a, b) {\n    return exports.compareBuild(a, b, loose)\n  })\n}\n\nexports.rsort = rsort\nfunction rsort (list, loose) {\n  return list.sort(function (a, b) {\n    return exports.compareBuild(b, a, loose)\n  })\n}\n\nexports.gt = gt\nfunction gt (a, b, loose) {\n  return compare(a, b, loose) > 0\n}\n\nexports.lt = lt\nfunction lt (a, b, loose) {\n  return compare(a, b, loose) < 0\n}\n\nexports.eq = eq\nfunction eq (a, b, loose) {\n  return compare(a, b, loose) === 0\n}\n\nexports.neq = neq\nfunction neq (a, b, loose) {\n  return compare(a, b, loose) !== 0\n}\n\nexports.gte = gte\nfunction gte (a, b, loose) {\n  return compare(a, b, loose) >= 0\n}\n\nexports.lte = lte\nfunction lte (a, b, loose) {\n  return compare(a, b, loose) <= 0\n}\n\nexports.cmp = cmp\nfunction cmp (a, op, b, loose) {\n  switch (op) {\n    case '===':\n      if (typeof a === 'object')\n        a = a.version\n      if (typeof b === 'object')\n        b = b.version\n      return a === b\n\n    case '!==':\n      if (typeof a === 'object')\n        a = a.version\n      if (typeof b === 'object')\n        b = b.version\n      return a !== b\n\n    case '':\n    case '=':\n    case '==':\n      return eq(a, b, loose)\n\n    case '!=':\n      return neq(a, b, loose)\n\n    case '>':\n      return gt(a, b, loose)\n\n    case '>=':\n      return gte(a, b, loose)\n\n    case '<':\n      return lt(a, b, loose)\n\n    case '<=':\n      return lte(a, b, loose)\n\n    default:\n      throw new TypeError('Invalid operator: ' + op)\n  }\n}\n\nexports.Comparator = Comparator\nfunction Comparator (comp, options) {\n  if (!options || typeof options !== 'object') {\n    options = {\n      loose: !!options,\n      includePrerelease: false\n    }\n  }\n\n  if (comp instanceof Comparator) {\n    if (comp.loose === !!options.loose) {\n      return comp\n    } else {\n      comp = comp.value\n    }\n  }\n\n  if (!(this instanceof Comparator)) {\n    return new Comparator(comp, options)\n  }\n\n  debug('comparator', comp, options)\n  this.options = options\n  this.loose = !!options.loose\n  this.parse(comp)\n\n  if (this.semver === ANY) {\n    this.value = ''\n  } else {\n    this.value = this.operator + this.semver.version\n  }\n\n  debug('comp', this)\n}\n\nvar ANY = {}\nComparator.prototype.parse = function (comp) {\n  var r = this.options.loose ? re[t.COMPARATORLOOSE] : re[t.COMPARATOR]\n  var m = comp.match(r)\n\n  if (!m) {\n    throw new TypeError('Invalid comparator: ' + comp)\n  }\n\n  this.operator = m[1] !== undefined ? m[1] : ''\n  if (this.operator === '=') {\n    this.operator = ''\n  }\n\n  // if it literally is just '>' or '' then allow anything.\n  if (!m[2]) {\n    this.semver = ANY\n  } else {\n    this.semver = new SemVer(m[2], this.options.loose)\n  }\n}\n\nComparator.prototype.toString = function () {\n  return this.value\n}\n\nComparator.prototype.test = function (version) {\n  debug('Comparator.test', version, this.options.loose)\n\n  if (this.semver === ANY || version === ANY) {\n    return true\n  }\n\n  if (typeof version === 'string') {\n    try {\n      version = new SemVer(version, this.options)\n    } catch (er) {\n      return false\n    }\n  }\n\n  return cmp(version, this.operator, this.semver, this.options)\n}\n\nComparator.prototype.intersects = function (comp, options) {\n  if (!(comp instanceof Comparator)) {\n    throw new TypeError('a Comparator is required')\n  }\n\n  if (!options || typeof options !== 'object') {\n    options = {\n      loose: !!options,\n      includePrerelease: false\n    }\n  }\n\n  var rangeTmp\n\n  if (this.operator === '') {\n    if (this.value === '') {\n      return true\n    }\n    rangeTmp = new Range(comp.value, options)\n    return satisfies(this.value, rangeTmp, options)\n  } else if (comp.operator === '') {\n    if (comp.value === '') {\n      return true\n    }\n    rangeTmp = new Range(this.value, options)\n    return satisfies(comp.semver, rangeTmp, options)\n  }\n\n  var sameDirectionIncreasing =\n    (this.operator === '>=' || this.operator === '>') &&\n    (comp.operator === '>=' || comp.operator === '>')\n  var sameDirectionDecreasing =\n    (this.operator === '<=' || this.operator === '<') &&\n    (comp.operator === '<=' || comp.operator === '<')\n  var sameSemVer = this.semver.version === comp.semver.version\n  var differentDirectionsInclusive =\n    (this.operator === '>=' || this.operator === '<=') &&\n    (comp.operator === '>=' || comp.operator === '<=')\n  var oppositeDirectionsLessThan =\n    cmp(this.semver, '<', comp.semver, options) &&\n    ((this.operator === '>=' || this.operator === '>') &&\n    (comp.operator === '<=' || comp.operator === '<'))\n  var oppositeDirectionsGreaterThan =\n    cmp(this.semver, '>', comp.semver, options) &&\n    ((this.operator === '<=' || this.operator === '<') &&\n    (comp.operator === '>=' || comp.operator === '>'))\n\n  return sameDirectionIncreasing || sameDirectionDecreasing ||\n    (sameSemVer && differentDirectionsInclusive) ||\n    oppositeDirectionsLessThan || oppositeDirectionsGreaterThan\n}\n\nexports.Range = Range\nfunction Range (range, options) {\n  if (!options || typeof options !== 'object') {\n    options = {\n      loose: !!options,\n      includePrerelease: false\n    }\n  }\n\n  if (range instanceof Range) {\n    if (range.loose === !!options.loose &&\n        range.includePrerelease === !!options.includePrerelease) {\n      return range\n    } else {\n      return new Range(range.raw, options)\n    }\n  }\n\n  if (range instanceof Comparator) {\n    return new Range(range.value, options)\n  }\n\n  if (!(this instanceof Range)) {\n    return new Range(range, options)\n  }\n\n  this.options = options\n  this.loose = !!options.loose\n  this.includePrerelease = !!options.includePrerelease\n\n  // First, split based on boolean or ||\n  this.raw = range\n  this.set = range.split(/\\s*\\|\\|\\s*/).map(function (range) {\n    return this.parseRange(range.trim())\n  }, this).filter(function (c) {\n    // throw out any that are not relevant for whatever reason\n    return c.length\n  })\n\n  if (!this.set.length) {\n    throw new TypeError('Invalid SemVer Range: ' + range)\n  }\n\n  this.format()\n}\n\nRange.prototype.format = function () {\n  this.range = this.set.map(function (comps) {\n    return comps.join(' ').trim()\n  }).join('||').trim()\n  return this.range\n}\n\nRange.prototype.toString = function () {\n  return this.range\n}\n\nRange.prototype.parseRange = function (range) {\n  var loose = this.options.loose\n  range = range.trim()\n  // `1.2.3 - 1.2.4` => `>=1.2.3 <=1.2.4`\n  var hr = loose ? re[t.HYPHENRANGELOOSE] : re[t.HYPHENRANGE]\n  range = range.replace(hr, hyphenReplace)\n  debug('hyphen replace', range)\n  // `> 1.2.3 < 1.2.5` => `>1.2.3 <1.2.5`\n  range = range.replace(re[t.COMPARATORTRIM], comparatorTrimReplace)\n  debug('comparator trim', range, re[t.COMPARATORTRIM])\n\n  // `~ 1.2.3` => `~1.2.3`\n  range = range.replace(re[t.TILDETRIM], tildeTrimReplace)\n\n  // `^ 1.2.3` => `^1.2.3`\n  range = range.replace(re[t.CARETTRIM], caretTrimReplace)\n\n  // normalize spaces\n  range = range.split(/\\s+/).join(' ')\n\n  // At this point, the range is completely trimmed and\n  // ready to be split into comparators.\n\n  var compRe = loose ? re[t.COMPARATORLOOSE] : re[t.COMPARATOR]\n  var set = range.split(' ').map(function (comp) {\n    return parseComparator(comp, this.options)\n  }, this).join(' ').split(/\\s+/)\n  if (this.options.loose) {\n    // in loose mode, throw out any that are not valid comparators\n    set = set.filter(function (comp) {\n      return !!comp.match(compRe)\n    })\n  }\n  set = set.map(function (comp) {\n    return new Comparator(comp, this.options)\n  }, this)\n\n  return set\n}\n\nRange.prototype.intersects = function (range, options) {\n  if (!(range instanceof Range)) {\n    throw new TypeError('a Range is required')\n  }\n\n  return this.set.some(function (thisComparators) {\n    return (\n      isSatisfiable(thisComparators, options) &&\n      range.set.some(function (rangeComparators) {\n        return (\n          isSatisfiable(rangeComparators, options) &&\n          thisComparators.every(function (thisComparator) {\n            return rangeComparators.every(function (rangeComparator) {\n              return thisComparator.intersects(rangeComparator, options)\n            })\n          })\n        )\n      })\n    )\n  })\n}\n\n// take a set of comparators and determine whether there\n// exists a version which can satisfy it\nfunction isSatisfiable (comparators, options) {\n  var result = true\n  var remainingComparators = comparators.slice()\n  var testComparator = remainingComparators.pop()\n\n  while (result && remainingComparators.length) {\n    result = remainingComparators.every(function (otherComparator) {\n      return testComparator.intersects(otherComparator, options)\n    })\n\n    testComparator = remainingComparators.pop()\n  }\n\n  return result\n}\n\n// Mostly just for testing and legacy API reasons\nexports.toComparators = toComparators\nfunction toComparators (range, options) {\n  return new Range(range, options).set.map(function (comp) {\n    return comp.map(function (c) {\n      return c.value\n    }).join(' ').trim().split(' ')\n  })\n}\n\n// comprised of xranges, tildes, stars, and gtlt's at this point.\n// already replaced the hyphen ranges\n// turn into a set of JUST comparators.\nfunction parseComparator (comp, options) {\n  debug('comp', comp, options)\n  comp = replaceCarets(comp, options)\n  debug('caret', comp)\n  comp = replaceTildes(comp, options)\n  debug('tildes', comp)\n  comp = replaceXRanges(comp, options)\n  debug('xrange', comp)\n  comp = replaceStars(comp, options)\n  debug('stars', comp)\n  return comp\n}\n\nfunction isX (id) {\n  return !id || id.toLowerCase() === 'x' || id === '*'\n}\n\n// ~, ~> --> * (any, kinda silly)\n// ~2, ~2.x, ~2.x.x, ~>2, ~>2.x ~>2.x.x --> >=2.0.0 <3.0.0\n// ~2.0, ~2.0.x, ~>2.0, ~>2.0.x --> >=2.0.0 <2.1.0\n// ~1.2, ~1.2.x, ~>1.2, ~>1.2.x --> >=1.2.0 <1.3.0\n// ~1.2.3, ~>1.2.3 --> >=1.2.3 <1.3.0\n// ~1.2.0, ~>1.2.0 --> >=1.2.0 <1.3.0\nfunction replaceTildes (comp, options) {\n  return comp.trim().split(/\\s+/).map(function (comp) {\n    return replaceTilde(comp, options)\n  }).join(' ')\n}\n\nfunction replaceTilde (comp, options) {\n  var r = options.loose ? re[t.TILDELOOSE] : re[t.TILDE]\n  return comp.replace(r, function (_, M, m, p, pr) {\n    debug('tilde', comp, _, M, m, p, pr)\n    var ret\n\n    if (isX(M)) {\n      ret = ''\n    } else if (isX(m)) {\n      ret = '>=' + M + '.0.0 <' + (+M + 1) + '.0.0'\n    } else if (isX(p)) {\n      // ~1.2 == >=1.2.0 <1.3.0\n      ret = '>=' + M + '.' + m + '.0 <' + M + '.' + (+m + 1) + '.0'\n    } else if (pr) {\n      debug('replaceTilde pr', pr)\n      ret = '>=' + M + '.' + m + '.' + p + '-' + pr +\n            ' <' + M + '.' + (+m + 1) + '.0'\n    } else {\n      // ~1.2.3 == >=1.2.3 <1.3.0\n      ret = '>=' + M + '.' + m + '.' + p +\n            ' <' + M + '.' + (+m + 1) + '.0'\n    }\n\n    debug('tilde return', ret)\n    return ret\n  })\n}\n\n// ^ --> * (any, kinda silly)\n// ^2, ^2.x, ^2.x.x --> >=2.0.0 <3.0.0\n// ^2.0, ^2.0.x --> >=2.0.0 <3.0.0\n// ^1.2, ^1.2.x --> >=1.2.0 <2.0.0\n// ^1.2.3 --> >=1.2.3 <2.0.0\n// ^1.2.0 --> >=1.2.0 <2.0.0\nfunction replaceCarets (comp, options) {\n  return comp.trim().split(/\\s+/).map(function (comp) {\n    return replaceCaret(comp, options)\n  }).join(' ')\n}\n\nfunction replaceCaret (comp, options) {\n  debug('caret', comp, options)\n  var r = options.loose ? re[t.CARETLOOSE] : re[t.CARET]\n  return comp.replace(r, function (_, M, m, p, pr) {\n    debug('caret', comp, _, M, m, p, pr)\n    var ret\n\n    if (isX(M)) {\n      ret = ''\n    } else if (isX(m)) {\n      ret = '>=' + M + '.0.0 <' + (+M + 1) + '.0.0'\n    } else if (isX(p)) {\n      if (M === '0') {\n        ret = '>=' + M + '.' + m + '.0 <' + M + '.' + (+m + 1) + '.0'\n      } else {\n        ret = '>=' + M + '.' + m + '.0 <' + (+M + 1) + '.0.0'\n      }\n    } else if (pr) {\n      debug('replaceCaret pr', pr)\n      if (M === '0') {\n        if (m === '0') {\n          ret = '>=' + M + '.' + m + '.' + p + '-' + pr +\n                ' <' + M + '.' + m + '.' + (+p + 1)\n        } else {\n          ret = '>=' + M + '.' + m + '.' + p + '-' + pr +\n                ' <' + M + '.' + (+m + 1) + '.0'\n        }\n      } else {\n        ret = '>=' + M + '.' + m + '.' + p + '-' + pr +\n              ' <' + (+M + 1) + '.0.0'\n      }\n    } else {\n      debug('no pr')\n      if (M === '0') {\n        if (m === '0') {\n          ret = '>=' + M + '.' + m + '.' + p +\n                ' <' + M + '.' + m + '.' + (+p + 1)\n        } else {\n          ret = '>=' + M + '.' + m + '.' + p +\n                ' <' + M + '.' + (+m + 1) + '.0'\n        }\n      } else {\n        ret = '>=' + M + '.' + m + '.' + p +\n              ' <' + (+M + 1) + '.0.0'\n      }\n    }\n\n    debug('caret return', ret)\n    return ret\n  })\n}\n\nfunction replaceXRanges (comp, options) {\n  debug('replaceXRanges', comp, options)\n  return comp.split(/\\s+/).map(function (comp) {\n    return replaceXRange(comp, options)\n  }).join(' ')\n}\n\nfunction replaceXRange (comp, options) {\n  comp = comp.trim()\n  var r = options.loose ? re[t.XRANGELOOSE] : re[t.XRANGE]\n  return comp.replace(r, function (ret, gtlt, M, m, p, pr) {\n    debug('xRange', comp, ret, gtlt, M, m, p, pr)\n    var xM = isX(M)\n    var xm = xM || isX(m)\n    var xp = xm || isX(p)\n    var anyX = xp\n\n    if (gtlt === '=' && anyX) {\n      gtlt = ''\n    }\n\n    // if we're including prereleases in the match, then we need\n    // to fix this to -0, the lowest possible prerelease value\n    pr = options.includePrerelease ? '-0' : ''\n\n    if (xM) {\n      if (gtlt === '>' || gtlt === '<') {\n        // nothing is allowed\n        ret = '<0.0.0-0'\n      } else {\n        // nothing is forbidden\n        ret = '*'\n      }\n    } else if (gtlt && anyX) {\n      // we know patch is an x, because we have any x at all.\n      // replace X with 0\n      if (xm) {\n        m = 0\n      }\n      p = 0\n\n      if (gtlt === '>') {\n        // >1 => >=2.0.0\n        // >1.2 => >=1.3.0\n        // >1.2.3 => >= 1.2.4\n        gtlt = '>='\n        if (xm) {\n          M = +M + 1\n          m = 0\n          p = 0\n        } else {\n          m = +m + 1\n          p = 0\n        }\n      } else if (gtlt === '<=') {\n        // <=0.7.x is actually <0.8.0, since any 0.7.x should\n        // pass.  Similarly, <=7.x is actually <8.0.0, etc.\n        gtlt = '<'\n        if (xm) {\n          M = +M + 1\n        } else {\n          m = +m + 1\n        }\n      }\n\n      ret = gtlt + M + '.' + m + '.' + p + pr\n    } else if (xm) {\n      ret = '>=' + M + '.0.0' + pr + ' <' + (+M + 1) + '.0.0' + pr\n    } else if (xp) {\n      ret = '>=' + M + '.' + m + '.0' + pr +\n        ' <' + M + '.' + (+m + 1) + '.0' + pr\n    }\n\n    debug('xRange return', ret)\n\n    return ret\n  })\n}\n\n// Because * is AND-ed with everything else in the comparator,\n// and '' means \"any version\", just remove the *s entirely.\nfunction replaceStars (comp, options) {\n  debug('replaceStars', comp, options)\n  // Looseness is ignored here.  star is always as loose as it gets!\n  return comp.trim().replace(re[t.STAR], '')\n}\n\n// This function is passed to string.replace(re[t.HYPHENRANGE])\n// M, m, patch, prerelease, build\n// 1.2 - 3.4.5 => >=1.2.0 <=3.4.5\n// 1.2.3 - 3.4 => >=1.2.0 <3.5.0 Any 3.4.x will do\n// 1.2 - 3.4 => >=1.2.0 <3.5.0\nfunction hyphenReplace ($0,\n  from, fM, fm, fp, fpr, fb,\n  to, tM, tm, tp, tpr, tb) {\n  if (isX(fM)) {\n    from = ''\n  } else if (isX(fm)) {\n    from = '>=' + fM + '.0.0'\n  } else if (isX(fp)) {\n    from = '>=' + fM + '.' + fm + '.0'\n  } else {\n    from = '>=' + from\n  }\n\n  if (isX(tM)) {\n    to = ''\n  } else if (isX(tm)) {\n    to = '<' + (+tM + 1) + '.0.0'\n  } else if (isX(tp)) {\n    to = '<' + tM + '.' + (+tm + 1) + '.0'\n  } else if (tpr) {\n    to = '<=' + tM + '.' + tm + '.' + tp + '-' + tpr\n  } else {\n    to = '<=' + to\n  }\n\n  return (from + ' ' + to).trim()\n}\n\n// if ANY of the sets match ALL of its comparators, then pass\nRange.prototype.test = function (version) {\n  if (!version) {\n    return false\n  }\n\n  if (typeof version === 'string') {\n    try {\n      version = new SemVer(version, this.options)\n    } catch (er) {\n      return false\n    }\n  }\n\n  for (var i = 0; i < this.set.length; i++) {\n    if (testSet(this.set[i], version, this.options)) {\n      return true\n    }\n  }\n  return false\n}\n\nfunction testSet (set, version, options) {\n  for (var i = 0; i < set.length; i++) {\n    if (!set[i].test(version)) {\n      return false\n    }\n  }\n\n  if (version.prerelease.length && !options.includePrerelease) {\n    // Find the set of versions that are allowed to have prereleases\n    // For example, ^1.2.3-pr.1 desugars to >=1.2.3-pr.1 <2.0.0\n    // That should allow `1.2.3-pr.2` to pass.\n    // However, `1.2.4-alpha.notready` should NOT be allowed,\n    // even though it's within the range set by the comparators.\n    for (i = 0; i < set.length; i++) {\n      debug(set[i].semver)\n      if (set[i].semver === ANY) {\n        continue\n      }\n\n      if (set[i].semver.prerelease.length > 0) {\n        var allowed = set[i].semver\n        if (allowed.major === version.major &&\n            allowed.minor === version.minor &&\n            allowed.patch === version.patch) {\n          return true\n        }\n      }\n    }\n\n    // Version has a -pre, but it's not one of the ones we like.\n    return false\n  }\n\n  return true\n}\n\nexports.satisfies = satisfies\nfunction satisfies (version, range, options) {\n  try {\n    range = new Range(range, options)\n  } catch (er) {\n    return false\n  }\n  return range.test(version)\n}\n\nexports.maxSatisfying = maxSatisfying\nfunction maxSatisfying (versions, range, options) {\n  var max = null\n  var maxSV = null\n  try {\n    var rangeObj = new Range(range, options)\n  } catch (er) {\n    return null\n  }\n  versions.forEach(function (v) {\n    if (rangeObj.test(v)) {\n      // satisfies(v, range, options)\n      if (!max || maxSV.compare(v) === -1) {\n        // compare(max, v, true)\n        max = v\n        maxSV = new SemVer(max, options)\n      }\n    }\n  })\n  return max\n}\n\nexports.minSatisfying = minSatisfying\nfunction minSatisfying (versions, range, options) {\n  var min = null\n  var minSV = null\n  try {\n    var rangeObj = new Range(range, options)\n  } catch (er) {\n    return null\n  }\n  versions.forEach(function (v) {\n    if (rangeObj.test(v)) {\n      // satisfies(v, range, options)\n      if (!min || minSV.compare(v) === 1) {\n        // compare(min, v, true)\n        min = v\n        minSV = new SemVer(min, options)\n      }\n    }\n  })\n  return min\n}\n\nexports.minVersion = minVersion\nfunction minVersion (range, loose) {\n  range = new Range(range, loose)\n\n  var minver = new SemVer('0.0.0')\n  if (range.test(minver)) {\n    return minver\n  }\n\n  minver = new SemVer('0.0.0-0')\n  if (range.test(minver)) {\n    return minver\n  }\n\n  minver = null\n  for (var i = 0; i < range.set.length; ++i) {\n    var comparators = range.set[i]\n\n    comparators.forEach(function (comparator) {\n      // Clone to avoid manipulating the comparator's semver object.\n      var compver = new SemVer(comparator.semver.version)\n      switch (comparator.operator) {\n        case '>':\n          if (compver.prerelease.length === 0) {\n            compver.patch++\n          } else {\n            compver.prerelease.push(0)\n          }\n          compver.raw = compver.format()\n          /* fallthrough */\n        case '':\n        case '>=':\n          if (!minver || gt(minver, compver)) {\n            minver = compver\n          }\n          break\n        case '<':\n        case '<=':\n          /* Ignore maximum versions */\n          break\n        /* istanbul ignore next */\n        default:\n          throw new Error('Unexpected operation: ' + comparator.operator)\n      }\n    })\n  }\n\n  if (minver && range.test(minver)) {\n    return minver\n  }\n\n  return null\n}\n\nexports.validRange = validRange\nfunction validRange (range, options) {\n  try {\n    // Return '*' instead of '' so that truthiness works.\n    // This will throw if it's invalid anyway\n    return new Range(range, options).range || '*'\n  } catch (er) {\n    return null\n  }\n}\n\n// Determine if version is less than all the versions possible in the range\nexports.ltr = ltr\nfunction ltr (version, range, options) {\n  return outside(version, range, '<', options)\n}\n\n// Determine if version is greater than all the versions possible in the range.\nexports.gtr = gtr\nfunction gtr (version, range, options) {\n  return outside(version, range, '>', options)\n}\n\nexports.outside = outside\nfunction outside (version, range, hilo, options) {\n  version = new SemVer(version, options)\n  range = new Range(range, options)\n\n  var gtfn, ltefn, ltfn, comp, ecomp\n  switch (hilo) {\n    case '>':\n      gtfn = gt\n      ltefn = lte\n      ltfn = lt\n      comp = '>'\n      ecomp = '>='\n      break\n    case '<':\n      gtfn = lt\n      ltefn = gte\n      ltfn = gt\n      comp = '<'\n      ecomp = '<='\n      break\n    default:\n      throw new TypeError('Must provide a hilo val of \"<\" or \">\"')\n  }\n\n  // If it satisifes the range it is not outside\n  if (satisfies(version, range, options)) {\n    return false\n  }\n\n  // From now on, variable terms are as if we're in \"gtr\" mode.\n  // but note that everything is flipped for the \"ltr\" function.\n\n  for (var i = 0; i < range.set.length; ++i) {\n    var comparators = range.set[i]\n\n    var high = null\n    var low = null\n\n    comparators.forEach(function (comparator) {\n      if (comparator.semver === ANY) {\n        comparator = new Comparator('>=0.0.0')\n      }\n      high = high || comparator\n      low = low || comparator\n      if (gtfn(comparator.semver, high.semver, options)) {\n        high = comparator\n      } else if (ltfn(comparator.semver, low.semver, options)) {\n        low = comparator\n      }\n    })\n\n    // If the edge version comparator has a operator then our version\n    // isn't outside it\n    if (high.operator === comp || high.operator === ecomp) {\n      return false\n    }\n\n    // If the lowest version comparator has an operator and our version\n    // is less than it then it isn't higher than the range\n    if ((!low.operator || low.operator === comp) &&\n        ltefn(version, low.semver)) {\n      return false\n    } else if (low.operator === ecomp && ltfn(version, low.semver)) {\n      return false\n    }\n  }\n  return true\n}\n\nexports.prerelease = prerelease\nfunction prerelease (version, options) {\n  var parsed = parse(version, options)\n  return (parsed && parsed.prerelease.length) ? parsed.prerelease : null\n}\n\nexports.intersects = intersects\nfunction intersects (r1, r2, options) {\n  r1 = new Range(r1, options)\n  r2 = new Range(r2, options)\n  return r1.intersects(r2)\n}\n\nexports.coerce = coerce\nfunction coerce (version, options) {\n  if (version instanceof SemVer) {\n    return version\n  }\n\n  if (typeof version === 'number') {\n    version = String(version)\n  }\n\n  if (typeof version !== 'string') {\n    return null\n  }\n\n  options = options || {}\n\n  var match = null\n  if (!options.rtl) {\n    match = version.match(re[t.COERCE])\n  } else {\n    // Find the right-most coercible string that does not share\n    // a terminus with a more left-ward coercible string.\n    // Eg, '1.2.3.4' wants to coerce '2.3.4', not '3.4' or '4'\n    //\n    // Walk through the string checking with a /g regexp\n    // Manually set the index so as to pick up overlapping matches.\n    // Stop when we get a match that ends at the string end, since no\n    // coercible string can be more right-ward without the same terminus.\n    var next\n    while ((next = re[t.COERCERTL].exec(version)) &&\n      (!match || match.index + match[0].length !== version.length)\n    ) {\n      if (!match ||\n          next.index + next[0].length !== match.index + match[0].length) {\n        match = next\n      }\n      re[t.COERCERTL].lastIndex = next.index + next[1].length + next[2].length\n    }\n    // leave it in a clean state\n    re[t.COERCERTL].lastIndex = -1\n  }\n\n  if (match === null) {\n    return null\n  }\n\n  return parse(match[2] +\n    '.' + (match[3] || '0') +\n    '.' + (match[4] || '0'), options)\n}\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nfunction __export(m) {\r\n    for (var p in m) if (!exports.hasOwnProperty(p)) exports[p] = m[p];\r\n}\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nexports.ErrorCodes = vscode_jsonrpc_1.ErrorCodes;\r\nexports.ResponseError = vscode_jsonrpc_1.ResponseError;\r\nexports.CancellationToken = vscode_jsonrpc_1.CancellationToken;\r\nexports.CancellationTokenSource = vscode_jsonrpc_1.CancellationTokenSource;\r\nexports.Disposable = vscode_jsonrpc_1.Disposable;\r\nexports.Event = vscode_jsonrpc_1.Event;\r\nexports.Emitter = vscode_jsonrpc_1.Emitter;\r\nexports.Trace = vscode_jsonrpc_1.Trace;\r\nexports.TraceFormat = vscode_jsonrpc_1.TraceFormat;\r\nexports.SetTraceNotification = vscode_jsonrpc_1.SetTraceNotification;\r\nexports.LogTraceNotification = vscode_jsonrpc_1.LogTraceNotification;\r\nexports.RequestType = vscode_jsonrpc_1.RequestType;\r\nexports.RequestType0 = vscode_jsonrpc_1.RequestType0;\r\nexports.NotificationType = vscode_jsonrpc_1.NotificationType;\r\nexports.NotificationType0 = vscode_jsonrpc_1.NotificationType0;\r\nexports.MessageReader = vscode_jsonrpc_1.MessageReader;\r\nexports.MessageWriter = vscode_jsonrpc_1.MessageWriter;\r\nexports.ConnectionStrategy = vscode_jsonrpc_1.ConnectionStrategy;\r\nexports.StreamMessageReader = vscode_jsonrpc_1.StreamMessageReader;\r\nexports.StreamMessageWriter = vscode_jsonrpc_1.StreamMessageWriter;\r\nexports.IPCMessageReader = vscode_jsonrpc_1.IPCMessageReader;\r\nexports.IPCMessageWriter = vscode_jsonrpc_1.IPCMessageWriter;\r\nexports.createClientPipeTransport = vscode_jsonrpc_1.createClientPipeTransport;\r\nexports.createServerPipeTransport = vscode_jsonrpc_1.createServerPipeTransport;\r\nexports.generateRandomPipeName = vscode_jsonrpc_1.generateRandomPipeName;\r\nexports.createClientSocketTransport = vscode_jsonrpc_1.createClientSocketTransport;\r\nexports.createServerSocketTransport = vscode_jsonrpc_1.createServerSocketTransport;\r\nexports.ProgressType = vscode_jsonrpc_1.ProgressType;\r\n__export(require(\"vscode-languageserver-types\"));\r\n__export(require(\"./protocol\"));\r\nconst callHierarchy = require(\"./protocol.callHierarchy.proposed\");\r\nconst st = require(\"./protocol.sematicTokens.proposed\");\r\nvar Proposed;\r\n(function (Proposed) {\r\n    let CallHierarchyPrepareRequest;\r\n    (function (CallHierarchyPrepareRequest) {\r\n        CallHierarchyPrepareRequest.method = callHierarchy.CallHierarchyPrepareRequest.method;\r\n        CallHierarchyPrepareRequest.type = callHierarchy.CallHierarchyPrepareRequest.type;\r\n    })(CallHierarchyPrepareRequest = Proposed.CallHierarchyPrepareRequest || (Proposed.CallHierarchyPrepareRequest = {}));\r\n    let CallHierarchyIncomingCallsRequest;\r\n    (function (CallHierarchyIncomingCallsRequest) {\r\n        CallHierarchyIncomingCallsRequest.method = callHierarchy.CallHierarchyIncomingCallsRequest.method;\r\n        CallHierarchyIncomingCallsRequest.type = callHierarchy.CallHierarchyIncomingCallsRequest.type;\r\n    })(CallHierarchyIncomingCallsRequest = Proposed.CallHierarchyIncomingCallsRequest || (Proposed.CallHierarchyIncomingCallsRequest = {}));\r\n    let CallHierarchyOutgoingCallsRequest;\r\n    (function (CallHierarchyOutgoingCallsRequest) {\r\n        CallHierarchyOutgoingCallsRequest.method = callHierarchy.CallHierarchyOutgoingCallsRequest.method;\r\n        CallHierarchyOutgoingCallsRequest.type = callHierarchy.CallHierarchyOutgoingCallsRequest.type;\r\n    })(CallHierarchyOutgoingCallsRequest = Proposed.CallHierarchyOutgoingCallsRequest || (Proposed.CallHierarchyOutgoingCallsRequest = {}));\r\n    Proposed.SemanticTokenTypes = st.SemanticTokenTypes;\r\n    Proposed.SemanticTokenModifiers = st.SemanticTokenModifiers;\r\n    Proposed.SemanticTokens = st.SemanticTokens;\r\n    let SemanticTokensRequest;\r\n    (function (SemanticTokensRequest) {\r\n        SemanticTokensRequest.method = st.SemanticTokensRequest.method;\r\n        SemanticTokensRequest.type = st.SemanticTokensRequest.type;\r\n    })(SemanticTokensRequest = Proposed.SemanticTokensRequest || (Proposed.SemanticTokensRequest = {}));\r\n    let SemanticTokensEditsRequest;\r\n    (function (SemanticTokensEditsRequest) {\r\n        SemanticTokensEditsRequest.method = st.SemanticTokensEditsRequest.method;\r\n        SemanticTokensEditsRequest.type = st.SemanticTokensEditsRequest.type;\r\n    })(SemanticTokensEditsRequest = Proposed.SemanticTokensEditsRequest || (Proposed.SemanticTokensEditsRequest = {}));\r\n    let SemanticTokensRangeRequest;\r\n    (function (SemanticTokensRangeRequest) {\r\n        SemanticTokensRangeRequest.method = st.SemanticTokensRangeRequest.method;\r\n        SemanticTokensRangeRequest.type = st.SemanticTokensRangeRequest.type;\r\n    })(SemanticTokensRangeRequest = Proposed.SemanticTokensRangeRequest || (Proposed.SemanticTokensRangeRequest = {}));\r\n})(Proposed = exports.Proposed || (exports.Proposed = {}));\r\nfunction createProtocolConnection(reader, writer, logger, strategy) {\r\n    return vscode_jsonrpc_1.createMessageConnection(reader, writer, logger, strategy);\r\n}\r\nexports.createProtocolConnection = createProtocolConnection;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nclass ProtocolRequestType0 extends vscode_jsonrpc_1.RequestType0 {\r\n    constructor(method) {\r\n        super(method);\r\n    }\r\n}\r\nexports.ProtocolRequestType0 = ProtocolRequestType0;\r\nclass ProtocolRequestType extends vscode_jsonrpc_1.RequestType {\r\n    constructor(method) {\r\n        super(method);\r\n    }\r\n}\r\nexports.ProtocolRequestType = ProtocolRequestType;\r\nclass ProtocolNotificationType extends vscode_jsonrpc_1.NotificationType {\r\n    constructor(method) {\r\n        super(method);\r\n    }\r\n}\r\nexports.ProtocolNotificationType = ProtocolNotificationType;\r\nclass ProtocolNotificationType0 extends vscode_jsonrpc_1.NotificationType0 {\r\n    constructor(method) {\r\n        super(method);\r\n    }\r\n}\r\nexports.ProtocolNotificationType0 = ProtocolNotificationType0;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) TypeFox and others. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst messages_1 = require(\"./messages\");\r\n/**\r\n * A request to result a `CallHierarchyItem` in a document at a given position.\r\n * Can be used as an input to a incoming or outgoing call hierarchy.\r\n *\r\n * @since 3.16.0 - Proposed state\r\n */\r\nvar CallHierarchyPrepareRequest;\r\n(function (CallHierarchyPrepareRequest) {\r\n    CallHierarchyPrepareRequest.method = 'textDocument/prepareCallHierarchy';\r\n    CallHierarchyPrepareRequest.type = new messages_1.ProtocolRequestType(CallHierarchyPrepareRequest.method);\r\n})(CallHierarchyPrepareRequest = exports.CallHierarchyPrepareRequest || (exports.CallHierarchyPrepareRequest = {}));\r\n/**\r\n * A request to resolve the incoming calls for a given `CallHierarchyItem`.\r\n *\r\n * @since 3.16.0 - Proposed state\r\n */\r\nvar CallHierarchyIncomingCallsRequest;\r\n(function (CallHierarchyIncomingCallsRequest) {\r\n    CallHierarchyIncomingCallsRequest.method = 'callHierarchy/incomingCalls';\r\n    CallHierarchyIncomingCallsRequest.type = new messages_1.ProtocolRequestType(CallHierarchyIncomingCallsRequest.method);\r\n})(CallHierarchyIncomingCallsRequest = exports.CallHierarchyIncomingCallsRequest || (exports.CallHierarchyIncomingCallsRequest = {}));\r\n/**\r\n * A request to resolve the outgoing calls for a given `CallHierarchyItem`.\r\n *\r\n * @since 3.16.0 - Proposed state\r\n */\r\nvar CallHierarchyOutgoingCallsRequest;\r\n(function (CallHierarchyOutgoingCallsRequest) {\r\n    CallHierarchyOutgoingCallsRequest.method = 'callHierarchy/outgoingCalls';\r\n    CallHierarchyOutgoingCallsRequest.type = new messages_1.ProtocolRequestType(CallHierarchyOutgoingCallsRequest.method);\r\n})(CallHierarchyOutgoingCallsRequest = exports.CallHierarchyOutgoingCallsRequest || (exports.CallHierarchyOutgoingCallsRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nconst messages_1 = require(\"./messages\");\r\n/**\r\n * A request to list all color symbols found in a given text document. The request's\r\n * parameter is of type [DocumentColorParams](#DocumentColorParams) the\r\n * response is of type [ColorInformation[]](#ColorInformation) or a Thenable\r\n * that resolves to such.\r\n */\r\nvar DocumentColorRequest;\r\n(function (DocumentColorRequest) {\r\n    DocumentColorRequest.method = 'textDocument/documentColor';\r\n    DocumentColorRequest.type = new messages_1.ProtocolRequestType(DocumentColorRequest.method);\r\n    /** @deprecated Use DocumentColorRequest.type */\r\n    DocumentColorRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(DocumentColorRequest = exports.DocumentColorRequest || (exports.DocumentColorRequest = {}));\r\n/**\r\n * A request to list all presentation for a color. The request's\r\n * parameter is of type [ColorPresentationParams](#ColorPresentationParams) the\r\n * response is of type [ColorInformation[]](#ColorInformation) or a Thenable\r\n * that resolves to such.\r\n */\r\nvar ColorPresentationRequest;\r\n(function (ColorPresentationRequest) {\r\n    ColorPresentationRequest.type = new messages_1.ProtocolRequestType('textDocument/colorPresentation');\r\n})(ColorPresentationRequest = exports.ColorPresentationRequest || (exports.ColorPresentationRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst messages_1 = require(\"./messages\");\r\n/**\r\n * The 'workspace/configuration' request is sent from the server to the client to fetch a certain\r\n * configuration setting.\r\n *\r\n * This pull model replaces the old push model were the client signaled configuration change via an\r\n * event. If the server still needs to react to configuration changes (since the server caches the\r\n * result of `workspace/configuration` requests) the server should register for an empty configuration\r\n * change event and empty the cache if such an event is received.\r\n */\r\nvar ConfigurationRequest;\r\n(function (ConfigurationRequest) {\r\n    ConfigurationRequest.type = new messages_1.ProtocolRequestType('workspace/configuration');\r\n})(ConfigurationRequest = exports.ConfigurationRequest || (exports.ConfigurationRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nconst messages_1 = require(\"./messages\");\r\n// @ts-ignore: to avoid inlining LocatioLink as dynamic import\r\nlet __noDynamicImport;\r\n/**\r\n * A request to resolve the type definition locations of a symbol at a given text\r\n * document position. The request's parameter is of type [TextDocumentPositioParams]\r\n * (#TextDocumentPositionParams) the response is of type [Declaration](#Declaration)\r\n * or a typed array of [DeclarationLink](#DeclarationLink) or a Thenable that resolves\r\n * to such.\r\n */\r\nvar DeclarationRequest;\r\n(function (DeclarationRequest) {\r\n    DeclarationRequest.method = 'textDocument/declaration';\r\n    DeclarationRequest.type = new messages_1.ProtocolRequestType(DeclarationRequest.method);\r\n    /** @deprecated Use DeclarationRequest.type */\r\n    DeclarationRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(DeclarationRequest = exports.DeclarationRequest || (exports.DeclarationRequest = {}));\r\n","\"use strict\";\r\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nconst messages_1 = require(\"./messages\");\r\n/**\r\n * Enum of known range kinds\r\n */\r\nvar FoldingRangeKind;\r\n(function (FoldingRangeKind) {\r\n    /**\r\n     * Folding range for a comment\r\n     */\r\n    FoldingRangeKind[\"Comment\"] = \"comment\";\r\n    /**\r\n     * Folding range for a imports or includes\r\n     */\r\n    FoldingRangeKind[\"Imports\"] = \"imports\";\r\n    /**\r\n     * Folding range for a region (e.g. `#region`)\r\n     */\r\n    FoldingRangeKind[\"Region\"] = \"region\";\r\n})(FoldingRangeKind = exports.FoldingRangeKind || (exports.FoldingRangeKind = {}));\r\n/**\r\n * A request to provide folding ranges in a document. The request's\r\n * parameter is of type [FoldingRangeParams](#FoldingRangeParams), the\r\n * response is of type [FoldingRangeList](#FoldingRangeList) or a Thenable\r\n * that resolves to such.\r\n */\r\nvar FoldingRangeRequest;\r\n(function (FoldingRangeRequest) {\r\n    FoldingRangeRequest.method = 'textDocument/foldingRange';\r\n    FoldingRangeRequest.type = new messages_1.ProtocolRequestType(FoldingRangeRequest.method);\r\n    /** @deprecated Use FoldingRangeRequest.type */\r\n    FoldingRangeRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(FoldingRangeRequest = exports.FoldingRangeRequest || (exports.FoldingRangeRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nconst messages_1 = require(\"./messages\");\r\n// @ts-ignore: to avoid inlining LocatioLink as dynamic import\r\nlet __noDynamicImport;\r\n/**\r\n * A request to resolve the implementation locations of a symbol at a given text\r\n * document position. The request's parameter is of type [TextDocumentPositioParams]\r\n * (#TextDocumentPositionParams) the response is of type [Definition](#Definition) or a\r\n * Thenable that resolves to such.\r\n */\r\nvar ImplementationRequest;\r\n(function (ImplementationRequest) {\r\n    ImplementationRequest.method = 'textDocument/implementation';\r\n    ImplementationRequest.type = new messages_1.ProtocolRequestType(ImplementationRequest.method);\r\n    /** @deprecated Use ImplementationRequest.type */\r\n    ImplementationRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(ImplementationRequest = exports.ImplementationRequest || (exports.ImplementationRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst Is = require(\"./utils/is\");\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nconst messages_1 = require(\"./messages\");\r\nconst protocol_implementation_1 = require(\"./protocol.implementation\");\r\nexports.ImplementationRequest = protocol_implementation_1.ImplementationRequest;\r\nconst protocol_typeDefinition_1 = require(\"./protocol.typeDefinition\");\r\nexports.TypeDefinitionRequest = protocol_typeDefinition_1.TypeDefinitionRequest;\r\nconst protocol_workspaceFolders_1 = require(\"./protocol.workspaceFolders\");\r\nexports.WorkspaceFoldersRequest = protocol_workspaceFolders_1.WorkspaceFoldersRequest;\r\nexports.DidChangeWorkspaceFoldersNotification = protocol_workspaceFolders_1.DidChangeWorkspaceFoldersNotification;\r\nconst protocol_configuration_1 = require(\"./protocol.configuration\");\r\nexports.ConfigurationRequest = protocol_configuration_1.ConfigurationRequest;\r\nconst protocol_colorProvider_1 = require(\"./protocol.colorProvider\");\r\nexports.DocumentColorRequest = protocol_colorProvider_1.DocumentColorRequest;\r\nexports.ColorPresentationRequest = protocol_colorProvider_1.ColorPresentationRequest;\r\nconst protocol_foldingRange_1 = require(\"./protocol.foldingRange\");\r\nexports.FoldingRangeRequest = protocol_foldingRange_1.FoldingRangeRequest;\r\nconst protocol_declaration_1 = require(\"./protocol.declaration\");\r\nexports.DeclarationRequest = protocol_declaration_1.DeclarationRequest;\r\nconst protocol_selectionRange_1 = require(\"./protocol.selectionRange\");\r\nexports.SelectionRangeRequest = protocol_selectionRange_1.SelectionRangeRequest;\r\nconst protocol_progress_1 = require(\"./protocol.progress\");\r\nexports.WorkDoneProgress = protocol_progress_1.WorkDoneProgress;\r\nexports.WorkDoneProgressCreateRequest = protocol_progress_1.WorkDoneProgressCreateRequest;\r\nexports.WorkDoneProgressCancelNotification = protocol_progress_1.WorkDoneProgressCancelNotification;\r\n// @ts-ignore: to avoid inlining LocatioLink as dynamic import\r\nlet __noDynamicImport;\r\n/**\r\n * The DocumentFilter namespace provides helper functions to work with\r\n * [DocumentFilter](#DocumentFilter) literals.\r\n */\r\nvar DocumentFilter;\r\n(function (DocumentFilter) {\r\n    function is(value) {\r\n        const candidate = value;\r\n        return Is.string(candidate.language) || Is.string(candidate.scheme) || Is.string(candidate.pattern);\r\n    }\r\n    DocumentFilter.is = is;\r\n})(DocumentFilter = exports.DocumentFilter || (exports.DocumentFilter = {}));\r\n/**\r\n * The DocumentSelector namespace provides helper functions to work with\r\n * [DocumentSelector](#DocumentSelector)s.\r\n */\r\nvar DocumentSelector;\r\n(function (DocumentSelector) {\r\n    function is(value) {\r\n        if (!Array.isArray(value)) {\r\n            return false;\r\n        }\r\n        for (let elem of value) {\r\n            if (!Is.string(elem) && !DocumentFilter.is(elem)) {\r\n                return false;\r\n            }\r\n        }\r\n        return true;\r\n    }\r\n    DocumentSelector.is = is;\r\n})(DocumentSelector = exports.DocumentSelector || (exports.DocumentSelector = {}));\r\n/**\r\n * The `client/registerCapability` request is sent from the server to the client to register a new capability\r\n * handler on the client side.\r\n */\r\nvar RegistrationRequest;\r\n(function (RegistrationRequest) {\r\n    RegistrationRequest.type = new messages_1.ProtocolRequestType('client/registerCapability');\r\n})(RegistrationRequest = exports.RegistrationRequest || (exports.RegistrationRequest = {}));\r\n/**\r\n * The `client/unregisterCapability` request is sent from the server to the client to unregister a previously registered capability\r\n * handler on the client side.\r\n */\r\nvar UnregistrationRequest;\r\n(function (UnregistrationRequest) {\r\n    UnregistrationRequest.type = new messages_1.ProtocolRequestType('client/unregisterCapability');\r\n})(UnregistrationRequest = exports.UnregistrationRequest || (exports.UnregistrationRequest = {}));\r\nvar ResourceOperationKind;\r\n(function (ResourceOperationKind) {\r\n    /**\r\n     * Supports creating new files and folders.\r\n     */\r\n    ResourceOperationKind.Create = 'create';\r\n    /**\r\n     * Supports renaming existing files and folders.\r\n     */\r\n    ResourceOperationKind.Rename = 'rename';\r\n    /**\r\n     * Supports deleting existing files and folders.\r\n     */\r\n    ResourceOperationKind.Delete = 'delete';\r\n})(ResourceOperationKind = exports.ResourceOperationKind || (exports.ResourceOperationKind = {}));\r\nvar FailureHandlingKind;\r\n(function (FailureHandlingKind) {\r\n    /**\r\n     * Applying the workspace change is simply aborted if one of the changes provided\r\n     * fails. All operations executed before the failing operation stay executed.\r\n     */\r\n    FailureHandlingKind.Abort = 'abort';\r\n    /**\r\n     * All operations are executed transactional. That means they either all\r\n     * succeed or no changes at all are applied to the workspace.\r\n     */\r\n    FailureHandlingKind.Transactional = 'transactional';\r\n    /**\r\n     * If the workspace edit contains only textual file changes they are executed transactional.\r\n     * If resource changes (create, rename or delete file) are part of the change the failure\r\n     * handling startegy is abort.\r\n     */\r\n    FailureHandlingKind.TextOnlyTransactional = 'textOnlyTransactional';\r\n    /**\r\n     * The client tries to undo the operations already executed. But there is no\r\n     * guarantee that this is succeeding.\r\n     */\r\n    FailureHandlingKind.Undo = 'undo';\r\n})(FailureHandlingKind = exports.FailureHandlingKind || (exports.FailureHandlingKind = {}));\r\n/**\r\n * The StaticRegistrationOptions namespace provides helper functions to work with\r\n * [StaticRegistrationOptions](#StaticRegistrationOptions) literals.\r\n */\r\nvar StaticRegistrationOptions;\r\n(function (StaticRegistrationOptions) {\r\n    function hasId(value) {\r\n        const candidate = value;\r\n        return candidate && Is.string(candidate.id) && candidate.id.length > 0;\r\n    }\r\n    StaticRegistrationOptions.hasId = hasId;\r\n})(StaticRegistrationOptions = exports.StaticRegistrationOptions || (exports.StaticRegistrationOptions = {}));\r\n/**\r\n * The TextDocumentRegistrationOptions namespace provides helper functions to work with\r\n * [TextDocumentRegistrationOptions](#TextDocumentRegistrationOptions) literals.\r\n */\r\nvar TextDocumentRegistrationOptions;\r\n(function (TextDocumentRegistrationOptions) {\r\n    function is(value) {\r\n        const candidate = value;\r\n        return candidate && (candidate.documentSelector === null || DocumentSelector.is(candidate.documentSelector));\r\n    }\r\n    TextDocumentRegistrationOptions.is = is;\r\n})(TextDocumentRegistrationOptions = exports.TextDocumentRegistrationOptions || (exports.TextDocumentRegistrationOptions = {}));\r\n/**\r\n * The WorkDoneProgressOptions namespace provides helper functions to work with\r\n * [WorkDoneProgressOptions](#WorkDoneProgressOptions) literals.\r\n */\r\nvar WorkDoneProgressOptions;\r\n(function (WorkDoneProgressOptions) {\r\n    function is(value) {\r\n        const candidate = value;\r\n        return Is.objectLiteral(candidate) && (candidate.workDoneProgress === undefined || Is.boolean(candidate.workDoneProgress));\r\n    }\r\n    WorkDoneProgressOptions.is = is;\r\n    function hasWorkDoneProgress(value) {\r\n        const candidate = value;\r\n        return candidate && Is.boolean(candidate.workDoneProgress);\r\n    }\r\n    WorkDoneProgressOptions.hasWorkDoneProgress = hasWorkDoneProgress;\r\n})(WorkDoneProgressOptions = exports.WorkDoneProgressOptions || (exports.WorkDoneProgressOptions = {}));\r\n/**\r\n * The initialize request is sent from the client to the server.\r\n * It is sent once as the request after starting up the server.\r\n * The requests parameter is of type [InitializeParams](#InitializeParams)\r\n * the response if of type [InitializeResult](#InitializeResult) of a Thenable that\r\n * resolves to such.\r\n */\r\nvar InitializeRequest;\r\n(function (InitializeRequest) {\r\n    InitializeRequest.type = new messages_1.ProtocolRequestType('initialize');\r\n})(InitializeRequest = exports.InitializeRequest || (exports.InitializeRequest = {}));\r\n/**\r\n * Known error codes for an `InitializeError`;\r\n */\r\nvar InitializeError;\r\n(function (InitializeError) {\r\n    /**\r\n     * If the protocol version provided by the client can't be handled by the server.\r\n     * @deprecated This initialize error got replaced by client capabilities. There is\r\n     * no version handshake in version 3.0x\r\n     */\r\n    InitializeError.unknownProtocolVersion = 1;\r\n})(InitializeError = exports.InitializeError || (exports.InitializeError = {}));\r\n/**\r\n * The intialized notification is sent from the client to the\r\n * server after the client is fully initialized and the server\r\n * is allowed to send requests from the server to the client.\r\n */\r\nvar InitializedNotification;\r\n(function (InitializedNotification) {\r\n    InitializedNotification.type = new messages_1.ProtocolNotificationType('initialized');\r\n})(InitializedNotification = exports.InitializedNotification || (exports.InitializedNotification = {}));\r\n//---- Shutdown Method ----\r\n/**\r\n * A shutdown request is sent from the client to the server.\r\n * It is sent once when the client decides to shutdown the\r\n * server. The only notification that is sent after a shutdown request\r\n * is the exit event.\r\n */\r\nvar ShutdownRequest;\r\n(function (ShutdownRequest) {\r\n    ShutdownRequest.type = new messages_1.ProtocolRequestType0('shutdown');\r\n})(ShutdownRequest = exports.ShutdownRequest || (exports.ShutdownRequest = {}));\r\n//---- Exit Notification ----\r\n/**\r\n * The exit event is sent from the client to the server to\r\n * ask the server to exit its process.\r\n */\r\nvar ExitNotification;\r\n(function (ExitNotification) {\r\n    ExitNotification.type = new messages_1.ProtocolNotificationType0('exit');\r\n})(ExitNotification = exports.ExitNotification || (exports.ExitNotification = {}));\r\n/**\r\n * The configuration change notification is sent from the client to the server\r\n * when the client's configuration has changed. The notification contains\r\n * the changed configuration as defined by the language client.\r\n */\r\nvar DidChangeConfigurationNotification;\r\n(function (DidChangeConfigurationNotification) {\r\n    DidChangeConfigurationNotification.type = new messages_1.ProtocolNotificationType('workspace/didChangeConfiguration');\r\n})(DidChangeConfigurationNotification = exports.DidChangeConfigurationNotification || (exports.DidChangeConfigurationNotification = {}));\r\n//---- Message show and log notifications ----\r\n/**\r\n * The message type\r\n */\r\nvar MessageType;\r\n(function (MessageType) {\r\n    /**\r\n     * An error message.\r\n     */\r\n    MessageType.Error = 1;\r\n    /**\r\n     * A warning message.\r\n     */\r\n    MessageType.Warning = 2;\r\n    /**\r\n     * An information message.\r\n     */\r\n    MessageType.Info = 3;\r\n    /**\r\n     * A log message.\r\n     */\r\n    MessageType.Log = 4;\r\n})(MessageType = exports.MessageType || (exports.MessageType = {}));\r\n/**\r\n * The show message notification is sent from a server to a client to ask\r\n * the client to display a particular message in the user interface.\r\n */\r\nvar ShowMessageNotification;\r\n(function (ShowMessageNotification) {\r\n    ShowMessageNotification.type = new messages_1.ProtocolNotificationType('window/showMessage');\r\n})(ShowMessageNotification = exports.ShowMessageNotification || (exports.ShowMessageNotification = {}));\r\n/**\r\n * The show message request is sent from the server to the client to show a message\r\n * and a set of options actions to the user.\r\n */\r\nvar ShowMessageRequest;\r\n(function (ShowMessageRequest) {\r\n    ShowMessageRequest.type = new messages_1.ProtocolRequestType('window/showMessageRequest');\r\n})(ShowMessageRequest = exports.ShowMessageRequest || (exports.ShowMessageRequest = {}));\r\n/**\r\n * The log message notification is sent from the server to the client to ask\r\n * the client to log a particular message.\r\n */\r\nvar LogMessageNotification;\r\n(function (LogMessageNotification) {\r\n    LogMessageNotification.type = new messages_1.ProtocolNotificationType('window/logMessage');\r\n})(LogMessageNotification = exports.LogMessageNotification || (exports.LogMessageNotification = {}));\r\n//---- Telemetry notification\r\n/**\r\n * The telemetry event notification is sent from the server to the client to ask\r\n * the client to log telemetry data.\r\n */\r\nvar TelemetryEventNotification;\r\n(function (TelemetryEventNotification) {\r\n    TelemetryEventNotification.type = new messages_1.ProtocolNotificationType('telemetry/event');\r\n})(TelemetryEventNotification = exports.TelemetryEventNotification || (exports.TelemetryEventNotification = {}));\r\n/**\r\n * Defines how the host (editor) should sync\r\n * document changes to the language server.\r\n */\r\nvar TextDocumentSyncKind;\r\n(function (TextDocumentSyncKind) {\r\n    /**\r\n     * Documents should not be synced at all.\r\n     */\r\n    TextDocumentSyncKind.None = 0;\r\n    /**\r\n     * Documents are synced by always sending the full content\r\n     * of the document.\r\n     */\r\n    TextDocumentSyncKind.Full = 1;\r\n    /**\r\n     * Documents are synced by sending the full content on open.\r\n     * After that only incremental updates to the document are\r\n     * send.\r\n     */\r\n    TextDocumentSyncKind.Incremental = 2;\r\n})(TextDocumentSyncKind = exports.TextDocumentSyncKind || (exports.TextDocumentSyncKind = {}));\r\n/**\r\n * The document open notification is sent from the client to the server to signal\r\n * newly opened text documents. The document's truth is now managed by the client\r\n * and the server must not try to read the document's truth using the document's\r\n * uri. Open in this sense means it is managed by the client. It doesn't necessarily\r\n * mean that its content is presented in an editor. An open notification must not\r\n * be sent more than once without a corresponding close notification send before.\r\n * This means open and close notification must be balanced and the max open count\r\n * is one.\r\n */\r\nvar DidOpenTextDocumentNotification;\r\n(function (DidOpenTextDocumentNotification) {\r\n    DidOpenTextDocumentNotification.method = 'textDocument/didOpen';\r\n    DidOpenTextDocumentNotification.type = new messages_1.ProtocolNotificationType(DidOpenTextDocumentNotification.method);\r\n})(DidOpenTextDocumentNotification = exports.DidOpenTextDocumentNotification || (exports.DidOpenTextDocumentNotification = {}));\r\n/**\r\n * The document change notification is sent from the client to the server to signal\r\n * changes to a text document.\r\n */\r\nvar DidChangeTextDocumentNotification;\r\n(function (DidChangeTextDocumentNotification) {\r\n    DidChangeTextDocumentNotification.method = 'textDocument/didChange';\r\n    DidChangeTextDocumentNotification.type = new messages_1.ProtocolNotificationType(DidChangeTextDocumentNotification.method);\r\n})(DidChangeTextDocumentNotification = exports.DidChangeTextDocumentNotification || (exports.DidChangeTextDocumentNotification = {}));\r\n/**\r\n * The document close notification is sent from the client to the server when\r\n * the document got closed in the client. The document's truth now exists where\r\n * the document's uri points to (e.g. if the document's uri is a file uri the\r\n * truth now exists on disk). As with the open notification the close notification\r\n * is about managing the document's content. Receiving a close notification\r\n * doesn't mean that the document was open in an editor before. A close\r\n * notification requires a previous open notification to be sent.\r\n */\r\nvar DidCloseTextDocumentNotification;\r\n(function (DidCloseTextDocumentNotification) {\r\n    DidCloseTextDocumentNotification.method = 'textDocument/didClose';\r\n    DidCloseTextDocumentNotification.type = new messages_1.ProtocolNotificationType(DidCloseTextDocumentNotification.method);\r\n})(DidCloseTextDocumentNotification = exports.DidCloseTextDocumentNotification || (exports.DidCloseTextDocumentNotification = {}));\r\n/**\r\n * The document save notification is sent from the client to the server when\r\n * the document got saved in the client.\r\n */\r\nvar DidSaveTextDocumentNotification;\r\n(function (DidSaveTextDocumentNotification) {\r\n    DidSaveTextDocumentNotification.method = 'textDocument/didSave';\r\n    DidSaveTextDocumentNotification.type = new messages_1.ProtocolNotificationType(DidSaveTextDocumentNotification.method);\r\n})(DidSaveTextDocumentNotification = exports.DidSaveTextDocumentNotification || (exports.DidSaveTextDocumentNotification = {}));\r\n/**\r\n * Represents reasons why a text document is saved.\r\n */\r\nvar TextDocumentSaveReason;\r\n(function (TextDocumentSaveReason) {\r\n    /**\r\n     * Manually triggered, e.g. by the user pressing save, by starting debugging,\r\n     * or by an API call.\r\n     */\r\n    TextDocumentSaveReason.Manual = 1;\r\n    /**\r\n     * Automatic after a delay.\r\n     */\r\n    TextDocumentSaveReason.AfterDelay = 2;\r\n    /**\r\n     * When the editor lost focus.\r\n     */\r\n    TextDocumentSaveReason.FocusOut = 3;\r\n})(TextDocumentSaveReason = exports.TextDocumentSaveReason || (exports.TextDocumentSaveReason = {}));\r\n/**\r\n * A document will save notification is sent from the client to the server before\r\n * the document is actually saved.\r\n */\r\nvar WillSaveTextDocumentNotification;\r\n(function (WillSaveTextDocumentNotification) {\r\n    WillSaveTextDocumentNotification.method = 'textDocument/willSave';\r\n    WillSaveTextDocumentNotification.type = new messages_1.ProtocolNotificationType(WillSaveTextDocumentNotification.method);\r\n})(WillSaveTextDocumentNotification = exports.WillSaveTextDocumentNotification || (exports.WillSaveTextDocumentNotification = {}));\r\n/**\r\n * A document will save request is sent from the client to the server before\r\n * the document is actually saved. The request can return an array of TextEdits\r\n * which will be applied to the text document before it is saved. Please note that\r\n * clients might drop results if computing the text edits took too long or if a\r\n * server constantly fails on this request. This is done to keep the save fast and\r\n * reliable.\r\n */\r\nvar WillSaveTextDocumentWaitUntilRequest;\r\n(function (WillSaveTextDocumentWaitUntilRequest) {\r\n    WillSaveTextDocumentWaitUntilRequest.method = 'textDocument/willSaveWaitUntil';\r\n    WillSaveTextDocumentWaitUntilRequest.type = new messages_1.ProtocolRequestType(WillSaveTextDocumentWaitUntilRequest.method);\r\n})(WillSaveTextDocumentWaitUntilRequest = exports.WillSaveTextDocumentWaitUntilRequest || (exports.WillSaveTextDocumentWaitUntilRequest = {}));\r\n/**\r\n * The watched files notification is sent from the client to the server when\r\n * the client detects changes to file watched by the language client.\r\n */\r\nvar DidChangeWatchedFilesNotification;\r\n(function (DidChangeWatchedFilesNotification) {\r\n    DidChangeWatchedFilesNotification.type = new messages_1.ProtocolNotificationType('workspace/didChangeWatchedFiles');\r\n})(DidChangeWatchedFilesNotification = exports.DidChangeWatchedFilesNotification || (exports.DidChangeWatchedFilesNotification = {}));\r\n/**\r\n * The file event type\r\n */\r\nvar FileChangeType;\r\n(function (FileChangeType) {\r\n    /**\r\n     * The file got created.\r\n     */\r\n    FileChangeType.Created = 1;\r\n    /**\r\n     * The file got changed.\r\n     */\r\n    FileChangeType.Changed = 2;\r\n    /**\r\n     * The file got deleted.\r\n     */\r\n    FileChangeType.Deleted = 3;\r\n})(FileChangeType = exports.FileChangeType || (exports.FileChangeType = {}));\r\nvar WatchKind;\r\n(function (WatchKind) {\r\n    /**\r\n     * Interested in create events.\r\n     */\r\n    WatchKind.Create = 1;\r\n    /**\r\n     * Interested in change events\r\n     */\r\n    WatchKind.Change = 2;\r\n    /**\r\n     * Interested in delete events\r\n     */\r\n    WatchKind.Delete = 4;\r\n})(WatchKind = exports.WatchKind || (exports.WatchKind = {}));\r\n/**\r\n * Diagnostics notification are sent from the server to the client to signal\r\n * results of validation runs.\r\n */\r\nvar PublishDiagnosticsNotification;\r\n(function (PublishDiagnosticsNotification) {\r\n    PublishDiagnosticsNotification.type = new messages_1.ProtocolNotificationType('textDocument/publishDiagnostics');\r\n})(PublishDiagnosticsNotification = exports.PublishDiagnosticsNotification || (exports.PublishDiagnosticsNotification = {}));\r\n/**\r\n * How a completion was triggered\r\n */\r\nvar CompletionTriggerKind;\r\n(function (CompletionTriggerKind) {\r\n    /**\r\n     * Completion was triggered by typing an identifier (24x7 code\r\n     * complete), manual invocation (e.g Ctrl+Space) or via API.\r\n     */\r\n    CompletionTriggerKind.Invoked = 1;\r\n    /**\r\n     * Completion was triggered by a trigger character specified by\r\n     * the `triggerCharacters` properties of the `CompletionRegistrationOptions`.\r\n     */\r\n    CompletionTriggerKind.TriggerCharacter = 2;\r\n    /**\r\n     * Completion was re-triggered as current completion list is incomplete\r\n     */\r\n    CompletionTriggerKind.TriggerForIncompleteCompletions = 3;\r\n})(CompletionTriggerKind = exports.CompletionTriggerKind || (exports.CompletionTriggerKind = {}));\r\n/**\r\n * Request to request completion at a given text document position. The request's\r\n * parameter is of type [TextDocumentPosition](#TextDocumentPosition) the response\r\n * is of type [CompletionItem[]](#CompletionItem) or [CompletionList](#CompletionList)\r\n * or a Thenable that resolves to such.\r\n *\r\n * The request can delay the computation of the [`detail`](#CompletionItem.detail)\r\n * and [`documentation`](#CompletionItem.documentation) properties to the `completionItem/resolve`\r\n * request. However, properties that are needed for the initial sorting and filtering, like `sortText`,\r\n * `filterText`, `insertText`, and `textEdit`, must not be changed during resolve.\r\n */\r\nvar CompletionRequest;\r\n(function (CompletionRequest) {\r\n    CompletionRequest.method = 'textDocument/completion';\r\n    CompletionRequest.type = new messages_1.ProtocolRequestType(CompletionRequest.method);\r\n    /** @deprecated Use CompletionRequest.type */\r\n    CompletionRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(CompletionRequest = exports.CompletionRequest || (exports.CompletionRequest = {}));\r\n/**\r\n * Request to resolve additional information for a given completion item.The request's\r\n * parameter is of type [CompletionItem](#CompletionItem) the response\r\n * is of type [CompletionItem](#CompletionItem) or a Thenable that resolves to such.\r\n */\r\nvar CompletionResolveRequest;\r\n(function (CompletionResolveRequest) {\r\n    CompletionResolveRequest.method = 'completionItem/resolve';\r\n    CompletionResolveRequest.type = new messages_1.ProtocolRequestType(CompletionResolveRequest.method);\r\n})(CompletionResolveRequest = exports.CompletionResolveRequest || (exports.CompletionResolveRequest = {}));\r\n/**\r\n * Request to request hover information at a given text document position. The request's\r\n * parameter is of type [TextDocumentPosition](#TextDocumentPosition) the response is of\r\n * type [Hover](#Hover) or a Thenable that resolves to such.\r\n */\r\nvar HoverRequest;\r\n(function (HoverRequest) {\r\n    HoverRequest.method = 'textDocument/hover';\r\n    HoverRequest.type = new messages_1.ProtocolRequestType(HoverRequest.method);\r\n})(HoverRequest = exports.HoverRequest || (exports.HoverRequest = {}));\r\n/**\r\n * How a signature help was triggered.\r\n *\r\n * @since 3.15.0\r\n */\r\nvar SignatureHelpTriggerKind;\r\n(function (SignatureHelpTriggerKind) {\r\n    /**\r\n     * Signature help was invoked manually by the user or by a command.\r\n     */\r\n    SignatureHelpTriggerKind.Invoked = 1;\r\n    /**\r\n     * Signature help was triggered by a trigger character.\r\n     */\r\n    SignatureHelpTriggerKind.TriggerCharacter = 2;\r\n    /**\r\n     * Signature help was triggered by the cursor moving or by the document content changing.\r\n     */\r\n    SignatureHelpTriggerKind.ContentChange = 3;\r\n})(SignatureHelpTriggerKind = exports.SignatureHelpTriggerKind || (exports.SignatureHelpTriggerKind = {}));\r\nvar SignatureHelpRequest;\r\n(function (SignatureHelpRequest) {\r\n    SignatureHelpRequest.method = 'textDocument/signatureHelp';\r\n    SignatureHelpRequest.type = new messages_1.ProtocolRequestType(SignatureHelpRequest.method);\r\n})(SignatureHelpRequest = exports.SignatureHelpRequest || (exports.SignatureHelpRequest = {}));\r\n/**\r\n * A request to resolve the definition location of a symbol at a given text\r\n * document position. The request's parameter is of type [TextDocumentPosition]\r\n * (#TextDocumentPosition) the response is of either type [Definition](#Definition)\r\n * or a typed array of [DefinitionLink](#DefinitionLink) or a Thenable that resolves\r\n * to such.\r\n */\r\nvar DefinitionRequest;\r\n(function (DefinitionRequest) {\r\n    DefinitionRequest.method = 'textDocument/definition';\r\n    DefinitionRequest.type = new messages_1.ProtocolRequestType(DefinitionRequest.method);\r\n    /** @deprecated Use DefinitionRequest.type */\r\n    DefinitionRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(DefinitionRequest = exports.DefinitionRequest || (exports.DefinitionRequest = {}));\r\n/**\r\n * A request to resolve project-wide references for the symbol denoted\r\n * by the given text document position. The request's parameter is of\r\n * type [ReferenceParams](#ReferenceParams) the response is of type\r\n * [Location[]](#Location) or a Thenable that resolves to such.\r\n */\r\nvar ReferencesRequest;\r\n(function (ReferencesRequest) {\r\n    ReferencesRequest.method = 'textDocument/references';\r\n    ReferencesRequest.type = new messages_1.ProtocolRequestType(ReferencesRequest.method);\r\n    /** @deprecated Use ReferencesRequest.type */\r\n    ReferencesRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(ReferencesRequest = exports.ReferencesRequest || (exports.ReferencesRequest = {}));\r\n/**\r\n * Request to resolve a [DocumentHighlight](#DocumentHighlight) for a given\r\n * text document position. The request's parameter is of type [TextDocumentPosition]\r\n * (#TextDocumentPosition) the request response is of type [DocumentHighlight[]]\r\n * (#DocumentHighlight) or a Thenable that resolves to such.\r\n */\r\nvar DocumentHighlightRequest;\r\n(function (DocumentHighlightRequest) {\r\n    DocumentHighlightRequest.method = 'textDocument/documentHighlight';\r\n    DocumentHighlightRequest.type = new messages_1.ProtocolRequestType(DocumentHighlightRequest.method);\r\n    /** @deprecated Use DocumentHighlightRequest.type */\r\n    DocumentHighlightRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(DocumentHighlightRequest = exports.DocumentHighlightRequest || (exports.DocumentHighlightRequest = {}));\r\n/**\r\n * A request to list all symbols found in a given text document. The request's\r\n * parameter is of type [TextDocumentIdentifier](#TextDocumentIdentifier) the\r\n * response is of type [SymbolInformation[]](#SymbolInformation) or a Thenable\r\n * that resolves to such.\r\n */\r\nvar DocumentSymbolRequest;\r\n(function (DocumentSymbolRequest) {\r\n    DocumentSymbolRequest.method = 'textDocument/documentSymbol';\r\n    DocumentSymbolRequest.type = new messages_1.ProtocolRequestType(DocumentSymbolRequest.method);\r\n    /** @deprecated Use DocumentSymbolRequest.type */\r\n    DocumentSymbolRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(DocumentSymbolRequest = exports.DocumentSymbolRequest || (exports.DocumentSymbolRequest = {}));\r\n/**\r\n * A request to provide commands for the given text document and range.\r\n */\r\nvar CodeActionRequest;\r\n(function (CodeActionRequest) {\r\n    CodeActionRequest.method = 'textDocument/codeAction';\r\n    CodeActionRequest.type = new messages_1.ProtocolRequestType(CodeActionRequest.method);\r\n    /** @deprecated Use CodeActionRequest.type */\r\n    CodeActionRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(CodeActionRequest = exports.CodeActionRequest || (exports.CodeActionRequest = {}));\r\n/**\r\n * A request to list project-wide symbols matching the query string given\r\n * by the [WorkspaceSymbolParams](#WorkspaceSymbolParams). The response is\r\n * of type [SymbolInformation[]](#SymbolInformation) or a Thenable that\r\n * resolves to such.\r\n */\r\nvar WorkspaceSymbolRequest;\r\n(function (WorkspaceSymbolRequest) {\r\n    WorkspaceSymbolRequest.method = 'workspace/symbol';\r\n    WorkspaceSymbolRequest.type = new messages_1.ProtocolRequestType(WorkspaceSymbolRequest.method);\r\n    /** @deprecated Use WorkspaceSymbolRequest.type */\r\n    WorkspaceSymbolRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(WorkspaceSymbolRequest = exports.WorkspaceSymbolRequest || (exports.WorkspaceSymbolRequest = {}));\r\n/**\r\n * A request to provide code lens for the given text document.\r\n */\r\nvar CodeLensRequest;\r\n(function (CodeLensRequest) {\r\n    CodeLensRequest.type = new messages_1.ProtocolRequestType('textDocument/codeLens');\r\n    /** @deprecated Use CodeLensRequest.type */\r\n    CodeLensRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(CodeLensRequest = exports.CodeLensRequest || (exports.CodeLensRequest = {}));\r\n/**\r\n * A request to resolve a command for a given code lens.\r\n */\r\nvar CodeLensResolveRequest;\r\n(function (CodeLensResolveRequest) {\r\n    CodeLensResolveRequest.type = new messages_1.ProtocolRequestType('codeLens/resolve');\r\n})(CodeLensResolveRequest = exports.CodeLensResolveRequest || (exports.CodeLensResolveRequest = {}));\r\n/**\r\n * A request to provide document links\r\n */\r\nvar DocumentLinkRequest;\r\n(function (DocumentLinkRequest) {\r\n    DocumentLinkRequest.method = 'textDocument/documentLink';\r\n    DocumentLinkRequest.type = new messages_1.ProtocolRequestType(DocumentLinkRequest.method);\r\n    /** @deprecated Use DocumentLinkRequest.type */\r\n    DocumentLinkRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(DocumentLinkRequest = exports.DocumentLinkRequest || (exports.DocumentLinkRequest = {}));\r\n/**\r\n * Request to resolve additional information for a given document link. The request's\r\n * parameter is of type [DocumentLink](#DocumentLink) the response\r\n * is of type [DocumentLink](#DocumentLink) or a Thenable that resolves to such.\r\n */\r\nvar DocumentLinkResolveRequest;\r\n(function (DocumentLinkResolveRequest) {\r\n    DocumentLinkResolveRequest.type = new messages_1.ProtocolRequestType('documentLink/resolve');\r\n})(DocumentLinkResolveRequest = exports.DocumentLinkResolveRequest || (exports.DocumentLinkResolveRequest = {}));\r\n/**\r\n * A request to to format a whole document.\r\n */\r\nvar DocumentFormattingRequest;\r\n(function (DocumentFormattingRequest) {\r\n    DocumentFormattingRequest.method = 'textDocument/formatting';\r\n    DocumentFormattingRequest.type = new messages_1.ProtocolRequestType(DocumentFormattingRequest.method);\r\n})(DocumentFormattingRequest = exports.DocumentFormattingRequest || (exports.DocumentFormattingRequest = {}));\r\n/**\r\n * A request to to format a range in a document.\r\n */\r\nvar DocumentRangeFormattingRequest;\r\n(function (DocumentRangeFormattingRequest) {\r\n    DocumentRangeFormattingRequest.method = 'textDocument/rangeFormatting';\r\n    DocumentRangeFormattingRequest.type = new messages_1.ProtocolRequestType(DocumentRangeFormattingRequest.method);\r\n})(DocumentRangeFormattingRequest = exports.DocumentRangeFormattingRequest || (exports.DocumentRangeFormattingRequest = {}));\r\n/**\r\n * A request to format a document on type.\r\n */\r\nvar DocumentOnTypeFormattingRequest;\r\n(function (DocumentOnTypeFormattingRequest) {\r\n    DocumentOnTypeFormattingRequest.method = 'textDocument/onTypeFormatting';\r\n    DocumentOnTypeFormattingRequest.type = new messages_1.ProtocolRequestType(DocumentOnTypeFormattingRequest.method);\r\n})(DocumentOnTypeFormattingRequest = exports.DocumentOnTypeFormattingRequest || (exports.DocumentOnTypeFormattingRequest = {}));\r\n/**\r\n * A request to rename a symbol.\r\n */\r\nvar RenameRequest;\r\n(function (RenameRequest) {\r\n    RenameRequest.method = 'textDocument/rename';\r\n    RenameRequest.type = new messages_1.ProtocolRequestType(RenameRequest.method);\r\n})(RenameRequest = exports.RenameRequest || (exports.RenameRequest = {}));\r\n/**\r\n * A request to test and perform the setup necessary for a rename.\r\n */\r\nvar PrepareRenameRequest;\r\n(function (PrepareRenameRequest) {\r\n    PrepareRenameRequest.method = 'textDocument/prepareRename';\r\n    PrepareRenameRequest.type = new messages_1.ProtocolRequestType(PrepareRenameRequest.method);\r\n})(PrepareRenameRequest = exports.PrepareRenameRequest || (exports.PrepareRenameRequest = {}));\r\n/**\r\n * A request send from the client to the server to execute a command. The request might return\r\n * a workspace edit which the client will apply to the workspace.\r\n */\r\nvar ExecuteCommandRequest;\r\n(function (ExecuteCommandRequest) {\r\n    ExecuteCommandRequest.type = new messages_1.ProtocolRequestType('workspace/executeCommand');\r\n})(ExecuteCommandRequest = exports.ExecuteCommandRequest || (exports.ExecuteCommandRequest = {}));\r\n/**\r\n * A request sent from the server to the client to modified certain resources.\r\n */\r\nvar ApplyWorkspaceEditRequest;\r\n(function (ApplyWorkspaceEditRequest) {\r\n    ApplyWorkspaceEditRequest.type = new messages_1.ProtocolRequestType('workspace/applyEdit');\r\n})(ApplyWorkspaceEditRequest = exports.ApplyWorkspaceEditRequest || (exports.ApplyWorkspaceEditRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nconst messages_1 = require(\"./messages\");\r\nvar WorkDoneProgress;\r\n(function (WorkDoneProgress) {\r\n    WorkDoneProgress.type = new vscode_jsonrpc_1.ProgressType();\r\n})(WorkDoneProgress = exports.WorkDoneProgress || (exports.WorkDoneProgress = {}));\r\n/**\r\n * The `window/workDoneProgress/create` request is sent from the server to the client to initiate progress\r\n * reporting from the server.\r\n */\r\nvar WorkDoneProgressCreateRequest;\r\n(function (WorkDoneProgressCreateRequest) {\r\n    WorkDoneProgressCreateRequest.type = new messages_1.ProtocolRequestType('window/workDoneProgress/create');\r\n})(WorkDoneProgressCreateRequest = exports.WorkDoneProgressCreateRequest || (exports.WorkDoneProgressCreateRequest = {}));\r\n/**\r\n * The `window/workDoneProgress/cancel` notification is sent from  the client to the server to cancel a progress\r\n * initiated on the server side.\r\n */\r\nvar WorkDoneProgressCancelNotification;\r\n(function (WorkDoneProgressCancelNotification) {\r\n    WorkDoneProgressCancelNotification.type = new messages_1.ProtocolNotificationType('window/workDoneProgress/cancel');\r\n})(WorkDoneProgressCancelNotification = exports.WorkDoneProgressCancelNotification || (exports.WorkDoneProgressCancelNotification = {}));\r\n","\"use strict\";\r\n/*---------------------------------------------------------------------------------------------\r\n *  Copyright (c) Microsoft Corporation. All rights reserved.\r\n *  Licensed under the MIT License. See License.txt in the project root for license information.\r\n *--------------------------------------------------------------------------------------------*/\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nconst messages_1 = require(\"./messages\");\r\n/**\r\n * A request to provide selection ranges in a document. The request's\r\n * parameter is of type [SelectionRangeParams](#SelectionRangeParams), the\r\n * response is of type [SelectionRange[]](#SelectionRange[]) or a Thenable\r\n * that resolves to such.\r\n */\r\nvar SelectionRangeRequest;\r\n(function (SelectionRangeRequest) {\r\n    SelectionRangeRequest.method = 'textDocument/selectionRange';\r\n    SelectionRangeRequest.type = new messages_1.ProtocolRequestType(SelectionRangeRequest.method);\r\n    /** @deprecated  Use SelectionRangeRequest.type */\r\n    SelectionRangeRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(SelectionRangeRequest = exports.SelectionRangeRequest || (exports.SelectionRangeRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst messages_1 = require(\"./messages\");\r\n/**\r\n * A set of predefined token types. This set is not fixed\r\n * an clients can specify additional token types via the\r\n * corresponding client capabilities.\r\n *\r\n * @since 3.16.0 - Proposed state\r\n */\r\nvar SemanticTokenTypes;\r\n(function (SemanticTokenTypes) {\r\n    SemanticTokenTypes[\"comment\"] = \"comment\";\r\n    SemanticTokenTypes[\"keyword\"] = \"keyword\";\r\n    SemanticTokenTypes[\"string\"] = \"string\";\r\n    SemanticTokenTypes[\"number\"] = \"number\";\r\n    SemanticTokenTypes[\"regexp\"] = \"regexp\";\r\n    SemanticTokenTypes[\"operator\"] = \"operator\";\r\n    SemanticTokenTypes[\"namespace\"] = \"namespace\";\r\n    SemanticTokenTypes[\"type\"] = \"type\";\r\n    SemanticTokenTypes[\"struct\"] = \"struct\";\r\n    SemanticTokenTypes[\"class\"] = \"class\";\r\n    SemanticTokenTypes[\"interface\"] = \"interface\";\r\n    SemanticTokenTypes[\"enum\"] = \"enum\";\r\n    SemanticTokenTypes[\"typeParameter\"] = \"typeParameter\";\r\n    SemanticTokenTypes[\"function\"] = \"function\";\r\n    SemanticTokenTypes[\"member\"] = \"member\";\r\n    SemanticTokenTypes[\"property\"] = \"property\";\r\n    SemanticTokenTypes[\"macro\"] = \"macro\";\r\n    SemanticTokenTypes[\"variable\"] = \"variable\";\r\n    SemanticTokenTypes[\"parameter\"] = \"parameter\";\r\n    SemanticTokenTypes[\"label\"] = \"label\";\r\n})(SemanticTokenTypes = exports.SemanticTokenTypes || (exports.SemanticTokenTypes = {}));\r\n/**\r\n * A set of predefined token modifiers. This set is not fixed\r\n * an clients can specify additional token types via the\r\n * corresponding client capabilities.\r\n *\r\n * @since 3.16.0 - Proposed state\r\n */\r\nvar SemanticTokenModifiers;\r\n(function (SemanticTokenModifiers) {\r\n    SemanticTokenModifiers[\"documentation\"] = \"documentation\";\r\n    SemanticTokenModifiers[\"declaration\"] = \"declaration\";\r\n    SemanticTokenModifiers[\"definition\"] = \"definition\";\r\n    SemanticTokenModifiers[\"reference\"] = \"reference\";\r\n    SemanticTokenModifiers[\"static\"] = \"static\";\r\n    SemanticTokenModifiers[\"abstract\"] = \"abstract\";\r\n    SemanticTokenModifiers[\"deprecated\"] = \"deprecated\";\r\n    SemanticTokenModifiers[\"async\"] = \"async\";\r\n    SemanticTokenModifiers[\"volatile\"] = \"volatile\";\r\n    SemanticTokenModifiers[\"readonly\"] = \"readonly\";\r\n})(SemanticTokenModifiers = exports.SemanticTokenModifiers || (exports.SemanticTokenModifiers = {}));\r\n/**\r\n * @since 3.16.0 - Proposed state\r\n */\r\nvar SemanticTokens;\r\n(function (SemanticTokens) {\r\n    function is(value) {\r\n        const candidate = value;\r\n        return candidate !== undefined && (candidate.resultId === undefined || typeof candidate.resultId === 'string') &&\r\n            Array.isArray(candidate.data) && (candidate.data.length === 0 || typeof candidate.data[0] === 'number');\r\n    }\r\n    SemanticTokens.is = is;\r\n})(SemanticTokens = exports.SemanticTokens || (exports.SemanticTokens = {}));\r\n/**\r\n * @since 3.16.0 - Proposed state\r\n */\r\nvar SemanticTokensRequest;\r\n(function (SemanticTokensRequest) {\r\n    SemanticTokensRequest.method = 'textDocument/semanticTokens';\r\n    SemanticTokensRequest.type = new messages_1.ProtocolRequestType(SemanticTokensRequest.method);\r\n})(SemanticTokensRequest = exports.SemanticTokensRequest || (exports.SemanticTokensRequest = {}));\r\n/**\r\n * @since 3.16.0 - Proposed state\r\n */\r\nvar SemanticTokensEditsRequest;\r\n(function (SemanticTokensEditsRequest) {\r\n    SemanticTokensEditsRequest.method = 'textDocument/semanticTokens/edits';\r\n    SemanticTokensEditsRequest.type = new messages_1.ProtocolRequestType(SemanticTokensEditsRequest.method);\r\n})(SemanticTokensEditsRequest = exports.SemanticTokensEditsRequest || (exports.SemanticTokensEditsRequest = {}));\r\n/**\r\n * @since 3.16.0 - Proposed state\r\n */\r\nvar SemanticTokensRangeRequest;\r\n(function (SemanticTokensRangeRequest) {\r\n    SemanticTokensRangeRequest.method = 'textDocument/semanticTokens/range';\r\n    SemanticTokensRangeRequest.type = new messages_1.ProtocolRequestType(SemanticTokensRangeRequest.method);\r\n})(SemanticTokensRangeRequest = exports.SemanticTokensRangeRequest || (exports.SemanticTokensRangeRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst vscode_jsonrpc_1 = require(\"vscode-jsonrpc\");\r\nconst messages_1 = require(\"./messages\");\r\n// @ts-ignore: to avoid inlining LocatioLink as dynamic import\r\nlet __noDynamicImport;\r\n/**\r\n * A request to resolve the type definition locations of a symbol at a given text\r\n * document position. The request's parameter is of type [TextDocumentPositioParams]\r\n * (#TextDocumentPositionParams) the response is of type [Definition](#Definition) or a\r\n * Thenable that resolves to such.\r\n */\r\nvar TypeDefinitionRequest;\r\n(function (TypeDefinitionRequest) {\r\n    TypeDefinitionRequest.method = 'textDocument/typeDefinition';\r\n    TypeDefinitionRequest.type = new messages_1.ProtocolRequestType(TypeDefinitionRequest.method);\r\n    /** @deprecated Use TypeDefinitionRequest.type */\r\n    TypeDefinitionRequest.resultType = new vscode_jsonrpc_1.ProgressType();\r\n})(TypeDefinitionRequest = exports.TypeDefinitionRequest || (exports.TypeDefinitionRequest = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nconst messages_1 = require(\"./messages\");\r\n/**\r\n * The `workspace/workspaceFolders` is sent from the server to the client to fetch the open workspace folders.\r\n */\r\nvar WorkspaceFoldersRequest;\r\n(function (WorkspaceFoldersRequest) {\r\n    WorkspaceFoldersRequest.type = new messages_1.ProtocolRequestType0('workspace/workspaceFolders');\r\n})(WorkspaceFoldersRequest = exports.WorkspaceFoldersRequest || (exports.WorkspaceFoldersRequest = {}));\r\n/**\r\n * The `workspace/didChangeWorkspaceFolders` notification is sent from the client to the server when the workspace\r\n * folder configuration changes.\r\n */\r\nvar DidChangeWorkspaceFoldersNotification;\r\n(function (DidChangeWorkspaceFoldersNotification) {\r\n    DidChangeWorkspaceFoldersNotification.type = new messages_1.ProtocolNotificationType('workspace/didChangeWorkspaceFolders');\r\n})(DidChangeWorkspaceFoldersNotification = exports.DidChangeWorkspaceFoldersNotification || (exports.DidChangeWorkspaceFoldersNotification = {}));\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\nObject.defineProperty(exports, \"__esModule\", { value: true });\r\nfunction boolean(value) {\r\n    return value === true || value === false;\r\n}\r\nexports.boolean = boolean;\r\nfunction string(value) {\r\n    return typeof value === 'string' || value instanceof String;\r\n}\r\nexports.string = string;\r\nfunction number(value) {\r\n    return typeof value === 'number' || value instanceof Number;\r\n}\r\nexports.number = number;\r\nfunction error(value) {\r\n    return value instanceof Error;\r\n}\r\nexports.error = error;\r\nfunction func(value) {\r\n    return typeof value === 'function';\r\n}\r\nexports.func = func;\r\nfunction array(value) {\r\n    return Array.isArray(value);\r\n}\r\nexports.array = array;\r\nfunction stringArray(value) {\r\n    return array(value) && value.every(elem => string(elem));\r\n}\r\nexports.stringArray = stringArray;\r\nfunction typedArray(value, check) {\r\n    return Array.isArray(value) && value.every(check);\r\n}\r\nexports.typedArray = typedArray;\r\nfunction objectLiteral(value) {\r\n    // Strictly speaking class instances pass this check as well. Since the LSP\r\n    // doesn't use classes we ignore this for now. If we do we need to add something\r\n    // like this: `Object.getPrototypeOf(Object.getPrototypeOf(x)) === null`\r\n    return value !== null && typeof value === 'object';\r\n}\r\nexports.objectLiteral = objectLiteral;\r\n","/* --------------------------------------------------------------------------------------------\r\n * Copyright (c) Microsoft Corporation. All rights reserved.\r\n * Licensed under the MIT License. See License.txt in the project root for license information.\r\n * ------------------------------------------------------------------------------------------ */\r\n'use strict';\r\n/**\r\n * The Position namespace provides helper functions to work with\r\n * [Position](#Position) literals.\r\n */\r\nexport var Position;\r\n(function (Position) {\r\n    /**\r\n     * Creates a new Position literal from the given line and character.\r\n     * @param line The position's line.\r\n     * @param character The position's character.\r\n     */\r\n    function create(line, character) {\r\n        return { line: line, character: character };\r\n    }\r\n    Position.create = create;\r\n    /**\r\n     * Checks whether the given liternal conforms to the [Position](#Position) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.objectLiteral(candidate) && Is.number(candidate.line) && Is.number(candidate.character);\r\n    }\r\n    Position.is = is;\r\n})(Position || (Position = {}));\r\n/**\r\n * The Range namespace provides helper functions to work with\r\n * [Range](#Range) literals.\r\n */\r\nexport var Range;\r\n(function (Range) {\r\n    function create(one, two, three, four) {\r\n        if (Is.number(one) && Is.number(two) && Is.number(three) && Is.number(four)) {\r\n            return { start: Position.create(one, two), end: Position.create(three, four) };\r\n        }\r\n        else if (Position.is(one) && Position.is(two)) {\r\n            return { start: one, end: two };\r\n        }\r\n        else {\r\n            throw new Error(\"Range#create called with invalid arguments[\" + one + \", \" + two + \", \" + three + \", \" + four + \"]\");\r\n        }\r\n    }\r\n    Range.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Range](#Range) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.objectLiteral(candidate) && Position.is(candidate.start) && Position.is(candidate.end);\r\n    }\r\n    Range.is = is;\r\n})(Range || (Range = {}));\r\n/**\r\n * The Location namespace provides helper functions to work with\r\n * [Location](#Location) literals.\r\n */\r\nexport var Location;\r\n(function (Location) {\r\n    /**\r\n     * Creates a Location literal.\r\n     * @param uri The location's uri.\r\n     * @param range The location's range.\r\n     */\r\n    function create(uri, range) {\r\n        return { uri: uri, range: range };\r\n    }\r\n    Location.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Location](#Location) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Range.is(candidate.range) && (Is.string(candidate.uri) || Is.undefined(candidate.uri));\r\n    }\r\n    Location.is = is;\r\n})(Location || (Location = {}));\r\n/**\r\n * The LocationLink namespace provides helper functions to work with\r\n * [LocationLink](#LocationLink) literals.\r\n */\r\nexport var LocationLink;\r\n(function (LocationLink) {\r\n    /**\r\n     * Creates a LocationLink literal.\r\n     * @param targetUri The definition's uri.\r\n     * @param targetRange The full range of the definition.\r\n     * @param targetSelectionRange The span of the symbol definition at the target.\r\n     * @param originSelectionRange The span of the symbol being defined in the originating source file.\r\n     */\r\n    function create(targetUri, targetRange, targetSelectionRange, originSelectionRange) {\r\n        return { targetUri: targetUri, targetRange: targetRange, targetSelectionRange: targetSelectionRange, originSelectionRange: originSelectionRange };\r\n    }\r\n    LocationLink.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [LocationLink](#LocationLink) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Range.is(candidate.targetRange) && Is.string(candidate.targetUri)\r\n            && (Range.is(candidate.targetSelectionRange) || Is.undefined(candidate.targetSelectionRange))\r\n            && (Range.is(candidate.originSelectionRange) || Is.undefined(candidate.originSelectionRange));\r\n    }\r\n    LocationLink.is = is;\r\n})(LocationLink || (LocationLink = {}));\r\n/**\r\n * The Color namespace provides helper functions to work with\r\n * [Color](#Color) literals.\r\n */\r\nexport var Color;\r\n(function (Color) {\r\n    /**\r\n     * Creates a new Color literal.\r\n     */\r\n    function create(red, green, blue, alpha) {\r\n        return {\r\n            red: red,\r\n            green: green,\r\n            blue: blue,\r\n            alpha: alpha,\r\n        };\r\n    }\r\n    Color.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Color](#Color) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.number(candidate.red)\r\n            && Is.number(candidate.green)\r\n            && Is.number(candidate.blue)\r\n            && Is.number(candidate.alpha);\r\n    }\r\n    Color.is = is;\r\n})(Color || (Color = {}));\r\n/**\r\n * The ColorInformation namespace provides helper functions to work with\r\n * [ColorInformation](#ColorInformation) literals.\r\n */\r\nexport var ColorInformation;\r\n(function (ColorInformation) {\r\n    /**\r\n     * Creates a new ColorInformation literal.\r\n     */\r\n    function create(range, color) {\r\n        return {\r\n            range: range,\r\n            color: color,\r\n        };\r\n    }\r\n    ColorInformation.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [ColorInformation](#ColorInformation) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Range.is(candidate.range) && Color.is(candidate.color);\r\n    }\r\n    ColorInformation.is = is;\r\n})(ColorInformation || (ColorInformation = {}));\r\n/**\r\n * The Color namespace provides helper functions to work with\r\n * [ColorPresentation](#ColorPresentation) literals.\r\n */\r\nexport var ColorPresentation;\r\n(function (ColorPresentation) {\r\n    /**\r\n     * Creates a new ColorInformation literal.\r\n     */\r\n    function create(label, textEdit, additionalTextEdits) {\r\n        return {\r\n            label: label,\r\n            textEdit: textEdit,\r\n            additionalTextEdits: additionalTextEdits,\r\n        };\r\n    }\r\n    ColorPresentation.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [ColorInformation](#ColorInformation) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.string(candidate.label)\r\n            && (Is.undefined(candidate.textEdit) || TextEdit.is(candidate))\r\n            && (Is.undefined(candidate.additionalTextEdits) || Is.typedArray(candidate.additionalTextEdits, TextEdit.is));\r\n    }\r\n    ColorPresentation.is = is;\r\n})(ColorPresentation || (ColorPresentation = {}));\r\n/**\r\n * Enum of known range kinds\r\n */\r\nexport var FoldingRangeKind;\r\n(function (FoldingRangeKind) {\r\n    /**\r\n     * Folding range for a comment\r\n     */\r\n    FoldingRangeKind[\"Comment\"] = \"comment\";\r\n    /**\r\n     * Folding range for a imports or includes\r\n     */\r\n    FoldingRangeKind[\"Imports\"] = \"imports\";\r\n    /**\r\n     * Folding range for a region (e.g. `#region`)\r\n     */\r\n    FoldingRangeKind[\"Region\"] = \"region\";\r\n})(FoldingRangeKind || (FoldingRangeKind = {}));\r\n/**\r\n * The folding range namespace provides helper functions to work with\r\n * [FoldingRange](#FoldingRange) literals.\r\n */\r\nexport var FoldingRange;\r\n(function (FoldingRange) {\r\n    /**\r\n     * Creates a new FoldingRange literal.\r\n     */\r\n    function create(startLine, endLine, startCharacter, endCharacter, kind) {\r\n        var result = {\r\n            startLine: startLine,\r\n            endLine: endLine\r\n        };\r\n        if (Is.defined(startCharacter)) {\r\n            result.startCharacter = startCharacter;\r\n        }\r\n        if (Is.defined(endCharacter)) {\r\n            result.endCharacter = endCharacter;\r\n        }\r\n        if (Is.defined(kind)) {\r\n            result.kind = kind;\r\n        }\r\n        return result;\r\n    }\r\n    FoldingRange.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [FoldingRange](#FoldingRange) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.number(candidate.startLine) && Is.number(candidate.startLine)\r\n            && (Is.undefined(candidate.startCharacter) || Is.number(candidate.startCharacter))\r\n            && (Is.undefined(candidate.endCharacter) || Is.number(candidate.endCharacter))\r\n            && (Is.undefined(candidate.kind) || Is.string(candidate.kind));\r\n    }\r\n    FoldingRange.is = is;\r\n})(FoldingRange || (FoldingRange = {}));\r\n/**\r\n * The DiagnosticRelatedInformation namespace provides helper functions to work with\r\n * [DiagnosticRelatedInformation](#DiagnosticRelatedInformation) literals.\r\n */\r\nexport var DiagnosticRelatedInformation;\r\n(function (DiagnosticRelatedInformation) {\r\n    /**\r\n     * Creates a new DiagnosticRelatedInformation literal.\r\n     */\r\n    function create(location, message) {\r\n        return {\r\n            location: location,\r\n            message: message\r\n        };\r\n    }\r\n    DiagnosticRelatedInformation.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [DiagnosticRelatedInformation](#DiagnosticRelatedInformation) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Location.is(candidate.location) && Is.string(candidate.message);\r\n    }\r\n    DiagnosticRelatedInformation.is = is;\r\n})(DiagnosticRelatedInformation || (DiagnosticRelatedInformation = {}));\r\n/**\r\n * The diagnostic's severity.\r\n */\r\nexport var DiagnosticSeverity;\r\n(function (DiagnosticSeverity) {\r\n    /**\r\n     * Reports an error.\r\n     */\r\n    DiagnosticSeverity.Error = 1;\r\n    /**\r\n     * Reports a warning.\r\n     */\r\n    DiagnosticSeverity.Warning = 2;\r\n    /**\r\n     * Reports an information.\r\n     */\r\n    DiagnosticSeverity.Information = 3;\r\n    /**\r\n     * Reports a hint.\r\n     */\r\n    DiagnosticSeverity.Hint = 4;\r\n})(DiagnosticSeverity || (DiagnosticSeverity = {}));\r\n/**\r\n * The diagnostic tags.\r\n *\r\n * @since 3.15.0\r\n */\r\nexport var DiagnosticTag;\r\n(function (DiagnosticTag) {\r\n    /**\r\n     * Unused or unnecessary code.\r\n     *\r\n     * Clients are allowed to render diagnostics with this tag faded out instead of having\r\n     * an error squiggle.\r\n     */\r\n    DiagnosticTag.Unnecessary = 1;\r\n    /**\r\n     * Deprecated or obsolete code.\r\n     *\r\n     * Clients are allowed to rendered diagnostics with this tag strike through.\r\n     */\r\n    DiagnosticTag.Deprecated = 2;\r\n})(DiagnosticTag || (DiagnosticTag = {}));\r\n/**\r\n * The Diagnostic namespace provides helper functions to work with\r\n * [Diagnostic](#Diagnostic) literals.\r\n */\r\nexport var Diagnostic;\r\n(function (Diagnostic) {\r\n    /**\r\n     * Creates a new Diagnostic literal.\r\n     */\r\n    function create(range, message, severity, code, source, relatedInformation) {\r\n        var result = { range: range, message: message };\r\n        if (Is.defined(severity)) {\r\n            result.severity = severity;\r\n        }\r\n        if (Is.defined(code)) {\r\n            result.code = code;\r\n        }\r\n        if (Is.defined(source)) {\r\n            result.source = source;\r\n        }\r\n        if (Is.defined(relatedInformation)) {\r\n            result.relatedInformation = relatedInformation;\r\n        }\r\n        return result;\r\n    }\r\n    Diagnostic.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Diagnostic](#Diagnostic) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate)\r\n            && Range.is(candidate.range)\r\n            && Is.string(candidate.message)\r\n            && (Is.number(candidate.severity) || Is.undefined(candidate.severity))\r\n            && (Is.number(candidate.code) || Is.string(candidate.code) || Is.undefined(candidate.code))\r\n            && (Is.string(candidate.source) || Is.undefined(candidate.source))\r\n            && (Is.undefined(candidate.relatedInformation) || Is.typedArray(candidate.relatedInformation, DiagnosticRelatedInformation.is));\r\n    }\r\n    Diagnostic.is = is;\r\n})(Diagnostic || (Diagnostic = {}));\r\n/**\r\n * The Command namespace provides helper functions to work with\r\n * [Command](#Command) literals.\r\n */\r\nexport var Command;\r\n(function (Command) {\r\n    /**\r\n     * Creates a new Command literal.\r\n     */\r\n    function create(title, command) {\r\n        var args = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            args[_i - 2] = arguments[_i];\r\n        }\r\n        var result = { title: title, command: command };\r\n        if (Is.defined(args) && args.length > 0) {\r\n            result.arguments = args;\r\n        }\r\n        return result;\r\n    }\r\n    Command.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [Command](#Command) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.title) && Is.string(candidate.command);\r\n    }\r\n    Command.is = is;\r\n})(Command || (Command = {}));\r\n/**\r\n * The TextEdit namespace provides helper function to create replace,\r\n * insert and delete edits more easily.\r\n */\r\nexport var TextEdit;\r\n(function (TextEdit) {\r\n    /**\r\n     * Creates a replace text edit.\r\n     * @param range The range of text to be replaced.\r\n     * @param newText The new text.\r\n     */\r\n    function replace(range, newText) {\r\n        return { range: range, newText: newText };\r\n    }\r\n    TextEdit.replace = replace;\r\n    /**\r\n     * Creates a insert text edit.\r\n     * @param position The position to insert the text at.\r\n     * @param newText The text to be inserted.\r\n     */\r\n    function insert(position, newText) {\r\n        return { range: { start: position, end: position }, newText: newText };\r\n    }\r\n    TextEdit.insert = insert;\r\n    /**\r\n     * Creates a delete text edit.\r\n     * @param range The range of text to be deleted.\r\n     */\r\n    function del(range) {\r\n        return { range: range, newText: '' };\r\n    }\r\n    TextEdit.del = del;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.objectLiteral(candidate)\r\n            && Is.string(candidate.newText)\r\n            && Range.is(candidate.range);\r\n    }\r\n    TextEdit.is = is;\r\n})(TextEdit || (TextEdit = {}));\r\n/**\r\n * The TextDocumentEdit namespace provides helper function to create\r\n * an edit that manipulates a text document.\r\n */\r\nexport var TextDocumentEdit;\r\n(function (TextDocumentEdit) {\r\n    /**\r\n     * Creates a new `TextDocumentEdit`\r\n     */\r\n    function create(textDocument, edits) {\r\n        return { textDocument: textDocument, edits: edits };\r\n    }\r\n    TextDocumentEdit.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate)\r\n            && VersionedTextDocumentIdentifier.is(candidate.textDocument)\r\n            && Array.isArray(candidate.edits);\r\n    }\r\n    TextDocumentEdit.is = is;\r\n})(TextDocumentEdit || (TextDocumentEdit = {}));\r\nexport var CreateFile;\r\n(function (CreateFile) {\r\n    function create(uri, options) {\r\n        var result = {\r\n            kind: 'create',\r\n            uri: uri\r\n        };\r\n        if (options !== void 0 && (options.overwrite !== void 0 || options.ignoreIfExists !== void 0)) {\r\n            result.options = options;\r\n        }\r\n        return result;\r\n    }\r\n    CreateFile.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && candidate.kind === 'create' && Is.string(candidate.uri) &&\r\n            (candidate.options === void 0 ||\r\n                ((candidate.options.overwrite === void 0 || Is.boolean(candidate.options.overwrite)) && (candidate.options.ignoreIfExists === void 0 || Is.boolean(candidate.options.ignoreIfExists))));\r\n    }\r\n    CreateFile.is = is;\r\n})(CreateFile || (CreateFile = {}));\r\nexport var RenameFile;\r\n(function (RenameFile) {\r\n    function create(oldUri, newUri, options) {\r\n        var result = {\r\n            kind: 'rename',\r\n            oldUri: oldUri,\r\n            newUri: newUri\r\n        };\r\n        if (options !== void 0 && (options.overwrite !== void 0 || options.ignoreIfExists !== void 0)) {\r\n            result.options = options;\r\n        }\r\n        return result;\r\n    }\r\n    RenameFile.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && candidate.kind === 'rename' && Is.string(candidate.oldUri) && Is.string(candidate.newUri) &&\r\n            (candidate.options === void 0 ||\r\n                ((candidate.options.overwrite === void 0 || Is.boolean(candidate.options.overwrite)) && (candidate.options.ignoreIfExists === void 0 || Is.boolean(candidate.options.ignoreIfExists))));\r\n    }\r\n    RenameFile.is = is;\r\n})(RenameFile || (RenameFile = {}));\r\nexport var DeleteFile;\r\n(function (DeleteFile) {\r\n    function create(uri, options) {\r\n        var result = {\r\n            kind: 'delete',\r\n            uri: uri\r\n        };\r\n        if (options !== void 0 && (options.recursive !== void 0 || options.ignoreIfNotExists !== void 0)) {\r\n            result.options = options;\r\n        }\r\n        return result;\r\n    }\r\n    DeleteFile.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && candidate.kind === 'delete' && Is.string(candidate.uri) &&\r\n            (candidate.options === void 0 ||\r\n                ((candidate.options.recursive === void 0 || Is.boolean(candidate.options.recursive)) && (candidate.options.ignoreIfNotExists === void 0 || Is.boolean(candidate.options.ignoreIfNotExists))));\r\n    }\r\n    DeleteFile.is = is;\r\n})(DeleteFile || (DeleteFile = {}));\r\nexport var WorkspaceEdit;\r\n(function (WorkspaceEdit) {\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate &&\r\n            (candidate.changes !== void 0 || candidate.documentChanges !== void 0) &&\r\n            (candidate.documentChanges === void 0 || candidate.documentChanges.every(function (change) {\r\n                if (Is.string(change.kind)) {\r\n                    return CreateFile.is(change) || RenameFile.is(change) || DeleteFile.is(change);\r\n                }\r\n                else {\r\n                    return TextDocumentEdit.is(change);\r\n                }\r\n            }));\r\n    }\r\n    WorkspaceEdit.is = is;\r\n})(WorkspaceEdit || (WorkspaceEdit = {}));\r\nvar TextEditChangeImpl = /** @class */ (function () {\r\n    function TextEditChangeImpl(edits) {\r\n        this.edits = edits;\r\n    }\r\n    TextEditChangeImpl.prototype.insert = function (position, newText) {\r\n        this.edits.push(TextEdit.insert(position, newText));\r\n    };\r\n    TextEditChangeImpl.prototype.replace = function (range, newText) {\r\n        this.edits.push(TextEdit.replace(range, newText));\r\n    };\r\n    TextEditChangeImpl.prototype.delete = function (range) {\r\n        this.edits.push(TextEdit.del(range));\r\n    };\r\n    TextEditChangeImpl.prototype.add = function (edit) {\r\n        this.edits.push(edit);\r\n    };\r\n    TextEditChangeImpl.prototype.all = function () {\r\n        return this.edits;\r\n    };\r\n    TextEditChangeImpl.prototype.clear = function () {\r\n        this.edits.splice(0, this.edits.length);\r\n    };\r\n    return TextEditChangeImpl;\r\n}());\r\n/**\r\n * A workspace change helps constructing changes to a workspace.\r\n */\r\nvar WorkspaceChange = /** @class */ (function () {\r\n    function WorkspaceChange(workspaceEdit) {\r\n        var _this = this;\r\n        this._textEditChanges = Object.create(null);\r\n        if (workspaceEdit) {\r\n            this._workspaceEdit = workspaceEdit;\r\n            if (workspaceEdit.documentChanges) {\r\n                workspaceEdit.documentChanges.forEach(function (change) {\r\n                    if (TextDocumentEdit.is(change)) {\r\n                        var textEditChange = new TextEditChangeImpl(change.edits);\r\n                        _this._textEditChanges[change.textDocument.uri] = textEditChange;\r\n                    }\r\n                });\r\n            }\r\n            else if (workspaceEdit.changes) {\r\n                Object.keys(workspaceEdit.changes).forEach(function (key) {\r\n                    var textEditChange = new TextEditChangeImpl(workspaceEdit.changes[key]);\r\n                    _this._textEditChanges[key] = textEditChange;\r\n                });\r\n            }\r\n        }\r\n    }\r\n    Object.defineProperty(WorkspaceChange.prototype, \"edit\", {\r\n        /**\r\n         * Returns the underlying [WorkspaceEdit](#WorkspaceEdit) literal\r\n         * use to be returned from a workspace edit operation like rename.\r\n         */\r\n        get: function () {\r\n            return this._workspaceEdit;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    WorkspaceChange.prototype.getTextEditChange = function (key) {\r\n        if (VersionedTextDocumentIdentifier.is(key)) {\r\n            if (!this._workspaceEdit) {\r\n                this._workspaceEdit = {\r\n                    documentChanges: []\r\n                };\r\n            }\r\n            if (!this._workspaceEdit.documentChanges) {\r\n                throw new Error('Workspace edit is not configured for document changes.');\r\n            }\r\n            var textDocument = key;\r\n            var result = this._textEditChanges[textDocument.uri];\r\n            if (!result) {\r\n                var edits = [];\r\n                var textDocumentEdit = {\r\n                    textDocument: textDocument,\r\n                    edits: edits\r\n                };\r\n                this._workspaceEdit.documentChanges.push(textDocumentEdit);\r\n                result = new TextEditChangeImpl(edits);\r\n                this._textEditChanges[textDocument.uri] = result;\r\n            }\r\n            return result;\r\n        }\r\n        else {\r\n            if (!this._workspaceEdit) {\r\n                this._workspaceEdit = {\r\n                    changes: Object.create(null)\r\n                };\r\n            }\r\n            if (!this._workspaceEdit.changes) {\r\n                throw new Error('Workspace edit is not configured for normal text edit changes.');\r\n            }\r\n            var result = this._textEditChanges[key];\r\n            if (!result) {\r\n                var edits = [];\r\n                this._workspaceEdit.changes[key] = edits;\r\n                result = new TextEditChangeImpl(edits);\r\n                this._textEditChanges[key] = result;\r\n            }\r\n            return result;\r\n        }\r\n    };\r\n    WorkspaceChange.prototype.createFile = function (uri, options) {\r\n        this.checkDocumentChanges();\r\n        this._workspaceEdit.documentChanges.push(CreateFile.create(uri, options));\r\n    };\r\n    WorkspaceChange.prototype.renameFile = function (oldUri, newUri, options) {\r\n        this.checkDocumentChanges();\r\n        this._workspaceEdit.documentChanges.push(RenameFile.create(oldUri, newUri, options));\r\n    };\r\n    WorkspaceChange.prototype.deleteFile = function (uri, options) {\r\n        this.checkDocumentChanges();\r\n        this._workspaceEdit.documentChanges.push(DeleteFile.create(uri, options));\r\n    };\r\n    WorkspaceChange.prototype.checkDocumentChanges = function () {\r\n        if (!this._workspaceEdit || !this._workspaceEdit.documentChanges) {\r\n            throw new Error('Workspace edit is not configured for document changes.');\r\n        }\r\n    };\r\n    return WorkspaceChange;\r\n}());\r\nexport { WorkspaceChange };\r\n/**\r\n * The TextDocumentIdentifier namespace provides helper functions to work with\r\n * [TextDocumentIdentifier](#TextDocumentIdentifier) literals.\r\n */\r\nexport var TextDocumentIdentifier;\r\n(function (TextDocumentIdentifier) {\r\n    /**\r\n     * Creates a new TextDocumentIdentifier literal.\r\n     * @param uri The document's uri.\r\n     */\r\n    function create(uri) {\r\n        return { uri: uri };\r\n    }\r\n    TextDocumentIdentifier.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [TextDocumentIdentifier](#TextDocumentIdentifier) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.uri);\r\n    }\r\n    TextDocumentIdentifier.is = is;\r\n})(TextDocumentIdentifier || (TextDocumentIdentifier = {}));\r\n/**\r\n * The VersionedTextDocumentIdentifier namespace provides helper functions to work with\r\n * [VersionedTextDocumentIdentifier](#VersionedTextDocumentIdentifier) literals.\r\n */\r\nexport var VersionedTextDocumentIdentifier;\r\n(function (VersionedTextDocumentIdentifier) {\r\n    /**\r\n     * Creates a new VersionedTextDocumentIdentifier literal.\r\n     * @param uri The document's uri.\r\n     * @param uri The document's text.\r\n     */\r\n    function create(uri, version) {\r\n        return { uri: uri, version: version };\r\n    }\r\n    VersionedTextDocumentIdentifier.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [VersionedTextDocumentIdentifier](#VersionedTextDocumentIdentifier) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.uri) && (candidate.version === null || Is.number(candidate.version));\r\n    }\r\n    VersionedTextDocumentIdentifier.is = is;\r\n})(VersionedTextDocumentIdentifier || (VersionedTextDocumentIdentifier = {}));\r\n/**\r\n * The TextDocumentItem namespace provides helper functions to work with\r\n * [TextDocumentItem](#TextDocumentItem) literals.\r\n */\r\nexport var TextDocumentItem;\r\n(function (TextDocumentItem) {\r\n    /**\r\n     * Creates a new TextDocumentItem literal.\r\n     * @param uri The document's uri.\r\n     * @param languageId The document's language identifier.\r\n     * @param version The document's version number.\r\n     * @param text The document's text.\r\n     */\r\n    function create(uri, languageId, version, text) {\r\n        return { uri: uri, languageId: languageId, version: version, text: text };\r\n    }\r\n    TextDocumentItem.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [TextDocumentItem](#TextDocumentItem) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.uri) && Is.string(candidate.languageId) && Is.number(candidate.version) && Is.string(candidate.text);\r\n    }\r\n    TextDocumentItem.is = is;\r\n})(TextDocumentItem || (TextDocumentItem = {}));\r\n/**\r\n * Describes the content type that a client supports in various\r\n * result literals like `Hover`, `ParameterInfo` or `CompletionItem`.\r\n *\r\n * Please note that `MarkupKinds` must not start with a `$`. This kinds\r\n * are reserved for internal usage.\r\n */\r\nexport var MarkupKind;\r\n(function (MarkupKind) {\r\n    /**\r\n     * Plain text is supported as a content format\r\n     */\r\n    MarkupKind.PlainText = 'plaintext';\r\n    /**\r\n     * Markdown is supported as a content format\r\n     */\r\n    MarkupKind.Markdown = 'markdown';\r\n})(MarkupKind || (MarkupKind = {}));\r\n(function (MarkupKind) {\r\n    /**\r\n     * Checks whether the given value is a value of the [MarkupKind](#MarkupKind) type.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate === MarkupKind.PlainText || candidate === MarkupKind.Markdown;\r\n    }\r\n    MarkupKind.is = is;\r\n})(MarkupKind || (MarkupKind = {}));\r\nexport var MarkupContent;\r\n(function (MarkupContent) {\r\n    /**\r\n     * Checks whether the given value conforms to the [MarkupContent](#MarkupContent) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.objectLiteral(value) && MarkupKind.is(candidate.kind) && Is.string(candidate.value);\r\n    }\r\n    MarkupContent.is = is;\r\n})(MarkupContent || (MarkupContent = {}));\r\n/**\r\n * The kind of a completion entry.\r\n */\r\nexport var CompletionItemKind;\r\n(function (CompletionItemKind) {\r\n    CompletionItemKind.Text = 1;\r\n    CompletionItemKind.Method = 2;\r\n    CompletionItemKind.Function = 3;\r\n    CompletionItemKind.Constructor = 4;\r\n    CompletionItemKind.Field = 5;\r\n    CompletionItemKind.Variable = 6;\r\n    CompletionItemKind.Class = 7;\r\n    CompletionItemKind.Interface = 8;\r\n    CompletionItemKind.Module = 9;\r\n    CompletionItemKind.Property = 10;\r\n    CompletionItemKind.Unit = 11;\r\n    CompletionItemKind.Value = 12;\r\n    CompletionItemKind.Enum = 13;\r\n    CompletionItemKind.Keyword = 14;\r\n    CompletionItemKind.Snippet = 15;\r\n    CompletionItemKind.Color = 16;\r\n    CompletionItemKind.File = 17;\r\n    CompletionItemKind.Reference = 18;\r\n    CompletionItemKind.Folder = 19;\r\n    CompletionItemKind.EnumMember = 20;\r\n    CompletionItemKind.Constant = 21;\r\n    CompletionItemKind.Struct = 22;\r\n    CompletionItemKind.Event = 23;\r\n    CompletionItemKind.Operator = 24;\r\n    CompletionItemKind.TypeParameter = 25;\r\n})(CompletionItemKind || (CompletionItemKind = {}));\r\n/**\r\n * Defines whether the insert text in a completion item should be interpreted as\r\n * plain text or a snippet.\r\n */\r\nexport var InsertTextFormat;\r\n(function (InsertTextFormat) {\r\n    /**\r\n     * The primary text to be inserted is treated as a plain string.\r\n     */\r\n    InsertTextFormat.PlainText = 1;\r\n    /**\r\n     * The primary text to be inserted is treated as a snippet.\r\n     *\r\n     * A snippet can define tab stops and placeholders with `$1`, `$2`\r\n     * and `${3:foo}`. `$0` defines the final tab stop, it defaults to\r\n     * the end of the snippet. Placeholders with equal identifiers are linked,\r\n     * that is typing in one will update others too.\r\n     *\r\n     * See also: https://github.com/Microsoft/vscode/blob/master/src/vs/editor/contrib/snippet/common/snippet.md\r\n     */\r\n    InsertTextFormat.Snippet = 2;\r\n})(InsertTextFormat || (InsertTextFormat = {}));\r\n/**\r\n * Completion item tags are extra annotations that tweak the rendering of a completion\r\n * item.\r\n *\r\n * @since 3.15.0\r\n */\r\nexport var CompletionItemTag;\r\n(function (CompletionItemTag) {\r\n    /**\r\n     * Render a completion as obsolete, usually using a strike-out.\r\n     */\r\n    CompletionItemTag.Deprecated = 1;\r\n})(CompletionItemTag || (CompletionItemTag = {}));\r\n/**\r\n * The CompletionItem namespace provides functions to deal with\r\n * completion items.\r\n */\r\nexport var CompletionItem;\r\n(function (CompletionItem) {\r\n    /**\r\n     * Create a completion item and seed it with a label.\r\n     * @param label The completion item's label\r\n     */\r\n    function create(label) {\r\n        return { label: label };\r\n    }\r\n    CompletionItem.create = create;\r\n})(CompletionItem || (CompletionItem = {}));\r\n/**\r\n * The CompletionList namespace provides functions to deal with\r\n * completion lists.\r\n */\r\nexport var CompletionList;\r\n(function (CompletionList) {\r\n    /**\r\n     * Creates a new completion list.\r\n     *\r\n     * @param items The completion items.\r\n     * @param isIncomplete The list is not complete.\r\n     */\r\n    function create(items, isIncomplete) {\r\n        return { items: items ? items : [], isIncomplete: !!isIncomplete };\r\n    }\r\n    CompletionList.create = create;\r\n})(CompletionList || (CompletionList = {}));\r\nexport var MarkedString;\r\n(function (MarkedString) {\r\n    /**\r\n     * Creates a marked string from plain text.\r\n     *\r\n     * @param plainText The plain text.\r\n     */\r\n    function fromPlainText(plainText) {\r\n        return plainText.replace(/[\\\\`*_{}[\\]()#+\\-.!]/g, '\\\\$&'); // escape markdown syntax tokens: http://daringfireball.net/projects/markdown/syntax#backslash\r\n    }\r\n    MarkedString.fromPlainText = fromPlainText;\r\n    /**\r\n     * Checks whether the given value conforms to the [MarkedString](#MarkedString) type.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.string(candidate) || (Is.objectLiteral(candidate) && Is.string(candidate.language) && Is.string(candidate.value));\r\n    }\r\n    MarkedString.is = is;\r\n})(MarkedString || (MarkedString = {}));\r\nexport var Hover;\r\n(function (Hover) {\r\n    /**\r\n     * Checks whether the given value conforms to the [Hover](#Hover) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return !!candidate && Is.objectLiteral(candidate) && (MarkupContent.is(candidate.contents) ||\r\n            MarkedString.is(candidate.contents) ||\r\n            Is.typedArray(candidate.contents, MarkedString.is)) && (value.range === void 0 || Range.is(value.range));\r\n    }\r\n    Hover.is = is;\r\n})(Hover || (Hover = {}));\r\n/**\r\n * The ParameterInformation namespace provides helper functions to work with\r\n * [ParameterInformation](#ParameterInformation) literals.\r\n */\r\nexport var ParameterInformation;\r\n(function (ParameterInformation) {\r\n    /**\r\n     * Creates a new parameter information literal.\r\n     *\r\n     * @param label A label string.\r\n     * @param documentation A doc string.\r\n     */\r\n    function create(label, documentation) {\r\n        return documentation ? { label: label, documentation: documentation } : { label: label };\r\n    }\r\n    ParameterInformation.create = create;\r\n})(ParameterInformation || (ParameterInformation = {}));\r\n/**\r\n * The SignatureInformation namespace provides helper functions to work with\r\n * [SignatureInformation](#SignatureInformation) literals.\r\n */\r\nexport var SignatureInformation;\r\n(function (SignatureInformation) {\r\n    function create(label, documentation) {\r\n        var parameters = [];\r\n        for (var _i = 2; _i < arguments.length; _i++) {\r\n            parameters[_i - 2] = arguments[_i];\r\n        }\r\n        var result = { label: label };\r\n        if (Is.defined(documentation)) {\r\n            result.documentation = documentation;\r\n        }\r\n        if (Is.defined(parameters)) {\r\n            result.parameters = parameters;\r\n        }\r\n        else {\r\n            result.parameters = [];\r\n        }\r\n        return result;\r\n    }\r\n    SignatureInformation.create = create;\r\n})(SignatureInformation || (SignatureInformation = {}));\r\n/**\r\n * A document highlight kind.\r\n */\r\nexport var DocumentHighlightKind;\r\n(function (DocumentHighlightKind) {\r\n    /**\r\n     * A textual occurrence.\r\n     */\r\n    DocumentHighlightKind.Text = 1;\r\n    /**\r\n     * Read-access of a symbol, like reading a variable.\r\n     */\r\n    DocumentHighlightKind.Read = 2;\r\n    /**\r\n     * Write-access of a symbol, like writing to a variable.\r\n     */\r\n    DocumentHighlightKind.Write = 3;\r\n})(DocumentHighlightKind || (DocumentHighlightKind = {}));\r\n/**\r\n * DocumentHighlight namespace to provide helper functions to work with\r\n * [DocumentHighlight](#DocumentHighlight) literals.\r\n */\r\nexport var DocumentHighlight;\r\n(function (DocumentHighlight) {\r\n    /**\r\n     * Create a DocumentHighlight object.\r\n     * @param range The range the highlight applies to.\r\n     */\r\n    function create(range, kind) {\r\n        var result = { range: range };\r\n        if (Is.number(kind)) {\r\n            result.kind = kind;\r\n        }\r\n        return result;\r\n    }\r\n    DocumentHighlight.create = create;\r\n})(DocumentHighlight || (DocumentHighlight = {}));\r\n/**\r\n * A symbol kind.\r\n */\r\nexport var SymbolKind;\r\n(function (SymbolKind) {\r\n    SymbolKind.File = 1;\r\n    SymbolKind.Module = 2;\r\n    SymbolKind.Namespace = 3;\r\n    SymbolKind.Package = 4;\r\n    SymbolKind.Class = 5;\r\n    SymbolKind.Method = 6;\r\n    SymbolKind.Property = 7;\r\n    SymbolKind.Field = 8;\r\n    SymbolKind.Constructor = 9;\r\n    SymbolKind.Enum = 10;\r\n    SymbolKind.Interface = 11;\r\n    SymbolKind.Function = 12;\r\n    SymbolKind.Variable = 13;\r\n    SymbolKind.Constant = 14;\r\n    SymbolKind.String = 15;\r\n    SymbolKind.Number = 16;\r\n    SymbolKind.Boolean = 17;\r\n    SymbolKind.Array = 18;\r\n    SymbolKind.Object = 19;\r\n    SymbolKind.Key = 20;\r\n    SymbolKind.Null = 21;\r\n    SymbolKind.EnumMember = 22;\r\n    SymbolKind.Struct = 23;\r\n    SymbolKind.Event = 24;\r\n    SymbolKind.Operator = 25;\r\n    SymbolKind.TypeParameter = 26;\r\n})(SymbolKind || (SymbolKind = {}));\r\n/**\r\n * Symbol tags are extra annotations that tweak the rendering of a symbol.\r\n * @since 3.15\r\n */\r\nexport var SymbolTag;\r\n(function (SymbolTag) {\r\n    /**\r\n     * Render a symbol as obsolete, usually using a strike-out.\r\n     */\r\n    SymbolTag.Deprecated = 1;\r\n})(SymbolTag || (SymbolTag = {}));\r\nexport var SymbolInformation;\r\n(function (SymbolInformation) {\r\n    /**\r\n     * Creates a new symbol information literal.\r\n     *\r\n     * @param name The name of the symbol.\r\n     * @param kind The kind of the symbol.\r\n     * @param range The range of the location of the symbol.\r\n     * @param uri The resource of the location of symbol, defaults to the current document.\r\n     * @param containerName The name of the symbol containing the symbol.\r\n     */\r\n    function create(name, kind, range, uri, containerName) {\r\n        var result = {\r\n            name: name,\r\n            kind: kind,\r\n            location: { uri: uri, range: range }\r\n        };\r\n        if (containerName) {\r\n            result.containerName = containerName;\r\n        }\r\n        return result;\r\n    }\r\n    SymbolInformation.create = create;\r\n})(SymbolInformation || (SymbolInformation = {}));\r\nexport var DocumentSymbol;\r\n(function (DocumentSymbol) {\r\n    /**\r\n     * Creates a new symbol information literal.\r\n     *\r\n     * @param name The name of the symbol.\r\n     * @param detail The detail of the symbol.\r\n     * @param kind The kind of the symbol.\r\n     * @param range The range of the symbol.\r\n     * @param selectionRange The selectionRange of the symbol.\r\n     * @param children Children of the symbol.\r\n     */\r\n    function create(name, detail, kind, range, selectionRange, children) {\r\n        var result = {\r\n            name: name,\r\n            detail: detail,\r\n            kind: kind,\r\n            range: range,\r\n            selectionRange: selectionRange\r\n        };\r\n        if (children !== void 0) {\r\n            result.children = children;\r\n        }\r\n        return result;\r\n    }\r\n    DocumentSymbol.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [DocumentSymbol](#DocumentSymbol) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate &&\r\n            Is.string(candidate.name) && Is.number(candidate.kind) &&\r\n            Range.is(candidate.range) && Range.is(candidate.selectionRange) &&\r\n            (candidate.detail === void 0 || Is.string(candidate.detail)) &&\r\n            (candidate.deprecated === void 0 || Is.boolean(candidate.deprecated)) &&\r\n            (candidate.children === void 0 || Array.isArray(candidate.children));\r\n    }\r\n    DocumentSymbol.is = is;\r\n})(DocumentSymbol || (DocumentSymbol = {}));\r\n/**\r\n * A set of predefined code action kinds\r\n */\r\nexport var CodeActionKind;\r\n(function (CodeActionKind) {\r\n    /**\r\n     * Empty kind.\r\n     */\r\n    CodeActionKind.Empty = '';\r\n    /**\r\n     * Base kind for quickfix actions: 'quickfix'\r\n     */\r\n    CodeActionKind.QuickFix = 'quickfix';\r\n    /**\r\n     * Base kind for refactoring actions: 'refactor'\r\n     */\r\n    CodeActionKind.Refactor = 'refactor';\r\n    /**\r\n     * Base kind for refactoring extraction actions: 'refactor.extract'\r\n     *\r\n     * Example extract actions:\r\n     *\r\n     * - Extract method\r\n     * - Extract function\r\n     * - Extract variable\r\n     * - Extract interface from class\r\n     * - ...\r\n     */\r\n    CodeActionKind.RefactorExtract = 'refactor.extract';\r\n    /**\r\n     * Base kind for refactoring inline actions: 'refactor.inline'\r\n     *\r\n     * Example inline actions:\r\n     *\r\n     * - Inline function\r\n     * - Inline variable\r\n     * - Inline constant\r\n     * - ...\r\n     */\r\n    CodeActionKind.RefactorInline = 'refactor.inline';\r\n    /**\r\n     * Base kind for refactoring rewrite actions: 'refactor.rewrite'\r\n     *\r\n     * Example rewrite actions:\r\n     *\r\n     * - Convert JavaScript function to class\r\n     * - Add or remove parameter\r\n     * - Encapsulate field\r\n     * - Make method static\r\n     * - Move method to base class\r\n     * - ...\r\n     */\r\n    CodeActionKind.RefactorRewrite = 'refactor.rewrite';\r\n    /**\r\n     * Base kind for source actions: `source`\r\n     *\r\n     * Source code actions apply to the entire file.\r\n     */\r\n    CodeActionKind.Source = 'source';\r\n    /**\r\n     * Base kind for an organize imports source action: `source.organizeImports`\r\n     */\r\n    CodeActionKind.SourceOrganizeImports = 'source.organizeImports';\r\n    /**\r\n     * Base kind for auto-fix source actions: `source.fixAll`.\r\n     *\r\n     * Fix all actions automatically fix errors that have a clear fix that do not require user input.\r\n     * They should not suppress errors or perform unsafe fixes such as generating new types or classes.\r\n     *\r\n     * @since 3.15.0\r\n     */\r\n    CodeActionKind.SourceFixAll = 'source.fixAll';\r\n})(CodeActionKind || (CodeActionKind = {}));\r\n/**\r\n * The CodeActionContext namespace provides helper functions to work with\r\n * [CodeActionContext](#CodeActionContext) literals.\r\n */\r\nexport var CodeActionContext;\r\n(function (CodeActionContext) {\r\n    /**\r\n     * Creates a new CodeActionContext literal.\r\n     */\r\n    function create(diagnostics, only) {\r\n        var result = { diagnostics: diagnostics };\r\n        if (only !== void 0 && only !== null) {\r\n            result.only = only;\r\n        }\r\n        return result;\r\n    }\r\n    CodeActionContext.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [CodeActionContext](#CodeActionContext) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.typedArray(candidate.diagnostics, Diagnostic.is) && (candidate.only === void 0 || Is.typedArray(candidate.only, Is.string));\r\n    }\r\n    CodeActionContext.is = is;\r\n})(CodeActionContext || (CodeActionContext = {}));\r\nexport var CodeAction;\r\n(function (CodeAction) {\r\n    function create(title, commandOrEdit, kind) {\r\n        var result = { title: title };\r\n        if (Command.is(commandOrEdit)) {\r\n            result.command = commandOrEdit;\r\n        }\r\n        else {\r\n            result.edit = commandOrEdit;\r\n        }\r\n        if (kind !== void 0) {\r\n            result.kind = kind;\r\n        }\r\n        return result;\r\n    }\r\n    CodeAction.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate && Is.string(candidate.title) &&\r\n            (candidate.diagnostics === void 0 || Is.typedArray(candidate.diagnostics, Diagnostic.is)) &&\r\n            (candidate.kind === void 0 || Is.string(candidate.kind)) &&\r\n            (candidate.edit !== void 0 || candidate.command !== void 0) &&\r\n            (candidate.command === void 0 || Command.is(candidate.command)) &&\r\n            (candidate.isPreferred === void 0 || Is.boolean(candidate.isPreferred)) &&\r\n            (candidate.edit === void 0 || WorkspaceEdit.is(candidate.edit));\r\n    }\r\n    CodeAction.is = is;\r\n})(CodeAction || (CodeAction = {}));\r\n/**\r\n * The CodeLens namespace provides helper functions to work with\r\n * [CodeLens](#CodeLens) literals.\r\n */\r\nexport var CodeLens;\r\n(function (CodeLens) {\r\n    /**\r\n     * Creates a new CodeLens literal.\r\n     */\r\n    function create(range, data) {\r\n        var result = { range: range };\r\n        if (Is.defined(data)) {\r\n            result.data = data;\r\n        }\r\n        return result;\r\n    }\r\n    CodeLens.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [CodeLens](#CodeLens) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Range.is(candidate.range) && (Is.undefined(candidate.command) || Command.is(candidate.command));\r\n    }\r\n    CodeLens.is = is;\r\n})(CodeLens || (CodeLens = {}));\r\n/**\r\n * The FormattingOptions namespace provides helper functions to work with\r\n * [FormattingOptions](#FormattingOptions) literals.\r\n */\r\nexport var FormattingOptions;\r\n(function (FormattingOptions) {\r\n    /**\r\n     * Creates a new FormattingOptions literal.\r\n     */\r\n    function create(tabSize, insertSpaces) {\r\n        return { tabSize: tabSize, insertSpaces: insertSpaces };\r\n    }\r\n    FormattingOptions.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [FormattingOptions](#FormattingOptions) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.number(candidate.tabSize) && Is.boolean(candidate.insertSpaces);\r\n    }\r\n    FormattingOptions.is = is;\r\n})(FormattingOptions || (FormattingOptions = {}));\r\n/**\r\n * The DocumentLink namespace provides helper functions to work with\r\n * [DocumentLink](#DocumentLink) literals.\r\n */\r\nexport var DocumentLink;\r\n(function (DocumentLink) {\r\n    /**\r\n     * Creates a new DocumentLink literal.\r\n     */\r\n    function create(range, target, data) {\r\n        return { range: range, target: target, data: data };\r\n    }\r\n    DocumentLink.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [DocumentLink](#DocumentLink) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Range.is(candidate.range) && (Is.undefined(candidate.target) || Is.string(candidate.target));\r\n    }\r\n    DocumentLink.is = is;\r\n})(DocumentLink || (DocumentLink = {}));\r\n/**\r\n * The SelectionRange namespace provides helper function to work with\r\n * SelectionRange literals.\r\n */\r\nexport var SelectionRange;\r\n(function (SelectionRange) {\r\n    /**\r\n     * Creates a new SelectionRange\r\n     * @param range the range.\r\n     * @param parent an optional parent.\r\n     */\r\n    function create(range, parent) {\r\n        return { range: range, parent: parent };\r\n    }\r\n    SelectionRange.create = create;\r\n    function is(value) {\r\n        var candidate = value;\r\n        return candidate !== undefined && Range.is(candidate.range) && (candidate.parent === undefined || SelectionRange.is(candidate.parent));\r\n    }\r\n    SelectionRange.is = is;\r\n})(SelectionRange || (SelectionRange = {}));\r\nexport var EOL = ['\\n', '\\r\\n', '\\r'];\r\n/**\r\n * @deprecated Use the text document from the new vscode-languageserver-textdocument package.\r\n */\r\nexport var TextDocument;\r\n(function (TextDocument) {\r\n    /**\r\n     * Creates a new ITextDocument literal from the given uri and content.\r\n     * @param uri The document's uri.\r\n     * @param languageId  The document's language Id.\r\n     * @param content The document's content.\r\n     */\r\n    function create(uri, languageId, version, content) {\r\n        return new FullTextDocument(uri, languageId, version, content);\r\n    }\r\n    TextDocument.create = create;\r\n    /**\r\n     * Checks whether the given literal conforms to the [ITextDocument](#ITextDocument) interface.\r\n     */\r\n    function is(value) {\r\n        var candidate = value;\r\n        return Is.defined(candidate) && Is.string(candidate.uri) && (Is.undefined(candidate.languageId) || Is.string(candidate.languageId)) && Is.number(candidate.lineCount)\r\n            && Is.func(candidate.getText) && Is.func(candidate.positionAt) && Is.func(candidate.offsetAt) ? true : false;\r\n    }\r\n    TextDocument.is = is;\r\n    function applyEdits(document, edits) {\r\n        var text = document.getText();\r\n        var sortedEdits = mergeSort(edits, function (a, b) {\r\n            var diff = a.range.start.line - b.range.start.line;\r\n            if (diff === 0) {\r\n                return a.range.start.character - b.range.start.character;\r\n            }\r\n            return diff;\r\n        });\r\n        var lastModifiedOffset = text.length;\r\n        for (var i = sortedEdits.length - 1; i >= 0; i--) {\r\n            var e = sortedEdits[i];\r\n            var startOffset = document.offsetAt(e.range.start);\r\n            var endOffset = document.offsetAt(e.range.end);\r\n            if (endOffset <= lastModifiedOffset) {\r\n                text = text.substring(0, startOffset) + e.newText + text.substring(endOffset, text.length);\r\n            }\r\n            else {\r\n                throw new Error('Overlapping edit');\r\n            }\r\n            lastModifiedOffset = startOffset;\r\n        }\r\n        return text;\r\n    }\r\n    TextDocument.applyEdits = applyEdits;\r\n    function mergeSort(data, compare) {\r\n        if (data.length <= 1) {\r\n            // sorted\r\n            return data;\r\n        }\r\n        var p = (data.length / 2) | 0;\r\n        var left = data.slice(0, p);\r\n        var right = data.slice(p);\r\n        mergeSort(left, compare);\r\n        mergeSort(right, compare);\r\n        var leftIdx = 0;\r\n        var rightIdx = 0;\r\n        var i = 0;\r\n        while (leftIdx < left.length && rightIdx < right.length) {\r\n            var ret = compare(left[leftIdx], right[rightIdx]);\r\n            if (ret <= 0) {\r\n                // smaller_equal -> take left to preserve order\r\n                data[i++] = left[leftIdx++];\r\n            }\r\n            else {\r\n                // greater -> take right\r\n                data[i++] = right[rightIdx++];\r\n            }\r\n        }\r\n        while (leftIdx < left.length) {\r\n            data[i++] = left[leftIdx++];\r\n        }\r\n        while (rightIdx < right.length) {\r\n            data[i++] = right[rightIdx++];\r\n        }\r\n        return data;\r\n    }\r\n})(TextDocument || (TextDocument = {}));\r\nvar FullTextDocument = /** @class */ (function () {\r\n    function FullTextDocument(uri, languageId, version, content) {\r\n        this._uri = uri;\r\n        this._languageId = languageId;\r\n        this._version = version;\r\n        this._content = content;\r\n        this._lineOffsets = undefined;\r\n    }\r\n    Object.defineProperty(FullTextDocument.prototype, \"uri\", {\r\n        get: function () {\r\n            return this._uri;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FullTextDocument.prototype, \"languageId\", {\r\n        get: function () {\r\n            return this._languageId;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FullTextDocument.prototype, \"version\", {\r\n        get: function () {\r\n            return this._version;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    FullTextDocument.prototype.getText = function (range) {\r\n        if (range) {\r\n            var start = this.offsetAt(range.start);\r\n            var end = this.offsetAt(range.end);\r\n            return this._content.substring(start, end);\r\n        }\r\n        return this._content;\r\n    };\r\n    FullTextDocument.prototype.update = function (event, version) {\r\n        this._content = event.text;\r\n        this._version = version;\r\n        this._lineOffsets = undefined;\r\n    };\r\n    FullTextDocument.prototype.getLineOffsets = function () {\r\n        if (this._lineOffsets === undefined) {\r\n            var lineOffsets = [];\r\n            var text = this._content;\r\n            var isLineStart = true;\r\n            for (var i = 0; i < text.length; i++) {\r\n                if (isLineStart) {\r\n                    lineOffsets.push(i);\r\n                    isLineStart = false;\r\n                }\r\n                var ch = text.charAt(i);\r\n                isLineStart = (ch === '\\r' || ch === '\\n');\r\n                if (ch === '\\r' && i + 1 < text.length && text.charAt(i + 1) === '\\n') {\r\n                    i++;\r\n                }\r\n            }\r\n            if (isLineStart && text.length > 0) {\r\n                lineOffsets.push(text.length);\r\n            }\r\n            this._lineOffsets = lineOffsets;\r\n        }\r\n        return this._lineOffsets;\r\n    };\r\n    FullTextDocument.prototype.positionAt = function (offset) {\r\n        offset = Math.max(Math.min(offset, this._content.length), 0);\r\n        var lineOffsets = this.getLineOffsets();\r\n        var low = 0, high = lineOffsets.length;\r\n        if (high === 0) {\r\n            return Position.create(0, offset);\r\n        }\r\n        while (low < high) {\r\n            var mid = Math.floor((low + high) / 2);\r\n            if (lineOffsets[mid] > offset) {\r\n                high = mid;\r\n            }\r\n            else {\r\n                low = mid + 1;\r\n            }\r\n        }\r\n        // low is the least x for which the line offset is larger than the current offset\r\n        // or array.length if no line offset is larger than the current offset\r\n        var line = low - 1;\r\n        return Position.create(line, offset - lineOffsets[line]);\r\n    };\r\n    FullTextDocument.prototype.offsetAt = function (position) {\r\n        var lineOffsets = this.getLineOffsets();\r\n        if (position.line >= lineOffsets.length) {\r\n            return this._content.length;\r\n        }\r\n        else if (position.line < 0) {\r\n            return 0;\r\n        }\r\n        var lineOffset = lineOffsets[position.line];\r\n        var nextLineOffset = (position.line + 1 < lineOffsets.length) ? lineOffsets[position.line + 1] : this._content.length;\r\n        return Math.max(Math.min(lineOffset + position.character, nextLineOffset), lineOffset);\r\n    };\r\n    Object.defineProperty(FullTextDocument.prototype, \"lineCount\", {\r\n        get: function () {\r\n            return this.getLineOffsets().length;\r\n        },\r\n        enumerable: true,\r\n        configurable: true\r\n    });\r\n    return FullTextDocument;\r\n}());\r\nvar Is;\r\n(function (Is) {\r\n    var toString = Object.prototype.toString;\r\n    function defined(value) {\r\n        return typeof value !== 'undefined';\r\n    }\r\n    Is.defined = defined;\r\n    function undefined(value) {\r\n        return typeof value === 'undefined';\r\n    }\r\n    Is.undefined = undefined;\r\n    function boolean(value) {\r\n        return value === true || value === false;\r\n    }\r\n    Is.boolean = boolean;\r\n    function string(value) {\r\n        return toString.call(value) === '[object String]';\r\n    }\r\n    Is.string = string;\r\n    function number(value) {\r\n        return toString.call(value) === '[object Number]';\r\n    }\r\n    Is.number = number;\r\n    function func(value) {\r\n        return toString.call(value) === '[object Function]';\r\n    }\r\n    Is.func = func;\r\n    function objectLiteral(value) {\r\n        // Strictly speaking class instances pass this check as well. Since the LSP\r\n        // doesn't use classes we ignore this for now. If we do we need to add something\r\n        // like this: `Object.getPrototypeOf(Object.getPrototypeOf(x)) === null`\r\n        return value !== null && typeof value === 'object';\r\n    }\r\n    Is.objectLiteral = objectLiteral;\r\n    function typedArray(value, check) {\r\n        return Array.isArray(value) && value.every(check);\r\n    }\r\n    Is.typedArray = typedArray;\r\n})(Is || (Is = {}));\r\n","module.exports = require(\"buffer\");;","module.exports = require(\"child_process\");;","module.exports = require(\"crypto\");;","module.exports = require(\"fs\");;","module.exports = require(\"net\");;","module.exports = require(\"os\");;","module.exports = require(\"path\");;","module.exports = require(\"stream\");;","module.exports = require(\"string_decoder\");;","module.exports = require(\"vscode\");;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","import * as vscode from 'vscode';\nimport * as path from 'path';\nimport * as net from 'net';\nimport * as opn from \"open\";\nconst fp = require('find-free-port');\nconst psTree = require('ps-tree');\nimport * as cp from 'child_process';\nimport { \n\tLanguageClient,\n\tLanguageClientOptions,\n    NotificationType,\n\tServerOptions,\n\tTransportKind } from 'vscode-languageclient';\nimport { EEXIST } from 'constants';\nconst fs = require('fs')\n\nlet outputChannel = vscode.window.createOutputChannel('wolf-lsp');\nlet context:vscode.ExtensionContext;\n\nimport {startLanguageServer, stop} from './clients'\nimport { kill } from 'process';\n// let kernelStatusBar:vscode.StatusBarItem = vscode.window.createStatusBarItem(vscode.StatusBarAlignment.Left);\n\n// function retry(fn:any, retries=5, err=null) {\n//     if (!retries) {\n//         return Promise.reject(err);\n//     }\n//     return fn().catch((err:any) => {\n//         return retry(fn, (retries - 1), err);\n//     });\n// }\n\nexport function activate(context0: vscode.ExtensionContext){\n    context = context0;\n    let lspPath = context.asAbsolutePath(path.join('wolfram', 'wolfram-lsp.wl'));\n    let kernelPath = context.asAbsolutePath(path.join('wolfram', 'wolfram-kernel.wl'));\n\n    startLanguageServer(context, outputChannel)\n    vscode.workspace.onWillSaveTextDocument(willsaveDocument) \n\n}\n\n\nfunction willsaveDocument(event:vscode.TextDocumentWillSaveEvent) {\n    if(event.document.fileName.endsWith(\".nb\")) {\n        \n    }\n}\n\nexport function deactivate() {\n    console.log(\"deactivate\");\n    stop()// if (kernelStatusBar) {\n}\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n"],"sourceRoot":""}